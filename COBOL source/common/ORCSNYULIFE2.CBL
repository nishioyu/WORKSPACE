      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSNYULIFE2.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : 入院
      *  コンポーネント名  : 入院時生活療養費負担額取得サブ
      *                      （平成２８年４月改正対応）
      *  管理者            : 
      *  作成日付    作業者        記述
      *  16/02/17    NACL−小豆沢  新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  03.05.00    NACL-太田    07/05/10  グループ診療対応
      *              NACL-小豆沢  07/07/12  患者所得情報の取得をサブ
      *                                     ルーチンに変更
      *  04.01.00    NACL-小豆沢  07/12/17  短期滞在手術基本料２の入院
      *                                     翌日食事算定対応
      *平成２０年４月改定対応
      *  04.02.00    NACL-小豆沢  08/03/05  後期高齢者の判定変更
      *                                     生活療養の入院料判定追加
      *                                       短期滞在手術基本料３
      *                                       回復期リハビリテーション病棟入院料１
      *                                       回復期リハビリテーション病棟入院料２
      *  04.02.00    NACL-小豆沢  08/04/11  後期高齢者の判定をサブルーチン使用
      *                                     に変更
      *  04.02.00    NACL-小豆沢  08/05/02  特別入院基本料算定時にＡＤＬ入力から
      *                                     医療度の高い患者を判定
      *平成２７年１月難病対応
      *  04.07.00    NACL-小豆沢  15/06/02  地域包括ケア病棟入院料及び
      *                                     地域包括ケア入院医療管理料の
      *                                     算定で難病公費の算定時に
      *                                     医療度の高い患者とする判定追加
      *平成２８年４月改正対応
      *  04.08.00    NACL-小豆沢  16/02/17  ORCSNYULIFE.CBL -->  ORCSNYULIFE2.CBL
      *                                   ・経腸栄養対応の為、食事の返却を
      *                                     朝昼夕に分割
      *                                   ・難病、又は小児慢性特定疾患は
      *                                     医療度の高い患者とする
      *平成２９年１０月改正対応
      *  05.00.00    NACL-小豆沢  17/08/16  居住費金額変更対応
      *                                     境界層対応
      *                                     生活療養負担コード分割対応
      *  05.00.00    NACL-小豆沢  17/08/24  特定入院料の算定要件外で算定
      *                                     する療養病棟入院基本料Ｉの
      *                                     コード判定追加
      *  05.00.00    NACL-小豆沢  17/11/22  患者年齢６３歳以下は生活療養
      *                                     対象外のリターンコード返却
      *平成３０年４月改正対応
      *  05.00.00    NACL-小豆沢  18/02/27  生活療養食事負担額変更対応
      *                                     居住費負担額変更対応
      *  05.00.00    NACL-小豆沢  18/03/07  生活療養の医療度判定変更
      *  05.00.00    NACL-小豆沢  18/11/14  難病判定に急性増悪による転棟
      *                                     のシステム予約コード入力追加
      *令和２年４月改正対応
      *  05.00.00    NACL-小豆沢  20/03/09  短期滞在３廃止及び追加対応
      *  05.00.00    NACL-小豆沢  20/03/09  療養病棟入院２（経過措置２）廃止対応
      *  05.00.00    NACL-小豆沢  20/03/09  生活療養食事療養標準負担算定
      *                                     197002410 -> 197002310
      *  05.00.00    NACL-小豆沢  20/09/17  地域包括ケア病棟入院料の経過措置
      *                                     終了に伴う地域包括ケア病棟特別入院料
      *                                     の追加
      *  05.00.00    NACL-小豆沢  20/10/09  以下の特定入院料について診療行為で
      *                                     難病公費を使用された場合も据え置き
      *                                     の食事負担とする
      *                                     ・地域包括ケア病棟入院料
      *                                     ・地域包括ケア入院医療管理料
      *  05.00.00    NACL-小豆沢  20/10/28  月内の食事療養費変更に対応
      *  05.02.01    ORCAMO       24/05/15  令和６年改正対応
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    フラグ領域
       01  FLG-AREA.
           03  FLG-NYUINACCT               PIC 9(01).
           03  FLG-NYUINACT                PIC 9(01).
           03  FLG-PTINF                   PIC 9(01).
           03  FLG-PTHKNINF                PIC 9(01).
           03  FLG-PTKOHINF                PIC 9(01).
           03  FLG-SYSKANRI                PIC 9(01).
           03  FLG-OK                      PIC 9(01).
           03  FLG-RJN                     PIC 9(01).
           03  FLG-SEI                     PIC 9(01).
           03  FLG-PTNYUINRRK              PIC 9(01).
           03  FLG-HKNCOMBI                PIC 9(01).
           03  FLG-NANBYO                  PIC 9(01).
      *    添字領域
       01  IDX-AREA.
           03  IDX                         PIC 9(04).
           03  IDX1                        PIC 9(04).
           03  IDV                         PIC 9(02).
           03  TSY90-IDX                   PIC 9(02).
           03  IDX-RJN                     PIC 9(02).
           03  IDX-SEI                     PIC 9(04).
           03  IDX-SEI2                    PIC 9(04).
           03  IDX-T                       PIC 9(04).
           03  IDX-ST                      PIC 9(02).
           03  IDX-ED                      PIC 9(02).
      *
      *    コンスタント値
      *    平成２８年度改定生活療養判定用
      *  （医療度の高い生活療養を上位にまとめているので、データの並びに注意すること）
      *  （特別入院基本料は特別な判定があることからデータの最後とする）
       01  TBL-H28-SEIKATSU-AREA.
      *  医療度の高い生活療養
      *    回復期リハビリテーション病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190150210".
      *    回復期リハビリテーション病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190141710".
      *    回復期リハビリテーション病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190141910".
      *    短期滞在手術基本料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190125310".
      *    有床診療所療養病床入院基本料Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124310".
      *    有床診療所療養病床入院基本料Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124410".
      *    有床診療所療養病床入院基本料Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124510".
      *    療養病床以外・有床診療所療養病床入院Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155410".
      *    療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155810".
      *10  療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156210".
      *    療養病棟入院基本料１（入院基本料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123710".
      *    療養病棟入院基本料１（入院基本料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123810".
      *    療養病棟入院基本料１（入院基本料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123910".
      *    療養病棟入院基本料１（入院基本料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124010".
      *    療養病棟入院基本料１（入院基本料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124110".
      *    療養病棟入院基本料１（入院基本料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131710".
      *    療養病棟入院基本料２（入院基本料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132510".
      *    療養病棟入院基本料２（入院基本料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132710".
      *    療養病棟入院基本料２（入院基本料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132910".
      *20  療養病棟入院基本料２（入院基本料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133110".
      *    療養病棟入院基本料２（入院基本料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133310".
      *    療養病棟入院基本料２（入院基本料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133510".
      *    療養病棟入院基本料２（入院基本料Ａ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190166210".
      *    療養病棟入院基本料２（入院基本料Ｂ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190166410".
      *    療養病棟入院基本料２（入院基本料Ｃ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190166610".
      *    療養病棟入院基本料２（入院基本料Ｄ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190166810".
      *    療養病棟入院基本料２（入院基本料Ｅ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190167010".
      *    療養病棟入院基本料２（入院基本料Ｆ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190167210".
      *    療養病棟入院基本料２（入院基本料Ａ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190183810".
      *30  療養病棟入院基本料２（入院基本料Ｂ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190184010".
      *    療養病棟入院基本料２（入院基本料Ｃ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190184210".
      *    療養病棟入院基本料２（入院基本料Ｄ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190184410".
      *    療養病棟入院基本料２（入院基本料Ｅ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190184610".
      *    療養病棟入院基本料２（入院基本料Ｆ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190184810".
      *    療養病棟入院基本料２（入院基本料Ａ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190185610".
      *    療養病棟入院基本料２（入院基本料Ｂ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190185810".
      *    療養病棟入院基本料２（入院基本料Ｃ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190186010".
      *    療養病棟入院基本料２（入院基本料Ｄ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190186210".
      *    療養病棟入院基本料２（入院基本料Ｅ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190186410".
      *40  療養病棟入院基本料２（入院基本料Ｆ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190186610".
      *
      *  医療度の高くない生活療養
      *41  有床診療所療養病床入院基本料Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124610".
      *    有床診療所療養病床入院基本料Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124710".
      *    療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156610".
      *    療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190157010".
      *    療養病棟入院基本料１（入院基本料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131910".
      *    療養病棟入院基本料１（入院基本料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132110".
      *    療養病棟入院基本料１（入院基本料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132310".
      *    療養病棟入院基本料２（入院基本料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133710".
      *    療養病棟入院基本料２（入院基本料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133910".
      *50  療養病棟入院基本料２（入院基本料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190134110".
      *    療養病棟入院基本料２（入院基本料Ｇ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190167410".
      *    療養病棟入院基本料２（入院基本料Ｈ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190167610".
      *    療養病棟入院基本料２（入院基本料Ｉ）（生活療養）（夜勤時間超過減算）
           03   FILLER                     PIC X(09) VALUE "190167810".
      *    療養病棟入院基本料２（入院基本料Ｇ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190185010".
      *    療養病棟入院基本料２（入院基本料Ｈ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190185210".
      *    療養病棟入院基本料２（入院基本料Ｉ）（生活療養）（看護職員数等経過措置）
           03   FILLER                     PIC X(09) VALUE "190185410".
      *    療養病棟入院基本料２（入院基本料Ｇ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190186810".
      *    療養病棟入院基本料２（入院基本料Ｈ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190187010".
      *    療養病棟入院基本料２（入院基本料Ｉ）（生活療養）（夜勤時間特別入院基本料）
           03   FILLER                     PIC X(09) VALUE "190187210".
      *60  短手３
           03   FILLER                     PIC X(09) VALUE "190177710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190177910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178510".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179510".
      *70  短手３
           03   FILLER                     PIC X(09) VALUE "190179710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180510".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181510".
      *80  短手３
           03   FILLER                     PIC X(09) VALUE "190181710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190182110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196010".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196210".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196410".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196810".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197010".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197410".
      *90  短手３
           03   FILLER                     PIC X(09) VALUE "190197510".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197610".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197810".
      *93  短手３
           03   FILLER                     PIC X(09) VALUE "190198010".
      *94  地域包括ケア病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190175410".
      *    地域包括ケア入院医療管理料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190175610".
      *    地域包括ケア病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190175810".
      *    地域包括ケア入院医療管理料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190176010".
      *    地域包括ケア病棟入院料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190176210".
      *    地域包括ケア入院医療管理料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190176410".
      *    地域包括ケア病棟入院料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190176610".
      *101 地域包括ケア入院医療管理料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190176810".
      *
      *102 有床診療所療養病床入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124810".
      *103 療養病棟入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124210".
      *
       01  TBL-H28-SEIKATSU-R     REDEFINES  TBL-H28-SEIKATSU-AREA.
           03   TBL-H28-SEISRYCD           PIC X(09)  OCCURS  103.
      *
      *
      *    平成３０年度改定生活療養判定用
      *  （医療度の高い生活療養を上位にまとめているので、データの並びに注意すること）
      *  （特別入院基本料は特別な判定があることからデータの最後とする）
       01  TBL-H30-SEIKATSU-AREA.
      *  医療度の高い生活療養
      *    回復期リハビリテーション病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208010".
      *    回復期リハビリテーション病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208210".
      *    回復期リハビリテーション病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208410".
      *    回復期リハビリテーション病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208610".
      *    回復期リハビリテーション病棟入院料５（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208810".
      *    回復期リハビリテーション病棟入院料６（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209010".
      *    短期滞在手術基本料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190125310".
      *    有床診療所療養病床入院基本料Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124310".
      *    有床診療所療養病床入院基本料Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124410".
      *10  有床診療所療養病床入院基本料Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124510".
      *    療養病床以外・有床診療所療養病床入院Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155410".
      *    療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155810".
      *    療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156210".
      *    療養病棟入院料１（入院料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123710".
      *    療養病棟入院料１（入院料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123810".
      *    療養病棟入院料１（入院料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123910".
      *    療養病棟入院料１（入院料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124010".
      *    療養病棟入院料１（入院料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124110".
      *    療養病棟入院料１（入院料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131710".
      *20  療養病棟入院料２（入院料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132510".
      *    療養病棟入院料２（入院料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132710".
      *    療養病棟入院料２（入院料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132910".
      *    療養病棟入院料２（入院料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133110".
      *    療養病棟入院料２（入院料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133310".
      *    療養病棟入院料２（入院料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133510".
      *    療養病棟入院料２（入院料Ａ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190202610".
      *    療養病棟入院料２（入院料Ｂ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190202810".
      *    療養病棟入院料２（入院料Ｃ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190203010".
      *    療養病棟入院料２（入院料Ｄ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190203210".
      *30  療養病棟入院料２（入院料Ｅ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190203410".
      *    療養病棟入院料２（入院料Ｆ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190203610".
      *    療養病棟入院料２（入院基本料Ａ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190215210".
      *    療養病棟入院料２（入院基本料Ｂ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190215410".
      *    療養病棟入院料２（入院基本料Ｃ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190215610".
      *    療養病棟入院料２（入院基本料Ｄ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190215810".
      *    療養病棟入院料２（入院基本料Ｅ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190216010".
      *37  療養病棟入院料２（入院基本料Ｆ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190216210".
      *
      *  医療度の高くない生活療養
      *38  有床診療所療養病床入院基本料Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124610".
      *    有床診療所療養病床入院基本料Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124710".
      *40  療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156610".
      *    療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190157010".
      *    療養病棟入院料１（入院料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131910".
      *    療養病棟入院料１（入院料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132110".
      *    療養病棟入院料１（入院料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132310".
      *    療養病棟入院料２（入院料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133710".
      *    療養病棟入院料２（入院料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133910".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190134110".
      *    療養病棟入院料２（入院料Ｇ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190203810".
      *    療養病棟入院料２（入院料Ｈ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190204010".
      *50  療養病棟入院料２（入院料Ｉ）（生活療養）（経過措置２）
           03   FILLER                     PIC X(09) VALUE "190204210".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）（経過措置２・通則８）
           03   FILLER                     PIC X(09) VALUE "190204410".
      *    療養病棟入院料２（入院料Ｇ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190216410".
      *    療養病棟入院料２（入院料Ｈ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190216610".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）（経過措置１）
           03   FILLER                     PIC X(09) VALUE "190216810".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178510".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190178910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179110".
      *60  短手３
           03   FILLER                     PIC X(09) VALUE "190179310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190179910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190180710".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181310".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181510".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190181710".
      *70  短手３
           03   FILLER                     PIC X(09) VALUE "190181910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190182110".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196010".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196410".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196810".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190196910".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197010".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197410".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197510".
      *    短手３
           03   FILLER                     PIC X(09) VALUE "190197610".
      *80  短手３
           03   FILLER                     PIC X(09) VALUE "190197810".
      *81  短手３
           03   FILLER                     PIC X(09) VALUE "190198010".
      *82  地域包括ケア病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209210".
      *    地域包括ケア入院医療管理料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209410".
      *    地域包括ケア病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209610".
      *    地域包括ケア入院医療管理料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209810".
      *    地域包括ケア病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210010".
      *    地域包括ケア入院医療管理料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210210".
      *    地域包括ケア病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210410".
      *    地域包括ケア入院医療管理料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210610".
      *90  地域包括ケア病棟入院料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190210810".
      *    地域包括ケア入院医療管理料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211010".
      *    地域包括ケア病棟入院料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211210".
      *    地域包括ケア入院医療管理料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211410".
      *    地域包括ケア病棟入院料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211610".
      *    地域包括ケア入院医療管理料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211810".
      *    地域包括ケア病棟入院料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190212010".
      *97  地域包括ケア入院医療管理料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190212210".
      *
      *98  有床診療所療養病床入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124810".
      *99  療養病棟入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124210".
      *
       01  TBL-H30-SEIKATSU-R     REDEFINES  TBL-H30-SEIKATSU-AREA.
           03   TBL-H30-SEISRYCD           PIC X(09)  OCCURS  99.
      *
      *
      *    令和２年度改定生活療養判定用
      *  （医療度の高い生活療養を上位にまとめているので、データの並びに注意すること）
      *  （特別入院基本料は特別な判定があることからデータの最後とする）
       01  TBL-R02-SEIKATSU-AREA.
      *  医療度の高い生活療養
      *    回復期リハビリテーション病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208010".
      *    回復期リハビリテーション病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208210".
      *    回復期リハビリテーション病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208410".
      *    回復期リハビリテーション病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208610".
      *    回復期リハビリテーション病棟入院料５（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208810".
      *    回復期リハビリテーション病棟入院料６（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209010".
      *    短期滞在手術基本料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190125310".
      *    有床診療所療養病床入院基本料Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124310".
      *    有床診療所療養病床入院基本料Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124410".
      *10  有床診療所療養病床入院基本料Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124510".
      *    療養病床以外・有床診療所療養病床入院Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155410".
      *    療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155810".
      *    療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156210".
      *    療養病棟入院料１（入院料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123710".
      *    療養病棟入院料１（入院料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123810".
      *    療養病棟入院料１（入院料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123910".
      *    療養病棟入院料１（入院料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124010".
      *    療養病棟入院料１（入院料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124110".
      *    療養病棟入院料１（入院料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131710".
      *20  療養病棟入院料２（入院料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132510".
      *    療養病棟入院料２（入院料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132710".
      *    療養病棟入院料２（入院料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132910".
      *    療養病棟入院料２（入院料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133110".
      *    療養病棟入院料２（入院料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133310".
      *    療養病棟入院料２（入院料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133510".
      *    療養病棟入院料２（入院基本料Ａ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215210".
      *    療養病棟入院料２（入院基本料Ｂ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215410".
      *    療養病棟入院料２（入院基本料Ｃ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215610".
      *    療養病棟入院料２（入院基本料Ｄ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215810".
      *30  療養病棟入院料２（入院基本料Ｅ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216010".
      *31  療養病棟入院料２（入院基本料Ｆ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216210".
      *
      *  医療度の高くない生活療養
      *32  有床診療所療養病床入院基本料Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124610".
      *    有床診療所療養病床入院基本料Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124710".
      *    療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156610".
      *    療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190157010".
      *    療養病棟入院料１（入院料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131910".
      *    療養病棟入院料１（入院料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132110".
      *    療養病棟入院料１（入院料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132310".
      *    療養病棟入院料２（入院料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133710".
      *40  療養病棟入院料２（入院料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133910".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190134110".
      *    療養病棟入院料２（入院料Ｇ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216410".
      *    療養病棟入院料２（入院料Ｈ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216610".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216810".
      *    短手３（小児食物アレルギー負荷検査）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190178310".
      *    短手３（前立腺針生検法）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190178510".
      *    短手３（関節鏡下手根管開放手術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190178910".
      *    短手３（腹腔鏡下交感神経節切除術（両側））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179110".
      *    短手３（水晶体再建術・眼内レンズ挿入・その他・片側）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179310".
      *50  短手３（乳腺腫瘍摘出術（直径５ｃｍ未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179710".
      *    短手３（下肢静脈瘤手術（抜去切除術））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179910".
      *    短手３（下肢静脈瘤手術（硬化療法））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190180110".
      *    短手３（下肢静脈瘤手術（高位結紮術））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190180310".
      *    短手３（鼠径ヘルニア手術（１５歳以上））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190180710".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（１５歳以上））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181110".
      *    短手３（内視鏡的大腸ポリープ・粘膜切除術２ｃｍ未満）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181310".
      *    短手３（内視鏡的大腸ポリープ・粘膜切除術２ｃｍ以上）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181510".
      *    短手３（痔核手術（硬化療法（四段階注射法）））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181710".
      *    短手３（子宮頚部（腹部）切除術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181910".
      *60  短手３（水晶体再建術・眼内レンズ挿入・その他・両側）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190196010".
      *    短手３（鼠径ヘルニア手術（３歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190196810".
      *    短手３（鼠径ヘルニア手術（３歳以上６歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190196910".
      *    短手３（鼠径ヘルニア手術（６歳以上１５歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197010".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（３歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197410".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（３歳以上６歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197510".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（６歳以上１５歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197610".
      *    短手３（体外衝撃波・尿管結石破砕術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197810".
      *    短手３（ガンマナイフによる定位放射線治療）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190198010".
      *    短手３（経皮的シャント拡張術・血栓除去術（初回））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190221010".
      *70  短手３（経皮的シャント拡張術・血栓除去術・３月以内）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190221210".
      *71  地域包括ケア病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209210".
      *    地域包括ケア入院医療管理料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209410".
      *    地域包括ケア病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209610".
      *    地域包括ケア入院医療管理料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209810".
      *    地域包括ケア病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210010".
      *    地域包括ケア入院医療管理料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210210".
      *    地域包括ケア病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210410".
      *    地域包括ケア入院医療管理料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210610".
      *    地域包括ケア病棟入院料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190210810".
      *80  地域包括ケア入院医療管理料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211010".
      *    地域包括ケア病棟入院料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211210".
      *    地域包括ケア入院医療管理料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211410".
      *    地域包括ケア病棟入院料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211610".
      *    地域包括ケア入院医療管理料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211810".
      *    地域包括ケア病棟入院料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190212010".
      *86  地域包括ケア入院医療管理料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190212210".
      *87  地域包括ケア病棟特別入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190231210".
      *88  地域包括ケア病棟特別入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190231410".
      *89  地域包括ケア病棟特別入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190231610".
      *90  地域包括ケア病棟特別入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190231810".
      *91  地域包括ケア病棟特別入院料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190232010".
      *92  地域包括ケア病棟特別入院料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190232210".
      *93  地域包括ケア病棟特別入院料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190232410".
      *94  地域包括ケア病棟特別入院料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190232610".
      *
      *95  有床診療所療養病床入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124810".
      *96  療養病棟入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124210".
      *
       01  TBL-R02-SEIKATSU-R     REDEFINES  TBL-R02-SEIKATSU-AREA.
           03   TBL-R02-SEISRYCD           PIC X(09)  OCCURS  96.
      *
      *    令和４年度改定生活療養判定用
      *  （医療度の高い生活療養を上位にまとめているので、データの並びに注意すること）
      *  （特別入院基本料は特別な判定があることからデータの最後とする）
       01  TBL-R04-SEIKATSU-AREA.
      *  医療度の高い生活療養
      *    回復期リハビリテーション病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208010".
      *    回復期リハビリテーション病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208210".
      *    回復期リハビリテーション病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208410".
      *    回復期リハビリテーション病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208610".
      *    回復期リハビリテーション病棟入院料５（生活療養）
           03   FILLER                     PIC X(09) VALUE "190249610".
      *    回復期リハビリテーション病棟入院料５（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190208810".
      *    回復期リハビリテーション病棟入院料６（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190209010".
      *    短期滞在手術基本料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190125310".
      *    有床診療所療養病床入院基本料Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124310".
      *10  有床診療所療養病床入院基本料Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124410".
      *    有床診療所療養病床入院基本料Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124510".
      *    療養病床以外・有床診療所療養病床入院Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155410".
      *    療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155810".
      *    療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156210".
      *    療養病棟入院料１（入院料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123710".
      *    療養病棟入院料１（入院料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123810".
      *    療養病棟入院料１（入院料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190123910".
      *    療養病棟入院料１（入院料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124010".
      *    療養病棟入院料１（入院料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124110".
      *20  療養病棟入院料１（入院料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131710".
      *    療養病棟入院料２（入院料Ａ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132510".
      *    療養病棟入院料２（入院料Ｂ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132710".
      *    療養病棟入院料２（入院料Ｃ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132910".
      *    療養病棟入院料２（入院料Ｄ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133110".
      *    療養病棟入院料２（入院料Ｅ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133310".
      *    療養病棟入院料２（入院料Ｆ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133510".
      *    療養病棟入院料２（入院基本料Ａ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215210".
      *    療養病棟入院料２（入院基本料Ｂ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215410".
      *    療養病棟入院料２（入院基本料Ｃ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215610".
      *    療養病棟入院料２（入院基本料Ｄ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190215810".
      *31  療養病棟入院料２（入院基本料Ｅ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216010".
      *32  療養病棟入院料２（入院基本料Ｆ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216210".
      *
      *  医療度の高くない生活療養
      *33  有床診療所療養病床入院基本料Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124610".
      *    有床診療所療養病床入院基本料Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124710".
      *    療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156610".
      *    療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190157010".
      *    療養病棟入院料１（入院料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190131910".
      *    療養病棟入院料１（入院料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132110".
      *    療養病棟入院料１（入院料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190132310".
      *40  療養病棟入院料２（入院料Ｇ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133710".
      *    療養病棟入院料２（入院料Ｈ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190133910".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190134110".
      *    療養病棟入院料２（入院料Ｇ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216410".
      *    療養病棟入院料２（入院料Ｈ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216610".
      *    療養病棟入院料２（入院料Ｉ）（生活療養）（経過措置）
           03   FILLER                     PIC X(09) VALUE "190216810".
      *    短手３（小児食物アレルギー負荷検査）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190178310".
      *    短手３（前立腺針生検法）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190178510".
      *    短手３（関節鏡下手根管開放手術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190178910".
      *    短手３（腹腔鏡下交感神経節切除術（両側））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179110".
      *50  短手３（水晶体再建術・眼内レンズ挿入・その他・片側）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179310".
      *    短手３（乳腺腫瘍摘出術（直径５ｃｍ未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179710".
      *    短手３（下肢静脈瘤手術（抜去切除術））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190179910".
      *    短手３（下肢静脈瘤手術（硬化療法））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190180110".
      *    短手３（下肢静脈瘤手術（高位結紮術））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190180310".
      *    短手３（鼠径ヘルニア手術（１５歳以上））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190180710".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（１５歳以上））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181110".
      *    短手３（内視鏡的大腸ポリープ・粘膜切除術２ｃｍ未満）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181310".
      *    短手３（内視鏡的大腸ポリープ・粘膜切除術２ｃｍ以上）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181510".
      *    短手３（痔核手術（硬化療法（四段階注射法）））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181710".
      *60  短手３（子宮頚部（腹部）切除術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190181910".
      *    短手３（水晶体再建術・眼内レンズ挿入・その他・両側）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190196010".
      *    短手３（鼠径ヘルニア手術（３歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190196810".
      *    短手３（鼠径ヘルニア手術（３歳以上６歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190196910".
      *    短手３（鼠径ヘルニア手術（６歳以上１５歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197010".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（３歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197410".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（３歳以上６歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197510".
      *    短手３（腹腔鏡下鼠径ヘルニア手術（６歳以上１５歳未満））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197610".
      *    短手３（体外衝撃波・尿管結石破砕術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190197810".
      *    短手３（ガンマナイフによる定位放射線治療）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190198010".
      *    短手３（経皮的シャント拡張術・血栓除去術（初回））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190221010".
      *71  短手３（経皮的シャント拡張術・血栓除去術・３月以内）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190221210".
      *    2022-04-01
      *72  短手３（終夜睡眠ポリグラフィー１、２以外・安全精度管理下）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190265710".
      *    短手３（終夜睡眠ポリグラフィー１、２以外・その他・生活）
           03   FILLER                     PIC X(09) VALUE "190265910".
      *    短手３（ＭＳＬＴ）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190266110".
      *    短手３（内分泌負荷試験・下垂体前葉負荷試験（ＧＨ））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190266310".
      *    短手３（経皮的放射線治療用金属マーカー留置術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190266510".
      *    短手３（四肢・躯幹軟部腫瘍摘出術（手））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190266710".
      *    短手３（骨折観血的手術（手舟状骨））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190266910".
      *    短手３（骨内異物（挿入物を含む）除去術（前腕））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190267110".
      *80  短手３（骨内異物（挿入物を含む）除去術（鎖骨））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190267310".
      *    短手３（骨内異物（挿入物を含む）除去術（手））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190267510".
      *    短手３（ガングリオン摘出術（手））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190267710".
      *    短手３（涙管チューブ挿入術（涙道内視鏡））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190267910".
      *    短手３（眼瞼内反症手術（皮膚切開法））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190268110".
      *    短手３（眼瞼下垂症手術（眼瞼挙筋前転法））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190268310".
      *    短手３（眼瞼下垂症手術（その他のもの））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190268510".
      *    短手３（翼状片手術（弁の移植を要するもの））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190268710".
      *    短手３（斜視手術（後転法））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190268910".
      *    短手３（斜視手術（前転法及び後転法の併施））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190269110".
      *90  短手３（治療的角膜切除術・エキシマレーザー）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190269310".
      *    短手３（緑内障手術・水晶体再建術併用眼内ドレーン挿入）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190269510".
      *    短手３（水晶体再建術・眼内レンズを挿入しない・片側）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190269710".
      *    短手３（水晶体再建術・眼内レンズを挿入しない・両側）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190269910".
      *    短手３（鼓膜形成手術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190270110".
      *    短手３（鼻骨骨折整復固定術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190270310".
      *    短手３（喉頭・声帯ポリープ切除（直達喉頭鏡、ファイバー）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190270510".
      *    短手３（乳腺腫瘍摘出術（直径５ｃｍ以上））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190270710".
      *    短手３（大伏在静脈抜去術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190270910".
      *    短手３（下肢静脈瘤血管内焼灼術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190271110".
      *100 短手３（下肢静脈瘤血管内塞栓術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190271310".
      *    短手３（肛門ポリープ切除術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190271510".
      *    短手３（肛門尖圭コンジローム切除術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190271710".
      *    短手３（尿失禁手術（ボツリヌス毒素によるもの））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190271910".
      *    短手３（顕微鏡下精索静脈瘤手術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190272110".
      *    短手３（子宮鏡下有茎粘膜下筋腫切出、ポリープ・電解液）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190272310".
      *    短手３（子宮鏡下有茎粘膜下筋腫切出、ポリープ・その他）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190272510".
      *    短手３（子宮鏡下子宮筋腫摘出術（電解質溶液利用））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190272710".
      *    短手３（子宮鏡下子宮筋腫摘出術（その他））（生活療養）
           03   FILLER                     PIC X(09) VALUE "190272910".
      *    短手３（腹腔鏡下卵管形成術）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190273110".
      *110 地域包括ケア病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209210".
      *    地域包括ケア入院医療管理料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209410".
      *    地域包括ケア病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209610".
      *    地域包括ケア入院医療管理料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190209810".
      *    地域包括ケア病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210010".
      *    地域包括ケア入院医療管理料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210210".
      *    地域包括ケア病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210410".
      *    地域包括ケア入院医療管理料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190210610".
      *    地域包括ケア病棟入院料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190210810".
      *    地域包括ケア入院医療管理料１（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211010".
      *120 地域包括ケア病棟入院料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211210".
      *    地域包括ケア入院医療管理料２（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211410".
      *    地域包括ケア病棟入院料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211610".
      *    地域包括ケア入院医療管理料３（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190211810".
      *    地域包括ケア病棟入院料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190212010".
      *125 地域包括ケア入院医療管理料４（生活療養）（特定地域）
           03   FILLER                     PIC X(09) VALUE "190212210".
      *    地域包括ケア（注１）
           03   FILLER                     PIC X(09) VALUE "190249810".
           03   FILLER                     PIC X(09) VALUE "190250210".
           03   FILLER                     PIC X(09) VALUE "190250610".
           03   FILLER                     PIC X(09) VALUE "190252210".
      *130
           03   FILLER                     PIC X(09) VALUE "190253010".
           03   FILLER                     PIC X(09) VALUE "190253410".
           03   FILLER                     PIC X(09) VALUE "190253810".
           03   FILLER                     PIC X(09) VALUE "190255410".
      *    地域包括ケア（注９）
           03   FILLER                     PIC X(09) VALUE "190256210".
           03   FILLER                     PIC X(09) VALUE "190257010".
           03   FILLER                     PIC X(09) VALUE "190250810".
           03   FILLER                     PIC X(09) VALUE "190254010".
      *    地域包括ケア（注１０）
           03   FILLER                     PIC X(09) VALUE "190257810".
           03   FILLER                     PIC X(09) VALUE "190258010".
      *140
           03   FILLER                     PIC X(09) VALUE "190258210".
           03   FILLER                     PIC X(09) VALUE "190258610".
           03   FILLER                     PIC X(09) VALUE "190253210".
           03   FILLER                     PIC X(09) VALUE "190253610".
           03   FILLER                     PIC X(09) VALUE "190254210".
           03   FILLER                     PIC X(09) VALUE "190255610".
      *    地域包括ケア（注１１）
           03   FILLER                     PIC X(09) VALUE "190259010".
           03   FILLER                     PIC X(09) VALUE "190259410".
           03   FILLER                     PIC X(09) VALUE "190259810".
           03   FILLER                     PIC X(09) VALUE "190260010".
      *150
           03   FILLER                     PIC X(09) VALUE "190251010".
           03   FILLER                     PIC X(09) VALUE "190252410".
           03   FILLER                     PIC X(09) VALUE "190254410".
           03   FILLER                     PIC X(09) VALUE "190255810".
      *    地域包括ケア（注１２）
           03   FILLER                     PIC X(09) VALUE "190260210".
           03   FILLER                     PIC X(09) VALUE "190260410".
           03   FILLER                     PIC X(09) VALUE "190260610".
           03   FILLER                     PIC X(09) VALUE "190260810".
           03   FILLER                     PIC X(09) VALUE "190250010".
           03   FILLER                     PIC X(09) VALUE "190250410".
      *160
           03   FILLER                     PIC X(09) VALUE "190251210".
           03   FILLER                     PIC X(09) VALUE "190252610".
      *    地域包括ケア（合成コード）
           03   FILLER                     PIC X(09) VALUE "190251410".
           03   FILLER                     PIC X(09) VALUE "190251610".
           03   FILLER                     PIC X(09) VALUE "190251810".
           03   FILLER                     PIC X(09) VALUE "190252010".
           03   FILLER                     PIC X(09) VALUE "190252810".
           03   FILLER                     PIC X(09) VALUE "190254610".
           03   FILLER                     PIC X(09) VALUE "190254810".
           03   FILLER                     PIC X(09) VALUE "190255010".
      *170
           03   FILLER                     PIC X(09) VALUE "190255210".
           03   FILLER                     PIC X(09) VALUE "190256010".
           03   FILLER                     PIC X(09) VALUE "190256410".
           03   FILLER                     PIC X(09) VALUE "190256610".
           03   FILLER                     PIC X(09) VALUE "190256810".
           03   FILLER                     PIC X(09) VALUE "190257210".
           03   FILLER                     PIC X(09) VALUE "190257410".
           03   FILLER                     PIC X(09) VALUE "190257610".
           03   FILLER                     PIC X(09) VALUE "190258410".
           03   FILLER                     PIC X(09) VALUE "190258810".
      *180
           03   FILLER                     PIC X(09) VALUE "190259210".
           03   FILLER                     PIC X(09) VALUE "190259610".
      *182 特定機能病院リハビリテーション病棟入院料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190265210".
      *183 有床診療所療養病床入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124810".
      *184 療養病棟入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124210".
      *
       01  TBL-R04-SEIKATSU-R     REDEFINES  TBL-R04-SEIKATSU-AREA.
           03   TBL-R04-SEISRYCD           PIC X(09)  OCCURS  184.
      *
      *
      *    令和６年６月改定生活療養判定用
      *  （医療度の高い生活療養を上位にまとめているので、データの並びに注意すること）
      *  （特別入院基本料は特別な判定があることからデータの最後とする）
       01  TBL-R06-SEIKATSU-AREA.
      *  医療度の高い生活療養
      *01  回復期リハビリテーション病棟入院料１（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208010".
      *    回復期リハビリテーション病棟入院料２（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208210".
      *    回復期リハビリテーション病棟入院料３（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208410".
      *    回復期リハビリテーション病棟入院料４（生活療養）
           03   FILLER                     PIC X(09) VALUE "190208610".
      *    回復期リハビリテーション病棟入院料５（生活療養）
           03   FILLER                     PIC X(09) VALUE "190249610".
      *    回復期リハビリテーション入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190838810".
      *    有床診療所療養病床入院基本料Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124310".
      *    有床診療所療養病床入院基本料Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124410".
      *    有床診療所療養病床入院基本料Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124510".
      *10  療養病床以外・有床診療所療養病床入院Ａ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155410".
      *    療養病床以外・有床診療所療養病床入院Ｂ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190155810".
      *    療養病床以外・有床診療所療養病床入院Ｃ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156210".
      *    療養病棟入院料１（入院料１から２４）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190817710".
           03   FILLER                     PIC X(09) VALUE "190817910".
           03   FILLER                     PIC X(09) VALUE "190818110".
           03   FILLER                     PIC X(09) VALUE "190818310".
           03   FILLER                     PIC X(09) VALUE "190818510".
           03   FILLER                     PIC X(09) VALUE "190818710".
           03   FILLER                     PIC X(09) VALUE "190818910".
           03   FILLER                     PIC X(09) VALUE "190819110".
      *20
           03   FILLER                     PIC X(09) VALUE "190819310".
           03   FILLER                     PIC X(09) VALUE "190819510".
           03   FILLER                     PIC X(09) VALUE "190819710".
           03   FILLER                     PIC X(09) VALUE "190819910".
           03   FILLER                     PIC X(09) VALUE "190820110".
           03   FILLER                     PIC X(09) VALUE "190820310".
           03   FILLER                     PIC X(09) VALUE "190820510".
           03   FILLER                     PIC X(09) VALUE "190820710".
           03   FILLER                     PIC X(09) VALUE "190820910".
           03   FILLER                     PIC X(09) VALUE "190821110".
      *30
           03   FILLER                     PIC X(09) VALUE "190821310".
           03   FILLER                     PIC X(09) VALUE "190821510".
           03   FILLER                     PIC X(09) VALUE "190821710".
           03   FILLER                     PIC X(09) VALUE "190821910".
           03   FILLER                     PIC X(09) VALUE "190822110".
           03   FILLER                     PIC X(09) VALUE "190822310".
      *37  療養病棟入院料１（入院料２８から３０）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190823110".
           03   FILLER                     PIC X(09) VALUE "190823310".
           03   FILLER                     PIC X(09) VALUE "190823510".
      *40  療養病棟入院料２（入院料１から２４）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190823710".
           03   FILLER                     PIC X(09) VALUE "190823910".
           03   FILLER                     PIC X(09) VALUE "190824110".
           03   FILLER                     PIC X(09) VALUE "190824310".
           03   FILLER                     PIC X(09) VALUE "190824510".
           03   FILLER                     PIC X(09) VALUE "190824710".
           03   FILLER                     PIC X(09) VALUE "190824910".
           03   FILLER                     PIC X(09) VALUE "190825110".
           03   FILLER                     PIC X(09) VALUE "190825310".
           03   FILLER                     PIC X(09) VALUE "190825510".
      *50
           03   FILLER                     PIC X(09) VALUE "190825710".
           03   FILLER                     PIC X(09) VALUE "190825910".
           03   FILLER                     PIC X(09) VALUE "190826110".
           03   FILLER                     PIC X(09) VALUE "190826310".
           03   FILLER                     PIC X(09) VALUE "190826510".
           03   FILLER                     PIC X(09) VALUE "190826710".
           03   FILLER                     PIC X(09) VALUE "190826910".
           03   FILLER                     PIC X(09) VALUE "190827110".
           03   FILLER                     PIC X(09) VALUE "190827310".
           03   FILLER                     PIC X(09) VALUE "190827510".
      *60
           03   FILLER                     PIC X(09) VALUE "190827710".
           03   FILLER                     PIC X(09) VALUE "190827910".
           03   FILLER                     PIC X(09) VALUE "190828110".
           03   FILLER                     PIC X(09) VALUE "190828310".
      *64  療養病棟入院料２（入院料２８から３０）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190829110".
           03   FILLER                     PIC X(09) VALUE "190829310".
           03   FILLER                     PIC X(09) VALUE "190829510".
      *  医療度の高くない生活療養
      *67  有床診療所療養病床入院基本料Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124610".
      *    有床診療所療養病床入院基本料Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124710".
      *    療養病床以外・有床診療所療養病床入院Ｄ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190156610".
      *70  療養病床以外・有床診療所療養病床入院Ｅ（生活療養）
           03   FILLER                     PIC X(09) VALUE "190157010".
      *    療養病棟入院料１（入院料２５）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190822510".
      *    療養病棟入院料１（入院料２６）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190822710".
      *73  療養病棟入院料１（入院料２７）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190822910".
      *    療養病棟入院料２（入院料２５）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190828510".
      *    療養病棟入院料２（入院料２６）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190828710".
      *76  療養病棟入院料２（入院料２７）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190828910".
      *77  短手３
           03   FILLER                     PIC X(09) VALUE "190265710".
           03   FILLER                     PIC X(09) VALUE "190265910".
           03   FILLER                     PIC X(09) VALUE "190266110".
      *80  短手３
           03   FILLER                     PIC X(09) VALUE "190266310".
           03   FILLER                     PIC X(09) VALUE "190178310".
           03   FILLER                     PIC X(09) VALUE "190178510".
           03   FILLER                     PIC X(09) VALUE "190266510".
           03   FILLER                     PIC X(09) VALUE "190266710".
           03   FILLER                     PIC X(09) VALUE "190266910".
           03   FILLER                     PIC X(09) VALUE "190267110".
           03   FILLER                     PIC X(09) VALUE "190267310".
           03   FILLER                     PIC X(09) VALUE "190267510".
           03   FILLER                     PIC X(09) VALUE "190267710".
      *90  短手３
           03   FILLER                     PIC X(09) VALUE "190178910".
           03   FILLER                     PIC X(09) VALUE "190179110".
           03   FILLER                     PIC X(09) VALUE "190873310".
           03   FILLER                     PIC X(09) VALUE "190873510".
           03   FILLER                     PIC X(09) VALUE "190873710".
           03   FILLER                     PIC X(09) VALUE "190873910".
           03   FILLER                     PIC X(09) VALUE "190874110".
           03   FILLER                     PIC X(09) VALUE "190874310".
           03   FILLER                     PIC X(09) VALUE "190874510".
           03   FILLER                     PIC X(09) VALUE "190874710".
      *100 短手３
           03   FILLER                     PIC X(09) VALUE "190874910".
           03   FILLER                     PIC X(09) VALUE "190875110".
           03   FILLER                     PIC X(09) VALUE "190875310".
           03   FILLER                     PIC X(09) VALUE "190875510".
           03   FILLER                     PIC X(09) VALUE "190875710".
           03   FILLER                     PIC X(09) VALUE "190875910".
           03   FILLER                     PIC X(09) VALUE "190876110".
           03   FILLER                     PIC X(09) VALUE "190876310".
           03   FILLER                     PIC X(09) VALUE "190876510".
           03   FILLER                     PIC X(09) VALUE "190876710".
      *110 短手３
           03   FILLER                     PIC X(09) VALUE "190179310".
           03   FILLER                     PIC X(09) VALUE "190196010".
           03   FILLER                     PIC X(09) VALUE "190269710".
           03   FILLER                     PIC X(09) VALUE "190269910".
           03   FILLER                     PIC X(09) VALUE "190270110".
           03   FILLER                     PIC X(09) VALUE "190270310".
           03   FILLER                     PIC X(09) VALUE "190270510".
           03   FILLER                     PIC X(09) VALUE "190179710".
           03   FILLER                     PIC X(09) VALUE "190270710".
           03   FILLER                     PIC X(09) VALUE "190221010".
      *120 短手３
           03   FILLER                     PIC X(09) VALUE "190221210".
           03   FILLER                     PIC X(09) VALUE "190179910".
           03   FILLER                     PIC X(09) VALUE "190180110".
           03   FILLER                     PIC X(09) VALUE "190180310".
           03   FILLER                     PIC X(09) VALUE "190270910".
           03   FILLER                     PIC X(09) VALUE "190271110".
           03   FILLER                     PIC X(09) VALUE "190271310".
           03   FILLER                     PIC X(09) VALUE "190196810".
           03   FILLER                     PIC X(09) VALUE "190196910".
           03   FILLER                     PIC X(09) VALUE "190197010".
      *130 短手３
           03   FILLER                     PIC X(09) VALUE "190180710".
           03   FILLER                     PIC X(09) VALUE "190197410".
           03   FILLER                     PIC X(09) VALUE "190197510".
           03   FILLER                     PIC X(09) VALUE "190197610".
           03   FILLER                     PIC X(09) VALUE "190181110".
           03   FILLER                     PIC X(09) VALUE "190181310".
           03   FILLER                     PIC X(09) VALUE "190181510".
           03   FILLER                     PIC X(09) VALUE "190181710".
           03   FILLER                     PIC X(09) VALUE "190271510".
           03   FILLER                     PIC X(09) VALUE "190271710".
      *140 短手３
           03   FILLER                     PIC X(09) VALUE "190197810".
           03   FILLER                     PIC X(09) VALUE "190271910".
           03   FILLER                     PIC X(09) VALUE "190272110".
           03   FILLER                     PIC X(09) VALUE "190181910".
           03   FILLER                     PIC X(09) VALUE "190272310".
           03   FILLER                     PIC X(09) VALUE "190272510".
           03   FILLER                     PIC X(09) VALUE "190272710".
           03   FILLER                     PIC X(09) VALUE "190272910".
           03   FILLER                     PIC X(09) VALUE "190273110".
           03   FILLER                     PIC X(09) VALUE "190198010".
      *150 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190858910".
           03   FILLER                     PIC X(09) VALUE "190859110".
           03   FILLER                     PIC X(09) VALUE "190859310".
           03   FILLER                     PIC X(09) VALUE "190859510".
           03   FILLER                     PIC X(09) VALUE "190859710".
           03   FILLER                     PIC X(09) VALUE "190859910".
           03   FILLER                     PIC X(09) VALUE "190860110".
           03   FILLER                     PIC X(09) VALUE "190860310".
           03   FILLER                     PIC X(09) VALUE "190860510".
           03   FILLER                     PIC X(09) VALUE "190860710".
      *160 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190860910".
           03   FILLER                     PIC X(09) VALUE "190861110".
           03   FILLER                     PIC X(09) VALUE "190861310".
           03   FILLER                     PIC X(09) VALUE "190861510".
           03   FILLER                     PIC X(09) VALUE "190861710".
           03   FILLER                     PIC X(09) VALUE "190861910".
           03   FILLER                     PIC X(09) VALUE "190862110".
           03   FILLER                     PIC X(09) VALUE "190862310".
           03   FILLER                     PIC X(09) VALUE "190862510".
           03   FILLER                     PIC X(09) VALUE "190862710".
      *170 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190862910".
           03   FILLER                     PIC X(09) VALUE "190863110".
           03   FILLER                     PIC X(09) VALUE "190863310".
           03   FILLER                     PIC X(09) VALUE "190863510".
           03   FILLER                     PIC X(09) VALUE "190863710".
           03   FILLER                     PIC X(09) VALUE "190863910".
           03   FILLER                     PIC X(09) VALUE "190864110".
           03   FILLER                     PIC X(09) VALUE "190864310".
           03   FILLER                     PIC X(09) VALUE "190864510".
           03   FILLER                     PIC X(09) VALUE "190864710".
      *180 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190864910".
           03   FILLER                     PIC X(09) VALUE "190865110".
           03   FILLER                     PIC X(09) VALUE "190865310".
           03   FILLER                     PIC X(09) VALUE "190865510".
           03   FILLER                     PIC X(09) VALUE "190865710".
           03   FILLER                     PIC X(09) VALUE "190865910".
           03   FILLER                     PIC X(09) VALUE "190866110".
           03   FILLER                     PIC X(09) VALUE "190866310".
           03   FILLER                     PIC X(09) VALUE "190866510".
           03   FILLER                     PIC X(09) VALUE "190866710".
      *190 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190866910".
           03   FILLER                     PIC X(09) VALUE "190867110".
           03   FILLER                     PIC X(09) VALUE "190867310".
           03   FILLER                     PIC X(09) VALUE "190867510".
           03   FILLER                     PIC X(09) VALUE "190867710".
           03   FILLER                     PIC X(09) VALUE "190867910".
           03   FILLER                     PIC X(09) VALUE "190868110".
           03   FILLER                     PIC X(09) VALUE "190868310".
           03   FILLER                     PIC X(09) VALUE "190839010".
           03   FILLER                     PIC X(09) VALUE "190839210".
      *200 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190839410".
           03   FILLER                     PIC X(09) VALUE "190839610".
           03   FILLER                     PIC X(09) VALUE "190839810".
           03   FILLER                     PIC X(09) VALUE "190840010".
           03   FILLER                     PIC X(09) VALUE "190840210".
           03   FILLER                     PIC X(09) VALUE "190840410".
           03   FILLER                     PIC X(09) VALUE "190840610".
           03   FILLER                     PIC X(09) VALUE "190840810".
           03   FILLER                     PIC X(09) VALUE "190841010".
           03   FILLER                     PIC X(09) VALUE "190841210".
      *210 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190841410".
           03   FILLER                     PIC X(09) VALUE "190841610".
           03   FILLER                     PIC X(09) VALUE "190841810".
           03   FILLER                     PIC X(09) VALUE "190842010".
           03   FILLER                     PIC X(09) VALUE "190842210".
           03   FILLER                     PIC X(09) VALUE "190842410".
           03   FILLER                     PIC X(09) VALUE "190842610".
           03   FILLER                     PIC X(09) VALUE "190842810".
           03   FILLER                     PIC X(09) VALUE "190843010".
           03   FILLER                     PIC X(09) VALUE "190843210".
      *220 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190843410".
           03   FILLER                     PIC X(09) VALUE "190843610".
           03   FILLER                     PIC X(09) VALUE "190843810".
           03   FILLER                     PIC X(09) VALUE "190844010".
           03   FILLER                     PIC X(09) VALUE "190844210".
           03   FILLER                     PIC X(09) VALUE "190844410".
           03   FILLER                     PIC X(09) VALUE "190844610".
           03   FILLER                     PIC X(09) VALUE "190844810".
           03   FILLER                     PIC X(09) VALUE "190845010".
           03   FILLER                     PIC X(09) VALUE "190845210".
      *230 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190845410".
           03   FILLER                     PIC X(09) VALUE "190845610".
           03   FILLER                     PIC X(09) VALUE "190845810".
           03   FILLER                     PIC X(09) VALUE "190846010".
           03   FILLER                     PIC X(09) VALUE "190846210".
           03   FILLER                     PIC X(09) VALUE "190846410".
           03   FILLER                     PIC X(09) VALUE "190846610".
           03   FILLER                     PIC X(09) VALUE "190846810".
           03   FILLER                     PIC X(09) VALUE "190847010".
           03   FILLER                     PIC X(09) VALUE "190847210".
      *240 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190847410".
           03   FILLER                     PIC X(09) VALUE "190847610".
           03   FILLER                     PIC X(09) VALUE "190847810".
           03   FILLER                     PIC X(09) VALUE "190848010".
           03   FILLER                     PIC X(09) VALUE "190848210".
           03   FILLER                     PIC X(09) VALUE "190848410".
           03   FILLER                     PIC X(09) VALUE "190848610".
           03   FILLER                     PIC X(09) VALUE "190848810".
           03   FILLER                     PIC X(09) VALUE "190849010".
           03   FILLER                     PIC X(09) VALUE "190849210".
      *250 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190849410".
           03   FILLER                     PIC X(09) VALUE "190849610".
           03   FILLER                     PIC X(09) VALUE "190849810".
           03   FILLER                     PIC X(09) VALUE "190850010".
           03   FILLER                     PIC X(09) VALUE "190850210".
           03   FILLER                     PIC X(09) VALUE "190850410".
           03   FILLER                     PIC X(09) VALUE "190850610".
           03   FILLER                     PIC X(09) VALUE "190850810".
           03   FILLER                     PIC X(09) VALUE "190851010".
           03   FILLER                     PIC X(09) VALUE "190851210".
      *260 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190851410".
           03   FILLER                     PIC X(09) VALUE "190851610".
           03   FILLER                     PIC X(09) VALUE "190851810".
           03   FILLER                     PIC X(09) VALUE "190852010".
           03   FILLER                     PIC X(09) VALUE "190852210".
           03   FILLER                     PIC X(09) VALUE "190852410".
           03   FILLER                     PIC X(09) VALUE "190852610".
           03   FILLER                     PIC X(09) VALUE "190852810".
           03   FILLER                     PIC X(09) VALUE "190853010".
           03   FILLER                     PIC X(09) VALUE "190853210".
      *270 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190853410".
           03   FILLER                     PIC X(09) VALUE "190853610".
           03   FILLER                     PIC X(09) VALUE "190853810".
           03   FILLER                     PIC X(09) VALUE "190854010".
           03   FILLER                     PIC X(09) VALUE "190854210".
           03   FILLER                     PIC X(09) VALUE "190854410".
           03   FILLER                     PIC X(09) VALUE "190854610".
           03   FILLER                     PIC X(09) VALUE "190854810".
           03   FILLER                     PIC X(09) VALUE "190855010".
           03   FILLER                     PIC X(09) VALUE "190855210".
      *280 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190855410".
           03   FILLER                     PIC X(09) VALUE "190855610".
           03   FILLER                     PIC X(09) VALUE "190855810".
           03   FILLER                     PIC X(09) VALUE "190856010".
           03   FILLER                     PIC X(09) VALUE "190856210".
           03   FILLER                     PIC X(09) VALUE "190856410".
           03   FILLER                     PIC X(09) VALUE "190856610".
           03   FILLER                     PIC X(09) VALUE "190856810".
           03   FILLER                     PIC X(09) VALUE "190857010".
           03   FILLER                     PIC X(09) VALUE "190857210".
      *290 地域包括ケア病棟入院料、地域包括ケア入院医療管理料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190857410".
           03   FILLER                     PIC X(09) VALUE "190857610".
           03   FILLER                     PIC X(09) VALUE "190857810".
           03   FILLER                     PIC X(09) VALUE "190858010".
      *294 特定機能病院リハビリテーション病棟入院料（生活療養）
           03   FILLER                     PIC X(09) VALUE "190265210".
      *295 有床診療所療養病床入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124810".
      *296 療養病棟入院基本料（特別入院基本料）（生活療養）
           03   FILLER                     PIC X(09) VALUE "190124210".
      *
       01  TBL-R06-SEIKATSU-R     REDEFINES  TBL-R06-SEIKATSU-AREA.
           03   TBL-R06-SEISRYCD           PIC X(09)  OCCURS  296.
      *
      *    一時領域
       01  WRK-AREA.
      *
           03  WRK-YMD.
               05  WRK-YYMM                PIC X(06).
               05  WRK-DD                  PIC 9(02).
           03  WRK-RJN-TBL.
               05  WRK-RJN                 PIC 9(01)   OCCURS   31.
      *    救急搬送診療料を算定し、かつ、入院料未算定の日
           03  WRK-KYUKYU-DAY              PIC 9(02).
           03  WRK-KYUKYU-YMD              PIC X(08).
           03  WRK-KYUKYU-NYUINCD          PIC X(09).
      *
      *    保険組合せ退避
           03  WRK-NYUIN-TABLE.
               05  WRK-NYUIN-TBL           OCCURS  31.
                   07  WRK-HKNCOMBI-DAY    PIC 9(03).
      *    算定要件外区分退避
           03  WRK-SANTEIYOUKENKBN-TABLE.
               05  WRK-SANTEIYOUKENKBN     PIC X(01)  OCCURS  31.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    システム管理マスタ
           COPY    "CPSYSKANRI.INC".
      *
           COPY    "CPSK5000.INC".
      *
      *    入院診療会計マスタ−
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    入院診療行為マスター
       01  NYUINACT-REC.
           COPY    "CPNYUINACT.INC".
      *
      *    患者マスタ−
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    患者公費情報マスタ−
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    患者保険情報マスタ−
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    年金
       01  TNKRRK-REC.
           COPY    "CPTNKRRK.INC".
      *
      *    患者入院履歴
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
           COPY    "MCPAREA".
      *
      *****************************************************************
      *    サブプロ用　領域
      *****************************************************************
      *
      *   日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *
      *    患者所得情報編集サブ
           COPY    "CPORCSSYOTOKU.INC".
      *
      *    入院料未算定日取得サブ
           COPY    "CPORCSNYUINDAY.INC".
      *
      *    医療区分取得サブ
           COPY    "CPORCSS008.INC".
      *
      *    特定入院料コード取得サブ
           COPY  "CPORCSTOKNYUIN.INC".
      *
      *    食事負担据え置き対象取得パラメタ
           COPY    "CPORCSSKJKEEP.INC".
      *
      *****************************************************************
      *    連絡　領域
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    入院会計作成用パラメタ
           COPY    "CPORCSNYULIFE2.INC".
      *
      *    スパ領域
           COPY    "COMMON-SPA".
      *
       PROCEDURE                   DIVISION    USING
           ORCSNYULIFE2-AREA
           SPA-AREA
           .
      *
      *****************************************************************
      *    主　　処理
      *****************************************************************
       000-PROC-SEC                    SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
           INITIALIZE                  LNK-NYULIFE2-HENKYAKU-AREA
           MOVE    ZERO                TO  LNK-NYULIFE2-RC
      *
      *    パラメータチェック
           PERFORM 100-PRM-CHK-SEC
           IF    ( LNK-NYULIFE2-RC       NOT =   ZERO )
               GO  TO  000-PROC-EXT
           END-IF
      *
      *    主処理
           IF      LNK-NYULIFE2-RC      =    ZERO
               PERFORM 200-MAIN-SEC
           END-IF
      *
      **     PERFORM    VARYING IDX   FROM   1   BY  1
      **                UNTIL IDX   >   31
      **       DISPLAY "IDX = " IDX
      **       DISPLAY "LNK-NYULIFE2-KBN = " LNK-NYULIFE2-KBN(IDX)
      **       DISPLAY "LNK-NYULIFE2-FTNKBN2 = " LNK-NYULIFE2-FTNKBN2(IDX)
      **       PERFORM   VARYING   IDX-T   FROM  1  BY  1
      **         UNTIL   IDX-T   >   3
      **         DISPLAY "IDX-T = " IDX-T
      **         DISPLAY "LNK-NYULIFE2-SKJ-SRYCD =" LNK-NYULIFE2-SKJ-SRYCD
      **                                                      (IDX IDX-T)
      **         DISPLAY "LNK-NYULIFE2-SKJ-MONEY =" LNK-NYULIFE2-SKJ-MONEY
      **                                                      (IDX IDX-T)
      **       END-PERFORM
      **     END-PERFORM
           .
       000-PROC-EXT.
      *
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    パラメータチェック
      *****************************************************************
       100-PRM-CHK-SEC                     SECTION.
      *
      *    算定年月チェック
           IF     (LNK-NYULIFE2-SANTEIYM    =   SPACE)   OR
                  (LNK-NYULIFE2-SANTEIYM    <=  "201603")
               MOVE    1               TO  LNK-NYULIFE2-RC
               GO  TO  100-PRM-CHK-EXT
           END-IF
      *
      *    患者マスター検索
           INITIALIZE                       PTINF-REC
           MOVE    LNK-NYULIFE2-HOSPNUM  TO  PTINF-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID     TO  PTINF-PTID
           PERFORM 900-PTINF-READ-SEC
           IF      FLG-PTINF            NOT =   ZERO
               MOVE    2                TO  LNK-NYULIFE2-RC
               GO  TO  100-PRM-CHK-EXT
           ELSE
      *        保険年齢のチェック（入院会計マスター検索）
               INITIALIZE                   ORCSAGECHKAREA
               MOVE    LNK-NYULIFE2-HOSPNUM  TO  AGECHK-HOSPNUM
               MOVE    LNK-NYULIFE2-PTID     TO  AGECHK-PTID
               MOVE    LNK-NYULIFE2-SANTEIYM TO  AGECHK-SRYYMD(1:6)
               MOVE    "01"                  TO  AGECHK-SRYYMD(7:2)
               MOVE    PTINF-BIRTHDAY        TO  AGECHK-BIRTHDAY
               CALL   "ORCSAGECHK"    USING      ORCSAGECHKAREA
                                                 SPA-AREA
               IF      AGECHK-NENREI         <=  63
                   MOVE    4                TO  LNK-NYULIFE2-RC
                   GO  TO  100-PRM-CHK-EXT
               END-IF
           END-IF
      *
      *    入院中のチェック（入院会計マスター検索）
           INITIALIZE                      NYUINACCT-REC
           MOVE    LNK-NYULIFE2-HOSPNUM  TO  NACCT-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID     TO  NACCT-PTID
           MOVE    LNK-NYULIFE2-SANTEIYM TO  NACCT-SRYYM
           MOVE    "5"                  TO  NACCT-ZAISKBKBN
           MOVE    "tbl_nyuinacct"      TO  MCP-TABLE
           MOVE    "key17"              TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT        NOT =   ZERO
               MOVE    3                TO  LNK-NYULIFE2-RC
           ELSE
               MOVE    "tbl_nyuinacct"  TO  MCP-TABLE
               MOVE    "key17"          TO  MCP-PATHNAME
               PERFORM 910-NYUINACCT-READ-SEC
               IF   FLG-NYUINACCT       =   ZERO
      *             難病公費判定用に保険組合せ番号を退避
                    PERFORM    VARYING   IDX1   FROM   1   BY   1
                               UNTIL     IDX1   >      31
                        MOVE   NACCT-DAY (IDX1) TO 
                                            WRK-HKNCOMBI-DAY(IDX1)
                    END-PERFORM
               ELSE
                    MOVE    3           TO  LNK-NYULIFE2-RC
               END-IF
           END-IF
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
           .
       100-PRM-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    主取得
      *****************************************************************
       200-MAIN-SEC            SECTION.
      *
      *    医療区分取得サブの呼出し（特別入院基本料算定時の医療区分判定用）
           INITIALIZE                      SS008-AREA
           MOVE    LNK-NYULIFE2-HOSPNUM     TO  SPA-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID        TO  SPA-PTID
           MOVE    LNK-NYULIFE2-SANTEIYM    TO  SS008-SRYYM
           CALL   "ORCSS008"       USING   SS008-AREA
                                           SPA-AREA
      *     PERFORM   VARYING  IDX   FROM  1  BY  1
      *       UNTIL   IDX    >   31
      *          DISPLAY "SS008-MEDKBNDAY = " SS008-MEDKBNDAY(IDX)
      *     END-PERFORM
         
      *
      *    救急搬送診療料を算定し、かつ、入院料未算定の日を特定し、
      *    該当日の食事が生活療養に該当するか判定（サブプロより取得）
           MOVE    ZERO                    TO  WRK-KYUKYU-DAY
           MOVE    SPACE                   TO  WRK-KYUKYU-YMD
           INITIALIZE                          ORCSNYUINDAY-AREA
           MOVE    LNK-NYULIFE2-HOSPNUM     TO  LNK-NYUINDAY-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID        TO  LNK-NYUINDAY-PTID
           MOVE    LNK-NYULIFE2-SANTEIYM    TO  LNK-NYUINDAY-SANTEIYM
           CALL    "ORCSNYUINDAY"      USING   ORCSNYUINDAY-AREA
                                               SPA-AREA
           IF      LNK-NYUINDAY-RC         =   ZERO
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                      UNTIL   IDX1   >   31
                         IF   (LNK-NYUINDAY-KBN(IDX1)   =   "1")   AND
                              (LNK-NYUINDAY-KYUKYU-KBN(IDX1)   =   "1")
                             MOVE    IDX1  TO  WRK-KYUKYU-DAY
                             MOVE    LNK-NYULIFE2-SANTEIYM
                                           TO  WRK-KYUKYU-YMD(1:6)
                             MOVE    WRK-KYUKYU-DAY
                                           TO  WRK-KYUKYU-YMD(7:2)
                         END-IF
                   END-PERFORM
           END-IF
           IF   WRK-KYUKYU-DAY             NOT =   ZERO
      *      患者入院履歴から算定入院料の取得
             INITIALIZE                          PTNYUINRRK-REC
             MOVE   LNK-NYULIFE2-HOSPNUM   TO  PTNYUINRRK-HOSPNUM
             MOVE   LNK-NYULIFE2-PTID      TO  PTNYUINRRK-PTID
             MOVE   LNK-NYULIFE2-SANTEIYM  TO  PTNYUINRRK-TENNYUYMD(1:6)
             MOVE   "99"                   TO  PTNYUINRRK-TENNYUYMD(7:2)
             MOVE   LNK-NYULIFE2-SANTEIYM  TO  PTNYUINRRK-TENSTUYMD(1:6)
             MOVE   "01"                   TO  PTNYUINRRK-TENSTUYMD(7:2)
             MOVE   "tbl_ptnyuinrrk"       TO  MCP-TABLE
             MOVE   "key44"                TO  MCP-PATHNAME
             PERFORM 910-PTNYUINRRK-SELECT-SEC
             IF      FLG-PTNYUINRRK        =   ZERO
               MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
               MOVE    "key44"             TO  MCP-PATHNAME
               PERFORM 910-PTNYUINRRK-READ-SEC
               PERFORM  UNTIL  
                  ( FLG-PTNYUINRRK         =   1  )
      *
                   IF  (PTNYUINRRK-TENNYUYMD  <=  WRK-KYUKYU-YMD) AND
                       (WRK-KYUKYU-YMD        <=  PTNYUINRRK-TENSTUYMD)
      *               特定入院料コードをサブプロより取得
                      INITIALIZE             ORCSTOKNYUIN-AREA
                      MOVE  PTNYUINRRK-TOKUTEI-KBN
                                           TO  LNK-TOKNYUIN-KBN
                      MOVE  PTNYUINRRK-TOKUTEI-NYUIN
                                           TO  LNK-TOKNYUIN-NYUIN
                      MOVE  PTNYUINRRK-BTUNUM
                                           TO  LNK-TOKNYUIN-BTUNUM
                      MOVE  PTNYUINRRK-BRMNUM
                                           TO  LNK-TOKNYUIN-BRMNUM
                      MOVE  PTNYUINRRK-TOKU-SANTEIYOUKENKBN
                                       TO  LNK-TOKNYUIN-SANTEIYOUKENKBN
      *                DISPLAY "PTNYUINRRK-TOKU-SANTEIYOUKENKBN = "
      *                         PTNYUINRRK-TOKU-SANTEIYOUKENKBN
                      MOVE  WRK-KYUKYU-YMD
                                           TO  LNK-TOKNYUIN-SANTEIYMD
                      CALL  "ORCSTOKNYUIN"   USING    ORCSTOKNYUIN-AREA
                                                      SPA-AREA
                      IF    LNK-TOKNYUIN-RC   =    ZERO
                         IF    LNK-TOKNYUIN-GAI-SRYCD =  SPACE
                              MOVE   LNK-TOKNYUIN-SRYCD
                                           TO  WRK-KYUKYU-NYUINCD
                         ELSE
                              MOVE   LNK-TOKNYUIN-GAI-SRYCD
                                           TO  WRK-KYUKYU-NYUINCD
                         END-IF
                   END-IF
      *
                   END-IF
                   MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
                   MOVE    "key44"             TO  MCP-PATHNAME
                   PERFORM 910-PTNYUINRRK-READ-SEC
      *
               END-PERFORM
             END-IF
      *
             MOVE    "tbl_ptnyuinrrk"      TO  MCP-TABLE
             MOVE    "key44"               TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
           END-IF
      *
      *    患者入院履歴から特定入院料の算定要件区分取得
           MOVE   SPACE                  TO  WRK-SANTEIYOUKENKBN-TABLE
           INITIALIZE                        PTNYUINRRK-REC
           MOVE   LNK-NYULIFE2-HOSPNUM   TO  PTNYUINRRK-HOSPNUM
           MOVE   LNK-NYULIFE2-PTID      TO  PTNYUINRRK-PTID
           MOVE   LNK-NYULIFE2-SANTEIYM  TO  PTNYUINRRK-TENNYUYMD(1:6)
           MOVE   "99"                   TO  PTNYUINRRK-TENNYUYMD(7:2)
           MOVE   LNK-NYULIFE2-SANTEIYM  TO  PTNYUINRRK-TENSTUYMD(1:6)
           MOVE   "01"                   TO  PTNYUINRRK-TENSTUYMD(7:2)
           MOVE   "tbl_ptnyuinrrk"       TO  MCP-TABLE
           MOVE   "key44"                TO  MCP-PATHNAME
           PERFORM 910-PTNYUINRRK-SELECT-SEC
           IF      FLG-PTNYUINRRK        =   ZERO
             MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
             MOVE    "key44"             TO  MCP-PATHNAME
             PERFORM 910-PTNYUINRRK-READ-SEC
             PERFORM  UNTIL   ( FLG-PTNYUINRRK         =   1  )
      *
                IF (PTNYUINRRK-TENNYUYMD(1:6)  =  LNK-NYULIFE2-SANTEIYM)
                AND
                   (PTNYUINRRK-TENSTUYMD(1:6)  =  LNK-NYULIFE2-SANTEIYM)
                    MOVE   PTNYUINRRK-TENNYUYMD(7:2)   TO  IDX-ST
                    MOVE   PTNYUINRRK-TENSTUYMD(7:2)   TO  IDX-ED
                END-IF
                IF (PTNYUINRRK-TENNYUYMD(1:6)  <  LNK-NYULIFE2-SANTEIYM)
                AND
                   (PTNYUINRRK-TENSTUYMD(1:6)  =  LNK-NYULIFE2-SANTEIYM)
                    MOVE   1                           TO  IDX-ST
                    MOVE   PTNYUINRRK-TENSTUYMD(7:2)   TO  IDX-ED
                END-IF
                IF (PTNYUINRRK-TENNYUYMD(1:6)  =  LNK-NYULIFE2-SANTEIYM)
                AND
                   (PTNYUINRRK-TENSTUYMD(1:6)  >  LNK-NYULIFE2-SANTEIYM)
                    MOVE   PTNYUINRRK-TENNYUYMD(7:2)   TO  IDX-ST
                    MOVE   31                          TO  IDX-ED
                END-IF
                IF (PTNYUINRRK-TENNYUYMD(1:6)  <  LNK-NYULIFE2-SANTEIYM)
                AND
                   (PTNYUINRRK-TENSTUYMD(1:6)  >  LNK-NYULIFE2-SANTEIYM)
                    MOVE   1                           TO  IDX-ST
                    MOVE   31                          TO  IDX-ED
                END-IF
      *
      **          DISPLAY "IDX-ST = " IDX-ST
      **          DISPLAY "IDX-ED = " IDX-ED
      **          DISPLAY "PTNYUINRRK-TOKU-SANTEIYOUKENKBN = "
      **                   PTNYUINRRK-TOKU-SANTEIYOUKENKBN
                PERFORM    VARYING   IDX1  FROM   IDX-ST  BY  1
                  UNTIL   (IDX1    >  IDX-ED)
      **                DISPLAY "SET IDX1 = " IDX1
                      IF    PTNYUINRRK-TOKU-SANTEIYOUKENKBN  =  "1"
                         MOVE  "1"    TO  WRK-SANTEIYOUKENKBN(IDX1)
                      ELSE
                         MOVE  SPACE  TO  WRK-SANTEIYOUKENKBN(IDX1)
                      END-IF
                END-PERFORM
      *
                MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
                MOVE    "key44"             TO  MCP-PATHNAME
                PERFORM 910-PTNYUINRRK-READ-SEC
             END-PERFORM
           END-IF
      *
           MOVE     "tbl_ptnyuinrrk"      TO  MCP-TABLE
           MOVE     "key44"               TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *    食事負担据え置き対象取得サブ
           INITIALIZE                      ORCSSKJKEEP-AREA
           MOVE    LNK-NYULIFE2-HOSPNUM    TO  LNK-SKJKEEP-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID       TO  LNK-SKJKEEP-PTID
           MOVE    LNK-NYULIFE2-SANTEIYM   TO  LNK-SKJKEEP-SANTEIYM
           CALL    "ORCSSKJKEEP"    USING      ORCSSKJKEEP-AREA
                                               SPA-AREA

      *    入院時生活療養費の該当日と軽減区分２（入院料判定）を取得
           MOVE    ZERO                    TO  FLG-OK
           INITIALIZE                          NYUINACCT-REC
           MOVE    LNK-NYULIFE2-HOSPNUM    TO  NACCT-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID       TO  NACCT-PTID
           MOVE    LNK-NYULIFE2-SANTEIYM   TO  NACCT-SRYYM
           MOVE    "1"                     TO  NACCT-ZAISKBKBN
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM 910-NYUINACCT-SELECT-SEC
           IF      FLG-NYUINACCT           =   ZERO
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               MOVE    "key17"             TO  MCP-PATHNAME
               PERFORM   910-NYUINACCT-READ-SEC
               PERFORM   UNTIL   (FLG-NYUINACCT    =   1)
                   IF    NACCT-SRYCDTOTAL     =    99999916
                       CONTINUE
                   ELSE
      *             （平成２８年４月から平成３０年３月まで）
                     IF  (LNK-NYULIFE2-SANTEIYM >=  "201604")  AND
                         (LNK-NYULIFE2-SANTEIYM <=  "201803")
      *                生活療養に該当する入院料を判定し、
      *                返却値の対象区分を設定する
                       PERFORM    210-NYUINACT-GET-SEC
                       MOVE       ZERO        TO   FLG-SEI
                                                   IDX-SEI2
                       PERFORM    VARYING   IDX-SEI  FROM 1  BY  1
                         UNTIL   (IDX-SEI   >  103)    OR
                                 (FLG-SEI   =    1)
                             IF  NSRY-SRYCD(1) = TBL-H28-SEISRYCD
                                                        (IDX-SEI)
                                 MOVE   1        TO   FLG-SEI
                                 MOVE   IDX-SEI  TO   IDX-SEI2
                             END-IF
                       END-PERFORM
                       IF   FLG-SEI    =    1
                          PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                            IF     NACCT-DAY(IDX1)  NOT =  ZERO
                               MOVE   "1"    TO   LNK-NYULIFE2-KBN(IDX1)
                               MOVE    1     TO   FLG-OK
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（入院料判断）
                               IF  (IDX-SEI2   >=   1 )   AND
                                   (IDX-SEI2   <=   40)
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        難病公費の判定追加（以下入院料の場合のみ）
      *                        ・地域包括ケア病棟入院料
      *                        ・地域包括ケア入院医療管理料
                               IF  (IDX-SEI2   >=   94)   AND
                                   (IDX-SEI2   <=  101)
      *                          難病公費を使用されているか判定
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  WRK-HKNCOMBI-DAY(IDX1) NOT =  ZERO
                                     INITIALIZE            HKNCOMBI-REC
                                     MOVE   LNK-NYULIFE2-HOSPNUM
                                                   TO  COMB-HOSPNUM
                                     MOVE   LNK-NYULIFE2-PTID 
                                                   TO  COMB-PTID
                                     MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                                   TO  COMB-HKNCOMBINUM
                                     MOVE   "tbl_hkncombi"
                                                   TO  MCP-TABLE
                                     MOVE    "key" TO  MCP-PATHNAME
                                     PERFORM 910-HKNCOMBI-SELECT-SEC
                                     IF   FLG-HKNCOMBI      =   ZERO
                                       MOVE  "tbl_hkncombi"
                                                   TO  MCP-TABLE
                                       MOVE  "key"  TO  MCP-PATHNAME
                                       PERFORM   910-HKNCOMBI-READ-SEC
                                       IF  FLG-HKNCOMBI         =  ZERO
                                         IF  (COMB-KOHHKNNUM(1) = "054")
                                          OR (COMB-KOHHKNNUM(2) = "054")
                                          OR (COMB-KOHHKNNUM(3) = "054")
                                          OR (COMB-KOHHKNNUM(4) = "054")
                                             MOVE  1    TO   FLG-NANBYO
                                         END-IF
                                       END-IF
                                     END-IF
      *                              保険組合せクローズ
                                     MOVE    "tbl_hkncombi"
                                                        TO  MCP-TABLE
                                     MOVE    "key"      TO  MCP-PATHNAME
                                     PERFORM   900-CLOSE-SEC
                                 END-IF
      *
                                 IF   FLG-NANBYO  =   1
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（特別入院基本料算定時の
      *                                                    ＡＤＬ入力判断）
                               IF (IDX-SEI2   =  102  OR 103)    AND
                                  (SS008-MEDKBNDAY(IDX1)  =  "2" OR
                                                             "3" )
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        算定要件外で療養病棟入院基本料のＩを算定時
      *                        は医療区分と難病公費のダブルチェック
      **                         DISPLAY "IDX-SEI2 = " IDX-SEI2
      **                         DISPLAY "IDX1 = " IDX1
      **                         DISPLAY "WRK-SANTEIYOUKENKBN = "
      **                                 WRK-SANTEIYOUKENKBN(IDX1)
                               IF (IDX-SEI2       =  47 OR 50 OR
                                                     53 OR 56 OR 59) AND
                                 ((SS008-MEDKBNDAY(IDX1) = "2" OR
                                                           "3"))  AND
                                  (WRK-SANTEIYOUKENKBN(IDX1) = "1")
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
                            END-IF
                          END-PERFORM
                       END-IF
                     END-IF
      *
      *             （平成３０年４月から令和２年３月まで）
                     IF  (LNK-NYULIFE2-SANTEIYM >=  "201804")  AND
                         (LNK-NYULIFE2-SANTEIYM <=  "202003")
      *                生活療養に該当する入院料を判定し、
      *                返却値の対象区分を設定する
                       PERFORM    210-NYUINACT-GET-SEC
                       MOVE       ZERO        TO   FLG-SEI
                                                   IDX-SEI2
                       PERFORM    VARYING   IDX-SEI  FROM 1  BY  1
                         UNTIL   (IDX-SEI   >  99)    OR
                                 (FLG-SEI   =    1)
                             IF  NSRY-SRYCD(1) = TBL-H30-SEISRYCD
                                                        (IDX-SEI)
                                 MOVE   1        TO   FLG-SEI
                                 MOVE   IDX-SEI  TO   IDX-SEI2
                             END-IF
                       END-PERFORM
                       IF   FLG-SEI    =    1
                          PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                            IF     NACCT-DAY(IDX1)  NOT =  ZERO
                               MOVE   "1"    TO   LNK-NYULIFE2-KBN(IDX1)
                               MOVE    1     TO   FLG-OK
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（入院料判断）
                               IF  (IDX-SEI2   >=   1 )   AND
                                   (IDX-SEI2   <=   37)
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        難病公費の判定追加（以下入院料の場合のみ）
      *                        ・地域包括ケア病棟入院料
      *                        ・地域包括ケア入院医療管理料
                               IF  (IDX-SEI2   >=   82)   AND
                                   (IDX-SEI2   <=   97)
      *                          難病公費を使用されているか判定
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  WRK-HKNCOMBI-DAY(IDX1) NOT =  ZERO
                                     INITIALIZE            HKNCOMBI-REC
                                     MOVE   LNK-NYULIFE2-HOSPNUM
                                                   TO  COMB-HOSPNUM
                                     MOVE   LNK-NYULIFE2-PTID 
                                                   TO  COMB-PTID
                                     MOVE   WRK-HKNCOMBI-DAY(IDX1)
                                                   TO  COMB-HKNCOMBINUM
                                     MOVE   "tbl_hkncombi"
                                                   TO  MCP-TABLE
                                     MOVE    "key" TO  MCP-PATHNAME
                                     PERFORM 910-HKNCOMBI-SELECT-SEC
                                     IF   FLG-HKNCOMBI      =   ZERO
                                       MOVE  "tbl_hkncombi"
                                                   TO  MCP-TABLE
                                       MOVE  "key"  TO  MCP-PATHNAME
                                       PERFORM   910-HKNCOMBI-READ-SEC
                                       IF  FLG-HKNCOMBI         =  ZERO
                                         IF  (COMB-KOHHKNNUM(1) = "054")
                                          OR (COMB-KOHHKNNUM(2) = "054")
                                          OR (COMB-KOHHKNNUM(3) = "054")
                                          OR (COMB-KOHHKNNUM(4) = "054")
                                             MOVE  1    TO   FLG-NANBYO
                                         END-IF
                                       END-IF
                                     END-IF
      *                              保険組合せクローズ
                                     MOVE    "tbl_hkncombi"
                                                        TO  MCP-TABLE
                                     MOVE    "key"      TO  MCP-PATHNAME
                                     PERFORM   900-CLOSE-SEC
                                 END-IF
      *
                                 IF   FLG-NANBYO  =   1
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（特別入院基本料算定時の
      *                                                    ＡＤＬ入力判断）
                               IF (IDX-SEI2   =  98  OR  99)    AND
                                  (SS008-MEDKBNDAY(IDX1)  =  "2" OR
                                                             "3" )
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        算定要件外で療養病棟入院基本料のＩを算定時
      *                        は医療区分と難病公費のダブルチェック
      **                         DISPLAY "IDX-SEI2 = " IDX-SEI2
      **                         DISPLAY "IDX1 = " IDX1
      **                         DISPLAY "WRK-SANTEIYOUKENKBN = "
      **                                 WRK-SANTEIYOUKENKBN(IDX1)
                               IF (IDX-SEI2       =  44 OR 47 OR
                                                     50 OR 51 OR
                                                     54) AND
                                 ((SS008-MEDKBNDAY(IDX1) = "2" OR
                                                           "3"))  AND
                                  (WRK-SANTEIYOUKENKBN(IDX1) = "1")
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        急性増悪により療養病棟入院基本料のＩの算定時
      *                        は食事負担据え置き（システム予約入力）
                               IF (IDX-SEI2       =  44 OR 47 OR
                                                     50 OR 51 OR
                                                     54)
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF (LNK-SKJKEEP-KBN(IDX1)  =   "1") AND
                                    (LNK-SKJKEEP-NANBYOKBN(IDX1) = "2")
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
                            END-IF
                          END-PERFORM
                       END-IF
                     END-IF
      *
      *             （令和２年４月から令和４年３月まで）
                     IF  (LNK-NYULIFE2-SANTEIYM >=  "202004")  AND
                         (LNK-NYULIFE2-SANTEIYM <=  "202203")
      *                生活療養に該当する入院料を判定し、
      *                返却値の対象区分を設定する
                       PERFORM    210-NYUINACT-GET-SEC
                       MOVE       ZERO        TO   FLG-SEI
                                                   IDX-SEI2
                       PERFORM    VARYING   IDX-SEI  FROM 1  BY  1
                         UNTIL   (IDX-SEI   >  96)    OR
                                 (FLG-SEI   =    1)
                             IF  NSRY-SRYCD(1) = TBL-R02-SEISRYCD
                                                        (IDX-SEI)
                                 MOVE   1        TO   FLG-SEI
                                 MOVE   IDX-SEI  TO   IDX-SEI2
                             END-IF
                       END-PERFORM
                       IF   FLG-SEI    =    1
                          PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                            IF     NACCT-DAY(IDX1)  NOT =  ZERO
                               MOVE   "1"    TO   LNK-NYULIFE2-KBN(IDX1)
                               MOVE    1     TO   FLG-OK
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（入院料判断）
                               IF  (IDX-SEI2   >=   1 )   AND
                                   (IDX-SEI2   <=   31)
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        難病公費の判定追加（以下入院料の場合のみ）
      *                        ・地域包括ケア病棟入院料
      *                        ・地域包括ケア入院医療管理料
                               IF  (IDX-SEI2   >=   71)   AND
                                   (IDX-SEI2   <=   94)
      *                          難病公費を使用されているか判定
      **                           DISPLAY "FLG-NANBYO = " FLG-NANBYO
      **                           MOVE   ZERO       TO   FLG-NANBYO
      **                           IF  WRK-HKNCOMBI-DAY(IDX1) NOT =  ZERO
      **                               INITIALIZE            HKNCOMBI-REC
      **                               MOVE   LNK-NYULIFE2-HOSPNUM
      **                                             TO  COMB-HOSPNUM
      **                               MOVE   LNK-NYULIFE2-PTID 
      **                                             TO  COMB-PTID
      **                               MOVE   WRK-HKNCOMBI-DAY(IDX1)
      **                                             TO  COMB-HKNCOMBINUM
      **                               MOVE   "tbl_hkncombi"
      **                                             TO  MCP-TABLE
      **                               MOVE    "key" TO  MCP-PATHNAME
      **                               PERFORM 910-HKNCOMBI-SELECT-SEC
      **                               IF   FLG-HKNCOMBI      =   ZERO
      **                                 MOVE  "tbl_hkncombi"
      **                                             TO  MCP-TABLE
      **                                 MOVE  "key"  TO  MCP-PATHNAME
      **                                 PERFORM   910-HKNCOMBI-READ-SEC
      **                                 IF  FLG-HKNCOMBI         =  ZERO
      **                                   IF  (COMB-KOHHKNNUM(1) = "054")
      **                                    OR (COMB-KOHHKNNUM(2) = "054")
      **                                    OR (COMB-KOHHKNNUM(3) = "054")
      **                                    OR (COMB-KOHHKNNUM(4) = "054")
      **                                       MOVE  1    TO   FLG-NANBYO
      **                                   END-IF
      **                                 END-IF
      **                               END-IF
      ***                              保険組合せクローズ
      **                               MOVE    "tbl_hkncombi"
      **                                                  TO  MCP-TABLE
      **                               MOVE    "key"      TO  MCP-PATHNAME
      **                               PERFORM   900-CLOSE-SEC
      **                           END-IF
      *
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF   FLG-NANBYO  =   1
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（特別入院基本料算定時の
      *                                                    ＡＤＬ入力判断）
                               IF (IDX-SEI2   =  95  OR  96)    AND
                                  (SS008-MEDKBNDAY(IDX1)  =  "2" OR
                                                             "3" )
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        算定要件外で療養病棟入院基本料のＩを算定時
      *                        は医療区分と難病公費のダブルチェック
      **                         DISPLAY "IDX-SEI2 = " IDX-SEI2
      **                         DISPLAY "IDX1 = " IDX1
      **                         DISPLAY "WRK-SANTEIYOUKENKBN = "
      **                                 WRK-SANTEIYOUKENKBN(IDX1)
                               IF (IDX-SEI2       =  38 OR 41 OR 44) AND
                                 ((SS008-MEDKBNDAY(IDX1) = "2" OR
                                                           "3"))  AND
                                  (WRK-SANTEIYOUKENKBN(IDX1) = "1")
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        急性増悪により療養病棟入院基本料のＩの算定時
      *                        は食事負担据え置き（システム予約入力）
                               IF (IDX-SEI2       =  38 OR 41 OR 44)
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF (LNK-SKJKEEP-KBN(IDX1)  =   "1") AND
                                    (LNK-SKJKEEP-NANBYOKBN(IDX1) = "2")
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
                            END-IF
                          END-PERFORM
                       END-IF
                     END-IF
      *
      *             （令和４年４月から令和６年５月まで）
                     IF  (LNK-NYULIFE2-SANTEIYM >=  "202204")  AND
                         (LNK-NYULIFE2-SANTEIYM <=  "202405")
      *                生活療養に該当する入院料を判定し、
      *                返却値の対象区分を設定する
                       PERFORM    210-NYUINACT-GET-SEC
                       MOVE       ZERO        TO   FLG-SEI
                                                   IDX-SEI2
                       PERFORM    VARYING   IDX-SEI  FROM 1  BY  1
                         UNTIL   (IDX-SEI   >  184)    OR
                                 (FLG-SEI   =    1)
                             IF  NSRY-SRYCD(1) = TBL-R04-SEISRYCD
                                                        (IDX-SEI)
                                 MOVE   1        TO   FLG-SEI
                                 MOVE   IDX-SEI  TO   IDX-SEI2
                             END-IF
                       END-PERFORM
                       IF   FLG-SEI    =    1
                          PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                            IF     NACCT-DAY(IDX1)  NOT =  ZERO
                               MOVE   "1"    TO   LNK-NYULIFE2-KBN(IDX1)
                               MOVE    1     TO   FLG-OK
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（入院料判断）
                               IF  (IDX-SEI2   >=   1 )   AND
                                   (IDX-SEI2   <=   32)
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        難病公費の判定追加（以下入院料の場合のみ）
      *                        ・地域包括ケア病棟入院料
      *                        ・地域包括ケア入院医療管理料
                               IF  (IDX-SEI2   >=   110)   AND
                                   (IDX-SEI2   <=   181)
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF   FLG-NANBYO  =   1
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（特別入院基本料算定時の
      *                                                    ＡＤＬ入力判断）
                               IF (IDX-SEI2   =  183  OR  184)    AND
                                  (SS008-MEDKBNDAY(IDX1)  =  "2" OR
                                                             "3" )
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        算定要件外で療養病棟入院基本料のＩを算定時
      *                        は医療区分と難病公費のダブルチェック
      **                         DISPLAY "IDX-SEI2 = " IDX-SEI2
      **                         DISPLAY "IDX1 = " IDX1
      **                         DISPLAY "WRK-SANTEIYOUKENKBN = "
      **                                 WRK-SANTEIYOUKENKBN(IDX1)
                               IF (IDX-SEI2       =  39 OR 42 OR 45) AND
                                 ((SS008-MEDKBNDAY(IDX1) = "2" OR
                                                           "3"))  AND
                                  (WRK-SANTEIYOUKENKBN(IDX1) = "1")
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        急性増悪により療養病棟入院基本料のＩの算定時
      *                        は食事負担据え置き（システム予約入力）
                               IF (IDX-SEI2       =  39 OR 42 OR 45)
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF (LNK-SKJKEEP-KBN(IDX1)  =   "1") AND
                                    (LNK-SKJKEEP-NANBYOKBN(IDX1) = "2")
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
                            END-IF
                          END-PERFORM
                       END-IF
                     END-IF
      *
      *             （令和６年６月から）
                     IF  LNK-NYULIFE2-SANTEIYM >=  "202406"
      *                生活療養に該当する入院料を判定し、
      *                返却値の対象区分を設定する
                       PERFORM    210-NYUINACT-GET-SEC
                       MOVE       ZERO        TO   FLG-SEI
                                                   IDX-SEI2
                       PERFORM    VARYING   IDX-SEI  FROM 1  BY  1
                         UNTIL   (IDX-SEI   >  296)    OR
                                 (FLG-SEI   =    1)
                             IF  NSRY-SRYCD(1) = TBL-R06-SEISRYCD
                                                        (IDX-SEI)
                                 MOVE   1        TO   FLG-SEI
                                 MOVE   IDX-SEI  TO   IDX-SEI2
                             END-IF
                       END-PERFORM
                       IF   FLG-SEI    =    1
                          PERFORM    VARYING   IDX1   FROM   1   BY   1
                                  UNTIL     IDX1   >   31
                            IF     NACCT-DAY(IDX1)  NOT =  ZERO
                               MOVE   "1"    TO   LNK-NYULIFE2-KBN(IDX1)
                               MOVE    1     TO   FLG-OK
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（入院料判断）
                               IF  (IDX-SEI2   >=   1 )   AND
                                   (IDX-SEI2   <=   66)
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        難病公費の判定追加（以下入院料の場合のみ）
      *                        ・地域包括ケア病棟入院料
      *                        ・地域包括ケア入院医療管理料
                               IF  (IDX-SEI2   >=   150)   AND
                                   (IDX-SEI2   <=   293)
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF   FLG-NANBYO  =   1
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        病状の程度、治療の内容をしん酌して標準
      *                        負担額を軽減する患者の判定（特別入院基本料算定時の
      *                                                    ＡＤＬ入力判断）
                               IF (IDX-SEI2   =  295  OR  296)    AND
                                  (SS008-MEDKBNDAY(IDX1)  =  "2" OR
                                                             "3" )
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
      *                        算定要件外で療養病棟入院基本料の２７を算定時
      *                        は医療区分と難病公費のダブルチェック
      **                         DISPLAY "IDX-SEI2 = " IDX-SEI2
      **                         DISPLAY "IDX1 = " IDX1
      **                         DISPLAY "WRK-SANTEIYOUKENKBN = "
      **                                 WRK-SANTEIYOUKENKBN(IDX1)
                               IF (IDX-SEI2       =  73 OR 76) AND
                                 ((SS008-MEDKBNDAY(IDX1) = "2" OR
                                                           "3"))  AND
                                  (WRK-SANTEIYOUKENKBN(IDX1) = "1")
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF  LNK-SKJKEEP-KBN(IDX1)  =   "1"
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
      *                        急性増悪により療養病棟入院基本料の２７の算定時
      *                        は食事負担据え置き（システム予約入力）
                               IF (IDX-SEI2       =  73 OR 76)
                                 MOVE   ZERO       TO   FLG-NANBYO
                                 IF (LNK-SKJKEEP-KBN(IDX1)  =   "1") AND
                                    (LNK-SKJKEEP-NANBYOKBN(IDX1) = "2")
                                     MOVE  1    TO   FLG-NANBYO
                                 END-IF
                                 IF  FLG-NANBYO          =   1 
                                   MOVE   "1"   TO   
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                                 END-IF
                               END-IF
                            END-IF
                          END-PERFORM
                       END-IF
                     END-IF
      *
                   END-IF
      *
                   MOVE    "tbl_nyuinacct"      TO  MCP-TABLE
                   MOVE    "key17"              TO  MCP-PATHNAME
                   PERFORM 910-NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
      *
      *    入院会計クローズ
           MOVE    "tbl_nyuinacct"         TO  MCP-TABLE
           MOVE    "key17"                 TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *    短期滞在手術基本料２（短期滞在手術基本料３）の入院料未算定日
      *    について生活療養の該当日と軽減区分２の情報を取得（サブプロより取得）
           INITIALIZE                          ORCSNYUINDAY-AREA
           MOVE    LNK-NYULIFE2-HOSPNUM     TO  LNK-NYUINDAY-HOSPNUM
           MOVE    LNK-NYULIFE2-PTID        TO  LNK-NYUINDAY-PTID
           MOVE    LNK-NYULIFE2-SANTEIYM    TO  LNK-NYUINDAY-SANTEIYM
           CALL    "ORCSNYUINDAY"      USING   ORCSNYUINDAY-AREA
                                               SPA-AREA
           IF      LNK-NYUINDAY-RC         =   ZERO
               IF    LNK-NYUINDAY-TANKI2-TBL   NOT =    SPACE
                   PERFORM    VARYING   IDX1   FROM   1   BY   1
                      UNTIL   IDX1   >   31
                         IF    LNK-NYUINDAY-TANKI2-KBN(IDX1)   =   "2"
                               MOVE   "1"   TO   LNK-NYULIFE2-KBN(IDX1)
                               MOVE   "1"   TO
                                             LNK-NYULIFE2-FTNKBN2(IDX1)
                               IF   LNK-NYUINDAY-TANKI3-KBN(IDX1) = "2"
                                    MOVE   SPACE  TO
                                              LNK-NYULIFE2-FTNKBN2(IDX1)
                               END-IF
                               MOVE    1    TO   FLG-OK
                         END-IF
                   END-PERFORM
               END-IF
           END-IF
      *
      *−−−−医療機関食事情報取得ここから−−−−−−−−−−−
      *医療機関食事情報の取得（システム管理テーブルより）
           MOVE    ZERO                TO  FLG-SYSKANRI
           INITIALIZE                      SYSKANRI-REC
           MOVE    LNK-NYULIFE2-HOSPNUM TO  SYS-HOSPNUM
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    LNK-NYULIFE2-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "01"                TO  SYS-STYUKYMD(7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"  TO  MCP-TABLE
               MOVE    "key10"         TO  MCP-PATHNAME
               PERFORM  910-SYSKANRI-READ-SEC
      *        食事情報の退避
               IF     SYS-5000-SHOKUJIRYOYOCD  NOT =  SPACE
                   PERFORM    VARYING   IDX1  FROM  1  BY  1
                          UNTIL     IDX1   >    31
                       IF    LNK-NYULIFE2-KBN(IDX1)   =   "1"
      *                   入院時食事療養費
                           IF   SYS-5000-SHOKUJIRYOYOCD  = "197000110"
                                MOVE   "1"     TO  
                                          LNK-NYULIFE2-SKJKBN(IDX1)
                           ELSE
                                MOVE   "2"     TO  
                                          LNK-NYULIFE2-SKJKBN(IDX1)
                           END-IF
                       END-IF
                   END-PERFORM
               END-IF
           END-IF
      *    システム管理クローズ
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *月内の医療機関食事情報の取得（システム管理テーブルより）
           MOVE    ZERO                TO  FLG-SYSKANRI
           INITIALIZE                      SYSKANRI-REC
           MOVE    LNK-NYULIFE2-HOSPNUM TO  SYS-HOSPNUM
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    LNK-NYULIFE2-SANTEIYM
                                       TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           DISPLAY "MCP-RC =" MCP-RC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"  TO  MCP-TABLE
               MOVE    "key11"         TO  MCP-PATHNAME
               PERFORM  910-SYSKANRI-READ-SEC
               PERFORM  UNTIL   FLG-SYSKANRI   =   1
                  MOVE  SYS-5000-STYUKYMD(7:2)   TO  IDV
      *           食事情報の退避
                  IF     SYS-5000-SHOKUJIRYOYOCD  NOT =  SPACE
                      PERFORM    VARYING   IDX1  FROM  IDV  BY  1
                             UNTIL     IDX1   >    31
                          IF    LNK-NYULIFE2-KBN(IDX1)   =   "1"
      *                      入院時食事療養費
                              IF   SYS-5000-SHOKUJIRYOYOCD = "197000110"
                                   MOVE   "1"     TO  
                                             LNK-NYULIFE2-SKJKBN(IDX1)
                              ELSE
                                   MOVE   "2"     TO  
                                             LNK-NYULIFE2-SKJKBN(IDX1)
                              END-IF
                          END-IF
                      END-PERFORM
                  END-IF
                  MOVE    "tbl_syskanri"  TO  MCP-TABLE
                  MOVE    "key11"         TO  MCP-PATHNAME
                  PERFORM  910-SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
      *    システム管理クローズ
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *−−−−医療機関食事情報取得取得ここまで−−−−−−−−−−−
      *
      *
           IF    FLG-OK   =    1
      *
      *        老人適用のチェック
               IF      LNK-NYULIFE2-SANTEIYM <=  "200803"
      *          （平成２０年３月以前は老人保健の判定チェック）
                   MOVE    ZERO                 TO  FLG-RJN 
                   INITIALIZE                       PTKOHINF-REC
                   MOVE    LNK-NYULIFE2-HOSPNUM  TO  PTKOH-HOSPNUM
                   MOVE    LNK-NYULIFE2-PTID     TO  PTKOH-PTID
                   MOVE    "027"                TO  PTKOH-KOHNUM
                   MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                   MOVE    "key4"               TO  MCP-PATHNAME
                   PERFORM 910-PTKOHINF-SELECT-SEC
                   IF      FLG-PTKOHINF         =   ZERO
                       MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                       MOVE    "key4"               TO  MCP-PATHNAME
                       PERFORM   910-PTKOHINF-READ-SEC
                       PERFORM   UNTIL   (FLG-PTKOHINF   =   1)
                           IF    PTKOH-SAKJOKBN     =    SPACE
                                 MOVE   1           TO   FLG-RJN
                           END-IF
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM 910-PTKOHINF-READ-SEC
                       END-PERFORM
                   END-IF
      *            患者公費情報クローズ
                   MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                   MOVE    "key4"               TO  MCP-PATHNAME
                   PERFORM   900-CLOSE-SEC
               ELSE
      *          （平成２０年４月以降はサブルーチンによりチェック）
                   PERFORM  VARYING    IDX-RJN    FROM   1   BY  1
                     UNTIL  IDX-RJN    >   31
                       INITIALIZE                   ORCSAGECHKAREA
                       MOVE    LNK-NYULIFE2-HOSPNUM  TO  AGECHK-HOSPNUM
                       MOVE    LNK-NYULIFE2-PTID     TO  AGECHK-PTID
                       MOVE    LNK-NYULIFE2-SANTEIYM TO  WRK-YYMM
                       MOVE    IDX-RJN              TO  WRK-DD
                       MOVE    WRK-YMD              TO  AGECHK-SRYYMD
                       CALL   "ORCSAGECHK"          USING
                                                    ORCSAGECHKAREA
                                                    SPA-AREA
                       IF      AGECHK-ROUJIN2    =   1
                           MOVE   1              TO  WRK-RJN(IDX-RJN)
                       END-IF
                   END-PERFORM
               END-IF
      *
      *−−−−サブルーチンでの患者所得情報の取得ここから−−−−−
               INITIALIZE                          ORCSSYOTOKUAREA
               MOVE    LNK-NYULIFE2-HOSPNUM    TO  LNK-SYOTOKU-HOSPNUM
               MOVE    LNK-NYULIFE2-PTID       TO  LNK-SYOTOKU-PTID
               MOVE    LNK-NYULIFE2-SANTEIYM   TO  LNK-SYOTOKU-SRYYM
               MOVE    "1"                     TO  LNK-SYOTOKU-SKJCHKFLG
               CALL   "ORCSSYOTOKU"    USING    ORCSSYOTOKUAREA
                                                SPA-AREA
               IF    LNK-SYOTOKU-RC    =        ZERO
                    PERFORM   VARYING   IDX1   FROM   1  BY  1
                              UNTIL     IDX1   >    31
      *                  DISPLAY "IDX1 = " IDX1
      *                  DISPLAY "AGEKBN,SKJKBN,KKSKBN = "
      *                           LNK-SYOTOKU-AGEKBN(IDX1)
      *                          ","
      *                           LNK-SYOTOKU-SKJKBN(IDX1)
      *                          ","
      *                           LNK-SYOTOKU-KKSKBN(IDX1)
                        EVALUATE   LNK-SYOTOKU-SKJKBN(IDX1)
                            WHEN  "1"
                                MOVE  "3"  TO LNK-NYULIFE2-FTNKBN1(IDX1)
                            WHEN  "2"
                                MOVE  "1"  TO LNK-NYULIFE2-FTNKBN1(IDX1)
                            WHEN  "3"
                                MOVE  "2"  TO LNK-NYULIFE2-FTNKBN1(IDX1)
                            WHEN  "4"
                                MOVE  "4"  TO LNK-NYULIFE2-FTNKBN1(IDX1)
                        END-EVALUATE
                    END-PERFORM
               ELSE
                    DISPLAY "ORCSSYTOKU RC = " LNK-SYOTOKU-RC
               END-IF
      *−−−−サブルーチンでの患者所得情報の取得ここまで−−−−−
      *
      *
      *−−−−食事療養、環境療養コード、単価設定ここから−−−−−
            PERFORM   VARYING   IDX-T   FROM   1  BY  1
              UNTIL   IDX-T     >  3
               INITIALIZE                        NYUINACCT-REC
               MOVE    LNK-NYULIFE2-HOSPNUM  TO  NACCT-HOSPNUM
               MOVE    LNK-NYULIFE2-PTID     TO  NACCT-PTID
               MOVE    LNK-NYULIFE2-SANTEIYM TO  NACCT-SRYYM
               MOVE    "tbl_nyuinacct"       TO  MCP-TABLE
               EVALUATE   IDX-T
                   WHEN   1
                       MOVE    "key30"       TO  MCP-PATHNAME
                   WHEN   2
                       MOVE    "key31"       TO  MCP-PATHNAME
                   WHEN   3
                       MOVE    "key32"       TO  MCP-PATHNAME
               END-EVALUATE
               PERFORM 910-NYUINACCT-SELECT-SEC
               MOVE    "tbl_nyuinacct"     TO  MCP-TABLE
               EVALUATE   IDX-T
                   WHEN   1
                       MOVE    "key30"       TO  MCP-PATHNAME
                   WHEN   2
                       MOVE    "key31"       TO  MCP-PATHNAME
                   WHEN   3
                       MOVE    "key32"       TO  MCP-PATHNAME
               END-EVALUATE
               PERFORM   910-NYUINACCT-READ-SEC
      *
      *       入院会計クローズ
               MOVE    "tbl_nyuinacct"             TO  MCP-TABLE
               EVALUATE   IDX-T
                   WHEN   1
                       MOVE    "key30"       TO  MCP-PATHNAME
                   WHEN   2
                       MOVE    "key31"       TO  MCP-PATHNAME
                   WHEN   3
                       MOVE    "key32"       TO  MCP-PATHNAME
               END-EVALUATE
               PERFORM   900-CLOSE-SEC
      *
               IF   LNK-NYULIFE2-SANTEIYM   <=  "202405"
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                  IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-SKJKBN(IDX1)
                        WHEN  "1"
                            IF    NACCT-DAY(IDX1) NOT =  3
                              MOVE  "197001310"   TO
                                            LNK-NYULIFE2-SKJ-SRYCD
                                                            (IDX1 IDX-T)
                              MOVE   554          TO
                                            LNK-NYULIFE2-SKJ-MONEY
                                                            (IDX1 IDX-T)
                            ELSE
                              MOVE  "197003510"   TO
                                            LNK-NYULIFE2-SKJ-SRYCD
                                                            (IDX1 IDX-T)
                              MOVE   500          TO
                                            LNK-NYULIFE2-SKJ-MONEY
                                                            (IDX1 IDX-T)
                            END-IF
                            MOVE  "197001410"   TO
                                            LNK-NYULIFE2-KAN-SRYCD(IDX1)
                            MOVE   398          TO
                                            LNK-NYULIFE2-KAN-MONEY(IDX1)
                        WHEN  "2"
                            MOVE  "197001710"   TO
                                            LNK-NYULIFE2-SKJ-SRYCD
                                                            (IDX1 IDX-T)
                            MOVE   420          TO
                                            LNK-NYULIFE2-SKJ-MONEY
                                                            (IDX1 IDX-T)
                            MOVE  "197001810"   TO
                                            LNK-NYULIFE2-KAN-SRYCD(IDX1)
                            MOVE   398          TO
                                            LNK-NYULIFE2-KAN-MONEY(IDX1)
                    END-EVALUATE
                  END-IF
                END-PERFORM
               ELSE
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                  IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-SKJKBN(IDX1)
                        WHEN  "1"
                            IF    NACCT-DAY(IDX1) NOT =  3
                              MOVE  "197001310"   TO
                                            LNK-NYULIFE2-SKJ-SRYCD
                                                            (IDX1 IDX-T)
                              MOVE   584          TO
                                            LNK-NYULIFE2-SKJ-MONEY
                                                            (IDX1 IDX-T)
                            ELSE
                              MOVE  "197003510"   TO
                                            LNK-NYULIFE2-SKJ-SRYCD
                                                            (IDX1 IDX-T)
                              MOVE   530          TO
                                            LNK-NYULIFE2-SKJ-MONEY
                                                            (IDX1 IDX-T)
                            END-IF
                            MOVE  "197001410"   TO
                                            LNK-NYULIFE2-KAN-SRYCD(IDX1)
                            MOVE   398          TO
                                            LNK-NYULIFE2-KAN-MONEY(IDX1)
                        WHEN  "2"
                            MOVE  "197001710"   TO
                                            LNK-NYULIFE2-SKJ-SRYCD
                                                            (IDX1 IDX-T)
                            MOVE   450          TO
                                            LNK-NYULIFE2-SKJ-MONEY
                                                            (IDX1 IDX-T)
                            MOVE  "197001810"   TO
                                            LNK-NYULIFE2-KAN-SRYCD(IDX1)
                            MOVE   398          TO
                                            LNK-NYULIFE2-KAN-MONEY(IDX1)
                    END-EVALUATE
                  END-IF
                END-PERFORM
               END-IF
      *−−−−食事療養、環境療養コード、単価設定ここまで−−−−−
      *
      *−−−−食事負担、環境療養負担コード、単価設定ここから−−−
      *        生活療養食事標準負担額設定（一般所得者）（令和６年５月まで）
               IF   LNK-NYULIFE2-SANTEIYM   <=  "202405"
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                 IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-SKJKBN(IDX1)
                        WHEN  "1"
                            MOVE  "197002010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                            MOVE   460          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                        WHEN  "2"
                            MOVE  "197002110"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                            MOVE   420          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                    END-EVALUATE
                 END-IF
                END-PERFORM
               END-IF
      *        生活療養食事標準負担額設定（一般所得者）（令和６年６月以降）
               IF   LNK-NYULIFE2-SANTEIYM   >=  "202406"
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                 IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-SKJKBN(IDX1)
                        WHEN  "1"
                            MOVE  "197002010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                            MOVE   490          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                        WHEN  "2"
                            MOVE  "197002110"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                            MOVE   450          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                    END-EVALUATE
                 END-IF
                END-PERFORM
               END-IF
      *
      *        生活療養食事標準負担額設定（軽減ありの患者）（平成２９年９月迄）
               IF   LNK-NYULIFE2-SANTEIYM <=  "201709"
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                 IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-FTNKBN2(IDX1)
                        WHEN  SPACE
      *                   所得の状況による軽減
                            EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
                                WHEN   "1"
                                WHEN   "2"
      *                           （低２）
                                    MOVE  "197002210"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                WHEN   "3"
      *                           （低１）
                                    IF  (FLG-RJN         =  0)   AND
                                        (WRK-RJN(IDX1)   =  0)                                        
                                       MOVE  "197002310"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   130          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    ELSE
                                       MOVE  "197002410"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   130          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
                                WHEN   "4"
      *                           （低１−老齢福祉年金受給者）
                                    MOVE  "197002510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                            END-EVALUATE
                        WHEN  "1"
      *                   病状の程度による軽減
                            EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
                                WHEN   SPACE
      *                           （医療区分２、３（一般））
                                    MOVE  "197002710"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    IF    LNK-NYULIFE2-SANTEIYM
                                                        >= "201604"
                                       MOVE   360      TO
                                           LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                             難病等据え置き患者の置換
                                    EVALUATE     LNK-SKJKEEP-KBN(IDX1)
                                        WHEN     "1"
                                           MOVE  "197003610"   TO
                                              LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                           MOVE   260      TO
                                             LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                        WHEN     "2"
                                           MOVE  "197003710"   TO
                                              LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                           MOVE   260      TO
                                             LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-EVALUATE
                                WHEN   "1"
      *                           （医療区分２、３（低２　９０日以下））
                                    MOVE  "197002810"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                WHEN   "2"
      *                           （医療区分２、３（低２　９０日超））
                                    MOVE  "197002910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   160          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                WHEN   "3"
                                WHEN   "4"
      *                           （医療区分２、３（低１））
                                    MOVE  "197003010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                            END-EVALUATE
                    END-EVALUATE
                 END-IF
                END-PERFORM
               END-IF
      *
      *        生活療養食事標準負担額設定（軽減ありの患者）
      *       （平成２９年１０月から令和６年５月まで）
               IF   (LNK-NYULIFE2-SANTEIYM >=  "201710")  AND
                    (LNK-NYULIFE2-SANTEIYM <=  "202405")
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                 IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-FTNKBN2(IDX1)
      *             （医療区分１）
                      WHEN  SPACE
                        EVALUATE    LNK-SYOTOKU-AGEKBN(IDX1)
      *                   ７０歳未満
                          WHEN    "2"
                            EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得オ
                                WHEN   "1"
                                WHEN   "2"
                                    MOVE  "197003910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             境界層患者
                                    IF   LNK-SYOTOKU-KKSKBN(IDX1) = "1"
                                      MOVE  "197004010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
                            END-EVALUATE
      *                   ７０歳以上
                          WHEN    "1"
                            EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得２
                                WHEN   "1"
                                WHEN   "2"
                                    MOVE  "197002210"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                         低所得１
                                WHEN   "3"
                                    IF  (FLG-RJN         =  0)   AND
                                        (WRK-RJN(IDX1)   =  0)                                        
                                       MOVE  "197002310"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   130          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    ELSE
                                       MOVE  "197002410"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
      *                                令和２年食事負担コード廃止対応
      *                                197002410 -> 197002310
                                       IF   LNK-NYULIFE2-SANTEIYM >=  
                                                               "202004"
                                         MOVE  "197002310"   TO
                                           LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       END-IF
                                       MOVE   130          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                             境界層患者
                                    IF   LNK-SYOTOKU-KKSKBN(IDX1) = "1"
                                      MOVE  "197004110"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得１−老齢福祉年金受給者
                                WHEN   "4"
                                    MOVE  "197002510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                            END-EVALUATE
                        END-EVALUATE
      *             （医療区分２、３）
                      WHEN  "1"
      *                   一般所得者
                          IF   LNK-NYULIFE2-FTNKBN1(IDX1)  =  SPACE
                              MOVE  "197002710"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                              IF    LNK-NYULIFE2-SANTEIYM
                                                      >= "201604"
                                       MOVE   360      TO
                                           LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-IF
      *                       平成３０年改正
                              IF    LNK-NYULIFE2-SANTEIYM
                                                      >= "201804"
                                  IF   LNK-NYULIFE2-SKJKBN(IDX1)  =  "1"
                                       MOVE  "197005110"   TO
                                             LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   460      TO
                                           LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                  ELSE
                                       MOVE  "197005210"   TO
                                             LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   420      TO
                                           LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                  END-IF
                              END-IF
      *                       難病等据え置き患者の置換
                              EVALUATE     LNK-SKJKEEP-KBN(IDX1)
                                  WHEN     "1"
                                      MOVE  "197003610"   TO
                                              LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   260      TO
                                             LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                  WHEN     "2"
                                      MOVE  "197003710"   TO
                                              LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   260      TO
                                             LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-EVALUATE
                          END-IF
      *
                          EVALUATE    LNK-SYOTOKU-AGEKBN(IDX1)
      *                     ７０歳未満
                            WHEN    "2"
                              EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得オ　９０日以下
                                WHEN   "1"
                                    MOVE  "197004210"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004310"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得オ　９０日超
                                WHEN   "2"
                                    MOVE  "197004410"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   160          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   160          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
                              END-EVALUATE
      *                       境界層患者
                              IF  (LNK-NYULIFE2-FTNKBN1(IDX1) = "1" OR
                                                                "2") AND 
                                  (LNK-SYOTOKU-KKSKBN(IDX1)   = "1")
                                  MOVE  "197004610"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                        (IDX1 IDX-T)
                                  MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-IF
      *
      *                     ７０歳以上
                            WHEN    "1"
                              EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得２　９０日以下
                                WHEN   "1"
                                    MOVE  "197002810"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004710"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   210          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得２　９０日超
                                WHEN   "2"
                                    MOVE  "197002910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   160          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004810"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   160          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得１
                                WHEN   "3"
                                    MOVE  "197003010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                      MOVE  "197004910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                             境界層患者
                                    IF   LNK-SYOTOKU-KKSKBN(IDX1) = "1"
                                      MOVE  "197005010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得１−老齢福祉年金受給者
                                WHEN   "4"
                                    MOVE  "197002510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   100          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-EVALUATE
      *
                          END-EVALUATE
                    END-EVALUATE
                 END-IF
                END-PERFORM
               END-IF
      *
      *        生活療養食事標準負担額設定（軽減ありの患者）（令和６年６月以降）
               IF   LNK-NYULIFE2-SANTEIYM >=  "202406"
                PERFORM   VARYING   IDX1   FROM   1  BY  1
                 UNTIL   IDX1   >    31
                 IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    EVALUATE  LNK-NYULIFE2-FTNKBN2(IDX1)
      *             （医療区分１）
                      WHEN  SPACE
                        EVALUATE    LNK-SYOTOKU-AGEKBN(IDX1)
      *                   ７０歳未満
                          WHEN    "2"
                            EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得オ
                                WHEN   "1"
                                WHEN   "2"
                                    MOVE  "197003910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   230          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             境界層患者
                                    IF   LNK-SYOTOKU-KKSKBN(IDX1) = "1"
                                      MOVE  "197004010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
                            END-EVALUATE
      *                   ７０歳以上
                          WHEN    "1"
                            EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得２
                                WHEN   "1"
                                WHEN   "2"
                                    MOVE  "197002210"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   230          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                         低所得１
                                WHEN   "3"
                                    IF  (FLG-RJN         =  0)   AND
                                        (WRK-RJN(IDX1)   =  0)                                        
                                       MOVE  "197002310"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   140          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    ELSE
                                       MOVE  "197002310"   TO
                                           LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   140          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                             境界層患者
                                    IF   LNK-SYOTOKU-KKSKBN(IDX1) = "1"
                                      MOVE  "197004110"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得１−老齢福祉年金受給者
                                WHEN   "4"
                                    MOVE  "197002510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                            END-EVALUATE
                        END-EVALUATE
      *             （医療区分２、３）
                      WHEN  "1"
      *                   一般所得者
                          IF   LNK-NYULIFE2-FTNKBN1(IDX1)  =  SPACE
                              IF   LNK-NYULIFE2-SKJKBN(IDX1)  =  "1"
                                   MOVE  "197005110"   TO
                                             LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                   MOVE   490      TO
                                           LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              ELSE
                                   MOVE  "197005210"   TO
                                             LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                   MOVE   450      TO
                                           LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-IF
      *                       難病等据え置き患者の置換
                              EVALUATE     LNK-SKJKEEP-KBN(IDX1)
                                  WHEN     "1"
                                      MOVE  "197003610"   TO
                                              LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   280      TO
                                             LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                  WHEN     "2"
                                      MOVE  "197003710"   TO
                                              LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   260      TO
                                             LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-EVALUATE
                          END-IF
      *
                          EVALUATE    LNK-SYOTOKU-AGEKBN(IDX1)
      *                     ７０歳未満
                            WHEN    "2"
                              EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得オ　９０日以下
                                WHEN   "1"
                                    MOVE  "197004210"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   230          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004310"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   230          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得オ　９０日超
                                WHEN   "2"
                                    MOVE  "197004410"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   180          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   180          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
                              END-EVALUATE
      *                       境界層患者
                              IF  (LNK-NYULIFE2-FTNKBN1(IDX1) = "1" OR
                                                                "2") AND 
                                  (LNK-SYOTOKU-KKSKBN(IDX1)   = "1")
                                  MOVE  "197004610"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                        (IDX1 IDX-T)
                                  MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-IF
      *
      *                     ７０歳以上
                            WHEN    "1"
                              EVALUATE   LNK-NYULIFE2-FTNKBN1(IDX1)
      *                         低所得２　９０日以下
                                WHEN   "1"
                                    MOVE  "197002810"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   230          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004710"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   230          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得２　９０日超
                                WHEN   "2"
                                    MOVE  "197002910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   180          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                       MOVE  "197004810"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                       MOVE   180          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得１
                                WHEN   "3"
                                    MOVE  "197003010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
      *                             難病患者の置換
                                    IF   LNK-SKJKEEP-KBN(IDX1)  =  "1"
                                      MOVE  "197004910"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                             境界層患者
                                    IF   LNK-SYOTOKU-KKSKBN(IDX1) = "1"
                                      MOVE  "197005010"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                      MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                                    END-IF
      *                         低所得１−老齢福祉年金受給者
                                WHEN   "4"
                                    MOVE  "197002510"   TO
                                         LNK-NYULIFE2-SKJFTN-SRYCD
                                                            (IDX1 IDX-T)
                                    MOVE   110          TO
                                         LNK-NYULIFE2-SKJFTN-MONEY
                                                            (IDX1 IDX-T)
                              END-EVALUATE
      *
                          END-EVALUATE
                    END-EVALUATE
                 END-IF
                END-PERFORM
               END-IF
      *
            END-PERFORM
      *
      *      生活療養環境療養標準負担額設定
             IF   LNK-NYULIFE2-SANTEIYM <=  "201709"
      *        平成２９年９月迄
               PERFORM   VARYING   IDX1   FROM   1  BY  1
               UNTIL   IDX1   >    31
                IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
                    IF  LNK-NYULIFE2-FTNKBN2(IDX1)   =   SPACE
                        MOVE  "197001910"       TO
                                        LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  320       TO
                                        LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
      *             老齢福祉年金受給者は環境療養患者負担無しに置換え
                    IF  LNK-NYULIFE2-FTNKBN1(IDX1)   =   "4"
                        MOVE  SPACE  TO  LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  ZERO   TO  LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
      *             精神病床１年超で医療区分２、３は患者負担無しに置換え
                    IF (LNK-NYULIFE2-FTNKBN2(IDX1)   =  "1")   AND
                       (LNK-SKJKEEP-KBN(IDX1)        =  "2")
                        MOVE  SPACE  TO  LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  ZERO   TO  LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
                END-IF
               END-PERFORM
             ELSE
      *        平成２９年１０月以降
               PERFORM   VARYING   IDX1   FROM   1  BY  1
               UNTIL   IDX1   >    31
                IF   LNK-NYULIFE2-KBN(IDX1)   =   "1"
      *             医療区分１（１日３７０円）
                    IF  LNK-NYULIFE2-FTNKBN2(IDX1)   =   SPACE
                        MOVE  "197001910"       TO
                                        LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  370       TO
                                        LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
      *             医療区分２、３（１日２００円）
                    IF  LNK-NYULIFE2-FTNKBN2(IDX1)   =  "1"
                        MOVE  "197003810"       TO
                                        LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  200       TO
                                        LNK-NYULIFE2-KANFTN-MONEY(IDX1)
      *                 平成３０年改正　医療区分２、３（１日３７０円）
                        IF   LNK-NYULIFE2-SANTEIYM >=  "201804"
                             MOVE  370       TO
                                        LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                        END-IF
                    END-IF
      *             境界層患者は環境療養患者負担無しに置換え
                    IF  LNK-SYOTOKU-KKSKBN(IDX1)   =   "1"
                        MOVE  SPACE  TO  LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  ZERO   TO  LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
      *             老齢福祉年金受給者は環境療養患者負担無しに置換え
                    IF  LNK-NYULIFE2-FTNKBN1(IDX1)   =   "4"
                        MOVE  SPACE  TO  LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  ZERO   TO  LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
      *             指定難病で医療区分２、３は患者負担無しに置換え
                    IF (LNK-NYULIFE2-FTNKBN2(IDX1)   =  "1")   AND
                       (LNK-SKJKEEP-KBN(IDX1)        =  "1")
                        MOVE  SPACE  TO  LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
                        MOVE  ZERO   TO  LNK-NYULIFE2-KANFTN-MONEY(IDX1)
                    END-IF
                END-IF
               END-PERFORM
             END-IF
      *
      *−−−−食事負担、環境療養負担コード、単価設定ここまで−−−
      *
           END-IF
      *
           IF   FLG-OK   =   ZERO
               MOVE   4      TO   LNK-NYULIFE2-RC
           END-IF
      *
      *     PERFORM   VARYING  IDX1   FROM  1   BY  1
      *               UNTIL  IDX1   >   31
      *          DISPLAY "IDX1 = " IDX1
      *          DISPLAY "LNK-SKJKEEP-KBN(IDX1) = "
      *                   LNK-SKJKEEP-KBN(IDX1)
      *          DISPLAY "LNK-NYULIFE2-KBN(IDX1) = " 
      *                   LNK-NYULIFE2-KBN(IDX1)
      *          DISPLAY "LNK-NYULIFE2-FTNKBN1(IDX1) = " 
      *                   LNK-NYULIFE2-FTNKBN1(IDX1)
      *          DISPLAY "LNK-NYULIFE2-FTNKBN2(IDX1) = " 
      *                   LNK-NYULIFE2-FTNKBN2(IDX1)
      *          DISPLAY  "LNK-NYULIFE2-SKJ-SRYCD(IDX1) = "
      *                    LNK-NYULIFE2-SKJ-SRYCD(IDX1)
      *          DISPLAY "LNK-NYULIFE2-SKJ-MONEY(IDX1) = "
      *                   LNK-NYULIFE2-SKJ-MONEY(IDX1)
      *          DISPLAY  "LNK-NYULIFE2-SKJFTN-SRYCD(IDX1) = "
      *                    LNK-NYULIFE2-SKJFTN-SRYCD(IDX1)
      *          DISPLAY "LNK-NYULIFE2-SKJFTN-MONEY(IDX1) = "
      *                   LNK-NYULIFE2-SKJFTN-MONEY(IDX1)
      *          DISPLAY  "LNK-NYULIFE2-KAN-SRYCD(IDX1) = "
      *                    LNK-NYULIFE2-KAN-SRYCD(IDX1)
      *          DISPLAY "LNK-NYULIFE2-KAN-MONEY(IDX1) = "
      *                   LNK-NYULIFE2-KAN-MONEY(IDX1)
      *          DISPLAY  "LNK-NYULIFE2-KANFTN-SRYCD(IDX1) = "
      *                    LNK-NYULIFE2-KANFTN-SRYCD(IDX1)
      *          DISPLAY "LNK-NYULIFE2-KANFTN-MONEY(IDX1) = "
      *                   LNK-NYULIFE2-KANFTN-MONEY(IDX1)
      *     END-PERFORM
           .
       200-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院診療行為取得
      *****************************************************************
       210-NYUINACT-GET-SEC            SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM       TO  NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN     TO  NSRY-NYUGAIKBN
           MOVE    NACCT-PTID          TO  NSRY-PTID
           MOVE    NACCT-SRYYM         TO  NSRY-SRYYM
           MOVE    NACCT-ZAINUM        TO  NSRY-ZAINUM
           MOVE    "tbl_nyuinact"      TO  MCP-TABLE
           MOVE    "key9"              TO  MCP-PATHNAME
           PERFORM 910-NYUINACT-SELECT-SEC
           IF      FLG-NYUINACT        =   ZERO
               MOVE    "tbl_nyuinact"  TO  MCP-TABLE
               MOVE    "key9"          TO  MCP-PATHNAME
               PERFORM   910-NYUINACT-READ-SEC
           END-IF
      *
      *    入院行為クローズ
           MOVE     "tbl_nyuinact"     TO  MCP-TABLE
           MOVE     "key9"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210-NYUINACT-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスター読込
      *****************************************************************
       910-SYSKANRI-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-5000-REC
               MOVE    ZERO                TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                      SYS-5000-REC
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           .
       910-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者マスター読込
      *****************************************************************
       900-PTINF-READ-SEC         SECTION.
      *
           MOVE    PTINF-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptinf"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC          =   ZERO
                   MOVE    MCPDATA-REC TO  PTINF-REC
                   MOVE    ZERO        TO  FLG-PTINF
               ELSE
                   INITIALIZE              PTINF-REC
                   MOVE    1           TO  FLG-PTINF
               END-IF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           MOVE    "tbl_ptinf"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       900-PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター検索
      *****************************************************************
       910-HKNCOMBI-SELECT-SEC        SECTION.
      *
           MOVE    HKNCOMBI-REC        TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-HKNCOMBI
           ELSE
               MOVE    1                  TO  FLG-HKNCOMBI
           END-IF
      *
           .
       910-HKNCOMBI-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスター読込
      *****************************************************************
       910-HKNCOMBI-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  HKNCOMBI-REC
               MOVE    ZERO                TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                      HKNCOMBI-REC
               MOVE    1                   TO  FLG-HKNCOMBI
           END-IF
      *
           .
       910-HKNCOMBI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者保険情報マスター検索
      *****************************************************************
       910-PTHKNINF-SELECT-SEC        SECTION.
      *
           MOVE    PTHKNINF-REC        TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-PTHKNINF
           ELSE
               MOVE    1                  TO  FLG-PTHKNINF
           END-IF
      *
           .
       910-PTHKNINF-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者保険情報マスター読込
      *****************************************************************
       910-PTHKNINF-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  PTHKNINF-REC
               MOVE    ZERO               TO  FLG-PTHKNINF
           ELSE
               INITIALIZE                     PTHKNINF-REC
               MOVE    1                  TO  FLG-PTHKNINF
           END-IF
      *
           .
       910-PTHKNINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報マスター検索
      *****************************************************************
       910-PTKOHINF-SELECT-SEC        SECTION.
      *
           MOVE    PTKOHINF-REC        TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-PTKOHINF
           ELSE
               MOVE    1                  TO  FLG-PTKOHINF
           END-IF
      *
           .
       910-PTKOHINF-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報マスター読込
      *****************************************************************
       910-PTKOHINF-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  PTKOHINF-REC
               MOVE    ZERO               TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                     PTKOHINF-REC
               MOVE    1                  TO  FLG-PTKOHINF
           END-IF
      *
           .
       910-PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター検索
      *****************************************************************
       910-NYUINACCT-SELECT-SEC        SECTION.
      *
           MOVE    NYUINACCT-REC       TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-NYUINACCT
           ELSE
               MOVE    1                  TO  FLG-NYUINACCT
           END-IF
      *
           .
       910-NYUINACCT-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター読込
      *****************************************************************
       910-NYUINACCT-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  NYUINACCT-REC
               MOVE    ZERO               TO  FLG-NYUINACCT
               IF      WRK-KYUKYU-DAY     NOT =   ZERO
                   IF   WRK-KYUKYU-NYUINCD   = NACCT-SRYCDTOTAL(6:9)
                        MOVE   1          TO  NACCT-DAY(WRK-KYUKYU-DAY)  
                   END-IF
               END-IF
           ELSE
               INITIALIZE                     NYUINACCT-REC
               MOVE    1                  TO  FLG-NYUINACCT
           END-IF
      *
           .
       910-NYUINACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院診療行為マスター検索
      *****************************************************************
       910-NYUINACT-SELECT-SEC        SECTION.
      *
           MOVE    NYUINACT-REC        TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-NYUINACT
           ELSE
               MOVE    1                  TO  FLG-NYUINACT
           END-IF
      *
           .
       910-NYUINACT-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院診療行為マスター読込
      *****************************************************************
       910-NYUINACT-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  NYUINACT-REC
               MOVE    ZERO                TO  FLG-NYUINACT
           ELSE
               INITIALIZE                      NYUINACT-REC
               MOVE    1                   TO  FLG-NYUINACT
           END-IF
      *
           .
       910-NYUINACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者入院履歴マスター検索
      *****************************************************************
       910-PTNYUINRRK-SELECT-SEC        SECTION.
      *
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO               TO  FLG-PTNYUINRRK
           ELSE
               MOVE    1                  TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       910-PTNYUINRRK-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者入院履歴マスター読込
      *****************************************************************
       910-PTNYUINRRK-READ-SEC        SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  PTNYUINRRK-REC
               MOVE    ZERO               TO  FLG-PTNYUINRRK
           ELSE
               INITIALIZE                     PTNYUINRRK-REC
               MOVE    1                  TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       910-PTNYUINRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＳＥＬＥＣＴ処理
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＦＥＴＣＨ処理
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルアクセス処理
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
      *
       910-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルクローズ処理
      *****************************************************************
       900-CLOSE-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR"      TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
      *
       900-CLOSE-SEC-EXT.
           EXIT.
