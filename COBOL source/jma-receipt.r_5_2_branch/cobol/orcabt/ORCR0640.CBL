      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0640.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : レセプト（入院）
      *  コンポーネント名  : 診療区分別点数集計
      *  管理者            : 
      *  作成日付    作業者        記述
      *  02/12/11    NaCl−門脇    新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  05.00.01    NACL-門脇    18/12/03  群馬県地方公費対応
      *  05.00.02    NACL-門脇    18/12/07  肝がん・重度肝硬変治療研究促進
      *                                     事業医療対応
      *  05.00.03    NACL-門脇    19/01/11  マル長と生保に関する修正
      *  05.00.04    NACL-門脇    19/02/13  ０７９又０２４単独の食事療養欄
      *                                     記載修正
      *  05.00.05    NACL-門脇    19/03/11  予約コード読み飛ばし修正
      *  05.00.06    NACL-門脇    19/03/13  北海道地方公費対応
      *  05.00.07    NACL-門脇    19/04/03  コメントマスタの改元対応に
      *                                     伴う修正
      *  05.00.08    NACL-門脇    19/05/07  地方公費一部負担金編集修正
      *  05.00.09    NACL-門脇    19/05/09  特記事項０１（公）に関わる
      *                                     レセプト一部負担金記載修正
      *  05.00.10    NACL-門脇    19/05/14  括弧再掲記載修正
      *  05.00.11    NACL-門脇    19/05/15  食事の算定がない場合の低所記載
      *                                     （７０歳未満）
      *  05.00.12    NACL-門脇    19/05/16  退院時共同指導料２コメント自動
      *                                     記載対応
      *  05.00.13    NACL-門脇    19/06/04  生保に関わる保険組み合わせ作成
      *                                     対応（主保険なしの場合）
      *  05.00.14    NACL-門脇    19/06/14  難病の特記事項置き換え対応
      *  05.00.15    NACL-門脇    19/07/01  リハビリ発症日レセプト記載対応
      *                                     （機能追加）
      *  05.00.16    NACL-門脇    19/07/26  特記事項記載修正（下船）
      *  05.00.17    NACL-門脇    19/08/21  請求点数０点の全国公費を記載
      *                                     しない場合の内部金額編集修正
      *  05.00.18    NACL-門脇    19/10/01  括弧再掲記載に関わる対応
      *  05.00.19    NACL-門脇    19/11/15  マル長対応
      *  05.00.20    NACL-門脇    19/12/26  器材点数０点時のコメントコード
      *                                     の取り扱い修正
      *  05.00.21    NACL-門脇    20/01/10  減免（免除・支払猶予）の災２の
      *                                     請求額情報編集対応
      *  05.00.22    NACL-門脇    20/01/17  生保一部負担金記載修正
      *  05.00.23    NACL-門脇    20/02/10  薬剤・器材の単位編集（点数付加）
      *  05.00.24    NACL-門脇    20/03/09  令和２年４月改正
      *                                     入院基本料加算区分編集
      *  05.00.25    NACL-門脇    20/03/11  小児慢性複数受給者証対応
      *  05.00.26    NACL-門脇    20/03/16  他医療機関受診＋標欠の計算修正
      *  05.00.27    NACL-門脇    20/03/26  小児慢性の実施機関番号追加対応
      *                                     （７１０・８１０）
      *  05.00.28    NACL-門脇    20/03/30  令和２年４月改正対応
      *  05.00.29    NACL-門脇    20/04/07  新型コロナウイルス対応
      *  05.00.30    NACL-門脇    20/04/16  器材の単位編集修正
      *  05.00.31    NACL-門脇    20/04/28  「他保険にて診察料算定済」の名称
      *                                     編集修正
      *  05.00.32    NACL-門脇    20/05/07  令和２年４月改正対応
      *                                     画像診断コメント対応
      *  05.00.33    NACL-門脇    20/05/08  新型コロナウイルス対応
      *  05.00.34    NACL-藤原    20/06/05  選択式コメント対応
      *  05.00.35    NACL-門脇    20/06/05  画像診断コメント対応修正
      *  05.00.36    NACL-門脇    20/06/12  選択式コメント対応（自動記載）
      *  05.00.37    NACL-門脇    20/06/26  保険別請求チェック表の計算修正
      *  05.00.38    NACL-門脇    20/09/03  選択式コメント対応（自動記載）
      *  05.00.39    NACL-門脇    20/10/09  選択式コメント対応（自動記載）
      *  05.00.40    NACL-門脇    20/10/21  診療情報提供料のコメント対応
      *  05.00.41    NACL-門脇    20/11/11  地方公費の公費給付対象額レセプト
      *                                     記載（記録）【第三・第四公費】
      *  05.00.42    NACL-門脇    20/11/12  点滴の剤回数編集
      *  05.00.43    NACL-門脇    20/11/13  三重県地方公費対応
      *  05.00.44    NACL-門脇    20/12/08  薬剤（一般名記載あり）編集修正
      *  05.00.45    NACL-藤原    20/12/16  新型コロナウィルス感染症の
      *                                     臨時的取り扱いの対応
      *  05.00.46    NACL-門脇    20/12/16  コロナ新設加算対応
      *  05.00.47    NACL-門脇    20/12/18  点滴コメント編集修正
      *  05.00.48    NACL-門脇    21/01/04  全国公費併用分請求点集計修正
      *  05.00.49    NACL-門脇    21/01/12  一般名記載編集修正
      *  05.00.50    NACL-門脇    21/02/17  028感染症入院の０円記載対応
      *  05.00.51    NACL-門脇    21/03/11  感染症対策実施加算対応
      *  05.00.52    ORCAMO       21/05/19  感染症入院（０２８、０２９）
      *                                     窓口負担対応
      *  05.00.53    ORCAMO       21/07/13  診療区分別点数欄集計修正
      *  05.00.54    ORCAMO       21/08/18  二類感染症患者入院診療加算対応
      *  05.00.55    ORCAMO       21/08/26  難病・小児慢性
      *                                     複数受給者証対応修正
      *  05.00.56    ORCAMO       21/08/26  公費が５つとなる場合の対応
      *                                     （マル長と地方公費併用）
      *  05.00.57    ORCAMO       21/09/07  資格確認・受診日等・窓口負担額
      *                                     レコードのレセプト電算記録対応
      *  05.00.58    ORCAMO       21/09/13  保険欄の括弧再掲編集修正
      *
      *  05.01.00    ORCAMO       21/11/05  保険別請求チェック表の公費
      *                                     請求額集計改善
      *  05.01.01    ORCAMO       21/11/15  公費が５つとなる場合の対応
      *                                     修正
      *  05.01.02    ORCAMO       21/12/01  予約コード読み飛ばし
      *  05.01.03    ORCAMO       22/01/06  在宅持続陽圧呼吸療法指導管
      *                                     理料対応
      *  05.01.04    ORCAMO       22/01/18  経口抗ウイルス薬対応
      *  05.01.05    ORCAMO       22/01/27  特別訪問看護指示加算対応
      *  05.01.06    ORCAMO       22/03/16  令和４年４月改正対応
      *  05.01.07    ORCAMO       22/05/11  新たな選択式コメント対応
      *                                     （４桁目が"6"）
      *  05.01.08    ORCAMO       22/05/13  新たなコメントパターン
      *                                     ８８０１の編集対応
      *  05.01.09    ORCAMO       22/05/17  新たな部位コメント追加
      *  05.01.10    ORCAMO       22/07/04  点滴コメント編集修正
      *  05.01.11    ORCAMO       22/09/27  令和４年１０月改正対応
      *                                     （減算コード対応）
      *                                     （特記事項対応）
      *                                     （一部負担金対応）
      *  05.01.12    ORCAMO       22/10/27  令和４年１０月改正対応
      *  05.01.13    ORCAMO       22/11/10  ０７９又０２４＋０１２に絡む
      *                                     レセプト記載対応
      *  05.01.14    ORCAMO       23/01/13  第３公費の公費給付対象額
      *                                     計算対応
      *  05.01.15    ORCAMO       23/01/20  ７５歳以上の船員保険（下船等
      *                                     ）の特記事項記載をやめる
      *  05.01.16    ORCAMO       23/02/14  第３公費の公費給付対象額
      *                                     計算対応修正
      *  05.01.17    ORCAMO       23/03/14  システム管理２０１０（マル長
      *                                     タブ）設定時の保険欄記載修正
      *  05.02.01    ORCAMO       23/04/03  地域公費の括弧再掲記載に
      *                                     関する対応
      *  05.02.02    ORCAMO       23/05/01  令和５年５月改正対応
      *  05.02.03    ORCAMO       23/05/25  令和５年５月改正対応
      *  05.02.04    ORCAMO       23/06/09  入院点滴１日まとめコメント
      *                                     拡張対応
      *  05.02.05    ORCAMO       23/07/04  令和５年５月改正対応
      *  05.02.06    ORCAMO       23/07/06  システム管理２０１０全国公費
      *                                     併用分請求点集計機能追加
      *  05.02.07    ORCAMO       23/07/31  オン資を行うことができない
      *                                     場合のレセプト対応
      *  05.02.08    ORCAMO       23/08/23  システム管理２０１０一部負担
      *                                     金記載１円未満端数処理と一部
      *                                     負担金１円→１０円単位記載の
      *                                     両方に設定がある場合の対応
      *  05.02.09    ORCAMO       23/09/23  宮城県富谷町子ども医療費の
      *                                     食事負担半額助成廃止
      *  05.02.10    ORCAMO       23/09/23  令和５年１０月改正対応
      *  05.02.11    ORCAMO       23/10/03  令和５年１０月改正対応
      *  05.02.12    ORCAMO       24/01/17  医療扶助資格確認対応
      *                                     （交付番号記載対応）
      *  05.02.13    ORCAMO       24/01/30  地域公費のレセプト公費給付
      *                                     対象額計算対応（全国公費が
      *                                     複数ある場合）
      *  05.02.14    ORCAMO       24/04/26  令和６年度改正対応
      *                                     CDKBN-KOUBANを２桁から３桁に変更
      *  05.02.15    ORCAMO       24/05/30  令和６年６月改正対応
      *  05.02.16    ORCAMO       24/07/10  酸素計算式記載フラグ編集修正
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION           SECTION.
       INPUT-OUTPUT            SECTION.
       FILE-CONTROL.
           SELECT  RECE62-FILE     ASSIGN  RECE62PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE62-KEY
                                   FILE    STATUS  IS  STS-RECE62.
           SELECT  RECE64-FILE     ASSIGN  RECE64PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE64-KEY
                                   FILE    STATUS  IS  STS-RECE64.
           SELECT  RECE65-FILE     ASSIGN  RECE65PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE65-KEY
                                   FILE    STATUS  IS  STS-RECE65.
           SELECT  RECE69-FILE     ASSIGN  RECE69PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE69-KEY
                                   FILE    STATUS  IS  STS-RECE69.
      *    エラーファイル
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                    SECTION.
      *
       FD  RECE62-FILE.
       01  RECE62-REC. 
           COPY    "CPRCF062.INC".
      *
       FD  RECE64-FILE.
       01  RECE64-REC. 
           COPY    "CPRCF064.INC".
      *
       FD  RECE65-FILE.
       01  RECE65-REC. 
           COPY    "CPRCF065.INC".
      *
       FD  RECE69-FILE.
       01  RECE69-REC. 
           COPY    "CPRCF069.INC".
      *
      *    エラーファイル
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *
      *     レセプト明細ファイル 名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE62PARA//.
      *
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE64PARA//.
      *
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE65PARA//.
      *
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE69PARA//.
      *
      *    エラーファイル 名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECEERR//.
      *
      *    ファイル名取得
           COPY    "CPRECEDAT1.INC".
           COPY    "CPTEMPFL.INC".
      *
      *    フラグ領域
       01  STS-AREA.
           03  STS-RECE62                              PIC X(02).
           03  STS-RECE64                              PIC X(02).
           03  STS-RECE65                              PIC X(02).
           03  STS-RECE69                              PIC X(02).
           03  STS-RECEERR                             PIC X(02).
      *
       01  FLG-AREA.
           03  FLG-END                                 PIC 9(01).
           03  FLG-SRYACCT                             PIC 9(01).
           03  FLG-SRYACT                              PIC 9(01).
           03  FLG-TENSU                               PIC 9(01).
           03  FLG-SYUNOU                              PIC 9(01).
           03  FLG-SYSKANRI                            PIC 9(01).
           03  FLG-SRYACCTPLUS                         PIC 9(01).
           03  FLG-RECE62                              PIC 9(01).
           03  FLG-KANJI                               PIC 9(01).
           03  FLG-SP                                  PIC 9(01).
           03  FLG-PTCOM                               PIC 9(01).
           03  FLG-NYUINACCT                           PIC 9(01).
           03  FLG-NYUINACT                            PIC 9(01).
           03  FLG-ARI                                 PIC 9(01).
           03  FLG-ARI2                                PIC 9(01).
           03  FLG-ARI5                                PIC 9(01).
           03  FLG-DAY21                               PIC 9(01).
           03  FLG-DAY21-SENTEI                        PIC 9(01).       
           03  FLG-DAY22                               PIC 9(01).
           03  FLG-DAY24                               PIC 9(01).
           03  FLG-NYUKHN                              PIC 9(01).
           03  FLG-MIJISI                              PIC 9(01).
           03  FLG-MIJISI-SENTEI                       PIC 9(01).       
           03  FLG-MIJISI2                             PIC 9(01).
           03  FLG-TENTEKI                             PIC 9(01).
           03  FLG-WRITE65                             PIC 9(01).
           03  FLG-WRITE65X                            PIC 9(01).
           03  FLG-SIKIBETU                            PIC 9(01).
           03  FLG-SENTEICDCHG                         PIC 9(01).
           03  FLG-ZANHAIKI                            PIC 9(01).
           03  FLG-FORMAL-KISAI                        PIC 9(01).
           03  FLG-RECE65-ZAN                          PIC 9(01).
           03  FLG-REWRITE                             PIC 9(01).
           03  FLG-OKIKAE                              PIC 9(01).
           03  FLG-SET                                 PIC 9(01).
           03  FLG-NYUINRYO                            PIC 9(01).
           03  FLG-HKNCOMBI                            PIC 9(01).
           03  FLG-HOUSIJI-COM                         PIC 9(01).
           03  FLG-OSIN-COM                            PIC 9(01).
           03  FLG-SYOBYO-COM                          PIC 9(01).
           03  FLG-RYOYO-COM                           PIC 9(01).
           03  FLG-SYODOU-COM                          PIC 9(01).
           03  FLG-KENSA-COM                           PIC 9(01).
           03  FLG-ZAIKYO-COM                          PIC 9(01).
           03  FLG-BOKOHO-COM                          PIC 9(01).
           03  FLG-HAIJRT-COM                          PIC 9(01).
           03  FLG-TAIKYO-COM                          PIC 9(01).
           03  FLG-ZAIHANKO-COM                        PIC 9(01).
           03  FLG-KIATU-COM                           PIC 9(01).
           03  FLG-SCPRO-COM                           PIC 9(01).
           03  FLG-HOUSEI-COM                          PIC 9(01).
           03  FLG-HOUMON-COM                          PIC 9(01).
           03  FLG-KENKSN-COM                          PIC 9(01).
           03  FLG-KINGAZ-COM                          PIC 9(01).
           03  FLG-HAIJSK-COM                          PIC 9(01).
           03  FLG-CYOJKSN-COM                         PIC 9(01).
           03  FLG-CYOJKSN-OK                          PIC 9(01).
      *****03  FLG-HKNNUM                              PIC 9(01).
           03  FLG-RECE69                              PIC 9(01).
           03  FLG-ZENKOH-ARI                          PIC 9(01).
           03  FLG-RINYAK                              PIC 9(01).
           03  FLG-TOKKI                               PIC 9(02).
           03  FLG-PTKOHINF                            PIC 9(01).
           03  FLG-TOKUSYU-SKJ                         PIC 9(01).
           03  FLG-SKJ200610FTN                        PIC 9(01).
           03  FLG-KOHYONKAIME                         PIC 9(01).
           03  FLG-MIYAGI                              PIC 9(01).
           03  FLG-KEISAN                              PIC 9(01).
           03  FLG-KEISAN2                             PIC 9(01).
           03  FLG-KEISAN3                             PIC 9(01).
           03  FLG-KEISAN-TOK1                         PIC 9(01).
           03  FLG-KEISAN-TOK2                         PIC 9(01).
           03  FLG-GENBUTU70                           PIC 9(01).
           03  FLG-GENBUTU70-KBN                       PIC 9(02).
           03  FLG-GENBUTU-TAISYOOK                    PIC 9(01).
           03  FLG-TENTEKIMATOME                       PIC 9(01).
           03  FLG-TAISYO                              PIC 9(01).
           03  FLG-RJNGENMEN-CHIARI                    PIC 9(01).
           03  FLG-IRYOHI70K                           PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70K                   PIC 9(01).
           03  FLG-SAIKEI-KISAI                        PIC 9(01).
           03  FLG-TAHOKEN                             PIC 9(01).
           03  FLG-DOTANDOKU-IGAI                      PIC 9(01).
           03  FLG-DOTANDOKU                           PIC 9(01).
           03  FLG-ZENKI-TOKUREI                       PIC 9(01).
           03  FLG-SKJFTNNASI                          PIC 9(01).
           03  FLG-HOKENICHIBU                         PIC 9(01).
           03  FLG-HOKENICHIBU-SYU                     PIC 9(01).
           03  FLG-HOKENICHIBU2                        PIC 9(01).
           03  FLG-HOKENICHIBU3                        PIC 9(01).
           03  FLG-HOKENICHIBU7                        PIC 9(01).
           03  FLG-HOKENICHIBU-CHK                     PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU                   PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU2                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU3                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU4                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU4X                 PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU4Y                 PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU5                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU5X                 PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU7                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU8                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU9                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU-SC                PIC 9(01).
           03  FLG-SYUNOU-ARI                          PIC 9(01).
           03  FLG-TOKU75                              PIC 9(01).
           03  FLG-TOKU75-KIZON                        PIC 9(01).
           03  FLG-SYOGAI75                            PIC 9(01).
           03  FLG-TOKU75-XXX                          PIC 9(01).
           03  FLG-TOKU75-KOHSKY                       PIC 9(01).
           03  FLG-KOKI-HIGAITO                        PIC 9(01).
           03  FLG-TOKUSITU                            PIC 9(01).
           03  FLG-TOKUSITU-TASU                       PIC 9(01).
           03  FLG-TOKUSITU-KBN                        PIC 9(02).
           03  FLG-KOUGAKU                             PIC 9(01).
           03  FLG-KOUGAKU2                            PIC 9(01).
           03  FLG-KISAIOK                             PIC 9(01).
           03  FLG-GENGAKU-OKIKAE                      PIC 9(01).
           03  FLG-KOHYONKAIME-NO                      PIC 9(01).
           03  FLG-KOUREI-KBN                          PIC 9(01).
           03  FLG-SETCOM                              PIC 9(01).
           03  FLG-WRKFILE-CLEAR                       PIC 9(01).
           03  FLG-WRKFILE-KGKTAI                      PIC 9(01).
           03  FLG-SAIGAI-TAISYO                       PIC 9(01).
           03  FLG-CHIIKI2                             PIC 9(01).
           03  FLG-CHIIKI3                             PIC 9(01).
           03  FLG-KGKIPNTAI                           PIC 9(01).
           03  FLG-KGK                                 PIC 9(01).
           03  FLG-KGK2                                PIC 9(01).
           03  FLG-SKY-TOKKOH                          PIC 9(01).
           03  FLG-SKY-TOKKOH2                         PIC 9(01).
           03  FLG-GENMEN-ARI                          PIC 9(01).
           03  FLG-GENMEN-NASI                         PIC 9(01).
           03  FLG-GENMEN-ARI2                         PIC 9(01).
           03  FLG-GENMEN-NASI2                        PIC 9(01).
           03  FLG-SAIGAI-JGN-ETC                      PIC 9(01).
           03  FLG-JIRITU-CYUKANSOU1                   PIC 9(01).
           03  FLG-JIRITU-CYUKANSOU2                   PIC 9(01).
           03  FLG-DOJITU                              PIC 9(01).
           03  FLG-SKJ-HANTEI1                         PIC 9(01).
           03  FLG-SKJ-HANTEI2                         PIC 9(01).
           03  FLG-KIN-OKIKAE                          PIC 9(01).
           03  FLG-KIN-OKIKAE2                         PIC 9(01).
           03  FLG-KIN-OKIKAE3                         PIC 9(01).
           03  FLG-ONSHI-HEN                           PIC 9(01).
           03  FLG-ONSHI-HEN2                          PIC 9(01).
           03  FLG-RIHA-OKIKAE                         PIC 9(02).
           03  FLG-HENSYU-NG                           PIC 9(01).
           03  FLG-HENSYU-NG2                          PIC 9(01).
           03  FLG-HENSYU-ARI                          PIC 9(01).
           03  FLG-ZEROKOGAITO                         PIC 9(01).
           03  FLG-SKJ-CHECK                           PIC 9(01).
           03  FLG-SYOGAISEIHO                         PIC 9(01).
           03  FLG-SYOGAISEIHO2                        PIC 9(01).
           03  FLG-SYOGAISEIHO3                        PIC 9(01).
           03  FLG-SYOGAISEIHO4                        PIC 9(01).
           03  FLG-DAISAN-ARI                          PIC 9(01).
           03  FLG-CYOKI-HENSYU                        PIC 9(01).
           03  FLG-CYOKI-HENSYU2                       PIC 9(01).
           03  FLG-CYOKI-HENSYU3                       PIC 9(01).
           03  FLG-CYOKI-HENSYU4                       PIC 9(01).
           03  FLG-DAISAN-GENBUTU                      PIC 9(01).
           03  FLG-CYOFUKU-KOH                         PIC 9(01).
           03  FLG-IRYORENKEI                          PIC 9(01).
           03  FLG-CHECK-ARI                           PIC 9(01).
           03  FLG-YKZ-PRTKBN                          PIC 9(01).
           03  FLG-KIZ-PRTKBN                          PIC 9(01).
           03  FLG-GENGAKU5                            PIC 9(01).
           03  FLG-KOHSKY-ARI                          PIC 9(01).
           03  FLG-HENSYU                              PIC 9(01).
           03  FLG-KOUREI-GENEKIKBN                    PIC 9(01).
           03  FLG-XX2-TUUKA                           PIC 9(01).
           03  FLG-XX4-TUUKA                           PIC 9(01).
           03  FLG-XX7-TUUKA                           PIC 9(01).
           03  FLG-XX7A-TUUKA                          PIC 9(01).
           03  FLG-XX8-TUUKA                           PIC 9(01).
           03  FLG-XX5-TUUKA                           PIC 9(01).
           03  FLG-XX3-TUUKA                           PIC 9(01).
           03  FLG-XX6-TUUKA                           PIC 9(01).
           03  FLG-XX10-TUUKA                          PIC 9(01).
           03  FLG-XX11-TUUKA                          PIC 9(01).
           03  FLG-HANTEI                              PIC 9(01).
           03  FLG-HANTEI2                             PIC 9(01).
           03  FLG-KANGAN                              PIC 9(01).
           03  FLG-KANGAN-TASU                         PIC 9(01).
           03  FLG-KANGAN-KBN                          PIC 9(02).
           03  FLG-KANGAN-ARI                          PIC 9(02).
           03  FLG-KISAIOK2                            PIC 9(01).
           03  FLG-CHECKKBN                            PIC 9(01).
           03  FLG-CHECKKBN-TASU                       PIC 9(01).
           03  FLG-OK                                  PIC 9(01).
           03  FLG-OK3                                 PIC 9(01).
           03  FLG-PTHKNINF                            PIC 9(01).
           03  FLG-KOHARI-CHECK                        PIC 9(01).
           03  FLG-CHECK-OK                            PIC 9(01). 
           03  FLG-SENTAKU-SYUGI                       PIC 9(01).
           03  FLG-SENTAKU-COM                         PIC 9(01).
           03  FLG-JYOHOTEIKYO                         PIC 9(01).
           03  FLG-SAINYUUIN-ARI                       PIC 9(01).
           03  FLG-SYUNOUEDYMD-ARI                     PIC 9(01).
           03  FLG-PTNYUINRRK                          PIC 9(01).
           03  FLG-SYUNOUTENSU-NG                      PIC 9(01).
           03  FLG-NOTEQUAL                            PIC 9(01).
           03  FLG-TOK11                               PIC 9(01).
           03  FLG-TOK12                               PIC 9(01).
           03  FLG-TOK36                               PIC 9(01).
           03  FLG-TOK11-COM                           PIC 9(01).
           03  FLG-HOUSKSN-COM                         PIC 9(01).
           03  FLG-GENTENCD-ARI                        PIC 9(01).
           03  FLG-NISYUOK1                            PIC 9(01).
           03  FLG-NISYUOK2                            PIC 9(01).
           03  FLG-KEISAN-TOK1BAC                      PIC 9(01).
           03  FLG-KEISAN-TOK2BAC                      PIC 9(01).
           03  FLG-TUUKA                               PIC 9(01).
           03  FLG-TUUKA2                              PIC 9(01).
           03  FLG-CYOKI-MIXPAT                        PIC 9(01).
           03  FLG-SKYIRYO-KOHFTN                      PIC 9(01).
           03  FLG-SKY-CHECK                           PIC 9(01).
           03  FLG-SYORI                               PIC 9(01).
           03  FLG-SYOTOKU-KBN                         PIC 9(01).
           03  FLG-SYOTOKU-TASU                        PIC 9(01).
           03  FLG-COVID-TASU                          PIC 9(01).
           03  FLG-COVID-TASU2                         PIC 9(02).
           03  FLG-TASU-KISAI                          PIC 9(01).
           03  FLG-CYOKI-ARI                           PIC 9(01).
           03  FLG-CYOKI-ARI2                          PIC 9(01).
           03  FLG-CYOKI-TOKKIARI                      PIC 9(01).
           03  FLG-CYOKI-TOKKIARI2                     PIC 9(01).
           03  FLG-COVID-CYOKI                         PIC 9(01).
           03  FLG-COVID-CYOKI2                        PIC 9(01).
           03  FLG-COVID-SEIHO                         PIC 9(01).
           03  FLG-COVID-ETC                           PIC 9(01).
           03  FLG-COVID-TANDOKU                       PIC 9(01).
           03  FLG-SEIHEI-Y                            PIC 9(01).
           03  FLG-KBN                                 PIC 9(01).
      *
      *    カウント領域
       01  CNT-AREA.
           03  CNT-IN-COMMIT                           PIC 9(06).
           03  CNT-IN-CANCEL                           PIC 9(06).
           03  CNT-OUT1                                PIC 9(06).
           03  CNT-OUT2                                PIC 9(06).
           03  CNT-TBL-OCC                             OCCURS  2.
               05  CNT-IN                              PIC 9(06).
               05  CNT-OUT3                            PIC 9(06).
      *
           03  CNT-DAY21                               PIC 9(06).
           03  CNT-DAY21-SENTEI                        PIC 9(06).       
           03  CNT-DAY21-X                             PIC 9(06).
           03  CNT-DAY21-SENTEI-X                      PIC 9(06).
           03  CNT-DAY21-Y                             PIC 9(06).
           03  CNT-DAY21-SENTEI-Y                      PIC 9(06).
           03  CNT-DAY22                               PIC 9(06).
           03  CNT-DAY24                               PIC 9(06).
           03  CNT-ZAIREN                              PIC 9(02).
           03  CNT-CYOKI-HENSYU1                       PIC 9(02).
           03  CNT-CYOKI-HENSYU2                       PIC 9(02).
           03  CNT-HKNCOMBI-KOHARI                     PIC 9(02).
      *
      *    添字領域
       01  IDX-AREA.
           03  IDX                                     PIC 9(03).
           03  IDX1                                    PIC 9(03).
           03  IDX2                                    PIC 9(03).
           03  IDX3                                    PIC 9(03).
           03  IDX4                                    PIC 9(03).
           03  IDX5                                    PIC 9(03).
           03  IDX6                                    PIC 9(04).
           03  IDX7                                    PIC 9(02).
           03  IDX8                                    PIC 9(02).
           03  IDX9                                    PIC 9(02).
           03  IDX10                                   PIC 9(03).
           03  IDX11                                   PIC 9(03).
           03  IDX13                                   PIC 9(03).
           03  IDX15                                   PIC 9(03).
           03  IDX16                                   PIC 9(03).
           03  IDX17                                   PIC 9(03).
           03  IDX18                                   PIC 9(03).
           03  IDX23                                   PIC 9(03).
           03  IDX24                                   PIC 9(03).
           03  IDX25                                   PIC 9(02).
           03  IDX26                                   PIC 9(02).
           03  IDX27                                   PIC 9(03).
           03  IDX28                                   PIC 9(03).
           03  IDX29                                   PIC 9(03).
           03  IDX30                                   PIC 9(03).
           03  IDX31                                   PIC 9(03).
           03  IDX32                                   PIC 9(03).
           03  IDX33                                   PIC 9(02).
           03  IDX34                                   PIC 9(03).
           03  IDX35                                   PIC 9(03).
           03  IDX36                                   PIC 9(03).
           03  IDX37                                   PIC 9(03).
           03  IDX38                                   PIC 9(03).
           03  IDX39                                   PIC 9(03).
           03  IDX40                                   PIC 9(02).
           03  IDX41                                   PIC 9(02).
           03  IDX42                                   PIC 9(03).
           03  IDX43                                   PIC 9(03).
           03  IDX44                                   PIC 9(03).
           03  IDX45                                   PIC 9(03).
           03  IDX46                                   PIC 9(01).
           03  IDX47                                   PIC 9(03).
           03  IDXA                                    PIC 9(01).
           03  IDXB                                    PIC 9(03).
           03  IDXC                                    PIC 9(03).
           03  IDXD                                    PIC 9(03).
           03  IDXX                                    PIC 9(03).
           03  IDY                                     PIC 9(03).
           03  IDY2                                    PIC 9(03).
           03  IDY3                                    PIC 9(03).
           03  IDY4                                    PIC 9(03).
           03  IDY5                                    PIC 9(03).
           03  IDY6                                    PIC 9(03).
           03  IDY7                                    PIC 9(03). 
           03  IDYX                                    PIC 9(02).
           03  IDYY                                    PIC 9(02).
           03  IDZ                                     PIC 9(03).
           03  IDZ1                                    PIC 9(03).
           03  IDZ2                                    PIC 9(03).
           03  IDZX                                    PIC 9(02).
           03  IDW                                     PIC 9(03).
           03  IDW2                                    PIC 9(03).
           03  IDW3                                    PIC 9(03).
           03  IDW4                                    PIC 9(03).
           03  IDW5                                    PIC 9(03).
           03  IDW6                                    PIC 9(03).
           03  IDW7                                    PIC 9(03).
           03  IDW8                                    PIC 9(03).
           03  IDW9                                    PIC 9(02).
           03  ID1                                     PIC 9(03).
           03  ID2                                     PIC 9(03).
           03  ID3                                     PIC 9(03).
           03  ID4                                     PIC 9(03).
           03  IDA                                     PIC 9(04).
           03  IDB                                     PIC 9(04).
           03  IDV                                     PIC 9(02).
           03  IDV2                                    PIC 9(03).
           03  IDU                                     PIC 9(03).
           03  NUM-IDX                                 PIC 9(01).
           03  HC-IDX                                  PIC 9(03).
           03  KH-IDX                                  PIC 9(03).
           03  BUN-IDX                                 PIC 9(03).
           03  BUN-IDX2                                PIC 9(03).
           03  BUN-IDX3                                PIC 9(03).
           03  BUN-IDX32                               PIC 9(03).
           03  BUN-IDX4                                PIC 9(03).
           03  BUN-IDX42                               PIC 9(03).
           03  BUN-IDX5                                PIC 9(03).
           03  BUN-IDX52                               PIC 9(03).
           03  BUN-IDX6                                PIC 9(03).
           03  SYUKEI-IDX                              PIC 9(03).
           03  SYUKEI-IDX2                             PIC 9(03).
           03  SYUKEI-IDX3                             PIC 9(03).
           03  SYUKEI-IDX4                             PIC 9(03).
           03  GENSAN-IDX                              PIC 9(03).
           03  GENSAN-IDX2                             PIC 9(03).
           03  NYUINACT-IDX                            PIC 9(03).
           03  KOHFTN-IDX                              PIC 9(03).
           03  KOHFTN-IDX2                             PIC 9(03).
           03  KOHFTN-IDX3                             PIC 9(03).
           03  KOHFTN-IDX4                             PIC 9(03).
           03  SYSKAN-IDX                              PIC 9(03).
           03  SYSKAN-IDX2                             PIC 9(03).
           03  KOHIDX                                  PIC 9(03).
           03  FUKA-IDX                                PIC 9(03).
           03  GEN-IDX                                 PIC 9(02).
           03  TOKU75-IDX                              PIC 9(03).
           03  TOKU75-IDX2                             PIC 9(03).
           03  IDX-SAI                                 PIC 9(03).
           03  IDX-NEXT                                PIC 9(03).
           03  SEIHIDX                                 PIC 9(02).
           03  KAKKIDX                                 PIC 9(02).
           03  SESNIDX                                 PIC 9(02).
           03  ONSHI-IDX3                              PIC 9(03).
           03  ONSHI-IDX4                              PIC 9(03).
           03  ONSHI-IDX5                              PIC 9(03).
           03  ONSHI-IDX6                              PIC 9(03).
           03  ONSHI-IDX7                              PIC 9(03).
           03  ONSHI-IDX8                              PIC 9(03).
           03  ONSHI-IDX9                              PIC 9(03).
      *
      *    ＯＣＲ編集領域
       01  OCR1-AREA.
           03  OCR1-HKNJANUM                           PIC 9(08).
           03  OCR1-HOSPCD                             PIC 9(07).
           03  OCR1-SKYTENSU                           PIC 9(07).
           03  OCR1-CHKDGT1                            PIC 9(01).
           03  OCR1-YKZFTN                             PIC 9(05).
           03  OCR1-CHKDGT2                            PIC 9(01).
           03  OCR1-FTNMONEY                           PIC 9(05).
           03  OCR1-CHKDGT3                            PIC 9(01).
           03  OCR1-CHKDGT4                            PIC 9(01).
           03  OCR1-JNISSU                             PIC 9(02).
           03  OCR1-SRYYM                              PIC 9(04).
           03  OCR1-CHKDGT5                            PIC 9(01).
           03  OCR1-FTNJANUM                           PIC 9(08).
           03  OCR1-JKYSNUM                            PIC 9(07).
           03  OCR1-CHKDGT6                            PIC 9(01).
           03  OCR1-PREFNUM                            PIC 9(02).
           03  OCR1-TENSUHYO                           PIC 9(01).
           03  OCR1-HKNSYUBETU1                        PIC 9(01).
           03  OCR1-HKNSYUBETU2                        PIC 9(01).
           03  OCR1-HONKZKKBN                          PIC 9(01).
           03  OCR1-SEIRINO                            PIC 9(01).
           03  OCR1-CHKDGT7                            PIC 9(01).
      *
       01  OCR2-AREA.
           03  OCR2-SEX                                PIC 9(01).
           03  OCR2-GENGO                              PIC 9(01).
           03  OCR2-BIRTHYY                            PIC 9(02).
           03  OCR2-CHKDGT1                            PIC 9(01).
           03  OCR2-KIGO                               PIC 9(10).
           03  OCR2-NUM                                PIC 9(10).
           03  OCR2-CHKDGT2                            PIC 9(01).
           03  OCR2-AREA-X.
               05  OCR2-FTNJANUM                       PIC 9(08).
               05  OCR2-JKYSNUM                        PIC 9(07).
               05  OCR2-CHKDGT3                        PIC 9(01).
               05  OCR2-JNISSU                         PIC 9(02).
               05  OCR2-TENSU                          PIC 9(07).
               05  OCR2-CHKDGT4                        PIC 9(01).
               05  OCR2-YKZFTN                         PIC 9(05).
               05  OCR2-CHKDGT5                        PIC 9(01).
               05  OCR2-FTNMONEY                       PIC 9(05).
               05  OCR2-CHKDGT6                        PIC 9(01).
               05  OCR2-CHKDGT7                        PIC 9(01).
           03  OCR2-YOBI                               PIC X(02).
      *
       01  OCR3-AREA.
           03  OCR3-AREA-X.
               05  OCR3-FTNJANUM                       PIC 9(08).
               05  OCR3-JKYSNUM                        PIC 9(07).
               05  OCR3-CHKDGT1                        PIC 9(01).
               05  OCR3-JNISSU                         PIC 9(02).
               05  OCR3-TENSU                          PIC 9(07).
               05  OCR3-CHKDGT2                        PIC 9(01).
               05  OCR3-YKZFTN                         PIC 9(05).
               05  OCR3-CHKDGT3                        PIC 9(01).
               05  OCR3-FTNMONEY                       PIC 9(05).
               05  OCR3-CHKDGT4                        PIC 9(01).
               05  OCR3-CHKDGT5                        PIC 9(01).
           03  OCR3-YOBI                               PIC X(28).
      *
      *    パス名領域
       01  WK-PATH                                     PIC X(20).
      *
      *    剤情報退避領域
       01  WK-ZAIKAISU                                 PIC S9(07).
       01  WK-ZAITEN                                   PIC S9(08).
       01  WK-SYUTEN                                   PIC S9(08).
       01  WK-KIZAITEN                                 PIC S9(08).
       01  WK-YKZTEN                                   PIC S9(08).
       01  WK-YKZTEN2                                  PIC S9(08).
      *
      *    エラーメッセージ編集領域
       01  ERR-EDIT-AREA.
           03  ERR-PTNUM                               PIC X(20).
           03  ERR-ERRMSG                              PIC X(80).
           03  ERR-HEN-ERRMSG                          PIC X(200).
      *
      *    点数テーブル検索用対象日領域
       01  WK-TAIHI-AREA.
           03  WK-TAIHI-DAY                            PIC 9(02).
           03  WK-TAIHI-FLG                            PIC 9(01).
           03  WK-TAIHI-SRYYMD.
               05  WK-TAIHI-SRYYM                      PIC 9(06).
               05  WK-TAIHI-SRYD                       PIC 9(02).
      *
       01  WRK-AREA-SAIKEI.
           03  WRK-KOH-FTN                             PIC 9(09).
           03  WRK-KOH-FTN-GEN70                       PIC 9(09).
           03  WRK-KOH-GAI                             PIC 9(09).
           03  WRK-KOH-GAI2                            PIC 9(09).
           03  WRK-KOH-GAI-GEN70                       PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN                   PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN1                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN2                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN3                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN4                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN5                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN6                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN8                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN9                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN10                 PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN11                 PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN                   PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN1                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN2                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN3                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN4                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN5                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN10                 PIC 9(09).
           03  FTN-KOH-XXX                             PIC 9(09).       
           03  FTN-KOH-XX2                             PIC 9(09).
           03  FTN-KOH-XX3                             PIC 9(09).
           03  FTN-KOH-XX4                             PIC 9(09).
           03  FTN-KOH-XX5                             PIC 9(09).
           03  FTN-KOH-XX6                             PIC 9(09).
           03  FTN-KOH-XX7                             PIC 9(09).
           03  FTN-KOH-XX7X                            PIC 9(09).
           03  FTN-KOH-XX8                             PIC 9(09).
           03  FTN-KOH-XX10                            PIC 9(09).
           03  FTN-KOH-XX11                            PIC 9(09).
           03  FTN-KOH-XX12                            PIC 9(09).
           03  FTN-KOH-YYY                             PIC 9(09).       
           03  FTN-KOH-YY2                             PIC 9(09).
           03  FTN-KOH-YY3                             PIC 9(09).
           03  FTN-KOH-YY4                             PIC 9(09).
           03  FTN-KOH-YY5                             PIC 9(09).
           03  FTN-KOH-YY6                             PIC 9(09).
           03  FTN-KOH-YY7                             PIC 9(09).
           03  FTN-KOH-YY8                             PIC 9(09).
           03  FTN-KOH-YY10                            PIC 9(09).
           03  FTN-KOH-YY11                            PIC 9(09).
           03  FTN-KOH-YY12                            PIC 9(09).
           03  FLG-KOH                                 PIC 9(01).
           03  FLG-GENBUTU-HANTEI                      PIC 9(01).
           03  FLG-GENBUTU-HANTEI2                     PIC 9(01).
           03  WRK-FTNKEI                              PIC 9(09).
           03  WRK-FTNKEI-Z                            PIC 9(09).
           03  WRK-FTNKEI-FTN                          PIC 9(09).
           03  WRK-FTNKEI-GENGAKU                      PIC 9(09).
           03  WRK-FTNKEI-GENGAKU2                     PIC 9(09).
           03  WRK-FTNKEI-XXX                          PIC 9(09).
           03  WRK-FTNKEI2                             PIC 9(09).
           03  WRK-FTNKEI3                             PIC 9(09).
           03  WRK-FTNKEI4                             PIC 9(09).
           03  WRK-FTNKEI5                             PIC 9(09).
           03  WRK-FTNKEI6                             PIC 9(09).
           03  WRK-KINGAKU                             PIC 9(09).
           03  WRK-KINGAKU2                            PIC 9(09).
           03  WRK-KINGAKU3                            PIC 9(09).
           03  WRK-KINGAKU-GENBUTU                     PIC 9(09).
           03  WRK-KINGAKU-GENBUTU2                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU3                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU4                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU5                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU10                   PIC 9(09).
           03  WRK-MADOGUCHIKBN                        PIC 9(01).
           03  WRK-MADOGUCHI-KOUREI                    PIC X(01).
           03  FLG-KINGAKU-GENBUTUX                    PIC 9(01).
           03  FLG-KINGAKU-GENBUTU                     PIC 9(01).
           03  FLG-KINGAKU-GENBUTU2                    PIC 9(01).
           03  FLG-KINGAKU-GENBUTU3                    PIC 9(01).
           03  FLG-KINGAKU-GENBUTU3X                   PIC 9(01).
           03  FLG-KINGAKU-GENBUTU4                    PIC 9(01).
           03  FLG-KINGAKU-GENBUTU5                    PIC 9(01).
           03  FLG-KINGAKU-GENBUTU10                   PIC 9(01).
           03  FLG-CYOKI                               PIC 9(01).
           03  FLG-JYOGENKBN                           PIC 9(01).
           03  FLG-JYOGENKBN2                          PIC 9(01).
           03  FLG-JYOGENKBN3                          PIC 9(01).
           03  WRK-JYOGENKBN-TEN                       PIC 9(09).
           03  WRK-JYOGENKBN-TEN2                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN21                     PIC 9(09).
           03  WRK-JYOGENKBN-TEN22                     PIC 9(09).
           03  WRK-JYOGENKBN-TEN23                     PIC 9(09).
           03  WRK-JYOGENKBN-TEN4                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN5                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN6                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN7                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN72                     PIC 9(09).
           03  WRK-JYOGENKBN-TEN73                     PIC 9(09).
           03  WRK-JYOGENKBN-TEN74                     PIC 9(09).
           03  WRK-JYOGENKBN-TEN8                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN9                      PIC 9(09).
           03  WRK-TAIHI-FTNMONEYINF-AREA.
             05  WRK-TAIHI-FTNMONEYINF     OCCURS  5.
                 07  WRK-TAIHI-FTNMONEY                PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY2               PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-KOJ            PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-EN             PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-EN2            PIC 9(09)V9(01).
      *
       01  WRK-SYUNOU-CYOKI-AREA.
           03  WRK-SYUNOU-CYOKI-TABLE.
             05  WRK-SYUNOU-CYOKI-OCC                  OCCURS   10.
                 07  WRK-SYUNOU-CYOKI-HKNCOMBINUM      PIC X(04).
                 07  WRK-SYUNOU-CYOKI-KOHFLG           PIC 9(01).
                 07  WRK-SYUNOU-CYOKI-TEKSTYMD         PIC X(08).
             05  WRK-SYUNOU-CYOKI-FTNMONEY             PIC 9(07).
             05  WRK-SYUNOU-CYOKI-FTNMONEY2            PIC 9(07).
             05  WRK-SYUNOU-CYOKI-TEKSTYMD-XXX         PIC X(08).
             05  WRK-SYUNOU-CYOKI-HANTEIFLG            PIC 9(01).
             05  WRK-SYUNOU-CYOKI-HANTEIFLG2           PIC 9(01).
             05  WRK-SYUNOU-CYOKI-KEISANFLG            PIC  9(01).
             05  WRK-SYUNOU-CYOKI-KEISANFLG2           PIC  9(01).
             05  FTN-CYOKI-XXX                         PIC 9(07).
             05  FTN-CYOKI-YYY                         PIC 9(07).
             05  FTN-CYOKI-XX2                         PIC 9(07).
             05  FTN-CYOKI-YY2                         PIC 9(07).
      *
       01  WRK-SKY-AREA.
           03  WRK-SKY-KEISAN                          PIC 9(09).
           03  WRK-SKY-KEISAN2                         PIC 9(09).
           03  WRK-SKY-KEISAN3                         PIC 9(09).
           03  WRK-SKY-KEISAN4                         PIC S9(09).
           03  WRK-SKY-KEISAN5                         PIC 9(09).
           03  WRK-SKY-KEISAN6                         PIC 9(09).
           03  WRK-SKY-HOKENJA                         PIC 9(09).
           03  WRK-SKY-HOKENJA-KOH                     PIC 9(09).
           03  WRK-SKY-ICHIBUFTN                       PIC 9(09).
           03  WRK-SKY-ZENGAKU                         PIC 9(09).
           03  WRK-SKY-ZENGAKU-KOH                     PIC 9(09).
           03  WRK-SKY-FTNMONEY                        PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH                    PIC 9(09)V9(01).
           03  WRK-SKY-FTNMONEY-KOH2                   PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH3                   PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH9                   PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOHX3                  PIC 9(09)V9(01).
           03  WRK-SKY-FTNMONEY-KOH9X3                 PIC 9(09).
           03  WRK-SKY-ZENGAKU2                        PIC 9(09).
           03  WRK-SKY-FTNMONEY2                       PIC 9(09).
           03  WRK-SKY-FTNMONEY3                       PIC 9(09).
           03  WRK-SKY-FTNMONEY9                       PIC 9(09).
           03  WRK-SKY-FTNMONEY-XXX                    PIC S9(09).
           03  WRK-SKY-FTNMONEY-XX2                    PIC S9(09).
           03  WRK-SKY-SKJ-ICHIBUFTN                   PIC 9(09).
           03  WRK-SKY-SKJ-ZENGAKU                     PIC 9(09).
           03  WRK-SKY-SKJ-FTNMONEY                    PIC 9(09).
           03  WRK-SKY-SKJ-ZENGAKU2                    PIC 9(09).
           03  WRK-SKY-SKJ-FTNMONEY2                   PIC 9(09).
           03  WRK-SKY-FTNMONEY-JYOKEN                 PIC 9(09).
           03  WRK-SKY-FTNMONEY9-JYOKEN                PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH-JYOKEN             PIC 9(09)V9(01).
           03  WRK-SKY-FTNMONEY-KOH9-JYOKEN            PIC 9(09).
           03  WRK-SKY-SKYIRYO-KOHFTN                  PIC 9(09).
           03  WRK-SKY-SKYSKJ-KOHFTN                   PIC 9(09).
      *
       01  WRK-DAY-TABLE.
           03  WRK-DAY-T                               OCCURS   31.
               05  WRK-DAY1                            PIC 9(04).
               05  WRK-DAY1-SENTEI                     PIC 9(04).       
               05  WRK-DAY1-SENTEI-KHNTEN              PIC 9(08)V9(5).
               05  WRK-DAY1-SENTEI-ZAITEN              PIC 9(08).       
               05  WRK-DAY1-SENTEI-ZAITEN-GEN          PIC 9(08)V9(5).
               05  WRK-DAY1-SENTEI-SRYCD               PIC 9(09).       
               05  WRK-DAY1-SENTEI-SRYCD2              PIC 9(09).       
               05  WRK-DAY1-SENTEI-SRYCD3              PIC 9(09).
               05  WRK-DAY1-HYOKETU-SRYCD              PIC 9(09).
               05  WRK-DAY1-HYOKETU-TEN                PIC 9(09)V99.
               05  WRK-DAY1-KSN-SRYCD                  PIC 9(09).
               05  WRK-DAY1-NYUTENTTLKBN               PIC 9(03).
               05  WRK-DAY1-KHNTEN                     PIC 9(08)V9(5).
               05  WRK-DAY1-ZAITEN-GEN                 PIC 9(08)V9(5).
               05  WRK-DAY1-KSNTEN                     PIC S9(08).
               05  WRK-DAY1-NYUKHNKSNKBN               PIC 9(03).
               05  WRK-DAY1-CHUKSNCD                   PIC X(04).
               05  WRK-DAY1-NYUKHNKBN                  PIC 9(03).
               05  WRK-DAY1-NYUINKHN                   PIC X(09).
               05  WRK-DAY2                            PIC 9(04).
               05  WRK-DAY4                            PIC 9(04).
               05  WRK-DAY4X                           PIC 9(04).
               05  WRK-DAY5                            PIC 9(04).
      *
       01  WRK-DAY-TABLE2.
           03  WRK-DAY-T2                              OCCURS   31.
               05  WRK-DAY21                           PIC 9(04).
               05  WRK-DAY21-X                         PIC 9(04).
               05  WRK-DAY21-Y                         PIC 9(04).
               05  WRK-DAY21-SENTEI                    PIC 9(04).       
               05  WRK-DAY21-SENTEI-X                  PIC 9(04).
               05  WRK-DAY21-SENTEI-Y                  PIC 9(04).
               05  WRK-DAY22                           PIC 9(04).
               05  WRK-DAY22-NYUTENTTLKBN              PIC 9(03).
               05  WRK-DAY22-NYUKHNRYO                 PIC 9(08).
               05  WRK-DAY22-NYUKHNKSNKBN              PIC 9(03).
               05  WRK-DAY22-CHUKSNCD                  PIC X(04).
               05  WRK-DAY22-NYUKHNKBN                 PIC 9(03).
               05  WRK-DAY22-NYUINKHN                  PIC X(09).
               05  WRK-DAY24                           PIC 9(04).
      *
       01  WRK-GAI-TABLE.
           03  WRK-GAI-TBL                             OCCURS   62.
             04  WRK-GAI-T                             OCCURS   10.
               05  WRK-GAI-DAY                         PIC 9(02).
               05  WRK-GAI-ZAITEN                      PIC 9(08).
               05  WRK-GAI-KANGOGEN-SRYCD              PIC X(09).
               05  WRK-GAI-ZAIKAISU                    PIC 9(04).
               05  WRK-GAI-KAISU-T.
                06  WRK-GAI-KAISU-OCC                  OCCURS   31.
                 07  WRK-GAI-KAISU                     PIC 9(01).
      *
       01  WRK-GAI-TABLE2.
           03  WRK-GAI-T2                              OCCURS   20.
               05  WRK-GAI2-DAY                        PIC 9(02).
               05  WRK-GAI2-KANGOGEN-SRYCD.
                   07  WRK-GAI2-KANGOGEN-SRYCD-9       PIC 9(09).
               05  WRK-GAI2-SRYCD.
                   07  WRK-GAI2-SRYCD-9                PIC 9(09).
               05  WRK-GAI2-SRYCD2.
                   07  WRK-GAI2-SRYCD2-9               PIC 9(09).
               05  WRK-GAI2-ZAITEN                     PIC 9(08).
               05  WRK-GAI2-ZAIKAISU                   PIC 9(04).
               05  WRK-GAI2-SRYKBNFLG                  PIC 9(01).
               05  WRK-GAI2-KAISU-T.
                06  WRK-GAI2-KAISU-OCC                 OCCURS   31.
                 07  WRK-GAI2-KAISU                    PIC 9(01).
      *
       01  WRK-GAI-DATA                                PIC X(73).
      *
       01  WRK-SKJ-TABLE.
           03  WRK-SKJ-T                               OCCURS   31.
               05  WRK-SKJ-ZAITEN                      PIC 9(08).
               05  WRK-SKJ-ZAIKAISU                    PIC 9(04).
               05  WRK-SKJ-SRYCD-T.
                06  WRK-SKJ-SRYCD-OCC                  OCCURS    5.
                 07  WRK-SKJ-SRYCD                     PIC 9(09).
      *
       01  WRK-SKJ-TABLE2.
           03  WRK-SKJ-T2                              OCCURS   31.
               05  WRK-SKJ2-ZAITEN                     PIC 9(08).
               05  WRK-SKJ2-ZAIKAISU                   PIC 9(04).
               05  WRK-SKJ2-MEISAISU                   PIC 9(04).
               05  WRK-SKJ2-SRYCDTOTAL                 PIC 9(14).
               05  WRK-SKJ2-SRYCD-T.
                06  WRK-SKJ2-SRYCD-OCC                 OCCURS    5.
                 07  WRK-SKJ2-SRYCD                    PIC 9(09).
               05  WRK-SKJ2-KAISU-T.
                06  WRK-SKJ2-KAISU-OCC                 OCCURS   31.
                 07  WRK-SKJ2-KAISU                    PIC 9(01).
      *
       01  WRK-SKJ200604-TABLE.
           03  WRK-SKJ200604-T                         OCCURS   10.
             04  WRK-SKJ200604-HKNCOMBI                PIC 9(04).
             04  WRK-SKJ200604-T2                      OCCURS   31.
               05  WRK-SKJ200604-KBN                   PIC 9(01).
               05  WRK-SKJ200604-SRYCDTOTAL            PIC 9(14).
               05  WRK-SKJ200604-MEISAISU              PIC 9(02).
               05  WRK-SKJ200604-SURYOUTOTAL           PIC 9(02).
               05  WRK-SKJ200604-SURYOUTOTALFTN        PIC 9(02).
      **>      05  WRK-SKJ200604-T3                    OCCURS    3.
               05  WRK-SKJ200604-T3                    OCCURS    4.
                   07  WRK-SKJ200604-DAY               PIC 9(04).
               05  WRK-SKJ200604-DAY-KAN               PIC 9(01).
      *
       01  WRK-SKJ-DOJITU-TABLE.
           03  WRK-SKJ-DOJITU-T                        OCCURS   10.
             04  WRK-SKJ-DOJITU-T2                     OCCURS   31.
               05  WRK-SKJ-DOJITU-KBN                  PIC 9(01).
               05  WRK-SKJ-DOJITU-SHOKUDO              PIC 9(04).
               05  WRK-SKJ-DOJITU-ASA                  PIC 9(04).
               05  WRK-SKJ-DOJITU-HIRU                 PIC 9(04).
               05  WRK-SKJ-DOJITU-YORU                 PIC 9(04).
               05  WRK-SKJ-DOJITU-HKNCOMBI             PIC 9(04).
      *
       01  WRK-NYULIFE-TABLE.
           03  WRK-NYULIFE-AREA                        OCCURS   31.
               05  WRK-NYULIFE-KBN                     PIC X(01).
               05  WRK-NYULIFE-SKJFTN-SRYCD            PIC X(09).
               05  WRK-NYULIFE-SKJFTN-MONEY            PIC 9(07).
               05  WRK-NYULIFE-KANFTN-SRYCD            PIC X(09).
               05  WRK-NYULIFE-KANFTN-MONEY            PIC 9(07).
      *
       01  WRK-SKJKEEP-TABLE.
           03  WRK-SKJKEEP-AREA                        OCCURS   31.
               05  WRK-SKJKEEP-KBN                     PIC X(01).
      *
       01  WRK-SKJHKN-TABLE.
           03  WRK-SKJHKN-AREA                         OCCURS   31.
               05  WRK-SKJHKN-HKNCOMBI                 PIC X(04).
               05  WRK-SKJHKN-HKNCOMBI-DOU             PIC X(04).
      *
       01  WRK-TENTEKI2-TABLE.
           03  WRK-TENTEKI2-AREA                       OCCURS   10.
             04  WRK-TENTEKI2-HKNCOMBI                 PIC 9(04).
      *
             04  WRK-TENTEKI2-HENKYAKU-AREA.
      *
               05  WRK-TENTEKI2-ZAINUM                 PIC 9(08)
                                                       OCCURS   40.
      *
               05  WRK-TENTEKI2-T-AREA                 OCCURS   31.
                 06  WRK-TENTEKI2-T-SAINYUIN           PIC X(01).
                 06  WRK-TENTEKI2-T-SRYKA              PIC X(02).
                 06  WRK-TENTEKI2-T-MEISAISU           PIC 9(03).
                 06  WRK-TENTEKI2-T-ZAITEN             PIC 9(07).
                 06  WRK-TENTEKI2-T-SRYCDTOTAL         PIC 9(13).
                 06  WRK-TENTEKI2-T-SRYCD-X.
                   07  WRK-TENTEKI2-T-SRYCD-X-OCC      OCCURS    5.
                     08  WRK-TENTEKI2-T-SRYCD            PIC X(09).
                     08  WRK-TENTEKI2-T-COM-MEISAISU     PIC 9(03).
                     08  WRK-TENTEKI2-T-COM-AREA       OCCURS    5.
                         10  WRK-TENTEKI2-T-COM-FLG      PIC X(01).
                         10  WRK-TENTEKI2-T-COM-SRYCD    PIC X(09).
                         10  WRK-TENTEKI2-T-COM-ZAINUM   PIC 9(08).
                         10  WRK-TENTEKI2-T-COM-RENNUM   PIC 9(03).
                         10  WRK-TENTEKI2-T-COM-MOJI     PIC X(100).
               05  WRK-TENTEKI2-T-ERRCD                PIC 9(01).
      *
               05  WRK-TENTEKI2-C-AREA                 OCCURS   31.
                 06  WRK-TENTEKI2-C-SAINYUIN           PIC X(01).
                 06  WRK-TENTEKI2-C-SRYKA              PIC X(02).
                 06  WRK-TENTEKI2-C-MEISAISU           PIC 9(03).
                 06  WRK-TENTEKI2-C-ZAITEN             PIC 9(07).
                 06  WRK-TENTEKI2-C-SRYCDTOTAL         PIC 9(13).
                 06  WRK-TENTEKI2-C-SRYCD-X.
                   07  WRK-TENTEKI2-C-SRYCD-X-OCC      OCCURS    5.
                     08  WRK-TENTEKI2-C-SRYCD            PIC X(09).
                     08  WRK-TENTEKI2-C-COM-MEISAISU     PIC 9(03).
                     08  WRK-TENTEKI2-C-COM-AREA       OCCURS    5.
                         10  WRK-TENTEKI2-C-COM-FLG      PIC X(01).
                         10  WRK-TENTEKI2-C-COM-SRYCD    PIC X(09).
                         10  WRK-TENTEKI2-C-COM-ZAINUM   PIC 9(08).
                         10  WRK-TENTEKI2-C-COM-RENNUM   PIC 9(03).
                         10  WRK-TENTEKI2-C-COM-MOJI     PIC X(100).
               05  WRK-TENTEKI2-C-ERRCD                PIC 9(01).
      *
       01  WRK-MIJ-TABLE.
           03  WRK-MIJ-T                               OCCURS   10.
             04  WRK-MIJ-HKNCOMBI                      PIC 9(04).
             04  WRK-MIJ-T2                            OCCURS    4.
               05  WRK-MIJ-CNT90                       PIC 9(02).
               05  WRK-MIJ-CNT92                       PIC 9(02).
               05  WRK-MIJ-T3                          OCCURS   31.
                   07  WRK-MIJ-DAY90                   PIC 9(04).
                   07  WRK-MIJ-DAY92                   PIC 9(04).
      *
       01  WRK-ORCSTEN-TABLE.
      ***  03  WRK-ORCSTEN-T                           OCCURS  350.
           03  WRK-ORCSTEN-T                           OCCURS  1100.
               05  WRK-ORCSTEN-SRYCD                   PIC X(09).
               05  WRK-ORCSTEN-SURYO                   PIC 9(05)V9(05).
               05  WRK-ORCSTEN-COM-MEI                 PIC X(140).
               05  WRK-ORCSTEN-COM-MEI2                PIC X(300).
           03  WRK-ORCSTEN-T2                          OCCURS   31.
               05  WRK-ORCSTEN-DAY                     PIC 9(03).
               05  WRK-ORCSTEN-DAY1                    PIC 9(03).
               05  WRK-ORCSTEN-DAY2                    PIC 9(03).
               05  WRK-ORCSTEN-KIZ-SRYKA               PIC X(02).
           03  WRK-ORCSTEN-ZAIKAISU                    PIC 9(04).
      *
      *    院外処方一般名編集情報退避領域
       01  WRK-ORCSGETGE-OUT-AREA.
           03  WRK-ORCSGETGE-OUT-TABLE                 OCCURS  50.
               05  WRK-ORCSGETGE-YAKKAKJNCD            PIC X(12).
               05  WRK-ORCSGETGE-GENERIC-KBN           PIC X(01).
               05  WRK-ORCSGETGE-GENERICNAME           PIC X(200).
      *
      *    第三者行為用の保険組み合わせ毎の院外処方判定領域
       01  WRK-DAISAN-INGAI-TABLE.
           03  WRK-DAISAN-INGAI-OCC                    OCCURS  10.
               05  WRK-DAISAN-INGAI                    PIC 9(01).
      *
      *    請求額情報編集（準備）領域
       01  WRK-KOHSKY-XXX-TABLE.
           03  WRK-KOHSKY-XXX-OCC                      OCCURS  10.
               05  WRK-KOHSKY-XXX-FLG                  PIC 9(01).
               05  WRK-KOHSKY-XXX-SKJFLG               PIC 9(01).
           03  WRK-KOHSKY-XXX-CYOKIFLG                 PIC 9(01).
           03  WRK-KOHSKY-XXX-COMPFTN-RUI              PIC 9(09).
           03  WRK-KOHSKY-XXX-COMPFTN-EN-RUI           PIC 9(09)V9(01).
           03  WRK-KOHSKY-XXX-COMPFTN-EN-RUI9          PIC 9(09).
           03  WRK-KOHSKY-XXX-FLG-RUI1                 PIC 9(01).
           03  WRK-KOHSKY-XXX-FLG-RUI2                 PIC 9(01).
           03  WRK-KOHSKY-XXX-SYUSKJFTN-RUI            PIC 9(09).
           03  WRK-KOHSKY-XXX-SKJFTN-RUI               PIC 9(09).
           03  WRK-KOHSKY-XXX-SKJFLG-RUI1              PIC 9(01).
           03  WRK-KOHSKY-XXX-SKJFLG-RUI2              PIC 9(01).
      *
      *    医療機関（基本情報）退避用領域
       01  TBL-SYS1001-T.
           03  TBL-SYS1001-OCC     OCCURS  100.
               05  TBL-SYS1001                         PIC X(610).
      *    施設基準情報退避用領域
       01  TBL-SYS1006-T.
           03  TBL-SYS1006-OCC                         OCCURS  100.
               05  TBL-SYS10062                        PIC X(610).
               05  TBL-SYS10067                        PIC X(610).
      *    帳票編集区分情報退避用領域
       01  TBL-SYS1030-T.
           03  TBL-SYS1030-OCC                         OCCURS  100.
               05  TBL-SYS1030                         PIC X(610).
      *
       01  TBL-DOTANDOKU.
           03  TBL-DOTANDOKU-OCC                       OCCURS  4.
               05  TBL-DOTANDOKU-FLG                   PIC 9(01).
      *
       01  TBL-TOKUSITU.
           03  TBL-TOKUSITU-OCC                        OCCURS  4.
               05  TBL-TOKUSITUFLG                     PIC 9(01).
      *
       01  TBL-KANGAN.
           03  TBL-KANGAN-OCC                          OCCURS  4.
               05  TBL-KANGANFLG                       PIC 9(01).
      *
       01  TBL-TOKATUKAI.
           03  TBL-TOKATUKAI-OCC                       OCCURS   4.
               05  TBL-TOKATUKAIFLG                    PIC  9(01).
      *
       01  TBL-TOKATUKAI2.
           03  TBL-TOKATUKAI2-OCC.
               05  TBL-TOKATUKAIFLG2                   PIC  9(01).
      *
       01  TBL-HKNFTNDATA.
           03  TBL-HKNFTNDATA-OCC                      OCCURS   4.
               05  TBL-HKNFTNDATA-JGN                  PIC  9(07).
               05  TBL-HKNFTNDATA-TAF                  PIC  9(07).
               05  TBL-HKNFTNDATA-GAIRAI               PIC  9(07).
               05  TBL-HKNFTNDATA-NYUIN                PIC  9(07).
               05  TBL-HKNFTNDATA-NYUSKJ               PIC  9(07).
               05  TBL-HKNFTNDATA-ZAN                  PIC  9(07).
               05  TBL-HKNFTNDATA-FLG                  PIC  9(01).
               05  TBL-HKNFTNDATA-JGNXXX               PIC  9(07).
               05  TBL-HKNFTNDATA-TEKFLG               PIC  9(01).
      *
       01  TBL-CYOFUKU-KOH.
           03  TBL-CYOFUKU-KOH-OCC                     OCCURS   4.
               05  TBL-CYOFUKU-KOHNUM                  PIC  X(03).
               05  TBL-CYOFUKU-KOHID                   PIC  9(10).
      *
       01  TBL-PTTOKKI.
           03  TBL-PTTOKKI-OCC                         OCCURS   5.
               05  TBL-PTTOKKI-NAIYO                   PIC  X(12).
               05  TBL-PTTOKKI-CD                      PIC  X(02).
      *
       01  TBL-TOKKI.
           03  TBL-TOKKI-OCC                           OCCURS   5.
               05  TBL-TOKKI-CD                        PIC  X(02).
      *
       01  TBL-HKNCOMBI.
           03  TBL-HKNCOMBI-OCC                        OCCURS  10.
               05  TBL-HKNCOMBI-TOTALTEN               PIC  9(07).
               05  TBL-HKNCOMBI-CHKFLG                 PIC  9(01).
               05  TBL-HKNCOMBI-CHKFLG2                PIC  9(01).
               05  TBL-HKNCOMBI-KOHARI                 PIC  9(01).
      *
       01  TBL-HKNCOMBI2.
           03  TBL-HKNCOMBI2-OCC                       OCCURS  10.
               05  TBL-HKNCOMBI-SKYTENFLG              PIC  9(01).
               05  TBL-HKNCOMBI-SKYTENFLG2             PIC  9(01).
      *
      *    医療機関（入院基本）退避用領域
       01  TBL-SYS5000-T.
           03  TBL-SYS5000-OCC     OCCURS  100.
               05  TBL-SYS5000                         PIC X(610).
      *
       01  TBL-RECECOMCHK.
           03  TBL-RECECOMCHK-FLG        PIC X(01)     OCCURS 200.
      *
      *    一時領域
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM                      PIC X(06).
               05  WRK-PARA-TERMID                     PIC X(16).
               05  WRK-PARA-SYSYMD                     PIC X(08).
               05  WRK-PARA-JOBID                      PIC 9(07).
               05  WRK-PARA-SHELLID                    PIC X(08).
           03  WRK-PARA-HOSPNUM                        PIC 9(02).
           03  WRK-PARA-PRTKBN                         PIC X(01).
      *
           03  WRK-SYS-SRYYMD                          PIC X(08).
      *
           03  WRK-CHK-HKNJANUM                        PIC X(08).
           03  WRK-CHK-HONKZKKBN                       PIC X(01).
           03  WRK-CHK-IDOU                            PIC 9(01).
           03  WRK-CHK-TAISYO                          PIC 9(01).
           03  WRK-CHK-TAISYO2                         PIC 9(01).
           03  WRK-CHK-TAISYO3                         PIC 9(01).
           03  WRK-CHK-TOKU75-MAE                      PIC 9(01).
           03  WRK-CHK-CNT                             PIC 9(07).
           03  WRK-CHK-HKNID                           PIC 9(10).
           03  WRK-CHK-HKNNUM                          PIC X(03).
           03  WRK-CHK-ICHIBUGAKU                      PIC 9(07).
           03  WRK-CHK-ICHIBUGAKU2                     PIC 9(07).
           03  WRK-CHK-FTNGAKU                         PIC 9(07).
           03  WRK-CHK-KOHFTNGAKU                      PIC 9(07).
           03  WRK-CHK-KEISAN1                         PIC 9(07).
           03  WRK-CHK-KEISAN2                         PIC 9(07).
           03  WRK-CHK-KINGAKU                         PIC 9(07).
           03  WRK-CHK-KINGAKU2                        PIC 9(07).
           03  WRK-CHK-KINGAKU3                        PIC 9(07).
           03  WRK-CHK-KINGAKU10                       PIC 9(07).
           03  WRK-CHK-KEIKASOCHIXX                    PIC 9(07).
           03  WRK-CHK-KEIKASOCHI1                     PIC S9(07).
           03  WRK-CHK-KEIKASOCHI2                     PIC S9(07).
           03  WRK-CHK-KEIKASOCHI3                     PIC S9(07).
           03  WRK-CHK-KOKIGAK                         PIC 9(07).
           03  WRK-CHK-KOKIGAK2                        PIC 9(07).
           03  WRK-CHK-KOKIGAK4                        PIC 9(07).
           03  WRK-CHK-KOKIGAK5                        PIC 9(07).
           03  WRK-CHK-KOKIGAK6                        PIC 9(07).
           03  WRK-CHK-KOKIGAK7                        PIC 9(07).
           03  WRK-CHK-KOKIGAK8                        PIC 9(07).
           03  WRK-CHK-KOKIGAK9                        PIC 9(07).
           03  WRK-CHK-KOKIGAK10                       PIC S9(07).
      *
           03  WRK-KEISAN                              PIC 9(07).
           03  WRK-KEISAN1                             PIC 9(07).
           03  WRK-KEISAN2                             PIC 9(08).
           03  WRK-KEISAN3                             PIC 9(07).
           03  WRK-KEISAN4                             PIC 9(07).
           03  WRK-KEISAN5                             PIC 9(07).
           03  WRK-KEISAN6                             PIC 9(07).
           03  WRK-KEISAN9                             PIC 9(07).
           03  WRK-KEISAN10                            PIC 9(09).
           03  WRK-KEISAN11                            PIC 9(09).
           03  WRK-KEISAN112                           PIC 9(09).
           03  WRK-KEISAN12                            PIC 9(09).
           03  WRK-KEISAN13                            PIC 9(09).
           03  WRK-KEISAN-XXX                          PIC 9(07).
           03  WRK-KEISAN-YYY                          PIC 9(07).
           03  WRK-KEISAN-ZZZ                          PIC 9(07).
      *
           03  WRK-JYOGEN41                            PIC 9(09).
      *
           03  WRK-ZENKAKU                             PIC X(80).
           03  WRK-NUM.
               05  WRK-NUM-X                           PIC X(10).
               05  FILLER                              PIC X(70).
           03  WRK-NUM-9                               PIC 9(10). 
           03  WRK-STIDX                               PIC 9(02).
           03  WRK-EDIDX                               PIC 9(02).
           03  WRK-SRYCD-X.
               05  WRK-SRYCD                           PIC 9(09).
           03  WRK-SRYCD2-X.
               05  WRK-SRYCD2                          PIC 9(09).
           03  WRK-ZAINUM                              PIC 9(08).
           03  WRK-ZAINUM-CNT                          PIC 9(03).
           03  WRK-ZAINUM-CNT2                         PIC 9(03).
           03  WRK-ZAINUM-CNT3                         PIC 9(03).
           03  WRK-RENNUM                              PIC 9(02).
           03  WRK-RENNUM2                             PIC 9(02).
           03  WRK-TANICD                              PIC 9(03).
           03  WRK-TANIMOJISU                          PIC 9(01).
           03  WRK-TANINAME                            PIC X(24).
      *
           03  WRK-SRYSURYO                            PIC 9(05)V9(05).
           03  WRK-SRYSURYO2                           PIC 9(05).
           03  WRK-SRYSURYO3                           PIC 9(05).
           03  WRK-KZI058-TEN                          PIC 9(09)V99.
           03  WRK-KZI058-TANICD                       PIC 9(03).
           03  WRK-KZI058-TANIMOJISU                   PIC 9(01).
           03  WRK-KZI058-TANINAME                     PIC X(24).
      *
           03  WRK-FILMTEN                             PIC 9(07)V9(02).
           03  WRK-FILMTEN2                            PIC 9(07)V9(02).
      *
           03  WRK-PREFNUM                             PIC X(02).
      *
           03  WRK-CHIHOU-KIN                          PIC 9(09).
           03  WRK-CHIHOU-KIN2                         PIC 9(09).
           03  WRK-CHIHOU-KIN4                         PIC 9(09).
           03  WRK-CHIHOU-KIN5                         PIC 9(09).
           03  WRK-CHIHOU-KIN6                         PIC 9(09).
           03  WRK-CHIHOU-KIN7                         PIC 9(09).
           03  WRK-CHIHOU-KIN8                         PIC 9(09).
           03  WRK-CHIHOU-KIN10                        PIC 9(09).
      *
           03  WRK-NYUJGNGAK                           PIC 9(07).
      *
           03  WRK-TOKKI                               PIC X(02).
           03  TOKKI-IDX                               PIC 9(02). 
           03  TOKKI-IDX2                              PIC 9(02).
      *
           03  WRK-SRYYM-5000                          PIC X(06).
      *
           03  WRK-SYS5000-COUNT                       PIC 9(02).
      *
           03  WRK-HYOKETU-TEN                         PIC 9(09)V99.
           03  WRK-HYOKETU-SRYCD                       PIC 9(09).
           03  WRK-KSN-SRYCD                           PIC 9(09).
      *
           03  WRK-NYUTENTTLKBN                        PIC 9(03).
      *
           03  WRK-KHNTEN                              PIC 9(08)V9(5).
           03  WRK-KHNTEN-MOTO                         PIC 9(08).
           03  WRK-KHNTEN-GEN                          PIC 9(08)V9(5).
      *****03  WRK-KHN-ZAITEN                          PIC 9(08)V9(5).
           03  WRK-KHN-ZAITEN-MOTO                     PIC 9(08).
           03  WRK-KHN-ZAITEN-GEN                      PIC 9(08)V9(5).
           03  WRK-SENTEI-KHNTEN                       PIC 9(08)V9(5).
           03  WRK-SENTEI-KHNTEN-MOTO                  PIC 9(08).
           03  WRK-SENTEI-KHNTEN-GEN                   PIC 9(08)V9(5).
      *****03  WRK-SENTEI-ZAITEN                       PIC 9(08)V9(5).
           03  WRK-SENTEI-ZAITEN-MOTO                  PIC 9(08).
           03  WRK-SENTEI-ZAITEN-GEN                   PIC 9(08)V9(5).
           03  WRK-KSNTEN                              PIC S9(08).
           03  WRK-ZAITEN-W                            PIC 9(08).
           03  WRK-ZAITEN-W2                           PIC 9(08).
           03  WRK-SENTEI-ZAITEN-W                     PIC 9(08).       
           03  WRK-SENTEI-SRYCD                        PIC 9(09).       
           03  WRK-SENTEI-SRYCD2                       PIC 9(09).       
           03  WRK-SENTEI-SRYCD3                       PIC 9(09).       
           03  WRK-SENTEI-SRYCD-W                      PIC 9(09).       
           03  WRK-SENTEI-SRYCD2-W                     PIC 9(09).       
           03  WRK-SENTEI-SRYCD3-W                     PIC 9(09).       
           03  WRK-KANGOGEN-SRYCD-W                    PIC 9(09).
           03  WRK-KANGOGEN-SRYCD-W2                   PIC 9(09).
           03  WRK-SENTEI-KEISU                        PIC 9V99.
           03  WRK-GAIHAKU-SRYCD                       PIC X(09).
           03  WRK-GAIHAKU-KHNTEN                      PIC 9(08).
           03  WRK-NYUKHNKSNKBN                        PIC 9(03).
           03  WRK-CHUKSNCD                            PIC X(04).
           03  WRK-NYUKHNKBN                           PIC 9(03).
           03  WRK-NYUINKHN                            PIC X(09).
           03  WRK-SHOKUJIRYOYO-OCC.
               05  WRK-SHOKUJIRYOYO                    PIC 9(01)
                                                       OCCURS 31.
           03  WRK-TOKUKANRIKASAN-OCC.
               05  WRK-TOKUKANRIKASAN                  PIC 9(01)
                                                       OCCURS 31.
           03  WRK-SYS-MIJISI-T.
             04  WRK-SYS-MIJISI-OCC                    OCCURS  4.
               05  WRK-SYS-MIJISI                      PIC 9(01).
               05  WRK-SYS-MIJISI-FLG                  PIC 9(01)
                                                       OCCURS 31.
               05  WRK-SYS-MIJISI-ZAITEN               PIC 9(08).
      *
           03  WRK-SKJ-FTN-T.
             04  WRK-SKJ-FTN-OCC                       OCCURS  5.
               05  WRK-SKJ-FTN                         PIC 9(07).
      *
           03  WRK-SISETU613                           PIC 9(01).
           03  WRK-SISETU695                           PIC 9(01).
           03  WRK-SISETU3055                          PIC 9(01).
           03  WRK-SISETU3056                          PIC 9(01).
           03  WRK-SISETU3057                          PIC 9(01).
           03  WRK-SISETU3058                          PIC 9(01).
           03  WRK-SISETU3168                          PIC 9(01).
           03  WRK-SISETU3169                          PIC 9(01).
      *
           03  WRK-TOKUSYU-SKJFLG-T.
             04  WRK-TOKUSYU-SKJFLG-OCC                OCCURS  4.
               05  WRK-TOKUSYU-SKJFLG                  PIC 9(01).
               05  WRK-TOKUSYU-SKJFLG2                 PIC 9(01).
      *
           03  WRK-KOGAKU-TAISYOGAI-T.
             04  WRK-KOGAKU-TAISYOGAI-OCC              OCCURS  4.
               05  WRK-KOGAKU-TAISYOGAI                PIC 9(01).
      *
           03  WRK-GENMEN-KOH-T.
             04  WRK-GENMEN-KOH-OCC                    OCCURS  4.
               05  WRK-GENMEN-ARI-KOH                  PIC 9(01).
               05  WRK-GENMEN-NASI-KOH                 PIC 9(01).
      *
      *    1桁目:生保 2桁目:結核 3桁目:精神
           03  WRK-3SYU-KBN.
               05  WRK-3SYU        PIC X(03).
      *
      *    パス名領域
           03  WRK-SRYACCT-PATHNAME
                                   PIC X(64).
      *
      *    数字半角全角変換用     
           03  WRK-CHAR-IDX                    PIC 9(02).
           03  WRK-CHAR-HENKAN-AREA.
               05  WRK-CHAR-X                  PIC X(20).
               05  WRK-CHAR-N                  PIC X(40).
               05  WRK-CHAR-CNT                PIC 9(02).
               05  WRK-CHAR-N-CNT              PIC 9(02).
      *     
      *    単価編集用     
           03  WRK-TANKA                       PIC 9(09)V9(02).
           03  WRK-TANKA-R  REDEFINES  WRK-TANKA.
               05  WRK-TANKA-S1                PIC 9(09).
               05  WRK-TANKA-S2                PIC 9(02).
           03  WRK-TANKA-X.
               05  WRK-TANKA-Z1                PIC ZZZZZZZZ9.
               05  WRK-TANKA-Z2                PIC X(01).
               05  WRK-TANKA-Z3                PIC ZZ.
      *
      ***  03  WRK-FUKA-KINGAKU                PIC 9(09).
           03  WRK-FUKA-KINGAKU                PIC 9(13)V9(05).
           03  WRK-FUKA-VALUE                  PIC 9(01).
      *
           03  WRK-BIRTHDAY                    PIC X(08).
      *
           03  WK-GENGAKUKBN                   PIC  9(01).
           03  WK-GENGAKUKBN-KEISAN            PIC  9(01).
           03  WK-GENGAKU-KOHID                PIC  9(10).
           03  WK-GENGAKU-RITU                 PIC  9(03).
           03  WK-GENGAKU-RITUX                PIC  9(03).
           03  WK-GENGAKU-RITU-KEISAN          PIC  9V99.
           03  WK-GENGAKU-KIN                  PIC  9(07).
           03  WK-GENGAKU-KIN2                 PIC  9(07).
           03  WK-GENGAKU-KIN3                 PIC  9(07).
           03  WK-GENGAKU-KTKBN                PIC  9(01).
      *
           03  WK-GENGAKU-KEISAN1              PIC  9(07).
           03  WK-GENGAKU-KEISAN2              PIC  9(07).
           03  WK-GENGAKU-KEISAN3              PIC  9(07).
           03  WK-GENGAKU-KEISAN9              PIC  9(07).
      *
           03  WK-GENGAKU-SKJFLG-T.
             04  WK-GENGAKU-SKJFLG-OCC         OCCURS  5.
               05  WK-GENGAKU-SKJMAE           PIC  9(07).
               05  WK-GENGAKU-SKJMAEFLG        PIC  9(01).
               05  WK-GENGAKU-SKJKASANFLG      PIC  9(01).
      *
           03  WK-GENGAKU-YMD.
               05  WK-GENGAKU-YM               PIC  9(06).
               05  WK-GENGAKU-DD               PIC  9(02).
           03  WK-GENGAKU2-YMD.
               05  WK-GENGAKU2-YM              PIC  9(06).
               05  WK-GENGAKU2-DD              PIC  9(02).
           03  WK-GENGAKU3-YMD.
               05  WK-GENGAKU3-YM              PIC  9(06).
               05  WK-GENGAKU3-DD              PIC  9(02).
      *
           03  WK-CHECK-TEKSTYMD               PIC  X(08).
           03  WK-CHECK-TEKEDYMD               PIC  X(08).
           03  WK-CHECK-YMD                    PIC  X(08).
      *
           03  WRK-TENTEKI2-SRYCD-X.
               05  WRK-TENTEKI2-SRYCD-X-OCC        OCCURS    5.
                 06  WRK-TENTEKI2-SRYCD            PIC X(09).
                 06  WRK-TENTEKI2-COM-MEISAISU     PIC 9(03).
                 06  WRK-TENTEKI2-COM-AREA         OCCURS    5.
                     08  WRK-TENTEKI2-COM-FLG      PIC X(01).
                     08  WRK-TENTEKI2-COM-SRYCD    PIC X(09).
                     08  WRK-TENTEKI2-COM-ZAINUM   PIC 9(08).
                     08  WRK-TENTEKI2-COM-RENNUM   PIC 9(03).
                     08  WRK-TENTEKI2-COM-MOJI     PIC X(100).
      *
           03  WRK-TENTEKI2-SRYCD2-X.
               05  WRK-TENTEKI2-SRYCD2-X-OCC       OCCURS  100.
                 06  WRK-TENTEKI2-SRYCD2           PIC X(09).
                 06  WRK-TENTEKI2-ZAINUM2          PIC 9(08).
                 06  WRK-TENTEKI2-RENNUM2          PIC 9(03).
                 06  WRK-TENTEKI2-COM-FLG2         PIC X(01).
                 06  WRK-TENTEKI2-COM-MOJI2        PIC X(100).
      *
           03  WRK-TH-SRYCD                    PIC  X(09).
           03  WRK-TH-INPUTNUM                 PIC  9(03).
           03  WRK-TH-HOSPNUM                  PIC  9(02).
           03  WRK-TH-PTID                     PIC  9(10).
           03  WRK-TH-ZAINUM                   PIC  9(08).
           03  WRK-TH-SRYKBN                   PIC  X(02).
           03  WRK-TH-INPUTCHI1                PIC  X(10).
           03  WRK-TH-INPUTCHI2                PIC  X(10).
           03  WRK-TH-INPUTCHI3                PIC  X(10).
           03  WRK-TH-INPUTCHI4                PIC  X(10).
           03  WRK-TH-INPUTSTRING              PIC  X(200).
      *
           03  WRK-GEN70-YMD.
               05  WRK-GEN70-YM                PIC  9(06).
               05  WRK-GEN70-DD                PIC  9(02).
      *
           03  WRK-GEN702-YMD.
               05  WRK-GEN702-YM               PIC  9(06).
               05  WRK-GEN702-DD               PIC  9(02).
      *
           03  WRK-KOH-GENDOGAKU               PIC  9(07).
           03  WRK-GEN70-GENDOGAKU             PIC  9(07).
           03  WRK-SEIHO-GENDO                 PIC  9(07).
           03  WRK-SEIHO-GENDO70               PIC  9(07).
           03  WRK-CYOKI-GENDO                 PIC  9(07).
           03  WRK-CYOKI-GENDO2                PIC  9(07).
           03  WRK-JYOGEN-KOH                  PIC  9(07).
           03  WRK-JYOGEN-KOH2                 PIC  9(07).
           03  WRK-JYOGEN-KOH9                 PIC  9(07).
           03  WRK-JIRITU-TAFTNRUIKEI          PIC  9(07).
           03  WRK-JIRITU-CYUKANSOU            PIC  9(01).
           03  WRK-KOUREI-IRYOHI70             PIC  9(09).
           03  WRK-KOUREI-IRYOHI70X            PIC  9(09).
           03  WRK-FTNKEI-KOH                  PIC  9(07).
           03  WRK-TAIHI-GENKIN2               PIC  9(07)V9(01).
           03  WRK-TAIHI-GENKIN3               PIC  9(07).
           03  WRK-TAIHI-GENKIN4               PIC  9(07).
           03  WRK-TAIHI-GENKIN-TBL.
              05  WRK-TAIHI-GENKIN-OCC         OCCURS   4.
                07  WRK-TAIHI-GENKIN           PIC  9(07).
                07  WRK-TAIHI-GENKIN-EN        PIC  9(07)V9(01).
                07  WRK-TAIHI-GENKIN9          PIC  9(07).
                07  WRK-TAIHI-GENKIN-GEN       PIC  9(07).
                07  WRK-TAIHI-GENKIN-EN-GEN    PIC  9(07)V9(01).
           03  WRK-TAIHI-GENKIN-XXX            PIC  9(07).
           03  WRK-TAIHI-GENKIN-XXX-EN         PIC  9(07).
      *
           03  WRK-FORMALNAME                  PIC  X(300).
      *
           03  WRK-KOHCNT                      PIC  9(01).
      *
           03  WRK-HANTEI-TOTALTEN             PIC  9(09).
      *
           03  WRK-STR                         PIC  X(200).
           03  WRK-LEN                         PIC  9(05).
           03  WRK-SHO                         PIC  9(05).
           03  WRK-AMARI                       PIC  9(05).
      *
           03  WRK-TOKU75-BIRTHDAY             PIC  X(08).
      *
           03  WRK-KINGAKU-TOK1                PIC  9(07).
           03  WRK-KINGAKU-TOK1X               PIC  9(07).
      *
           03  WRK-KINGAKU-TOK3                PIC  9(07).
           03  WRK-KINGAKU-TOK4                PIC  9(07).
           03  WRK-KINGAKU-TOK5                PIC  9(07).
      *
           03  WRK-KINGAKU-TOK7                PIC  9(07).
           03  WRK-KINGAKU-TOK8                PIC  9(07).
           03  WRK-KINGAKU-TOK9                PIC  9(07).
      *
           03  WRK-HKNFTNDATA-RUI              PIC  9(07).
      *
           03  WRK-EDYMD                       PIC  X(08).
      *
           03  WRK-KOH-KINGAKU                 PIC  9(07).
      *
           03  WRK-SAIGAI-DD                   PIC  9(02).
      *
           03  WRK-GENMEN-NASI-KIN             PIC  9(07).
           03  WRK-GENMEN-NASI-SKJ             PIC  9(07).
           03  WRK-GENMEN-NASI-KIN2            PIC  9(07).
           03  WRK-GENMEN-NASI-SKJ2            PIC  9(07).
      *
           03  WRK-JIRITU-SAIKEI               PIC  9(09).
           03  WRK-JIRITU-SAIKEI2              PIC  9(09).
      *
           03  WRK-SAIKEI-TAIHI                PIC  9(09).
           03  WRK-SKJFTN1-TAIHI               PIC  9(09).
           03  WRK-SKJFTN2-TAIHI               PIC  9(09).
           03  WRK-SKJFTN3-TAIHI               PIC  9(09).
      *
      *    数量編集用
           03  WRK-SURYOKETA                   PIC 9(02).
           03  WRK-SURYOKETA1                  PIC 9(02).
           03  WRK-SURYOKETA2                  PIC 9(02).
           03  WRK-SURYOST                     PIC 9(02).
           03  WRK-SURYO                       PIC 9(05)V9(05).
           03  WRK-SURYO-R  REDEFINES  WRK-SURYO.
               05  WRK-SURYO-S1                PIC 9(05).
               05  WRK-SURYO-S2                PIC 9(05).
           03  WRK-SURYO-X.
               05  WRK-SURYO-Z1                PIC ZZZZZ.
               05  WRK-SURYO-Z2                PIC X(01).
               05  WRK-SURYO-Z3                PIC ZZZZZ.
           03  WRK-SURYO-N.
               05  WRK-SURYO-N1                PIC X(10).
               05  WRK-SURYO-N2                PIC X(02).
               05  WRK-SURYO-N3                PIC X(10).
           03  WRK-SRYSURYOW                   PIC X(24).
      *
           03  WRK-SETCOM-JIDO                 PIC 9(03).
           03  WRK-SETCOM-JIDO2                PIC 9(03).
      *
           03  WRK-FTNMONEY-MAE                PIC 9(09).
      *
           03  WRK-CYOKI-KEISAN                PIC 9(09).
           03  WRK-CYOKI-KEISAN2               PIC 9(09).
           03  WRK-CYOKI-KEISAN3               PIC 9(09).
           03  WRK-CYOKI-KEISAN4               PIC 9(09).
           03  WRK-CYOKI-KEISAN5               PIC 9(09).
           03  WRK-CYOKI-KEISAN6               PIC 9(09).
           03  WRK-CYOKI-KEISAN7               PIC 9(09).
      *
           03  WRK-CYOKI-JGNGAK                PIC 9(09).
           03  WRK-CYOKI-KOH-FTN               PIC 9(09).
           03  WRK-CYOKI-KOH-FTN2              PIC 9(09).
           03  WRK-CYOKI-KOH-FTN3              PIC 9(09).
           03  WRK-CYOKI-KOH-FTN4              PIC 9(09).
      *
           03  WRK-KOHJGNGET-TAISYOKBN-T.
             04  WRK-KOHJGNGET-TAISYOKBN-OCC   OCCURS  4.
               05  WRK-KOHJGNGET-TAISYOKBN     PIC 9(01).
               05  WRK-KOHJGNGET-TEKIYOFLG     PIC 9(01).
      *
           03  WRK-KYURATE2                    PIC 9(03).
           03  WRK-KYURATE3                    PIC 9(03).
      *
           03  WRK-INPUTCOMENT                 PIC X(140).
           03  WRK-INPUTCOMENT2                PIC X(14).
           03  WRK-INPUTCOMENT-KIN-T.
               05  WRK-INPUTCOMENT-KIN         PIC 9(07).
           03  WRK-INPUTCOMENT-KIN2-T.
               05  WRK-INPUTCOMENT-KIN2        PIC X(07).
      *
           03  WRK-RIHA-YMD                    PIC X(07).
           03  WRK-RIHA-YMD-SEI                PIC X(08).
      *
           03  WRK-TAIHI-ZAINUM                PIC 9(08).
           03  WRK-TAIHI-OKIKAE                PIC 9(01).
           03  WRK-TAIHI-ZAINUM2               PIC 9(08).
           03  WRK-TAIHI-OKIKAE2               PIC 9(01).
           03  WRK-TAIHI-ZAINUM3               PIC 9(08).
           03  WRK-TAIHI-ZAINUM4               PIC 9(08).
           03  WRK-TAIHI-ZAINUM5               PIC 9(08).
      *
           03  WRK-TAIHI-TOTALTEN              PIC 9(08).
           03  WRK-DAISAN-FTNMONEY             PIC 9(08).
           03  WRK-DAISAN-FTNMONEY3            PIC 9(08).
           03  WRK-DAISAN-DAISANKBN            PIC X(01).
      *
           03  WRK-COL                         PIC 9(03).
      *
           03  WRK-KOHHBTNUM                   PIC X(02).
      *
           03  WRK-HKNNUM-CHECK-T.
               05  WRK-HKNNUM-CHECK-OCC        OCCURS 100.
                 07  WRK-HKNNUM                PIC X(03).
                 07  WRK-HKNNUM-KOHHBTNUM      PIC X(02).
      *
           03  WRK-CYOFUKU-KOH-YMD.
               05  WRK-CYOFUKU-KOH-YM          PIC 9(06).
               05  WRK-CYOFUKU-KOH-DD          PIC 9(02).
      *
           03  WRK-TOKUSITU-TOKKI              PIC X(02).
           03  WRK-TOKUSITU-TOKKI2             PIC X(02).
           03  WRK-KANGAN-TOKKI                PIC X(02).
           03  WRK-TAIHI-TOKKI                 PIC X(02).
      *
           03  WRK-1030-KOUHATUKA              PIC X(01).
      *
           03  WRK-NYUSAI-SRYKBN               PIC X(02).
      *
           03  WRK-CHIIKI-ENTANI               PIC 9(08).
           03  WRK-CHIIKI-ENTANI2              PIC 9(08).
      *
           03  WRK-SENIN-HOJOKBN               PIC X(01).
      *
           03  WRK-KASANKIN                    PIC 9(08). 
      *
           03  WRK-TENSU-KEISAN2               PIC 9(08)V9(5).
      *
           03  WRK-INPUTCOMMENT-ST             PIC 9(03).
      *
           03  WRK-INPUTCHI4                   PIC X(18).
           03  WRK-INPUTCHI4BK                 PIC X(10).
      *
           03  WRK-SYUNOU-CHECK-T.
             04  WRK-SYUNOU-CHECK-OCC          OCCURS  4.
               05  WRK-SYUNOU-CHECK-KIN        PIC 9(09).
               05  WRK-SYUNOU-CHECK-HKNTEN     PIC 9(09).
           03  WRK-NRRK-CHECK-RRKNUM           PIC 9(03).
           03  WRK-NRRK-CHECK-NYUINYMD         PIC X(08).
           03  WRK-NRRK-CHECK-TEIKIYMD         PIC X(08).
           03  WRK-NRRK-CHECK-TEIKIYMD2        PIC X(08).
      *
           03  WRK-CHK-ENTANI                  PIC 9(07)V9(01).
           03  WRK-CHK-ENTANI2                 PIC 9(07)V9(01).
      *
           03  WRK-NYUINHOJO-MAX-KIN           PIC 9(08).
           03  WRK-NYUINHOJO-HKNNUM            PIC X(03).
      *
           03  WRK-ONSHI-INPUTCOMENT           PIC X(140).
           03  WRK-ONSHI-NAME                  PIC X(300).
      *
           03  WRK-RECE-KOHI-CHECK1            PIC 9(01).
           03  WRK-RECE-KOHI-CHECK1X           PIC 9(01).
           03  WRK-RECE-KOHI-CHECK2            PIC 9(01).
           03  WRK-RECE-KOHI-CHECK2X           PIC 9(01).
           03  WRK-RECE-KOHI-CHKKIN            PIC 9(09).
           03  WRK-RECE-KOHI-FLG               PIC 9(01).
           03  WRK-RECE-KOHI-FTNMONEY2         PIC 9(09).
           03  WRK-RECE-KOHI-FTNMONEY3         PIC 9(09).
           03  WRK-RECE-KOHI-FTNMONEY4         PIC 9(09).
           03  WRK-RECE-KOHI-CAL               PIC 9(09).
      *
       01  WRK-ERR-AREA.
           03  WRK-RECEERR                         PIC X(200).
           03  WRK-ERRMSG                          PIC X(300).
           03  WRK-MCP-RC                          PIC 9(9).
           03  WRK-ERR-FILE-STS                    PIC X(02).
           03  WRK-ERR-FILE-MSG                    PIC X(100).
           03  WRK-ERR-FILE-MSG1                   PIC X(17).
           03  WRK-ERR-FLG                         PIC 9(01).
      *    エラーファイル名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //WRK-ERR-FILE-NM//.
      *    FULLNAME内のBASENAME開始位置
       01  WRK-SGETTEMP-ST         PIC 9(05).
      *
      *    剤の診療内容チェックテーブル
       01  TBL-ZAICHECK-AREA.
      *    （サ）
           03  FILLER          PIC X(09)   VALUE    "820000046".
      *    （検選）
           03  FILLER          PIC X(09)   VALUE    "820000053".
      *    （リハ選）
           03  FILLER          PIC X(09)   VALUE    "820000054".
      *    （精選）
           03  FILLER          PIC X(09)   VALUE    "820000055".
      *    検選；
           03  FILLER          PIC X(09)   VALUE    "830100457".
      *    リハ選；
           03  FILLER          PIC X(09)   VALUE    "830100372".
      *    精選；
           03  FILLER          PIC X(09)   VALUE    "830100534".
      *
       01  TBL-ZAICHECK-R      REDEFINES   TBL-ZAICHECK-AREA.
           03  TBL-ZAICHECK    PIC X(09)   OCCURS    7.
      *
       01  TBL-ZAICHECK-MAX    PIC 9(02)   VALUE     7.
      *
      *    減額・免除・支払猶予判定用テーブル
       01  TBL-GENGAKU-AREA.
           03  FILLER          PIC X(03)   VALUE    "960".
           03  FILLER          PIC X(03)   VALUE    "961".
           03  FILLER          PIC X(03)   VALUE    "962".
           03  FILLER          PIC X(03)   VALUE    "963".
           03  FILLER          PIC X(03)   VALUE    "953".
      *
       01  TBL-GENGAKU-R       REDEFINES   TBL-GENGAKU-AREA.
           03  TBL-GENGAKU     PIC X(03)   OCCURS    5.
      *
       01  TBL-GENGAKU-MAX     PIC 9(02)   VALUE     5.
      *
      *    ７０歳未満現物給付判定用テーブル
       01  TBL-GENBUTU70-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "967".
      *
       01  TBL-GENBUTU70-R     REDEFINES   TBL-GENBUTU70-AREA.
           03  TBL-GENBUTU70   PIC X(03)   OCCURS    2.
      *
       01  TBL-GENBUTU70-MAX   PIC 9(02)   VALUE     2.
      *
      *    酸素 
           COPY    "CMSANSOTBL.INC".
      *
      *   日本語数字
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "１２３４５６７８９０".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
       01  TBL-SUJI-AREA-X.
           03  FILLER          PIC X(10)   VALUE
              "1234567890".
       01  TBL-SUJI-X-R        REDEFINES   TBL-SUJI-AREA-X.
           03  TBL-SUJI-X      PIC X(01)   OCCURS   10.
      *
      *
       01  WRK-CONS-AREA.    
      *    固定端末ＩＤ
           03  WRK-CONS-TERMID     PIC X(64)   VALUE
                                   "0100007FZZZZZZZZZZZZZZZZZZZZZZZZ". 
      * 
           03  WRK-CONS-SRYYM-200604  PIC 9(06)   VALUE   200604. 
      *
      *    改行コード
           03  WRK-CONS-RETURN      PIC X(01)   VALUE   X"0A".
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *    点数マスタ退避ワーク
           COPY    "CPTTNS.INC".
      *
      *    ＲＥＣＥ６２のワークレコード
       01  RECE6W-REC.
           COPY    "CPRCF062.INC"  REPLACING  //RECE62//
                                   BY         //RECE6W//.
      *
       01  RECE6G-REC.
           COPY    "CPRCF062.INC"  REPLACING  //RECE62//
                                   BY         //RECE6G//.
      *
       01  RECE6C-REC.
           COPY    "CPRCF062.INC"  REPLACING  //RECE62//
                                   BY         //RECE6C//.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    ジョブ管理マスタ
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    診療行為
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    入院会計
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    入院診療行為
       01  NYUINACT-REC.
           COPY    "CPNYUINACT.INC".
      *
      *    点数
           COPY    "CPTENSU.INC".
      *
      *    収納
       01  SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    システム管理
           COPY    "CPSYSKANRI.INC".
           COPY    "CPSK1001.INC".
           COPY    "CPSK1006.INC".
           COPY    "CPSK2005.INC".
           COPY    "CPSK200501.INC".
           COPY    "CPSK5000.INC".
           COPY    "CPSK2010.INC".
           COPY    "CPSK1030.INC".
      *
      *    患者コメント
       01  PTCOM-REC.
       COPY    "CPPTCOM.INC".
      *
      *    選定入院料
       01  SENTEICDCHG-REC.
           COPY    "CPSENTEICDCHG.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    患者公費情報
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    診療会計マスタ付加
       01  SRYACCTPLUS-REC.
           COPY    "CPSRYACCTPLUS.INC".
      *
      *    保険番号
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    患者保険情報
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *    患者入院履歴
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *****************************************************************
      *    サブプロ用領域
      *****************************************************************
      *
      *    半角チェックサブ
           COPY    "CPORCSKANACHK.INC".
      *
      *   日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    患者番号変換サブ
           COPY    "CPORCSPTID.INC".
      *    数値変換サブ
           COPY    "CPORCSNUM.INC".
      *    チェックディジット（モジュラス１１用）算出サブ
           COPY    "CPORCCHKDGT11.INC".
      *   ジョブ管理ＤＢ制御サブ
           COPY    "CPORCSJOBKANRI.INC".
      *    入院点滴一括更新サブ
           COPY    "CPORCSTENTEK.INC".
      *    公費月上限額取得サブ
           COPY    "CPORCSJGNGET.INC".
      *    高齢者の一部負担金額記載に関するチェックサブ
           COPY    "CPORCSKOREIFTNCHK.INC".
      *    公費付加情報取得サブ
           COPY    "CPORCSKOHPLUS.INC".
      *    入院時生活療養費負担額取得サブ
           COPY    "CPORCSNYULIFE.INC".
      *    入院点滴手技加算まとめサブ
           COPY    "CPORCSTENTEK2.INC".
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *    患者自己負担金レセプト記載判定
           COPY    "CPORCSFTNJGNCHK.INC".
      *    特定疾患等算定判定サブ
           COPY    "CPORCSSRHKOH.INC".
      *
           COPY    "CPORCSGETTEMP.INC".
      *
      *    院外処方一般名編集サブ
           COPY    "CPORCSGETGENERIC.INC".
      *    入院時生活療養費負担額取得サブ２
           COPY    "CPORCSNYULIFE2.INC".
      *    食事負担据え置き対象取得サブ
           COPY    "CPORCSSKJKEEP.INC".
      *    入院料と異なる食事算定保険組み合わせ取得サブ
           COPY    "CPORCSSKJHKN.INC".
      *    入院料未算定日取得サブ
           COPY    "CPORCSNYUINDAY.INC".
      *    入院点数マスタ付加情報サブ
           COPY    "CPORCSNTENSU.INC".
      *    レセプトコメントチェックサブ
           COPY    "CPORCSRECECOMCHK.INC".
      *
      *    収納作成サブ
       01  LNK-ORCS02-REC.
           COPY  "CPORCS02.INC".
       01  LNK-SYUNOU-REC-T.
         02 LNK-SYUNOU-REC     OCCURS 10.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK-SYU-//.
       01  LNK-SYUDAY-REC-T.
         02 LNK-SYUDAY-REC     OCCURS 10.
           COPY  "CPSYUDAY.INC"  REPLACING  //SDAY-// BY //LNK-SDAY-//.
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    主処理
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC    UNTIL   FLG-END =   1 
      *
           PERFORM 300-TERM-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *****************************************************************
      *    初期　処理
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  CNT-AREA
           INITIALIZE                  SPA-AREA
                                       WRK-AREA
                                       TTNS-AREA
                                       FLG-AREA
      *
           MOVE    ZERO                TO  FLG-END
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-PRTKBN
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           DISPLAY "WRK-PARA-PRTKBN =" WRK-PARA-PRTKBN
      *
           INITIALIZE                      SGETTEMP-AREA
           MOVE    RECEERR             TO  SGETTEMP-BASENAMES  (1)
           MOVE    "RECE640"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (2)
           MOVE    "RECE650"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (3)
           MOVE    "RECE690"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (4)
           CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
           MOVE    SPACE               TO  RECEERR
           MOVE    SGETTEMP-FULLNAMES (1)
                                       TO  RECEERR
           MOVE    SGETTEMP-FULLNAMES (2)
                                       TO  RECE64PARA
           MOVE    SGETTEMP-FULLNAMES (3)
                                       TO  RECE65PARA
           MOVE    SGETTEMP-FULLNAMES (4)
                                       TO  RECE69PARA
      *
           MOVE   SGETTEMP-ST          TO  WRK-SGETTEMP-ST
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ＤＢオープン処理
               PERFORM 100-DBOPEN-SEC
      *
      *        ステップ管理開始処理
               MOVE    "STS"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    "ORCR0640"      TO  JOB-PGID
               MOVE    "診療区分別点数集計"
                                       TO  JOB-SHELLMSG
               PERFORM   900-CALL-ORCSJOB-SEC
      *        処理中止設定処理
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *                             
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *       医療機関情報
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
              MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
              MOVE    "01"                TO  SYS-STYUKYMD (7:2)
              MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
              MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key10"             TO  MCP-PATHNAME
              PERFORM   900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"  TO  MCP-TABLE
                  MOVE    "key10"         TO  MCP-PATHNAME
                  PERFORM 960-KANRIMST-READ-SEC
      *
                  IF      FLG-SYSKANRI     =   ZERO
                     MOVE   MCPDATA-REC   TO  SYS-1001-REC
                     MOVE   SYS-1001-PREFNUM  TO  WRK-PREFNUM
                     MOVE   SYS-1001-DAISANKBN
                                          TO  WRK-DAISAN-DAISANKBN
                     IF  WRK-DAISAN-DAISANKBN = SPACE
                       MOVE "2"           TO  WRK-DAISAN-DAISANKBN
                     END-IF
                  ELSE
                     MOVE  "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                     PERFORM 500-ERR-HENSYU-SEC
                  END-IF    
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
              END-IF
      *
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key10"             TO  MCP-PATHNAME
              PERFORM   900-CLOSE-SEC
      *
      *       施設基準情報
              MOVE     ZERO     TO     WRK-SISETU613
              MOVE     ZERO     TO     WRK-SISETU695
              MOVE     ZERO     TO     WRK-SISETU3055
              MOVE     ZERO     TO     WRK-SISETU3056
              MOVE     ZERO     TO     WRK-SISETU3057
              MOVE     ZERO     TO     WRK-SISETU3058
              MOVE     ZERO     TO     WRK-SISETU3168
              MOVE     ZERO     TO     WRK-SISETU3169
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    7
               IF   IDXA  =  1 OR 3 OR 4 OR 5 OR 6
                 CONTINUE
               ELSE
                INITIALIZE                      SYSKANRI-REC
                MOVE    "1006"              TO  SYS-KANRICD
                MOVE    IDXA                TO  SYS-KBNCD
                MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
                MOVE    "01"                TO  SYS-STYUKYMD (7:2)
                MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
                MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
                MOVE    SYSKANRI-REC        TO  MCPDATA-REC
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key10"             TO  MCP-PATHNAME
                PERFORM   900-DBSELECT-SEC
                IF      MCP-RC              =   ZERO
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key10"         TO  MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                    IF      FLG-SYSKANRI     =   ZERO
                       MOVE   MCPDATA-REC   TO  SYS-1006-REC
                       EVALUATE  IDXA
                         WHEN     2
                           MOVE  SYS-1006-SSTKIJUN(113)
                                            TO  WRK-SISETU613
                           MOVE  SYS-1006-SSTKIJUN(195)
                                            TO  WRK-SISETU695
                         WHEN     7
                           MOVE  SYS-1006-SSTKIJUN(55)
                                            TO  WRK-SISETU3055
                           MOVE  SYS-1006-SSTKIJUN(56)
                                            TO  WRK-SISETU3056
                           MOVE  SYS-1006-SSTKIJUN(57)
                                            TO  WRK-SISETU3057
                           MOVE  SYS-1006-SSTKIJUN(58)
                                            TO  WRK-SISETU3058
                           MOVE  SYS-1006-SSTKIJUN(168)
                                            TO  WRK-SISETU3168
                           MOVE  SYS-1006-SSTKIJUN(169)
                                            TO  WRK-SISETU3169
                       END-EVALUATE
                    END-IF
                END-IF
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key10"             TO  MCP-PATHNAME
                PERFORM   900-CLOSE-SEC
               END-IF
              END-PERFORM
      *       帳票編集区分情報
              MOVE    SPACE            TO  WRK-1030-KOUHATUKA
              IF      WRK-PARA-PRTKBN = "9" OR "2" OR "3" OR "4" OR "5"
                INITIALIZE                   SYSKANRI-REC
                MOVE    "1030"           TO  SYS-KANRICD
                MOVE    "*"              TO  SYS-KBNCD
                MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
                MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
                MOVE    SYSKANRI-REC     TO  MCPDATA-REC
                MOVE    "tbl_syskanri"   TO  MCP-TABLE
                MOVE    "key10"          TO  MCP-PATHNAME
                PERFORM   900-DBSELECT-SEC
                IF      MCP-RC           =   ZERO
                  MOVE  "tbl_syskanri"   TO  MCP-TABLE
                  MOVE  "key10"          TO  MCP-PATHNAME
                  PERFORM 960-KANRIMST-READ-SEC
                  IF    FLG-SYSKANRI     =   ZERO
                    MOVE    MCPDATA-REC  TO  SYS-1030-REC
                    MOVE    SYS-1030-KOUHATUKA
                                         TO  WRK-1030-KOUHATUKA
                  END-IF
                END-IF
                MOVE    "tbl_syskanri"   TO  MCP-TABLE
                MOVE    "key10"          TO  MCP-PATHNAME
                PERFORM   900-CLOSE-SEC
              END-IF
           ELSE
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1001-T
              INITIALIZE                      TBL-SYS1001-T
      *
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
              MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM   900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"  TO  MCP-TABLE
                  MOVE    "key8"          TO  MCP-PATHNAME
                  PERFORM  960-KANRIMST-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC   TO  SYS-1001-REC
                    ADD     1             TO  SYSKAN-IDX
                    MOVE    SYS-1001-REC  TO  TBL-SYS1001(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key8"          TO  MCP-PATHNAME
                    PERFORM  960-KANRIMST-READ-SEC
      *
                  END-PERFORM
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                          TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
              END-IF
      *
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM   900-CLOSE-SEC
      *
              MOVE     SPACE              TO  TBL-SYS1006-T
              INITIALIZE                      TBL-SYS1006-T
      *
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    7
               IF   IDXA  =  1 OR 3 OR 4 OR 5 OR 6
                 CONTINUE
               ELSE
                 MOVE     ZERO            TO  SYSKAN-IDX2
                 INITIALIZE                   SYSKANRI-REC
                 MOVE    "1006"           TO  SYS-KANRICD
                 MOVE    IDXA             TO  SYS-KBNCD
                 MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
                 MOVE    SYSKANRI-REC     TO  MCPDATA-REC
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key8"           TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF      MCP-RC           =   ZERO
                     MOVE    "tbl_syskanri"   TO  MCP-TABLE
                     MOVE    "key8"           TO  MCP-PATHNAME
                     PERFORM  960-KANRIMST-READ-SEC
                     PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                               OR    (SYSKAN-IDX2  >=  100)
      *
                       MOVE    MCPDATA-REC   TO  SYS-1006-REC
                       EVALUATE  IDXA
                         WHEN     2
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10062(SYSKAN-IDX2)
                         WHEN     7
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10067(SYSKAN-IDX2)
                       END-EVALUATE
      *
                       MOVE    "tbl_syskanri"   TO  MCP-TABLE
                       MOVE    "key8"           TO  MCP-PATHNAME
                       PERFORM  960-KANRIMST-READ-SEC
      *
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key8"           TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
               END-IF
              END-PERFORM
      *
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1030-T
              INITIALIZE                      TBL-SYS1030-T
              IF      WRK-PARA-PRTKBN = "9" OR "2" OR "3" OR "4" OR "5"
                INITIALIZE                      SYSKANRI-REC
                MOVE    "1030"              TO  SYS-KANRICD
                MOVE    "*"                 TO  SYS-KBNCD
                MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
                MOVE    SYSKANRI-REC        TO  MCPDATA-REC
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key8"              TO  MCP-PATHNAME
                PERFORM 900-DBSELECT-SEC
                IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"    TO  MCP-TABLE
                  MOVE    "key8"            TO  MCP-PATHNAME
                  PERFORM 960-KANRIMST-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC     TO  SYS-1030-REC
                    ADD     1               TO  SYSKAN-IDX
                    MOVE    SYS-1030-REC    TO  TBL-SYS1030(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"  TO  MCP-TABLE
                    MOVE    "key8"          TO  MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                  END-PERFORM
                END-IF
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key8"              TO  MCP-PATHNAME
                PERFORM 900-CLOSE-SEC
              END-IF
           END-IF
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *
             MOVE      WRK-PARA-SRYYM    TO  WRK-SRYYM-5000
             PERFORM   1001-SYS-5000-CHK-SEC
      *      食事・未実施減算情報（システム管理テーブルより）
             INITIALIZE                   WRK-SHOKUJIRYOYO-OCC
                                          WRK-TOKUKANRIKASAN-OCC
      *
             INITIALIZE                   WRK-SYS-MIJISI-T
      *
             INITIALIZE                      SYSKANRI-REC
             MOVE    "5000"              TO  SYS-KANRICD
             MOVE    "*"                 TO  SYS-KBNCD
             MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
             MOVE    "01"                TO  SYS-STYUKYMD (7:2)
             MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
             MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
             MOVE    SYSKANRI-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key10"             TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
                 MOVE    "tbl_syskanri"    TO  MCP-TABLE
                 MOVE    "key10"           TO  MCP-PATHNAME
                 PERFORM  960-KANRIMST-READ-SEC
                 IF      FLG-SYSKANRI        =   ZERO
                   MOVE    MCPDATA-REC     TO  SYS-5000-REC
                   PERFORM  1002-SYSKAN-HENSYU-SEC
                   IF        WRK-SYS5000-COUNT    =     ZERO
                      CONTINUE
                   ELSE
                      PERFORM  1003-SYS-5000-GET-SEC
                   END-IF
                 ELSE
                   MOVE "医療機関情報−入院基本が取得できませんでした。"
                                         TO  WRK-RECEERR
                   PERFORM 500-ERR-HENSYU-SEC
                 END-IF
             ELSE
                  MOVE "医療機関情報−入院基本が取得できませんでした。"
                                         TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
             END-IF
      *
             MOVE    "tbl_syskanri"    TO  MCP-TABLE
             MOVE    "key10"           TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           ELSE
      *
             MOVE     ZERO               TO  SYSKAN-IDX
             MOVE     SPACE              TO  TBL-SYS5000-T
             INITIALIZE                      TBL-SYS5000-T
      *
             INITIALIZE                      SYSKANRI-REC
             MOVE    "5000"              TO  SYS-KANRICD
             MOVE    "*"                 TO  SYS-KBNCD
             MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
             MOVE    SYSKANRI-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key8"              TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
                 MOVE    "tbl_syskanri"  TO  MCP-TABLE
                 MOVE    "key8"          TO  MCP-PATHNAME
                 PERFORM 960-KANRIMST-READ-SEC
                 PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                           OR    (SYSKAN-IDX   >=  100)
      *
                   MOVE    MCPDATA-REC  TO  SYS-5000-REC
                   ADD     1            TO  SYSKAN-IDX
                   MOVE   SYS-5000-REC  TO  TBL-SYS5000(SYSKAN-IDX)
      *
                   MOVE    "tbl_syskanri"  TO  MCP-TABLE
                   MOVE    "key8"          TO  MCP-PATHNAME
                   PERFORM 960-KANRIMST-READ-SEC
      *
                 END-PERFORM
             ELSE
                  MOVE "医療機関情報−入院基本が取得できませんでした。"
                                         TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
             END-IF
      *
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key8"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      *    レセプト編集区分情報
           INITIALIZE                   SYSKANRI-REC
           MOVE    "2005"           TO  SYS-KANRICD
           MOVE    "*"              TO  SYS-KBNCD
           MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
           MOVE    "01"             TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
           MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC     TO  MCPDATA-REC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"   TO  MCP-TABLE
               MOVE    "key10"          TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               IF      FLG-SYSKANRI     =   ZERO
                   MOVE    MCPDATA-REC      TO  SYS-2005-REC
               ELSE    
                   INITIALIZE                   SYS-2005-REC
               END-IF
           ELSE
               INITIALIZE                   SYS-2005-REC
           END-IF
           IF      SYS-2005-JIHITEKKSIKBN
                                        =   SPACE
               MOVE    ZERO             TO  SYS-2005-JIHITEKKSIKBN
           END-IF
           IF      SYS-2005-SYAOCRKBN   =   SPACE
               MOVE    ZERO             TO  SYS-2005-SYAOCRKBN
           END-IF
           IF      SYS-2005-KKHOCRKBN   =   SPACE
               MOVE    ZERO             TO  SYS-2005-KKHOCRKBN
           END-IF
      *
           MOVE    "tbl_syskanri"       TO  MCP-TABLE
           MOVE    "key10"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *         
           MOVE    SPACE            TO  SYSKANRI-REC
           INITIALIZE                   SYSKANRI-REC
           MOVE    "2005"           TO  SYS-KANRICD
           MOVE    "01"             TO  SYS-KBNCD
           MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
           MOVE    "01"             TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
           MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC     TO  MCPDATA-REC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"   TO  MCP-TABLE
               MOVE    "key10"          TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               IF      FLG-SYSKANRI     =   ZERO
                   MOVE    MCPDATA-REC      TO  SYS-200501-REC
               ELSE    
                   INITIALIZE                   SYS-200501-REC
               END-IF
           ELSE
               INITIALIZE                   SYS-200501-REC
           END-IF
           IF      SYS-200501-KOUIKIOCRKBN
                                    =   SPACE
               MOVE    ZERO             TO  SYS-200501-KOUIKIOCRKBN
           END-IF
           IF      SYS-200501-COMMENT-NYUINRYO-KSIKBN
                                    =   SPACE
               MOVE    "1"   TO  SYS-200501-COMMENT-NYUINRYO-KSIKBN
           END-IF
           IF      SYS-200501-COMMENT-NYUINRYO1-KSIKBN
                                    =   SPACE
               MOVE    "2"   TO  SYS-200501-COMMENT-NYUINRYO1-KSIKBN
           END-IF
           IF      SYS-200501-SHOKUJI-PRTKBN
                                    =   SPACE
               MOVE    "0"   TO  SYS-200501-SHOKUJI-PRTKBN
           END-IF
           IF      SYS-200501-GENBUTU-ICHIBU-KSIKBN
                                    =   SPACE
               MOVE    "0"   TO  SYS-200501-GENBUTU-ICHIBU-KSIKBN
           END-IF
           IF      SYS-200501-INSPECT-GENERAL-KBN   =   SPACE
               MOVE    "0"   TO  SYS-200501-INSPECT-GENERAL-KBN
           END-IF
           IF      SYS-200501-15-YKZ-PRTKBN         =   SPACE
               MOVE    "0"   TO  SYS-200501-15-YKZ-PRTKBN
           END-IF
           IF      SYS-200501-KOUHI-ICHIBU-KSIKBN   =   SPACE
               MOVE    "0"   TO  SYS-200501-KOUHI-ICHIBU-KSIKBN
           END-IF
           IF      SYS-200501-KOFUNUM-KSIKBN        =   SPACE
               MOVE    "0"   TO  SYS-200501-KOFUNUM-KSIKBN
           END-IF
      *
           MOVE    "tbl_syskanri"       TO  MCP-TABLE
           MOVE    "key10"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       100-INIT-EXT.
           EXIT.
      *
      ******************************************************************
      *    月内に複数の医療期間情報がないか検索（医療機関減算の確認）  *
      ******************************************************************
       1001-SYS-5000-CHK-SEC                 SECTION.
      *
           MOVE     ZERO               TO  WRK-SYS5000-COUNT
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SRYYM-5000      TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key11"           TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                   ADD     1     TO        WRK-SYS5000-COUNT
                   MOVE    "tbl_syskanri"    TO  MCP-TABLE
                   MOVE    "key11"           TO  MCP-PATHNAME
                   PERFORM 960-KANRIMST-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
      *
       1001-SYS-5000-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    シスカンの編集
      *****************************************************************
       1002-SYSKAN-HENSYU-SEC                SECTION.
      *
           PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                    UNTIL     GENSAN-IDX   >   4
                IF    SYS-5000-GENKBN(GENSAN-IDX)   =   "2"    
                    MOVE   1   TO   WRK-SYS-MIJISI(GENSAN-IDX)
                    PERFORM VARYING GENSAN-IDX2 FROM 1 BY 1
                        UNTIL     GENSAN-IDX2   >   31
                          MOVE   1   TO
                             WRK-SYS-MIJISI-FLG(GENSAN-IDX GENSAN-IDX2)
                    END-PERFORM
                END-IF
           END-PERFORM
      *
           PERFORM   VARYING   IDX8   FROM  1  BY  1
                      UNTIL    IDX8    >   31
              EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *         入院食事療養（１）
                WHEN         "197000110"
                    MOVE     1      TO   WRK-SHOKUJIRYOYO(IDX8)
                    EVALUATE  SYS-5000-SHOKUKBN(1)
                      WHEN     "1"
                        MOVE  ZERO  TO   WRK-TOKUKANRIKASAN(IDX8)
                      WHEN     "2"
                        MOVE    1   TO   WRK-TOKUKANRIKASAN(IDX8)
                    END-EVALUATE
      *         入院食事療養（２）
                WHEN         "197000710"
                    MOVE     2      TO   WRK-SHOKUJIRYOYO(IDX8)
              END-EVALUATE
           END-PERFORM
      *
           .
       1002-SYSKAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    月内の医療期間情報取得（医療機関減算情報）                  *
      ******************************************************************
       1003-SYS-5000-GET-SEC                 SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SRYYM-5000      TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"    TO  MCP-TABLE
               MOVE    "key11"           TO  MCP-PATHNAME
               PERFORM 960-KANRIMST-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                 MOVE   MCPDATA-REC  TO  SYS-5000-REC
                 MOVE   SYS-5000-STYUKYMD(7:2)  TO  IDV
                 PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                            UNTIL     GENSAN-IDX   >   4
                    IF    SYS-5000-GENKBN(GENSAN-IDX)   =   "2"    
                        MOVE   1   TO   WRK-SYS-MIJISI(GENSAN-IDX)
                        PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                           UNTIL     GENSAN-IDX2   >   31
                          MOVE   1      TO
                             WRK-SYS-MIJISI-FLG(GENSAN-IDX GENSAN-IDX2)
                        END-PERFORM
                    ELSE
                        PERFORM VARYING GENSAN-IDX2 FROM IDV BY 1
                           UNTIL     GENSAN-IDX2   >   31
                          MOVE   ZERO   TO
                             WRK-SYS-MIJISI-FLG(GENSAN-IDX GENSAN-IDX2)
                        END-PERFORM
                    END-IF
                 END-PERFORM
      *
                 PERFORM    VARYING  IDX8  FROM  IDV  BY  1
                             UNTIL   IDX8    >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                入院食事療養（１）
                       WHEN         "197000110"
                          MOVE     1      TO   WRK-SHOKUJIRYOYO(IDX8)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WRK-TOKUKANRIKASAN(IDX8)
                            WHEN     "2"
                              MOVE    1   TO   WRK-TOKUKANRIKASAN(IDX8)
                          END-EVALUATE
      *                入院食事療養（２）
                       WHEN         "197000710"
                          MOVE     2      TO   WRK-SHOKUJIRYOYO(IDX8)
                          MOVE    ZERO    TO   WRK-TOKUKANRIKASAN(IDX8)
                      END-EVALUATE
                 END-PERFORM
      *
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key11"          TO  MCP-PATHNAME
                 PERFORM 960-KANRIMST-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
      *
       1003-SYS-5000-GET-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ >       2
                   OR      FLG-END     =   1
      *
               IF      IDZ             =   1               
      *    レセプト処理
                   INITIALIZE                      SGETTEMP-AREA
                   MOVE    "RECE620"           TO  RECEDAT1PARA-FILE-ID
                   PERFORM 800-FILENM-SET-SEC
                   MOVE    RECEDAT1PARA-BASENAME
                                               TO  SGETTEMP-BASENAME
               ELSE
      *    請求書処理
                   INITIALIZE                      SGETTEMP-AREA
                   MOVE    "RECE62X"           TO  RECEDAT1PARA-FILE-ID
                   PERFORM 800-FILENM-SET-SEC
                   IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
                       MOVE    WRK-CONS-TERMID     TO
                                                   RECEDAT1PARA-TERMID
                   END-IF
                   MOVE    RECEDAT1PARA-BASENAME
                                               TO  SGETTEMP-BASENAME
               END-IF
               CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
               MOVE    SGETTEMP-FULLNAME   TO  RECE62PARA
      *
               PERFORM 200-HENSYU-SEC
      *        
               IF      WRK-PARA-SHELLID    =   "RECEPTX"
                   MOVE    1                   TO  FLG-END
               END-IF
           END-PERFORM 
      *
           MOVE    1                   TO  FLG-END
           .
       200-MAIN-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-HENSYU-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-RECE62
      *
           IF      IDZ             =   1               
      *    レセプト処理
               OPEN    OUTPUT              RECE64-FILE
               CLOSE                       RECE64-FILE
      *
               OPEN    OUTPUT              RECE65-FILE
               CLOSE                       RECE65-FILE
      *
               OPEN    OUTPUT              RECE64-FILE
               OPEN    I-O                 RECE65-FILE
           END-IF
      *
           OPEN    I-O                 RECE62-FILE
           IF      STS-RECE62          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    1                   TO  WRK-ERR-FLG
               MOVE    RECE62PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE62          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           OPEN    INPUT               RECE69-FILE
           IF      STS-RECE69          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    1                   TO  WRK-ERR-FLG
               MOVE    RECE69PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE69          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           PERFORM    RECE62-READ-SEC
      *
           PERFORM                     UNTIL   FLG-RECE62  =   1
             PERFORM     210-HENSYU-SEC
      *
             IF  FLG-RECE62 = ZERO
               PERFORM     RECE62-READ-SEC
               IF  CNT-IN-COMMIT   =   300
                   MOVE  ZERO          TO      CNT-IN-COMMIT
                   PERFORM 900-DBCOMMIT-SEC
                   PERFORM 900-DBSTART-SEC
               END-IF
      *
      *        処理中止設定処理
               IF      CNT-IN-CANCEL       =   50
                   MOVE    ZERO                TO  CNT-IN-CANCEL
                   PERFORM 500-CANCEL-HENSYU-SEC
               END-IF
             END-IF
           END-PERFORM
      *
           CLOSE   RECE62-FILE
           CLOSE   RECE69-FILE
      *
           IF      IDZ             =   1               
      *    レセプト処理
               CLOSE   RECE64-FILE
                       RECE65-FILE
           END-IF
           .
       200-HENSYU-EXT.
           EXIT.
      * 
      *****************************************************************
      *    編集処理
      *****************************************************************
       210-HENSYU-SEC                   SECTION.
      *
      *    地方公費データのとき不明分は処理の対象としない
           IF      IDZ                  =   2
           AND     RECE62-RECESYUBETU   =   ZERO
               GO  TO  210-HENSYU-EXT
           END-IF
      *
           INITIALIZE          WRK-AREA-SAIKEI
           INITIALIZE          WRK-SKY-AREA
      *
           INITIALIZE          WRK-DAY-TABLE
                               WRK-MIJ-TABLE
                               WRK-SKJ200604-TABLE
                               WRK-NYULIFE-TABLE
                               WRK-TENTEKI2-TABLE
                               WRK-SKJKEEP-TABLE
                               WRK-SKJHKN-TABLE
      *
           INITIALIZE          RECE6G-REC
           INITIALIZE          RECE6C-REC
      *
           INITIALIZE          WRK-KOHJGNGET-TAISYOKBN-T
      *
           INITIALIZE          TBL-TOKATUKAI
      *
           INITIALIZE          WRK-DAISAN-INGAI-TABLE
      *
           INITIALIZE          WK-GENGAKU-SKJFLG-T
      *
           INITIALIZE          TBL-HKNCOMBI2
      *
           MOVE      ZERO      TO   WK-GENGAKUKBN
           MOVE      ZERO      TO   WK-GENGAKUKBN-KEISAN
           MOVE      ZERO      TO   WK-GENGAKU-KOHID
           MOVE      ZERO      TO   WK-GENGAKU-RITU
           MOVE      ZERO      TO   WK-GENGAKU-KIN
           MOVE      ZERO      TO   WK-GENGAKU-KIN2
           MOVE      ZERO      TO   WK-GENGAKU-KIN3
           MOVE      ZERO      TO   WK-GENGAKU-KTKBN
           MOVE      ZERO      TO   FLG-SAIGAI-TAISYO
           MOVE      ZERO      TO   WRK-SAIGAI-DD
      *
           MOVE      ZERO      TO   WK-GENGAKU-KEISAN2
           MOVE      ZERO      TO   WK-GENGAKU-KEISAN3
           MOVE      ZERO      TO   WK-GENGAKU-KEISAN9
           MOVE      ZERO      TO   FLG-GENGAKU5
      *
           MOVE      SPACE     TO   WRK-TOKUSITU-TOKKI
           MOVE      SPACE     TO   WRK-TOKUSITU-TOKKI2
           MOVE      SPACE     TO   WRK-KANGAN-TOKKI
           MOVE      SPACE     TO   WRK-TAIHI-TOKKI
           MOVE      ZERO      TO   FLG-TASU-KISAI
           MOVE      ZERO      TO   FLG-COVID-TASU
           MOVE      ZERO      TO   FLG-COVID-TASU2
           MOVE      ZERO      TO   FLG-CYOKI-ARI
           MOVE      ZERO      TO   FLG-CYOKI-ARI2
           MOVE      ZERO      TO   FLG-CYOKI-TOKKIARI
           MOVE      ZERO      TO   FLG-CYOKI-TOKKIARI2
      *
           MOVE      ZERO      TO   WRK-TAIHI-ZAINUM
           MOVE      ZERO      TO   WRK-TAIHI-OKIKAE
           MOVE      ZERO      TO   WRK-TAIHI-ZAINUM2
           MOVE      ZERO      TO   WRK-TAIHI-OKIKAE2
           MOVE      ZERO      TO   WRK-TAIHI-ZAINUM3
           MOVE      ZERO      TO   WRK-TAIHI-ZAINUM4
           MOVE      ZERO      TO   WRK-TAIHI-ZAINUM5
      *
           MOVE      ZERO      TO   ONSHI-IDX3
           MOVE      ZERO      TO   ONSHI-IDX4
           MOVE      ZERO      TO   ONSHI-IDX5
           MOVE      ZERO      TO   ONSHI-IDX6
           MOVE      ZERO      TO   ONSHI-IDX7
           MOVE      ZERO      TO   ONSHI-IDX8
           MOVE      ZERO      TO   ONSHI-IDX9
      *
           MOVE    123456789   TO   RECE62-SAIKEI-CHIKAN-KIN1
           MOVE    123456789   TO   RECE62-SAIKEI-CHIKAN-KIN2
           MOVE    123456789   TO   RECE62-SAIKEI-CHIKAN-KIN3
           MOVE    123456789   TO   RECE62-SAIKEI-CHIKAN-KIN4
           MOVE    123456789   TO   RECE62-HKN-CHIKAN-KIN
           MOVE    123456789   TO   RECE62-KOH-CHIKAN-KIN1
           MOVE    123456789   TO   RECE62-KOH-CHIKAN-KIN2
           MOVE    123456789   TO   RECE62-KOH-CHIKAN-KIN3
           MOVE    123456789   TO   RECE62-KOH-CHIKAN-KIN4
           MOVE    123456789   TO   RECE62-SEI-CHIKAN-KIN1
           MOVE    123456789   TO   RECE62-SEI-CHIKAN-KIN2
           MOVE    123456789   TO   RECE62-SEI-CHIKAN-KIN3
           MOVE    123456789   TO   RECE62-SEI-CHIKAN-KIN4
      *
           PERFORM        2118-ETCKISAIFLGINF-HENSYU-SEC
      *
           PERFORM        2111-TENTEKIMATOME-HENSYU-SEC
      *
      ***  PERFORM    VARYING    IDX    FROM   1   BY   1
      ***             UNTIL     (IDX      >   10)  OR
      ***                       (RECE62-SRYKA(IDX)   =   SPACE)
               PERFORM    2101-RECE64-HENSYU-SEC
               PERFORM    2102-RECE64-HENSYU2-SEC
               PERFORM    2103-RECE64-HENSYU3-SEC
               PERFORM    2113-GENTEN-HENSYU-SEC
               PERFORM    2104-FTN-SET-SEC
      ***  END-PERFORM
      *
           IF    RECE62-SRYYM   >=  "200804"
             PERFORM      2114-BUNTENSU-HENSYU-SEC
           END-IF
      *
      *    保険組合せ番号情報編集（マル長をはずす）
           PERFORM 2106-HKNCOMBIINF-HENSYU-SEC
      *
      *    公費の再掲欄編集
           PERFORM 2105-KOH-SAIKEI-HENSYU-SEC
      *
           IF      IDZ                  =   1
               IF ( ( RECE62-TEISYUTUSAKI   =   1           ) AND
                    ( SYS-2005-SYAOCRKBN    =   "2"         )     ) 
               OR ( ( RECE62-TEISYUTUSAKI   =   2           ) AND
                    ( SYS-2005-KKHOCRKBN    =   "2" OR  "3" )     ) 
               OR ( ( RECE62-TEISYUTUSAKI   =   6           ) AND
                    ( SYS-200501-KOUIKIOCRKBN
                                            =   "2" OR  "3" )     )
      *
      *            医療保険・公費のフラグ
                   MOVE    SPACE              TO  WRK-3SYU-KBN
                   MOVE    ZERO               TO  SEIHIDX
                   MOVE    ZERO               TO  KAKKIDX
                   MOVE    ZERO               TO  SESNIDX
                   PERFORM   VARYING   IDX  FROM    1   BY  1
                         UNTIL   ( IDX                >    4    )
                         OR      ( RECE62-KOHID(IDX)  =   SPACE )
      *                生保
                       IF  RECE62-KOHNUM (IDX)  =   "012"
                           MOVE    "1"          TO  WRK-3SYU (1:1)
                           MOVE     IDX         TO  SEIHIDX
                       END-IF
      *                結核
                       IF  RECE62-KOHNUM (IDX)  =   "010"  OR  "011"
                           MOVE    "1"          TO  WRK-3SYU (2:1)
                           MOVE     IDX         TO  KAKKIDX
                       END-IF
      *
                       IF      RECE62-SRYYM <   WRK-CONS-SRYYM-200604
      *                    精神
                           IF  RECE62-KOHNUM (IDX)  =   "020"  OR  "021"
                               MOVE    "1"          TO  WRK-3SYU (3:1)
                               MOVE     IDX         TO  SESNIDX
                           END-IF
                       ELSE
      *                    自立支援法
                           IF  RECE62-KOHNUM (IDX)  =   "021"  OR  "015"
                                                    OR  "016"  OR  "024"
                               MOVE    "1"          TO  WRK-3SYU (3:1)
                               MOVE     IDX         TO  SESNIDX
                           END-IF
                       END-IF
                   END-PERFORM
      *    
                   IF      WRK-3SYU-KBN           =   ALL "1" AND
                           RECE62-KOHNUM (4)      =   SPACE   AND
                           RECE62-HKNNUM          =   SPACE
      *                ３種の場合
                       IF  KAKKIDX         >   SESNIDX
                           MOVE    SESNIDX     TO  IDA
                           MOVE    KAKKIDX     TO  IDB
                       ELSE
                           MOVE    KAKKIDX     TO  IDA
                           MOVE    SESNIDX     TO  IDB
                       END-IF
                       COMPUTE IDX5     =   SEIHIDX    +   1
                       COMPUTE IDX6     =   IDA        +   1
                       COMPUTE IDX7     =   IDB        +   1
                   ELSE    
      *                ３種以外の場合
                       MOVE    1               TO  IDA
                       MOVE    2               TO  IDB
                       MOVE    1               TO  IDX5
                       MOVE    2               TO  IDX6
                       MOVE    3               TO  IDX7
                   END-IF
      *
                   PERFORM     2107-OCR1-HENSYU-SEC
                   PERFORM     2108-OCR2-HENSYU-SEC
                   PERFORM     2109-OCR3-HENSYU-SEC
               END-IF
           END-IF
      *
      *    福岡県地方公費の判定
      ***  DISPLAY   "RECE62-PREFNUM = " RECE62-PREFNUM
           IF     (RECE62-PREFNUM     =   40    )
           AND    (RECE62-SRYYM      <=   200609)
               MOVE    ZERO               TO  KOHIDX
               PERFORM   VARYING   IDX  FROM    1   BY  1
                         UNTIL   ( IDX                >    4    )
                         OR      ( RECE62-KOHID(IDX)  =   SPACE )
      *            福岡県地方公費
                   EVALUATE    RECE62-KOHNUM (IDX)  (1:1)
                       WHEN    "1" THRU    "2"
                           IF      RECE62-KOHHBTNUM (IDX) =   "41"
                               CONTINUE
                           ELSE 
                               MOVE     IDX         TO  KOHIDX
                           END-IF
                   END-EVALUATE
               END-PERFORM
      *        福岡地方公費がある場合給付外点数を編集
               IF      KOHIDX          >   ZERO
                   PERFORM 300-KYUFUGAI-HENSYU-SEC
               END-IF 
           END-IF
      *
      *    災害区分編集
           PERFORM     2119-SAIGAIKBN-HENSYU-SEC
      *
      *    被保険者資格申立書提出患者と旧資格情報患者の情報クリア
      *    （災害を優先する  など）
           IF     RECE62-HKNNUM   NOT =  SPACE
             IF   RECE62-HKNJANUM     =  SPACE
               MOVE        ZERO   TO   RECE62-ONSHI-KSKFLG
               INITIALIZE              RECE62-ONSHI-KSKCOM
               IF   RECE62-RJNGAIKOHFTN(1)  = ZERO
                 IF  (RECE62-HKNNUM  = "002" OR "031" OR "032" OR
                                       "033" OR "034"             )
                 AND (RECE62-HOJOKBN = "1" OR "2" OR "3" OR "A" OR
                                       "B" OR "C" OR "D" OR "E" OR
                                       "F" OR "G" OR "H" OR "I"   )
                   MOVE    ZERO   TO   RECE62-ONSHI-MSTFLG
                   INITIALIZE          RECE62-ONSHI-MSTCOM
                 END-IF
               ELSE
                   MOVE    ZERO   TO   RECE62-ONSHI-MSTFLG
                   INITIALIZE          RECE62-ONSHI-MSTCOM
               END-IF
             ELSE
               MOVE        ZERO   TO   RECE62-ONSHI-MSTFLG
               INITIALIZE              RECE62-ONSHI-MSTCOM
               IF   RECE62-RJNGAIKOHFTN(1)  = ZERO
                 IF  (RECE62-HKNNUM  = "002" OR "031" OR "032" OR
                                       "033" OR "034"             )
                 AND (RECE62-HOJOKBN = "1" OR "2" OR "3" OR "A" OR
                                       "B" OR "C" OR "D" OR "E" OR
                                       "F" OR "G" OR "H" OR "I"   )
                   MOVE    ZERO   TO   RECE62-ONSHI-KSKFLG
                   INITIALIZE          RECE62-ONSHI-KSKCOM
                 END-IF
               ELSE
                   MOVE    ZERO   TO   RECE62-ONSHI-KSKFLG
                   INITIALIZE          RECE62-ONSHI-KSKCOM
               END-IF
             END-IF
           ELSE
             MOVE    ZERO   TO   RECE62-ONSHI-MSTFLG
             INITIALIZE          RECE62-ONSHI-MSTCOM
             MOVE    ZERO   TO   RECE62-ONSHI-KSKFLG
             INITIALIZE          RECE62-ONSHI-KSKCOM
           END-IF
      *
           IF   FLG-ZENKI-TOKUREI  =   1
              MOVE      1     TO     RECE62-RJNGAIKOHFTN(2)
           END-IF
      *
           PERFORM     2112-PTTOKKI-HENSYU-SEC
      *
      *    請求額情報編集
           PERFORM     2116-SKY-HENSYU-SEC
      *
      *    再掲・一部負担金置き換え編集
           PERFORM     211A-ICHIBUFUTAN-OKIKAE2-SEC
      *
      *    減額（円）置き換え編集
           IF   WK-GENGAKUKBN   =   2
             IF   RECE62-KOUREI   =  "1" OR "2"
               MOVE      ZERO              TO  RECE62-GENGAKU
             ELSE
               IF  RECE62-GENGAKU > WK-GENGAKU-KEISAN2
                 MOVE  WK-GENGAKU-KEISAN2  TO  RECE62-GENGAKU
               END-IF
             END-IF
           END-IF
      *    減額（円超）置き換え編集
           IF   WK-GENGAKUKBN   =   5
             IF   RECE62-KOUREI   =  "1" OR "2"
               MOVE      ZERO              TO  RECE62-GENGAKU
             ELSE
               IF  RECE62-GENGAKU < WK-GENGAKU-KEISAN3
      *          減額金額を計算
      **>        COMPUTE WK-GENGAKU-KEISAN1  = WK-GENGAKU-KEISAN3
      **>                                    - RECE62-GENGAKU
      **>        MOVE  WK-GENGAKU-KEISAN1  TO  RECE62-GENGAKU
      **>        IF  RECE62-GENGAKU > WK-GENGAKU-KEISAN2
      **>          MOVE  WK-GENGAKU-KEISAN2  TO  RECE62-GENGAKU
      **>        END-IF
      *
                 IF  RECE62-GENGAKU >= WK-GENGAKU-KEISAN2
                   COMPUTE WK-GENGAKU-KEISAN1  = WK-GENGAKU-KEISAN3
                                               - RECE62-GENGAKU
                 ELSE
                   COMPUTE WK-GENGAKU-KEISAN1  = WK-GENGAKU-KEISAN2
                                               - RECE62-GENGAKU
                 END-IF
                 MOVE    WK-GENGAKU-KEISAN1  TO  RECE62-GENGAKU
               END-IF
             END-IF
           END-IF
      *
      *    請求点数がない保険組み合わせ有りフラグ編集
           IF   RECE62-HKNCOMBI(2)   NOT =   ZERO
             PERFORM  VARYING  IDX18  FROM  1  BY  1
                       UNTIL  (IDX18                   >  10  )
                         OR   (RECE62-HKNCOMBI(IDX18)  =  ZERO)
               IF    (TBL-HKNCOMBI-SKYTENFLG (IDX18) = ZERO)
               AND   (TBL-HKNCOMBI-SKYTENFLG2(IDX18) =  1  )
                   MOVE    1    TO   RECE62-SKYTENFLG
               END-IF
             END-PERFORM
           END-IF
      *
      *    第三者行為の一部負担金編集
           IF   RECE62-DAISAN-GAITO   =   1  OR  2
      *
              IF    RECE62-DAISAN-CHIKAN   =   1
                COMPUTE  WRK-DAISAN-FTNMONEY3    =
                         RECE62-DAISAN-TOTALTEN  *
                         10
                IF  WRK-DAISAN-FTNMONEY3 < RECE62-DAISAN-FTNMONEY
                  MOVE   WRK-DAISAN-FTNMONEY3   TO
                                           RECE62-DAISAN-FTNMONEY
                END-IF
              END-IF
      *
              IF    RECE62-DAISAN-TOKKI    =   ZERO
                MOVE     13     TO     FLG-TOKKI
                PERFORM  21013-TOKKI-HENSYU-SEC
              END-IF
      *
              EVALUATE  RECE62-DAISAN-GENBUTU-GAITO
                WHEN      ZERO
                  IF    RECE62-DAISAN-CHIKAN  =  ZERO
                    COMPUTE  WRK-DAISAN-FTNMONEY     =
                             RECE62-DAISAN-TOTALTEN  *
                             10                      *
                             RECE62-KYURATE          /
                             100
                    IF  WRK-DAISAN-DAISANKBN  =  "1"
                      COMPUTE  WRK-DAISAN-FTNMONEY  =
                               WRK-DAISAN-FTNMONEY  +  5
                      COMPUTE  WRK-DAISAN-FTNMONEY  =
                               WRK-DAISAN-FTNMONEY  /  10
                      COMPUTE  WRK-DAISAN-FTNMONEY  =
                               WRK-DAISAN-FTNMONEY  *  10
                    END-IF
                    MOVE   WRK-DAISAN-FTNMONEY     TO
                                              RECE62-DAISAN-FTNMONEY
                  END-IF
                  IF  (RECE62-KOUREI         =  "1" OR "2")
                  OR  (RECE62-DAISAN-KOUREI  =   1        )
                    ADD    RECE62-DAISAN-FTNMONEY  TO
                                              RECE62-FTNMONEY(1)
                  END-IF
                WHEN       1
                  IF    RECE62-DAISAN-CHIKAN  =  ZERO
                    PERFORM    211B2-DAISAN-CHECK3-SEC
                    MOVE   WRK-DAISAN-FTNMONEY     TO
                                              RECE62-DAISAN-FTNMONEY
                  END-IF
                  IF RECE62-SKYIRYO-ICHIBUFTN >= RECE62-DAISAN-FTNMONEY
                    COMPUTE  RECE62-SKYIRYO-ICHIBUFTN  =
                             RECE62-SKYIRYO-ICHIBUFTN  -
                             RECE62-DAISAN-FTNMONEY
                  ELSE
                    DISPLAY  "??? RECE62-DAISAN-FTNMONEY="
                              RECE62-DAISAN-FTNMONEY
                    DISPLAY  "??? RECE62-SKYIRYO-ICHIBUFTN="
                              RECE62-SKYIRYO-ICHIBUFTN
      *???          MOVE     RECE62-SKYIRYO-ICHIBUFTN
      *???                          TO  RECE62-DAISAN-FTNMONEY
      *???          MOVE     ZERO   TO  RECE62-SKYIRYO-ICHIBUFTN
                  END-IF
              END-EVALUATE
           END-IF
      *
      *    第三者行為の院外処方の有無チェック
           PERFORM     211B1-DAISAN-CHECK2-SEC
      *
      *    入院補助公費＋長期の対応（長期の特記事項がない場合の対応）
      **>  IF   (FLG-CYOKI-ARI       =  1  )
      **>  AND  (FLG-CYOKI-TOKKIARI  = ZERO)
      **>    MOVE     26     TO     FLG-TOKKI
      **>    PERFORM  21013-TOKKI-HENSYU-SEC
      **>  END-IF
      **>  IF   (FLG-CYOKI-ARI2      =  1  )
      **>  AND  (FLG-CYOKI-TOKKIARI2 = ZERO)
      **>    MOVE     29     TO     FLG-TOKKI
      **>    PERFORM  21013-TOKKI-HENSYU-SEC
      **>  END-IF
      *
           PERFORM     RECE62-REWRITE-SEC
           .
       210-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の請求点数チェック
      *****************************************************************
       211B-DAISAN-CHECK-SEC      SECTION.
      *
           MOVE      ZERO      TO      FLG-DAISAN-ARI
      *
           PERFORM  VARYING  IDX16   FROM    1   BY  1
                     UNTIL  (IDX16                   >   10 )
                       OR   (RECE62-HKNCOMBI(IDX16)  =  ZERO)
      *
             IF     RECE62-DAISANFLG(IDX16)   =   1
      *
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE62-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE62-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE62-PTID            TO  SYU-PTID
               MOVE  RECE62-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE62-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key19"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key19"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     IF  (SYU-TOTAL-HKNTEN    NOT = ZERO)
                     OR  (SYU-KOH1SKJ-RYOYOHI NOT = ZERO)
                       MOVE   1   TO  RECE62-DAISAN-SKYFLG(IDX16)
                       ADD  SYU-TOTAL-HKNTEN
                                  TO  RECE62-DAISAN-TOTALTEN
                       ADD  SYU-KOH1SKJ-NISSU
                                  TO  RECE62-DAISAN-SKJ-NISSU-KEI
                       ADD  SYU-KOH1SKJ-RYOYOHI
                                  TO  RECE62-DAISAN-SKJ-RYOYOHI-KEI
                       ADD  SYU-KOH1SKJ-FTN-RECE
                                  TO  RECE62-DAISAN-SKJ-FTN-KEI
                       MOVE   1   TO  RECE62-DAISAN-GAITO
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key19"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key19"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
               MOVE       1                 TO  FLG-DAISAN-ARI
      *
             END-IF
      *
           END-PERFORM
      *
           IF    RECE62-DAISAN-GAITO  =   1
      *
             PERFORM  VARYING  IDX16   FROM    1   BY  1
                       UNTIL  (IDX16                   >   10 )
                         OR   (RECE62-HKNCOMBI(IDX16)  =  ZERO)
                         OR   (RECE62-DAISAN-GAITO     =   2  )
      *
               IF     RECE62-DAISANFLG(IDX16)   NOT =   1
      *
                 INITIALIZE                       SYUNOU-REC
                 MOVE  RECE62-HOSPNUM         TO  SYU-HOSPNUM
                 MOVE  RECE62-NYUGAIKBN       TO  SYU-NYUGAIKBN
                 MOVE  RECE62-PTID            TO  SYU-PTID
                 MOVE  RECE62-SRYYM           TO  SYU-SRYYMD(1:6)
                 MOVE  "__"                   TO  SYU-SRYYMD(7:2)
                 MOVE  RECE62-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
                 MOVE  SYUNOU-REC             TO  MCPDATA-REC
                 MOVE  "tbl_syunou"           TO  MCP-TABLE
                 MOVE  "key19"                TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF    MCP-RC   =   ZERO
                   MOVE    "tbl_syunou"       TO  MCP-TABLE
                   MOVE    "key19"            TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                   PERFORM  UNTIL  (FLG-SYUNOU          =  1 )
                             OR    (RECE62-DAISAN-GAITO =  2 )
                     IF    SYU-DENPJTIKBN    NOT =  "3"
                       IF  (SYU-TOTAL-HKNTEN    NOT = ZERO)
                       OR  (SYU-SYUSKJ-RYOYOHI  NOT = ZERO)
                       OR  (SYU-KOH1SKJ-RYOYOHI NOT = ZERO)
                         MOVE   2   TO  RECE62-DAISAN-GAITO
                       END-IF
                     END-IF
                     MOVE    "tbl_syunou"     TO  MCP-TABLE
                     MOVE    "key19"          TO  MCP-PATHNAME
                     PERFORM  900-SYUNOU-READ-SEC
                   END-PERFORM
                 END-IF
                 MOVE      "tbl_syunou"       TO  MCP-TABLE
                 MOVE      "key19"            TO  MCP-PATHNAME
                 PERFORM    900-CLOSE-SEC
      *
               END-IF
      *
             END-PERFORM
      *
           END-IF
      *
           IF    RECE62-DAISAN-GAITO  =  ZERO
           AND   FLG-DAISAN-ARI       =  ZERO
      *
             INITIALIZE                          HKNCOMBI-REC
             MOVE     RECE62-HOSPNUM       TO    COMB-HOSPNUM
             MOVE     RECE62-PTID          TO    COMB-PTID
             MOVE     HKNCOMBI-REC         TO    MCPDATA-REC
             MOVE     "tbl_hkncombi"       TO    MCP-TABLE
             MOVE     "key8"               TO    MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF     MCP-RC   =   ZERO
               MOVE   "tbl_hkncombi"       TO    MCP-TABLE
               MOVE   "key8"               TO    MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF   MCP-RC   =   ZERO
                 CONTINUE
               ELSE
                 MOVE     9     TO  RECE62-DAISAN-GAITO
               END-IF
             ELSE
               MOVE       9     TO  RECE62-DAISAN-GAITO
             END-IF
             MOVE     "tbl_hkncombi"       TO    MCP-TABLE
             MOVE     "key8"               TO    MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      ***********
      *
      *    現物給付計算対象かチェック
      *    全ての収納が現物給付計算されているかチェック
           MOVE     ZERO       TO     FLG-DAISAN-GENBUTU
           IF    RECE62-DAISAN-GENBUTU-GAITO   =   1
      *
             IF    RECE62-KOUREI    NOT =  SPACE
               PERFORM  VARYING  IDX16   FROM    1   BY  1
                         UNTIL  (IDX16                   >   10 )
                           OR   (RECE62-HKNCOMBI(IDX16)  =  ZERO)
                           OR   (FLG-DAISAN-GENBUTU      =   1  )
                 IF     RECE62-DAISANFLG(IDX16)   =   1
                   INITIALIZE                       SYUNOU-REC
                   MOVE  RECE62-HOSPNUM         TO  SYU-HOSPNUM
                   MOVE  RECE62-NYUGAIKBN       TO  SYU-NYUGAIKBN
                   MOVE  RECE62-PTID            TO  SYU-PTID
                   MOVE  RECE62-SRYYM           TO  SYU-SRYYMD(1:6)
                   MOVE  "__"                   TO  SYU-SRYYMD(7:2)
                   MOVE  RECE62-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
                   MOVE  SYUNOU-REC             TO  MCPDATA-REC
                   MOVE  "tbl_syunou"           TO  MCP-TABLE
                   MOVE  "key19"                TO  MCP-PATHNAME
                   PERFORM 900-DBSELECT-SEC
                   IF    MCP-RC   =   ZERO
                     MOVE    "tbl_syunou"       TO  MCP-TABLE
                     MOVE    "key19"            TO  MCP-PATHNAME
                     PERFORM  900-SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                       IF    SYU-DENPJTIKBN    NOT =  "3"
                         IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                         AND SYU-SKJ-FTNGAKU(2)    = ZERO
                           MOVE     1           TO  FLG-DAISAN-GENBUTU
                           MOVE   IDX16         TO  IDX23
                         END-IF
                       END-IF
                       MOVE    "tbl_syunou"     TO  MCP-TABLE
                       MOVE    "key19"          TO  MCP-PATHNAME
                       PERFORM  900-SYUNOU-READ-SEC
                     END-PERFORM
                   END-IF
                   MOVE      "tbl_syunou"       TO  MCP-TABLE
                   MOVE      "key19"            TO  MCP-PATHNAME
                   PERFORM    900-CLOSE-SEC
                 END-IF
               END-PERFORM
               IF   FLG-DAISAN-GENBUTU   =   1
                 MOVE     ZERO       TO     RECE62-DAISAN-GENBUTU-GAITO
                 IF    RECE62-DAISAN-GENBUTUFLG(IDX23) = ZERO
                  DISPLAY "現物給付対象未登録の第三者行為有"
                 ELSE
                  DISPLAY "現物給付対象登録後の再計算未実施分有"
                  DISPLAY "又は、減額認定証適用期間外の診療分有"
                 END-IF
                 DISPLAY  "HKNCOMBI=" RECE62-HKNCOMBI(IDX23)
                 DISPLAY  "DAISAN-GENBUTUFLG="
                                      RECE62-DAISAN-GENBUTUFLG(IDX23)
               END-IF
             ELSE
                 MOVE     ZERO       TO     RECE62-DAISAN-GENBUTU-GAITO
             END-IF
      *
           END-IF
      *
           .
       211B-DAISAN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の院外処方の有無チェック
      *****************************************************************
       211B1-DAISAN-CHECK2-SEC      SECTION.
      *
      *    病名記載の為、院外処方の有無チェックを行い、フラグの値を置換する
      *
      *    ＜第三者行為の請求点なし＞の場合
           IF    RECE62-DAISAN-GAITO  =  ZERO
             PERFORM  VARYING  IDX16   FROM    1   BY  1
                       UNTIL  (IDX16                   >   10 )
                         OR   (RECE62-HKNCOMBI(IDX16)  =  ZERO)
               IF   WRK-DAISAN-INGAI(IDX16)  =   1
                 IF     RECE62-DAISANFLG(IDX16)   =   1
                     MOVE   1   TO  RECE62-DAISAN-SKYFLG(IDX16)
                     MOVE   3   TO  RECE62-DAISAN-GAITO
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
      *    ＜第三者行為のみ請求点あり＞の場合
           IF    RECE62-DAISAN-GAITO  =   1
             PERFORM  VARYING  IDX16   FROM    1   BY  1
                       UNTIL  (IDX16                   >   10 )
                         OR   (RECE62-HKNCOMBI(IDX16)  =  ZERO)
               IF   WRK-DAISAN-INGAI(IDX16)  =   1
                 IF     RECE62-DAISANFLG(IDX16)   =   1
                   IF   RECE62-DAISAN-SKYFLG(IDX16) =  ZERO
                     MOVE   1   TO  RECE62-DAISAN-SKYFLG(IDX16)
                   END-IF
                 ELSE
                     MOVE   4   TO  RECE62-DAISAN-GAITO
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
           .
       211B1-DAISAN-CHECK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の一部負担金計算＜現物給付＞
      *****************************************************************
       211B2-DAISAN-CHECK3-SEC      SECTION.
      *
           MOVE     ZERO     TO    WRK-DAISAN-FTNMONEY
      *
           PERFORM  VARYING  IDX16   FROM    1   BY  1
                     UNTIL  (IDX16                   >   10 )
                       OR   (RECE62-HKNCOMBI(IDX16)  =  ZERO)
      *
             IF     RECE62-DAISANFLG(IDX16)   =   1
      *
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE62-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE62-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE62-PTID            TO  SYU-PTID
               MOVE  RECE62-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE62-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key19"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key19"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                       COMPUTE  WRK-DAISAN-FTNMONEY =
                                WRK-DAISAN-FTNMONEY +
                                SYU-SYUCOMPFTN
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key19"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key19"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
             END-IF
      *
           END-PERFORM
      *
           .
       211B2-DAISAN-CHECK3-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者の判定
      *****************************************************************
       2110-GENGAKU-HANTEI-SEC      SECTION.
      *
           IF   (RECE62-SRYYM       >=  "200610")
           AND  (RECE62-HKNNUM   NOT =   SPACE  )
      *
            IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
              CONTINUE
            ELSE
              MOVE      RECE62-SRYYM          TO   WK-GENGAKU-YM
              IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                 MOVE   RECE62-TEKSTYMD(7:2)  TO   WK-GENGAKU-DD
              ELSE
                 MOVE   01                    TO   WK-GENGAKU-DD
              END-IF
      *
              MOVE      RECE62-SRYYM          TO   WK-GENGAKU2-YM
              IF   RECE62-TEKEDYMD-X(1:6) >  RECE62-SRYYM
                 INITIALIZE                        STS-AREA-DAY
                 INITIALIZE                        LNK-DAY7-AREA
                 MOVE   "71"                  TO   LNK-DAY7-IRAI
                 MOVE   RECE62-SRYYM          TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"          USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI       TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)        TO   WK-GENGAKU2-DD
              ELSE
                 MOVE   RECE62-TEKEDYMD-X(7:2)
                                              TO   WK-GENGAKU2-DD
              END-IF
      *
              MOVE      RECE62-SRYYM          TO   WK-GENGAKU3-YM
              IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                 MOVE   RECE62-TEKSTYMD-X(7:2)
                                              TO   WK-GENGAKU3-DD
              ELSE
                 MOVE   01                    TO   WK-GENGAKU3-DD
              END-IF
      *
              PERFORM  21101-GENGAKU-HENSYU-SEC
      *
            END-IF
      *
            IF   (WK-GENGAKUKBN        =   2      )
            AND  (RECE62-SRYYM         <  "201204")
                   MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
      *
            IF   RECE62-SRYYM   >=  "201007"
              PERFORM  2115-SAIGAI-TAISYO-HANTEI-SEC
            END-IF
      *
            IF   RECE62-HKNNUM   =   "068" OR "069" OR "040"
             IF   RECE62-SRYYM  >=   "201101"
              IF   (WK-GENGAKUKBN      =   3 OR 4)
              AND  (FLG-SAIGAI-TAISYO  =   1     )
                CONTINUE
              ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
             ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
                MOVE     ZERO    TO    FLG-SAIGAI-TAISYO
             END-IF
            END-IF
      *
            IF   RECE62-HKNNUM   =   "004"
            AND  RECE62-SRYYM   >=   "201101"
              IF  RECE62-HKNJANUM(1:4) = "0404"
                CONTINUE
              ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
            END-IF
      *
           END-IF
      *
      ***
      *
           IF   (RECE62-SRYYM       >=  "201101")
           AND  (RECE62-HKNNUM       =   SPACE  )
      *
            MOVE      RECE62-SRYYM       TO   WK-GENGAKU-YM
            IF   RECE62-KOHTEKSTYMD(1)(1:6)
                                       >=  RECE62-SRYYM
               MOVE   RECE62-KOHTEKSTYMD(1)(7:2)
                                         TO   WK-GENGAKU-DD
            ELSE
               MOVE   01                 TO   WK-GENGAKU-DD
            END-IF
      *
            MOVE      RECE62-SRYYM       TO   WK-GENGAKU2-YM
            IF   RECE62-KOHTEKEDYMD(1)(1:6)
                                        >  RECE62-SRYYM
              INITIALIZE                      STS-AREA-DAY
              INITIALIZE                      LNK-DAY7-AREA
              MOVE   "71"                TO   LNK-DAY7-IRAI
              MOVE   RECE62-SRYYM        TO   LNK-DAY7-YM
              CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                              LNK-DAY7-AREA
              MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
              MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
            ELSE
              MOVE   RECE62-KOHTEKEDYMD(1)(7:2)
                                         TO   WK-GENGAKU2-DD
            END-IF
      *
            MOVE     "99999999"          TO   WK-GENGAKU3-YMD
      *
            PERFORM  21101-GENGAKU-HENSYU-SEC
      *
            PERFORM  2115-SAIGAI-TAISYO-HANTEI-SEC
      *
            IF   (WK-GENGAKUKBN      =   3 OR 4)
            AND  (FLG-SAIGAI-TAISYO  =   1     )
              CONTINUE
            ELSE
              MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   1   OR   2   OR   5
      *
      *       公費月上限額取得
              INITIALIZE                  LNK-ORCSJGNGET-REC
              MOVE  RECE62-HOSPNUM    TO  LNK-ORCSJGNGET-HOSPNUM
              MOVE  RECE62-NYUGAIKBN  TO  LNK-ORCSJGNGET-NYUGAIKBN
              MOVE  RECE62-PTID       TO  LNK-ORCSJGNGET-PTID
              EVALUATE   WK-GENGAKUKBN
                WHEN         1
                   MOVE    "960"      TO  LNK-ORCSJGNGET-KOHHKNNUM
                WHEN         2
                   MOVE    "961"      TO  LNK-ORCSJGNGET-KOHHKNNUM
                WHEN         5
                   MOVE    "953"      TO  LNK-ORCSJGNGET-KOHHKNNUM
              END-EVALUATE
              MOVE  WK-GENGAKU-KOHID  TO  LNK-ORCSJGNGET-KOHID
              MOVE  RECE62-SRYYM      TO  LNK-ORCSJGNGET-SRYYM
      *
              CALL    "ORCSJGNGET"    USING
                                      LNK-ORCSJGNGET-REC
                                      SPA-AREA
      *
              IF    LNK-ORCSJGNGET-RC   =   ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                      MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  WK-GENGAKU-RITU
                      IF   WK-GENGAKU-RITU  >  100
                          MOVE   100   TO  WK-GENGAKU-RITU
                      END-IF
                      IF   WK-GENGAKU-RITU  =  ZERO
                          MOVE   ZERO  TO  WK-GENGAKUKBN
                      END-IF
                   WHEN          2
                      MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  WK-GENGAKU-KIN
                                           WK-GENGAKU-KIN2
                                           WK-GENGAKU-KIN3
                      IF   WK-GENGAKU-KIN   =  ZERO
                          MOVE   ZERO  TO  WK-GENGAKUKBN
                      END-IF
                      COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  +  5
                      COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  / 10
                      COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  * 10
                      COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 +  5
                      COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 / 10
                      COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 * 10
                      COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 +  5
                      COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 / 10
                      COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 * 10
                   WHEN          5
                      MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  WK-GENGAKU-KIN
                                           WK-GENGAKU-KIN2
                                           WK-GENGAKU-KIN3
                      IF   WK-GENGAKU-KIN   =  9999999 OR 999999
                        MOVE     ZERO  TO  WK-GENGAKUKBN
                        MOVE     ZERO  TO  WK-GENGAKU-KIN
                        MOVE     ZERO  TO  WK-GENGAKU-KIN2
                        MOVE     ZERO  TO  WK-GENGAKU-KIN3
                      ELSE
                        COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  +  5
                        COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  / 10
                        COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  * 10
                        COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 +  5
                        COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 / 10
                        COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 * 10
                        COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 +  5
                        COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 / 10
                        COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 * 10
                      END-IF
                 END-EVALUATE
              END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
              EVALUATE   WK-GENGAKUKBN
      *           減額（割）
                  WHEN        1
                     MOVE    1                TO  RECE62-GENMENKBN
                     IF   WK-GENGAKUKBN-KEISAN  =  2
                       IF  RECE62-KYURATE  <= WK-GENGAKU-RITU
                          MOVE   100          TO  RECE62-GENGAKURATE
                       ELSE
      *****>              COMPUTE  WK-GENGAKU-RITU-KEISAN =
      *****>                      (WK-GENGAKU-RITU  /  RECE62-KYURATE)
      *****>                                        +  0.009
      *****>              COMPUTE  RECE62-GENGAKURATE =
      *****>                       WK-GENGAKU-RITU-KEISAN * 100
                          MOVE  WK-GENGAKU-RITU
                                              TO  RECE62-GENGAKURATE
                       END-IF
                     ELSE
                       MOVE  WK-GENGAKU-RITU  TO  RECE62-GENGAKURATE
                     END-IF
      *           減額（円）
                  WHEN        2
                     MOVE    1                TO  RECE62-GENMENKBN
                     MOVE    WK-GENGAKU-KIN   TO  RECE62-GENGAKU
      *           免除
                  WHEN        3
                     MOVE    2                TO  RECE62-GENMENKBN
      *           支払猶予
                  WHEN        4
                     MOVE    3                TO  RECE62-GENMENKBN
      *           減額（円超）
                  WHEN        5
                     MOVE    1                TO  RECE62-GENMENKBN
                     MOVE    WK-GENGAKU-KIN   TO  RECE62-GENGAKU
              END-EVALUATE
      *
              MOVE   WK-GENGAKU-KTKBN         TO  RECE62-GENMEN-COM
           END-IF
      *
           .
       2110-GENGAKU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者の編集
      *****************************************************************
       21101-GENGAKU-HENSYU-SEC      SECTION.
      *
           MOVE     SPACE    TO     WK-CHECK-TEKSTYMD
           MOVE     SPACE    TO     WK-CHECK-TEKEDYMD
      *
           PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                      UNTIL   (GEN-IDX    >    TBL-GENGAKU-MAX)
                        OR    (WK-GENGAKUKBN   NOT = ZERO     )
             INITIALIZE                       PTKOHINF-REC
             MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
             MOVE    RECE62-PTID          TO  PTKOH-PTID
             MOVE    TBL-GENGAKU(GEN-IDX) TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WK-GENGAKU-YMD ) AND
                      (WK-GENGAKU-YMD  <=   PTKOH-TEKEDYMD ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                  OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU2-YMD) AND
                      (WK-GENGAKU2-YMD <=   PTKOH-TEKEDYMD ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                  OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU3-YMD) AND
                      (WK-GENGAKU3-YMD <=   PTKOH-TEKEDYMD ) AND
                      (WK-GENGAKU3-YMD NOT = "99999999"    ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                      EVALUATE   GEN-IDX
                        WHEN        1
                          MOVE   1           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                        WHEN        2
                          MOVE   2           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                        WHEN        3
                          MOVE   3           TO  WK-GENGAKUKBN
                        WHEN        4
                          MOVE   4           TO  WK-GENGAKUKBN
                        WHEN        5
                          MOVE   5           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                      END-EVALUATE
      *
                      IF  RECE62-HKNJANUM  =  "270280" OR "67270280"
                        IF     PTKOH-JKYSNUM(1:1)  = "1"
                          MOVE   1           TO  WK-GENGAKU-KTKBN
                        END-IF
                        IF     PTKOH-JKYSNUM(1:1)  = "2"
                          MOVE   2           TO  WK-GENGAKU-KTKBN
                        END-IF
                      END-IF
      *
                      IF    WK-GENGAKUKBN  =  1
                        IF     PTKOH-FTNJANUM(1:1) = "1"
                          MOVE   1           TO  WK-GENGAKUKBN-KEISAN
                        END-IF
                        IF     PTKOH-FTNJANUM(1:1) = "2"
                          MOVE   2           TO  WK-GENGAKUKBN-KEISAN
                        END-IF
                      END-IF
      *
                      MOVE  PTKOH-TEKSTYMD   TO  WK-CHECK-TEKSTYMD
                      IF    PTKOH-TEKSTYMD(1:6)  <  RECE62-SRYYM
                        MOVE  RECE62-SRYYM   TO  WK-CHECK-TEKSTYMD(1:6)
                        MOVE  "01"           TO  WK-CHECK-TEKSTYMD(7:2)
                      END-IF
                      MOVE  PTKOH-TEKEDYMD   TO  WK-CHECK-TEKEDYMD
                      IF    PTKOH-TEKEDYMD(1:6)  >  RECE62-SRYYM
                        MOVE  RECE62-SRYYM   TO  WK-CHECK-TEKEDYMD(1:6)
                        MOVE  "31"           TO  WK-CHECK-TEKEDYMD(7:2)
                      END-IF
      *
                      MOVE       1           TO  FLG-PTKOHINF
                  ELSE
                      MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                      MOVE    "key4"           TO  MCP-PATHNAME
                      PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
           END-PERFORM
      *
           MOVE     ZERO      TO  FLG-CHECK-ARI
           IF   WK-GENGAKUKBN  NOT =  ZERO
              PERFORM  211011-GENGAKU-CHECK-SEC
              IF   FLG-CHECK-ARI  =  ZERO
                  MOVE  ZERO  TO  WK-GENGAKUKBN
              END-IF
           END-IF
      *
           .
       21101-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者のチェック
      *****************************************************************
       211011-GENGAKU-CHECK-SEC      SECTION.
      *
           PERFORM  VARYING  IDX32   FROM    1   BY  1
                     UNTIL  (IDX32                   >   10 )
                      OR    (RECE62-HKNCOMBI(IDX32)  =  ZERO)
                      OR    (FLG-CHECK-ARI           =   1  )
             IF   RECE62-DAISANFLG(IDX32)   =   1
               CONTINUE
             ELSE
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE62-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE62-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE62-PTID            TO  SYU-PTID
               MOVE  RECE62-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE62-HKNCOMBI(IDX32) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key19"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key19"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU      =  1)
                           OR    (FLG-CHECK-ARI   =  1)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     PERFORM  VARYING  IDX33  FROM  1  BY  1
                               UNTIL  (IDX33           >   31)
                                OR    (FLG-CHECK-ARI   =    1)
                       IF  SYU-DAY(IDX33) =  "1" OR "2" OR "9"
                         MOVE RECE62-SRYYM  TO  WK-CHECK-YMD(1:6)
                         MOVE IDX33         TO  WK-CHECK-YMD(7:2)
                         IF  (WK-CHECK-TEKSTYMD <= WK-CHECK-YMD     )
                         AND (WK-CHECK-YMD      <= WK-CHECK-TEKEDYMD)
                            MOVE   1   TO   FLG-CHECK-ARI
                         END-IF
                       END-IF
                     END-PERFORM
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key19"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key19"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
             END-IF
           END-PERFORM
      *
           .
       211011-GENGAKU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点滴手技加算まとめ編集
      *****************************************************************
       2111-TENTEKIMATOME-HENSYU-SEC      SECTION.
      *
           PERFORM    VARYING    IDX    FROM   1   BY   1
                       UNTIL    (IDX                   >   10  )
                         OR     (RECE62-HKNCOMBI(IDX)  =   ZERO)
      *
             INITIALIZE                 ORCSTENTEK2AREA
             MOVE    RECE62-HOSPNUM TO  LNK-ORCSTEN2-HOSPNUM
             MOVE    RECE62-PTID    TO  LNK-ORCSTEN2-PTID
             MOVE    RECE62-SRYYM   TO  LNK-ORCSTEN2-SRYYM
             MOVE    RECE62-HKNCOMBI(IDX)
                                    TO  LNK-ORCSTEN2-HKNCOMBI
             CALL    "ORCSTENTEK2"  USING
                                    ORCSTENTEK2AREA
                                    SPA-AREA
             IF      LNK-ORCSTEN2-RC  =   ZERO
               IF   (LNK-ORCSTEN2-TENTEK-ERRCD  = ZERO)
               OR   (LNK-ORCSTEN2-CHUJOU-ERRCD  = ZERO)
                 MOVE  RECE62-HKNCOMBI(IDX)
                                    TO  WRK-TENTEKI2-HKNCOMBI(IDX)
                 MOVE  LNK-ORCSTEN2-OUT-AREA
                                    TO  WRK-TENTEKI2-HENKYAKU-AREA(IDX)
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       2111-TENTEKIMATOME-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者特記事項編集
      *****************************************************************
       2112-PTTOKKI-HENSYU-SEC      SECTION.
      *
           INITIALIZE                TBL-PTTOKKI
      *
           MOVE      ZERO      TO    TOKKI-IDX2
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
               IF (( RECE62-PTTOKKI-CD(TOKKI-IDX)    = SPACE ) AND
                   ( RECE62-PTTOKKI-NAIYO(TOKKI-IDX) = SPACE ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "15"     ) AND
                   ((RECE62-SRYYM   <  "200608") OR
                    (RECE62-SRYYM   >  "200812")             ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "16"     ) AND
                   ( RECE62-SRYYM   <  "200610"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) =
                                    "17" OR "18" OR "19"     ) AND
                   ((RECE62-SRYYM   <  "200704") OR
                    (RECE62-SRYYM   >  "201807")             ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "20"     ) AND
                   ((RECE62-SRYYM   <  "200804") OR
                    (RECE62-SRYYM   >  "201903")             ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "21"     ) AND
                   ( RECE62-SRYYM   <  "200901"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) = "22"     ) AND
                   ( RECE62-SRYYM   >  "201807"              ))
               OR (( RECE62-PTTOKKI-CD(TOKKI-IDX) =
                                    "23" OR "24"             ) AND
                   ( RECE62-SRYYM   >  "201412"              ))
                 CONTINUE
               ELSE
                 ADD    1     TO    TOKKI-IDX2
                 MOVE   RECE62-PTTOKKI-CD(TOKKI-IDX)    TO
                                    TBL-PTTOKKI-CD(TOKKI-IDX2)
                 MOVE   RECE62-PTTOKKI-NAIYO(TOKKI-IDX) TO
                                    TBL-PTTOKKI-NAIYO(TOKKI-IDX2)
      *
                 IF  (WRK-KANGAN-TOKKI  NOT = SPACE         )
                 OR  (RECE62-KOHNUM(1)      = "095" OR "096")
                 OR  (RECE62-KOHNUM(2)      = "095" OR "096")
                 OR  (RECE62-KOHNUM(3)      = "095" OR "096")
                 OR  (RECE62-KOHNUM(4)      = "095" OR "096")
                  CONTINUE
                 ELSE
                  IF     RECE62-KOUREI-HANTEIFLG  =  "1"
                   IF    RECE62-SRYYM  >=  "201808"
                       EVALUATE  WRK-TOKUSITU-TOKKI
                         WHEN      "26"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "27" OR "28" OR "29" OR "30" OR
                               "31" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "27"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "28" OR "29" OR "30" OR
                               "31" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "28"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "29" OR "30" OR
                               "31" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "29"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "30" OR
                               "31" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "30"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "31" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "31"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "32"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "33"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "32" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "34"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "32" OR "33"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                       END-EVALUATE
                   ELSE
                     IF  RECE62-SRYYM  >=  "201708"
                       EVALUATE  WRK-TOKUSITU-TOKKI
                         WHEN      "17"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "18" OR "19" OR "22" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "18"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "19" OR "22" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "19"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "22" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "22"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "34"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "22"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                       END-EVALUATE
                     ELSE
                       EVALUATE  WRK-TOKUSITU-TOKKI
                         WHEN      "17"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "18" OR "19" OR "22" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "18"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "19" OR "22" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "19"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "22" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "22"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "23"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "22" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "24"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "22" OR "23"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                       END-EVALUATE
                     END-IF
                   END-IF
                  ELSE
                   IF    RECE62-SRYYM  >=  "201501"
                       EVALUATE  WRK-TOKUSITU-TOKKI
                         WHEN      "26"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "27" OR "28" OR "29" OR "30" OR
                               "31" OR "32" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "27"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "28" OR "29" OR "30" OR
                               "31" OR "32" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "28"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "29" OR "30" OR
                               "31" OR "32" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "29"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "30" OR
                               "31" OR "32" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "30"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "31" OR "32" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "31"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "32" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "32"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "33" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "33"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "32" OR "34" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "34"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "32" OR "33" OR "35"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "35"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "26" OR "27" OR "28" OR "29" OR
                               "30" OR "31" OR "32" OR "33" OR "34"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                       END-EVALUATE
                   ELSE
                       EVALUATE  WRK-TOKUSITU-TOKKI
                         WHEN      "17"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "18" OR "19" OR "22" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "18"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "19" OR "22" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "19"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "22" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "22"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "23" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "23"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "22" OR "24"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                         WHEN      "24"
                           IF  RECE62-PTTOKKI-CD(TOKKI-IDX) =
                               "17" OR "18" OR "19" OR "22" OR "23"
                             MOVE   WRK-TOKUSITU-TOKKI  TO
                                            WRK-TOKUSITU-TOKKI2
                           END-IF
                       END-EVALUATE
                   END-IF
                  END-IF
                 END-IF
               END-IF
           END-PERFORM
      *
           INITIALIZE                RECE62-PTTOKKI-AREA
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
                 MOVE   TBL-PTTOKKI-CD(TOKKI-IDX)       TO
                                    RECE62-PTTOKKI-CD(TOKKI-IDX)
                 MOVE   TBL-PTTOKKI-NAIYO(TOKKI-IDX)    TO
                                    RECE62-PTTOKKI-NAIYO(TOKKI-IDX)
      *          入院補助公費＋長期の対応
                 IF    RECE62-PTTOKKI-CD(TOKKI-IDX) = "02"
                   MOVE   1    TO    FLG-CYOKI-TOKKIARI
                 END-IF
                 IF    RECE62-PTTOKKI-CD(TOKKI-IDX) = "16"
                   MOVE   1    TO    FLG-CYOKI-TOKKIARI2
                 END-IF
           END-PERFORM
      *
      ***
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
            IF  (WRK-KANGAN-TOKKI  NOT = SPACE         )
            OR  (RECE62-KOHNUM(1)      = "095" OR "096")
            OR  (RECE62-KOHNUM(2)      = "095" OR "096")
            OR  (RECE62-KOHNUM(3)      = "095" OR "096")
            OR  (RECE62-KOHNUM(4)      = "095" OR "096")
             CONTINUE
            ELSE
             IF      RECE62-KOUREI-HANTEIFLG  =  "1"
               IF    RECE62-SRYYM  >=  "201808"
                   EVALUATE  WRK-TOKUSITU-TOKKI
                     WHEN      "26"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "27" OR "28" OR "29" OR "30" OR
                           "31" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "27"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "28" OR "29" OR "30" OR
                           "31" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "28"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "29" OR "30" OR
                           "31" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "29"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "30" OR
                           "31" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "30"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "31" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "31"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "32"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "33"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "32" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "34"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "32" OR "33"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                   END-EVALUATE
               ELSE
                 IF  RECE62-SRYYM  >=  "201708"
                   EVALUATE  WRK-TOKUSITU-TOKKI
                     WHEN      "17"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "18" OR "19" OR "22" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "18"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "19" OR "22" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "19"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "22" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "22"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "34"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "22"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  WRK-TOKUSITU-TOKKI
                     WHEN      "17"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "18" OR "19" OR "22" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "18"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "19" OR "22" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "19"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "22" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "22"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "23"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "22" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "24"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "22" OR "23"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
             ELSE
               IF    RECE62-SRYYM  >=  "201501"
                   EVALUATE  WRK-TOKUSITU-TOKKI
                     WHEN      "26"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "27" OR "28" OR "29" OR "30" OR
                           "31" OR "32" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "27"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "28" OR "29" OR "30" OR
                           "31" OR "32" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "28"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "29" OR "30" OR
                           "31" OR "32" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "29"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "30" OR
                           "31" OR "32" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "30"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "31" OR "32" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "31"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "32" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "32"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "33" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "33"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "32" OR "34" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "34"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "32" OR "33" OR "35"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "35"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "26" OR "27" OR "28" OR "29" OR
                           "30" OR "31" OR "32" OR "33" OR "34"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                   END-EVALUATE
               ELSE
                   EVALUATE  WRK-TOKUSITU-TOKKI
                     WHEN      "17"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "18" OR "19" OR "22" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "18"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "19" OR "22" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "19"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "22" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "22"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "23" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "23"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "22" OR "24"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                     WHEN      "24"
                       IF  RECE62-TOKKI(TOKKI-IDX) =
                           "17" OR "18" OR "19" OR "22" OR "23"
                         MOVE   WRK-TOKUSITU-TOKKI  TO
                                        WRK-TOKUSITU-TOKKI2
                       END-IF
                   END-EVALUATE
               END-IF
             END-IF
            END-IF
           END-PERFORM
      *
      ***
      *
           IF  (WRK-TOKUSITU-TOKKI  =
                "31" OR "32" OR "33" OR "34" OR "35" OR "43" OR "44")
           AND (WRK-KANGAN-TOKKI    =
                "26" OR "27" OR "28" OR "29" OR "30" OR "41" OR "42")
             MOVE  WRK-KANGAN-TOKKI    TO  WRK-TOKUSITU-TOKKI2
           END-IF
           IF  (WRK-TOKUSITU-TOKKI  =
                "26" OR "27" OR "28" OR "29" OR "30" OR "41" OR "42")
           AND (WRK-KANGAN-TOKKI    =
                "31" OR "32" OR "33" OR "34" OR "35" OR "43" OR "44")
             MOVE  WRK-TOKUSITU-TOKKI  TO  WRK-TOKUSITU-TOKKI2
           END-IF
      *
           IF  (WRK-TOKUSITU-TOKKI  =
                "31" OR "32" OR "33" OR "34" OR "35" OR "43" OR "44")
           OR  (WRK-KANGAN-TOKKI    =
                "31" OR "32" OR "33" OR "34" OR "35" OR "43" OR "44")
             MOVE  1                   TO  FLG-TASU-KISAI
           END-IF
      *
      ***
      *
           IF   ((RECE62-KOHNUM(1)     =  "095" OR "096") OR
                 (RECE62-KOHNUM(2)     =  "095" OR "096") OR
                 (RECE62-KOHNUM(3)     =  "095" OR "096") OR
                 (RECE62-KOHNUM(4)     =  "095" OR "096"))
           AND  ((FLG-COVID-TASU   NOT =  ZERO          ) OR
                 (FLG-COVID-TASU2  NOT =  ZERO          ))
           AND  ( FLG-TASU-KISAI       =  ZERO           )
              IF  FLG-COVID-TASU   NOT =  ZERO
                MOVE    27     TO   FLG-TOKKI
              ELSE
                MOVE    28     TO   FLG-TOKKI
              END-IF
              PERFORM   21013-TOKKI-HENSYU-SEC
      *
              IF   (WRK-TOKUSITU-TOKKI  NOT = SPACE)
              OR   (WRK-KANGAN-TOKKI    NOT = SPACE)
      *         この場合、難病、肝がん共に多数回該当では無い
      *         WRK-TOKUSITU-TOKKI,WRK-KANGAN-TOKKIは同じ
                IF  WRK-TOKUSITU-TOKKI  NOT = SPACE
                  MOVE  WRK-TOKUSITU-TOKKI  TO  WRK-TOKUSITU-TOKKI2
                ELSE
                  MOVE  WRK-KANGAN-TOKKI    TO  WRK-TOKUSITU-TOKKI2
                END-IF
              ELSE
                  MOVE  WRK-TAIHI-TOKKI     TO  WRK-TOKUSITU-TOKKI2
              END-IF
           END-IF
      *
      ***
      *
           INITIALIZE                TBL-TOKKI
      *
           MOVE      ZERO      TO    TOKKI-IDX2
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
               IF  (RECE62-TOKKI(TOKKI-IDX) = SPACE              )
               OR  (RECE62-TOKKI(TOKKI-IDX) = WRK-TOKUSITU-TOKKI2)
                 CONTINUE
               ELSE
                 ADD    1      TO    TOKKI-IDX2
                 MOVE   RECE62-TOKKI(TOKKI-IDX)   TO
                                     TBL-TOKKI-CD(TOKKI-IDX2)
               END-IF
           END-PERFORM
      *
           MOVE      SPACE     TO    RECE62-TOKKI(1)
           MOVE      SPACE     TO    RECE62-TOKKI(2)
           MOVE      SPACE     TO    RECE62-TOKKI(3)
           MOVE      SPACE     TO    RECE62-TOKKI(4)
           MOVE      SPACE     TO    RECE62-TOKKI(5)
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
                 MOVE   TBL-TOKKI-CD(TOKKI-IDX)   TO
                                     RECE62-TOKKI(TOKKI-IDX)
      *          入院補助公費＋長期の対応
                 IF    RECE62-TOKKI(TOKKI-IDX) = "02"
                   MOVE   1    TO    FLG-CYOKI-TOKKIARI
                 END-IF
                 IF    RECE62-TOKKI(TOKKI-IDX) = "16"
                   MOVE   1    TO    FLG-CYOKI-TOKKIARI2
                 END-IF
           END-PERFORM
      *
           .
       2112-PTTOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患扱いとする地方公費フラグ等の編集
      *****************************************************************
       2118-ETCKISAIFLGINF-HENSYU-SEC      SECTION.
      *
           IF    IDZ    =    1
      *
             PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                         UNTIL    KOHFTN-IDX     >    4
      *
              IF  ((WRK-PREFNUM                =  "13"    ) AND
                   (RECE62-KOHNUM(KOHFTN-IDX)  =  "151"   ) AND
                   (RECE62-SRYYM              >=  "200905"))
              OR  ((WRK-PREFNUM                =  "23"    ) AND
                   (RECE62-KOHNUM(KOHFTN-IDX)  =  "191"   ) AND
                   (RECE62-SRYYM              >=  "200910") AND
                   (RECE62-SRYYM              <=  "201509"))
              OR  ((WRK-PREFNUM                =  "23"
                                               OR "24"    ) AND
                   (RECE62-KOHNUM(KOHFTN-IDX)  =  "152"   ) AND
                   (RECE62-SRYYM              >=  "201104") AND
                   (RECE62-SRYYM              <=  "201412"))
                 MOVE     1     TO    TBL-TOKATUKAIFLG(KOHFTN-IDX)
              END-IF
      *
              IF   RECE62-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
      *
                 INITIALIZE                   LNK-ORCSJGNGET-REC
                 MOVE   RECE62-HOSPNUM    TO  LNK-ORCSJGNGET-HOSPNUM
                 MOVE   RECE62-KOHNUM(KOHFTN-IDX)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                 MOVE   RECE62-KOHTEKSTYMD(KOHFTN-IDX)
                                          TO  LNK-ORCSJGNGET-TEKSTYMD
                 MOVE   WRK-PREFNUM       TO  LNK-ORCSJGNGET-PREFNUM
                 MOVE   "1"               TO  LNK-ORCSJGNGET-HENFLG
                 CALL   "ORCSJGNGET"      USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
                 IF     LNK-ORCSJGNGET-RC     =   ZERO
                   MOVE   LNK-ORCSJGNGET-TAISYOKBN
                             TO    WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)
                   IF  (RECE62-SRYYM                >=  "201501")
                   AND (LNK-ORCSJGNGET-TEKIYOFLG     =   1      )
                   AND (TBL-TOKATUKAIFLG(KOHFTN-IDX) =   ZERO   )
                     MOVE  1   TO  WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
      ***************MOVE  1   TO  TBL-TOKATUKAIFLG(KOHFTN-IDX)
                   END-IF
                 END-IF
      *
              END-IF
      *
             END-PERFORM
      *
           END-IF
      *
           .
       2118-ETCKISAIFLGINF-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2101-RECE64-HENSYU-SEC                SECTION.
      *
           INITIALIZE                           SRYACCT-REC
           MOVE    RECE62-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE62-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE62-PTID          TO      ACCT-PTID
      ***  MOVE    RECE62-SRYKA(IDX)    TO      ACCT-SRYKA
           MOVE    RECE62-SRYYM         TO      ACCT-SRYYM
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"        TO      MCP-TABLE
           IF      WRK-PARA-PRTKBN     =   "4" OR "5" OR "9" OR "8"
               MOVE    "key63"             TO  WRK-SRYACCT-PATHNAME
           ELSE
               MOVE    "key33"             TO  WRK-SRYACCT-PATHNAME
           END-IF
           MOVE    WRK-SRYACCT-PATHNAME
                                       TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryacct"    TO      MCP-TABLE
               MOVE    WRK-SRYACCT-PATHNAME
                                       TO  MCP-PATHNAME
               PERFORM  900-SRYACCT-READ-SEC
               PERFORM  UNTIL
                  (FLG-SRYACCT        =    1)
                   PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE62-HKNCOMBI (IDX1)  =   ZERO 
                       IF      ACCT-HKNCOMBI   =
                                               RECE62-HKNCOMBI (IDX1)
      *
                           MOVE   ZERO           TO  FLG-TENTEKIMATOME
                           IF    ACCT-SRYKBN  =  "33"
                              PERFORM   21015-TENTEKIMATOME-CHECK-SEC
                           END-IF
      *
                           PERFORM   21016-FLG-KURIA-SEC
      *
                           IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                                (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                                (FLG-TENTEKIMATOME  =    ZERO)
                               IF  (ACCT-SRYKBN     = "97"     )
                               AND (ACCT-SRYCDTOTAL = 197000470
                                                   OR 197001570
                                                   OR 197001210)
                                 IF  (RECE62-SRYYM   >= "200604" )
                                 AND (ACCT-SRYCDTOTAL = 197000470
                                                     OR 197001570)
                                   PERFORM   21011-RECE64-TENSOU-SEC
                                   PERFORM   21012-RECE65-HENSYU-SEC
                                   IF    FLG-WRITE65  =   1
                                     PERFORM RECE64-WRITE-SEC
                                   END-IF
                                 END-IF
                               ELSE
                                 PERFORM   21011-RECE64-TENSOU-SEC
                                 PERFORM   21012-RECE65-HENSYU-SEC
                                 IF    FLG-WRITE65  =   1
                                   PERFORM RECE64-WRITE-SEC
                                 END-IF
                               END-IF
                           ELSE
                             IF   (ACCT-ZAIKAISU     NOT =  ZERO )
                             AND  (FLG-TENTEKIMATOME     =  ZERO )
                             AND  (ACCT-JIHOKBN          =  SPACE)
                               IF ( ACCT-SRYKBN  NOT =
                                    "12" AND "25" AND "93" AND "98")
                               OR ( ACCT-ZAIKBN  =   1             )
                                 IF  (ACCT-SRYCDTOTAL(1:12)  =
                                                    "000000999901")
                                 AND (ACCT-MEISAISU      =   1    )
                                      MOVE    1    TO      FLG-TOKKI
                                      PERFORM   21013-TOKKI-HENSYU-SEC
                                 ELSE
                                      IF    ACCT-SRYKBN  =
                                            "60" OR "64" OR "80"
                                        PERFORM 21014-SINRYO-CHECK-SEC
                                      END-IF
                                      PERFORM   21011-RECE64-TENSOU-SEC
                                      PERFORM   21012-RECE65-HENSYU-SEC
                                      IF    FLG-WRITE65  =   1
                                        PERFORM RECE64-WRITE-SEC
                                      END-IF
                                 END-IF
                               END-IF
                             ELSE
                               IF   (ACCT-ZAIKAISU     NOT =  ZERO )
                               AND  (FLG-TENTEKIMATOME     =  ZERO )
                               AND  (ACCT-JIHOKBN      NOT =  SPACE)
                               AND  (ACCT-ZAIKBN       =  3 OR 4   )
                                      PERFORM   21011-RECE64-TENSOU-SEC
                                      PERFORM   21012-RECE65-HENSYU-SEC
                                      IF    FLG-WRITE65  =   1
                                        PERFORM RECE64-WRITE-SEC
                                      END-IF
                               END-IF
                             END-IF
                           END-IF
                           MOVE    10                TO  IDX1
                       END-IF
                   END-PERFORM          
                   MOVE    "tbl_sryacct"     TO      MCP-TABLE
                   MOVE    WRK-SRYACCT-PATHNAME
                                             TO  MCP-PATHNAME
                   PERFORM   900-SRYACCT-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SRYACCT SELECT ERR" 
           END-IF
      *
           MOVE    "tbl_sryacct"      TO      MCP-TABLE
           MOVE    WRK-SRYACCT-PATHNAME
                                      TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       2101-RECE64-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21011-RECE64-TENSOU-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    ACCT-SRYKBN          TO      RECE64-SRYKBN
           IF     (ACCT-SRYKBN      =  "90"                  )
           AND    (ACCT-SRYCDTOTAL  =  190182690 OR 190876890
                                    OR 190814410 OR 190876910)
             MOVE    "92"               TO      RECE64-SRYKBN
           END-IF
           IF      ACCT-SRYKBN = "90" OR "92" OR "12"
                 MOVE    "6"            TO      RECE64-ZAISKBKBN
           ELSE 
              IF   ACCT-SRYKBN = "97"
      ***        MOVE    "4"            TO      RECE64-ZAISKBKBN
                 MOVE    "9"            TO      RECE64-ZAISKBKBN
                 IF   ACCT-ZAITEN  =  ZERO
                   MOVE  "A"            TO      RECE64-ZAISKBKBN
                 END-IF
              END-IF
           END-IF
           MOVE    ACCT-ZAINUM          TO      RECE64-ZAINUM
           MOVE    ZERO                 TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    ACCT-SRYKA           TO      RECE64-SRYKA
           MOVE    ACCT-HKNCOMBI        TO      RECE64-HKNCOMBI
           MOVE    ACCT-JIHOKBN         TO      RECE64-JIHOKBN
           MOVE    ACCT-ZAITEN          TO      RECE64-ZAITEN
           MOVE    ACCT-SRYCDTOTAL      TO      RECE64-SRYCDTOTAL
           MOVE    ACCT-SURYOUTOTAL     TO      RECE64-SURYOUTOTAL
           MOVE    ACCT-MEISAISU        TO      RECE64-MEISAISU
           MOVE    ACCT-ZAIKAISU        TO      RECE64-ZAIKAISU
           MOVE    ACCT-SYUTEN1         TO      RECE64-SYUTEN1
           MOVE    ACCT-SYUTEN2         TO      RECE64-SYUTEN2
           MOVE    ACCT-YKZTEN          TO      RECE64-YKZTEN
           MOVE    ACCT-KIZAITEN        TO      RECE64-KIZAITEN
           MOVE    ACCT-DRCD            TO      RECE64-DRCD
           MOVE    ACCT-ZAIREQFLG       TO      RECE64-ZAIREQFLG
           MOVE    ACCT-TEIGENRATE      TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX3   FROM    1    BY   1
                       UNTIL     IDX3   >       4
               PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    ACCT-DAY(IDX3 IDX2)  TO
                                            RECE64-KAISU (IDX3 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
                   IF     (IDX3                         =  1  )
                   AND    (RECE64-KAISU(IDX3 IDX2)  NOT = ZERO)
                       MOVE     RECE64-HKNCOMBI
                                        TO  RECE64-HKNCOMBI-DAY(IDX2)
                   END-IF
               END-PERFORM
           END-PERFORM
      *
           MOVE      ZERO     TO    FLG-OKIKAE
           IF   ( RECE62-AGE       >=  75        )
           OR   ( RECE62-BIRTHDAY  <  "19321001" )
               PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL    ( IDX2        >    31 )
                             OR     ( FLG-OKIKAE  =     1 )
                  IF  ( RECE62-BYOTOSYUBETU(IDX2) =  "02" OR "03" )
                  AND ( RECE64-KAISU(1 IDX2)  NOT =  ZERO         )
                        MOVE   1   TO   FLG-OKIKAE
                  END-IF    
               END-PERFORM
           END-IF
      *
           IF    FLG-RINYAK    NOT =    ZERO
                MOVE    FLG-RINYAK    TO     RECE64-SAFLG
           END-IF
      *
           .
       21011-RECE64-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       21012-RECE65-HENSYU-SEC               SECTION.
      *
           INITIALIZE     TBL-RECECOMCHK
      *
           INITIALIZE     WRK-ORCSGETGE-OUT-AREA
           MOVE    ZERO                 TO      FLG-IRYORENKEI
           IF    ((WRK-PARA-PRTKBN  =  "9"                     ) AND
                  (RECE62-SRYYM         >=   "201204"          ))
           OR    ((WRK-PARA-PRTKBN  =  "2" OR "3" OR "4" OR "5") AND
                  (SYS-200501-INSPECT-GENERAL-KBN  =   "1"     ) AND
                  (RECE62-SRYYM         >=   "201204"          ))
             PERFORM 210123-IRYORENKEI-HENSYU-SEC
           END-IF
           MOVE    ZERO                 TO      IDX17
      *
           MOVE    ZERO                 TO      FLG-GENTENCD-ARI
      *
           INITIALIZE                           SRYACT-REC
           MOVE    ACCT-HOSPNUM         TO      SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN       TO      SRY-NYUGAIKBN
           MOVE    ACCT-PTID            TO      SRY-PTID
      ***  MOVE    ACCT-SRYKA           TO      SRY-SRYKA
           MOVE    ACCT-SRYYM           TO      SRY-SRYYM
           MOVE    ACCT-ZAINUM          TO      SRY-ZAINUM
           MOVE    SRYACT-REC           TO      MCPDATA-REC
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key9"               TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
                   MOVE    ZERO         TO      FLG-ZANHAIKI
                                                FLG-FORMAL-KISAI
                   MOVE    ZERO         TO      WRK-RENNUM
                                                WRK-RENNUM2
                   MOVE    ZERO         TO      FLG-WRITE65X
                   PERFORM   210121-RECE65-TENSOU-SEC
                   IF   FLG-TENTEKI  =  ZERO
                     IF   ACCT-JIHOKBN    =  SPACE
                     AND  FLG-HENSYU-NG2  =  ZERO
                       PERFORM 210122-RECE62-HENSYU-SEC
                     END-IF
                     IF   FLG-WRITE65X  =  1
                       PERFORM RECE65-WRITE-SEC
                       MOVE  1  TO  FLG-WRITE65
                     END-IF
                   END-IF
                   IF  FLG-ZANHAIKI      =  1
                   OR  FLG-FORMAL-KISAI  =  1
                      PERFORM  RECE65-REWRITE-SEC
                   END-IF
                   MOVE    "tbl_sryact"      TO      MCP-TABLE
                   MOVE    "key9"            TO      MCP-PATHNAME
                   PERFORM   900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"      TO      MCP-TABLE
           MOVE    "key9"            TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           IF     WRK-FILMTEN  NOT =  ZERO
                COMPUTE    RECE64-SYUTEN2  =  WRK-FILMTEN + 0.5
           END-IF
      *
           IF   RECE62-SRYYM  >=  "202004"
                PERFORM    210124-RECECOMCHK-SEC
           END-IF
      *
           IF   FLG-TOK11         =   1
           AND  FLG-TOK11-COM     =  ZERO
           AND  RECE64-TOYAKUFLG  =  SPACE
                MOVE    9    TO      FLG-TOKKI
                PERFORM   21013-TOKKI-HENSYU-SEC
           END-IF
      *
           IF   FLG-TOK12         =   1
           AND  RECE64-TOYAKUFLG  =  SPACE
                MOVE   10    TO      FLG-TOKKI
                PERFORM   21013-TOKKI-HENSYU-SEC
           END-IF
      *
           IF   FLG-TOK36         =   1
           AND  RECE64-TOYAKUFLG  =  SPACE
                MOVE   17    TO      FLG-TOKKI
                PERFORM   21013-TOKKI-HENSYU-SEC
           END-IF
      *
           .
       21012-RECE65-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       210121-RECE65-TENSOU-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           MOVE    SRY-ZAINUM           TO      RECE65-ZAINUM
           MOVE    ZERO                 TO      RECE65-ZAIREN
           MOVE    SRY-RENNUM           TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    SRY-SRYKA            TO      RECE65-SRYKA
           MOVE    SRY-SRYKBN           TO      RECE65-SRYKBN
           MOVE    SRY-SRYSYUKBN        TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           IF     (ACCT-SRYKBN      =  "90"                  )
           AND    (ACCT-SRYCDTOTAL  =  190182690 OR 190876890
                                    OR 190814410 OR 190876910)
             MOVE    "92"               TO      RECE65-SRYKBN
             MOVE    "920"              TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           END-IF
           MOVE    SRY-JIHIMONEYTOTAL   TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (SRY-SRYCD(IDX2)  =   SPACE)
      *
            ADD    1                    TO      IDX17
      *
      *     老人精神病棟等の診療行為コード置き換え
            IF   RECE62-SRYYM  >= "200604"
              CONTINUE
            ELSE
              IF   FLG-OKIKAE   =   1
                EVALUATE  SRY-SRYCD(IDX2)
      *           血液学的検査判断料
                  WHEN  "160061810"
                      MOVE  "160703610"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           検体検査管理加算（１）
                  WHEN  "160170170"
                      MOVE  "160710070"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  539900
      *           検体検査管理加算（２）
                  WHEN  "160161610"
                      MOVE  "160709310"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  547700
      *           生化学的検査（１）判断料
                  WHEN  "160061910"
                      MOVE  "160703710"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           生化学的検査（２）判断料
                  WHEN  "160062010"
                      MOVE  "160703810"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           尿・糞便等検査判断料
                  WHEN  "160061710"
                      MOVE  "160703510"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           微生物学的検査判断料
                  WHEN  "160062210"
                      MOVE  "160704010"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
      *           免疫学的検査判断料
                  WHEN  "160062110"
                      MOVE  "160703910"  TO  SRY-SRYCD(IDX2)
                      COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                                  +  641800
                END-EVALUATE
              END-IF
            END-IF
      *
            MOVE    SRY-SRYCD(IDX2)    TO    WRK-SRYCD
            MOVE    RECE65-SRYYM       TO    WK-TAIHI-SRYYM
            MOVE    WK-TAIHI-DAY       TO    WK-TAIHI-SRYD
            PERFORM    900-TENSU-TBL-SEC
      *
            IF   (RECE62-SRYYM     >=  "202210")
            AND  (ACCT-SRYKBN       =  "11"    )
            AND  (ACCT-ZAITEN       =  ZERO    )
            AND  (SRY-RENNUM        =   1      )
            AND  (TNS-TENSIKIBETU   =   8      )
                  MOVE    1     TO    FLG-GENTENCD-ARI
                  MOVE    1     TO    RECE62-SKYZEROFLG
            END-IF
      *
            IF     ( SRY-SRYCD(IDX2)(1:1)  =  "S"   )
                  COMPUTE   RECE64-MEISAISU  =  RECE64-MEISAISU
                                             -  1
            END-IF
      *
            IF       SRY-SRYCD(IDX2)   =  "099999909"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    RECE62-ICBKINKSI-NASI
                  MOVE    2     TO    FLG-KIN-OKIKAE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999910"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    RECE62-ICBKINKSI-ARI
                  MOVE    1     TO    FLG-KIN-OKIKAE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999921"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    RECE62-KOHCHIKAN
                  MOVE    1     TO    FLG-KIN-OKIKAE2
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999922"
               IF    (ACCT-JIHOKBN            =   SPACE)
               AND   (RECE62-DAISANFLG(IDX1)  =    1   )
                  MOVE    1     TO    FLG-KIN-OKIKAE3
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999946"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    FLG-ONSHI-HEN
                  MOVE    1     TO    RECE62-ONSHI-MSTFLG
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999945"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    FLG-ONSHI-HEN2
                  MOVE    1     TO    RECE62-ONSHI-KSKFLG
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999923" OR "099999924" OR
                                          "099999925" OR "099999930" OR
                                          "099999931" OR "099999944"
                  MOVE    1     TO    FLG-HENSYU-NG
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099999929"
                  MOVE    1     TO    FLG-HENSYU-NG
                  MOVE    1     TO    RECE62-SKYZEROFLG
            END-IF
            IF       SRY-SRYCD(IDX2)(1:5)  =
                     "09960" OR "09970" OR "09980" OR "09983"
                  MOVE    1     TO    FLG-HENSYU-NG
            END-IF
            IF       SRY-SRYCD(IDX2)  =  "099999935" OR "099999936" OR
                                         "099999937" OR "099999938" OR
                                         "099999939" OR "099999940" OR
                                         "099999941" OR "099999942" OR
                                         "099999943"
               IF    ACCT-JIHOKBN     =   SPACE
                  EVALUATE  SRY-SRYCD(IDX2)
                    WHEN     "099999935"
                      IF  RECE62-RIHA2-SINDAI(IDX1)   = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    1     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999936"
                      IF  RECE62-RIHA2-NOUKE(IDX1)    = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    2     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999937"
                      IF  RECE62-RIHA2-UNDOKI(IDX1)   = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    3     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999938"
                      IF  RECE62-RIHA2-KOKYUKI(IDX1)  = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    4     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999939"
                      IF  RECE62-RIHA2-SESSYOKU(IDX1) = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    5     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999940"
                      IF  RECE62-RIHA2-HAIYO(IDX1)    = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    6     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999941"
                      IF  RECE62-RIHA2-SINDAI9(IDX1)  = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    7     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999942"
                      IF  RECE62-RIHA2-KOKYUKI9(IDX1) = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    8     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999943"
                      IF  RECE62-RIHA2-HAIYO9(IDX1)   = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    9     TO    FLG-RIHA-OKIKAE
                      END-IF
                  END-EVALUATE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
            END-IF
            IF       SRY-SRYCD(IDX2)   =  "099140004" OR "099400001"
                                       OR "099400002" OR "099400003"
                                       OR "099140011" OR "099140012"
                  MOVE    1     TO    FLG-HENSYU-NG
            END-IF
      *
            IF       RECE62-DAISANFLG(IDX1)  =   1
               IF  (ACCT-SRYKBN             =  "80"              )
               AND (SRY-SRYCD(IDX2)(1:5)    =
                         "09591" OR "09592" OR "09593" OR "09594")
                 IF   (FLG-HENSYU-ARI      =    ZERO)
                 AND  (ACCT-JIHOKBN        =   SPACE)
                 AND  (ACCT-ZAITEN     NOT =    ZERO)
                 AND  (ACCT-ZAIKAISU   NOT =    ZERO)
                   COMPUTE  RECE62-TOTALTEN(1) =  RECE62-TOTALTEN(1) -
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                   COMPUTE  RECE62-HENTOTALTEN(1) 
                                            =  RECE62-HENTOTALTEN(1) -
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                   MOVE     1     TO     FLG-HENSYU-ARI
                 END-IF
                 MOVE       1     TO     FLG-HENSYU-NG2
               END-IF
            END-IF
      *
            IF     ( SRY-SRYCD(IDX2)(1:3)  =  "001"        )
            OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                    (TNS-TEN               =  ZERO ) AND
                    (ACCT-ZAIKBN       NOT =   1   )       )
            OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
            OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                           OR "0086"       )
            OR     ((SRY-SRYSYUKBN  = "330" OR "331" OR
                                      "332" OR "350" OR
                                      "352"               ) AND
                    ((SRY-SRYCD(IDX2)(1:1) =   "8"       ) OR
                     (SRY-SRYCD(IDX2)(1:3) =   "008"     )) AND
                    ( ACCT-ZAITEN      NOT =   ZERO       ) AND
                    ( ACCT-SYUTEN1         =   ZERO       ) AND
                    ( ACCT-ZAIKAISU    NOT =   ZERO       ) AND
                    ( ACCT-JIHOKBN         =   SPACE      ))
            OR     ( FLG-KIN-OKIKAE    NOT =  ZERO         )
            OR     ( FLG-KIN-OKIKAE2   NOT =  ZERO         )
            OR     ( FLG-KIN-OKIKAE3   NOT =  ZERO         )
            OR     ( FLG-ONSHI-HEN     NOT =  ZERO         )
            OR     ( FLG-ONSHI-HEN2    NOT =  ZERO         )
            OR     ( FLG-RIHA-OKIKAE   NOT =  ZERO         )
            OR     ( FLG-HENSYU-NG     NOT =  ZERO         )
            OR     ( FLG-HENSYU-NG2    NOT =  ZERO         )
            OR     ( SRY-SRYCD(IDX2)       =
                     "099209902" OR "099209903" OR
                     "099209904" OR "099209905" OR
                     "099209906" OR "099209907" OR
                     "099209908" OR
                     "099999903" OR "099999904" OR
                     "099999905" OR "099999906" OR
                     "099999907" OR "099999908" OR
                     "099200101" OR "099999926" OR
                     "099999927" OR "099999928" OR
                     "099999934" OR
                     "099209811" OR "099209812" OR
                     "099209821" OR "099209822" OR
                     "099209711" OR "099209712" OR
                     "099209721" OR "099209722" OR
                     "099208101" OR "099208102" OR
                     "840000136" OR "840000140" OR
                     "099114001" OR "099140001" OR
                     "099140003" OR "099409905" OR
                     "099409906" OR "099409907" OR
                     "099409908" OR "099409909" OR
                     "099200301"                           )
      *
                  PERFORM   2101216-MEISAISU-HENSYU-SEC
      *
            END-IF
      *
            IF       SRY-SRYCD(IDX2)(1:7) = "0999901"
                  COMPUTE   RECE64-MEISAISU    =  RECE64-MEISAISU
                                               -  1
                  MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
                  COMPUTE   RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                               -  WRK-SRYCD
                  COMPUTE   RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                               -  1
                  MOVE    2    TO      FLG-TOKKI
                  PERFORM   21013-TOKKI-HENSYU-SEC
            END-IF
      *
            IF      SRY-SRYCD(IDX2)  =
                    "820000053" OR "820000054" OR "820000055" OR
                    "830100457" OR "830100372" OR "830100534"
                  MOVE    3    TO      FLG-TOKKI
                  PERFORM   21013-TOKKI-HENSYU-SEC
            END-IF
      *
            IF   ACCT-ZAIKBN       =     1
               IF      SRY-SRYCD(IDX2)  =
                       "820000094" OR "630010011" OR "630010012" OR
                       "630010013"
                    MOVE    1    TO      FLG-TOK11
               ELSE
                 IF   (SRY-SRYCD(IDX2)(1:3)  =  "059"           )
                 AND  (TNS-TEN               =  ZERO            )
                 AND  (TNS-KANANAME(1:14)    =  "コロナトクレイ")
                    MOVE    1    TO      FLG-TOK11-COM
                 END-IF
               END-IF
               IF   (FLG-TOK11      =  1                     )
               AND  (FLG-TOK11-COM  =  1                     )
               AND  (SRY-SRYSYUKBN  = "212" OR "292" OR "148")
                    MOVE   "1"         TO    RECE64-VIRUSFLG
                    MOVE   "80"        TO    RECE64-SRYKBN
                                             RECE65-SRYKBN
                    MOVE   "800"       TO    RECE64-SRYSYUKBN
                                             RECE65-SRYSYUKBN
                    MOVE   SPACE       TO    RECE64-TOYAKUFLG
               END-IF
      *
               IF      SRY-SRYCD(IDX2)  =  "820000095"
                    MOVE    1    TO      FLG-TOK12
               END-IF
      *
               IF     (RECE62-SRYYM    >=  "201411"   )
               AND    (SRY-SRYCD(IDX2)  =  "820000171")
                    MOVE    1    TO      FLG-TOK36
               END-IF
      *
               IF   (RECE64-VIRUSFLG = SPACE             )
               AND  (SRY-SRYSYUKBN   =
                     "212" OR "292" OR "222" OR "232" OR
                     "295" OR "298" OR "148" OR "149"    )
               AND  (RECE62-SRYYM   >=  "202203"         )
                    MOVE   "1"         TO    RECE64-TOYAKUFLG
               END-IF
            END-IF
      *
            IF      SRY-SRYCD(IDX2)(1:1)     =   "0" OR  "1" OR
                                                 "6" OR  "7" OR
                                                 "8"
      *
             IF  (  SRY-SRYSYUKBN            = "330" OR "331"  OR      
                                               "332" OR "350"  OR
                                               "352" )
             AND (( SRY-SRYCD(IDX2)(1:3)     = "059"             ) OR  
                  ( SRY-SRYCD(IDX2)(1:1)     = "7"               ) OR  
                  ( SRY-SRYCD(IDX2)          = "099309901"       ) OR
                  ( SRY-SRYCD(IDX2)(1:1)     = "6"               ))    
             AND (  ACCT-ZAITEN          NOT = ZERO  )
      *******AND (  ACCT-SYUTEN1             = ZERO  )
             AND (  ACCT-ZAIKAISU        NOT = ZERO  )
             AND (  ACCT-JIHOKBN             = SPACE )
      *
              MOVE    1                  TO    FLG-TENTEKI             
      *
             ELSE                                                      
      *
              IF     ( SRY-SRYCD(IDX2)(1:7)  =  "0999901"    )
              OR     ( SRY-SRYCD(IDX2)(1:3)  =  "001"        )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                      (TNS-TEN               =  ZERO ) AND
                      (ACCT-ZAIKBN       NOT =   1   )       )
              OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
              OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                             OR "0086"       )
              OR     ((SRY-SRYSYUKBN  = "330" OR "331" OR
                                        "332" OR "350" OR
                                        "352"               ) AND
                      ((SRY-SRYCD(IDX2)(1:1) =   "8"       ) OR
                       (SRY-SRYCD(IDX2)(1:3) =   "008"     )) AND
                      ( ACCT-ZAITEN      NOT =   ZERO       ) AND
                      ( ACCT-SYUTEN1         =   ZERO       ) AND
                      ( ACCT-ZAIKAISU    NOT =   ZERO       ) AND
                      ( ACCT-JIHOKBN         =   SPACE      ))
              OR     ( FLG-KIN-OKIKAE    NOT =  ZERO         )
              OR     ( FLG-KIN-OKIKAE2   NOT =  ZERO         )
              OR     ( FLG-KIN-OKIKAE3   NOT =  ZERO         )
              OR     ( FLG-ONSHI-HEN     NOT =  ZERO         )
              OR     ( FLG-ONSHI-HEN2    NOT =  ZERO         )
              OR     ( FLG-RIHA-OKIKAE   NOT =  ZERO         )
              OR     ( FLG-HENSYU-NG     NOT =  ZERO         )
              OR     ( FLG-HENSYU-NG2    NOT =  ZERO         )
              OR     ( SRY-SRYCD(IDX2)       =
                       "099209902" OR "099209903" OR
                       "099209904" OR "099209905" OR
                       "099209906" OR "099209907" OR
                       "099209908" OR
                       "099999903" OR "099999904" OR
                       "099999905" OR "099999906" OR
                       "099999907" OR "099999908" OR
                       "099200101" OR "099999926" OR
                       "099999927" OR "099999928" OR
                       "099999934" OR
                       "099209811" OR "099209812" OR
                       "099209821" OR "099209822" OR
                       "099209711" OR "099209712" OR
                       "099209721" OR "099209722" OR
                       "099208101" OR "099208102" OR
                       "840000136" OR "840000140" OR
                       "099114001" OR "099140001" OR
                       "099140003" OR "099409905" OR
                       "099409906" OR "099409907" OR
                       "099409908" OR "099409909" OR
                       "099200301"                           )
      *
               IF   FLG-KIN-OKIKAE   NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM  =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM
                   MOVE   FLG-KIN-OKIKAE  TO   WRK-TAIHI-OKIKAE
                   IF  SRY-SRYCD(IDX2) = "099999910" OR "099999909"
                     CONTINUE
                   ELSE
                     PERFORM   2101215-ICHIBUCOM-HENSYU-SEC
                   END-IF
                 END-IF
               END-IF
               IF   FLG-KIN-OKIKAE2  NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM2 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM2
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM2
                   MOVE   FLG-KIN-OKIKAE2 TO   WRK-TAIHI-OKIKAE2
                   IF  SRY-SRYCD(IDX2) = "099999921"
                     CONTINUE
                   ELSE
                     PERFORM   2101215-ICHIBUCOM-HENSYU2-SEC
                   END-IF
                 END-IF
               END-IF
               IF   FLG-KIN-OKIKAE3  NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM3 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM3
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM3
                   IF  SRY-SRYCD(IDX2) = "099999922"
                     CONTINUE
                   ELSE
                     PERFORM   2101215-ICHIBUCOM-HENSYU3-SEC
                   END-IF
                 END-IF
               END-IF
               IF   FLG-ONSHI-HEN    NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM4 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM4
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM4
                   PERFORM   210121A-MSTCOM-HENSYU-SEC
                 END-IF
               END-IF
               IF   FLG-ONSHI-HEN2   NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM5 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM5
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM5
                   PERFORM   210121B-KSKCOM-HENSYU-SEC
                 END-IF
               END-IF
               IF   FLG-RIHA-OKIKAE  NOT =  ZERO
                     PERFORM   2101217-RIHAYMD-HENSYU-SEC
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-KIZAITEN =  ZERO                        )
                 IF    SRY-SRYCD(IDX2)(1:3)  =  "059"
                 AND   TNS-TEN               =  ZERO
                   MOVE    1    TO    FLG-KIZ-PRTKBN
                 END-IF
               END-IF
      *
               IF      SRY-SRYCD(IDX2)    =     "099209811"
                  MOVE   "1"    TO    RECE64-JISANYAKKBN
               END-IF
               IF      SRY-SRYCD(IDX2)    =     "099209812"
                  MOVE   "2"    TO    RECE64-JISANYAKKBN
               END-IF
               IF      SRY-SRYCD(IDX2)    =     "099209821"
                  MOVE   "3"    TO    RECE64-JISANYAKKBN
               END-IF
               IF      SRY-SRYCD(IDX2)    =     "099209822"
                  MOVE   "4"    TO    RECE64-JISANYAKKBN
               END-IF
      *
               IF      SRY-SRYCD(IDX2)    =     "099209711"
                  MOVE   "5"    TO    RECE64-JISANYAKKBN
               END-IF
               IF      SRY-SRYCD(IDX2)    =     "099209712"
                  MOVE   "6"    TO    RECE64-JISANYAKKBN
               END-IF
               IF      SRY-SRYCD(IDX2)    =     "099209721"
                  MOVE   "7"    TO    RECE64-JISANYAKKBN
               END-IF
               IF      SRY-SRYCD(IDX2)    =     "099209722"
                  MOVE   "8"    TO    RECE64-JISANYAKKBN
               END-IF
      *
              ELSE
      *
               ADD     1                  TO    IDX4    
      *
               MOVE    SRY-SRYCD(IDX2)    TO    RECE65-SRYCD(IDX4)
      *
               IF     SRY-SRYCD(IDX2)      =    "160177770"
                  MOVE   "1"              TO    RECE62-KENTAIKASANFLG
                  MOVE   99               TO    RECE64-KNSJISGRPKBN
               END-IF
               IF     RECE64-KNSJISGRPKBN  =    ZERO
                 IF    TNS-KNSJISGRPKBN = 1 OR 2 OR 3 OR 4 OR 5 OR 6
                  MOVE  TNS-KNSJISGRPKBN  TO    RECE64-KNSJISGRPKBN
                 END-IF
               END-IF
      *
      ***      IF     SRY-SRYCD(IDX2)  =  "190128410" OR "190128310"
      ***                                             OR "190128570"
      ***         MOVE      1             TO    RECE64-NYUKSNFLG
      ***      END-IF
      *
               IF    ( ACCT-SRYKBN        =     "60" OR "64" )
               AND   ( TNS-KNSJISKBN      =      2           )
                   MOVE    TNS-KNSJISKBN        TO  RECE64-KNSJISKBN
               END-IF
      *
               IF    ( ACCT-SRYKBN  =  "14" OR "21" OR "22" OR "23" )
               AND   ( RECE64-ZAITEN     =     ZERO                 )
               AND   ( RECE64-SAFLG      =     SPACE                )
               AND   ( ACCT-ZAIKBN   NOT =     1                    )
                  IF   SRY-SRYCD(IDX2)   =     "820000046"
                     MOVE     "1"         TO    RECE64-SAFLG
                  END-IF
               END-IF
      *
               IF      ACCT-JIHOKBN  NOT =     SPACE
                  IF     RECE64-SAFLG   NOT =  SPACE
                        MOVE    "3"       TO    RECE64-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   RECE64-TOYAKUFLG = SPACE
                          MOVE  "4"       TO    RECE64-TOYAKUFLG
                        END-IF
                    ELSE
                        MOVE    "3"       TO    RECE64-TOYAKUFLG
                    END-IF
                  END-IF
               END-IF
      *
               IF    ( ACCT-SRYKBN  =  "21" OR "22" OR "23" )
               AND   ( RECE64-ZAITEN     =     ZERO         )
               AND   ( ACCT-ZAIKBN   NOT =     1            )
               AND   ( ACCT-JIHOKBN      =     SPACE        )
                  IF     RECE64-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE64-TOYAKUFLG
                        IF   (SRY-SRYSYUKBN  =  "212" OR "292" OR
                                                "222" OR "232" OR
                                                "295" OR "298")
                        AND  (RECE62-SRYYM  >=  "202203"      )
                            MOVE   "1"    TO    RECE64-TOYAKUFLG
                        END-IF
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "212" OR "292" OR
                                               "222" OR "232" OR
                                               "295" OR "298"
                          IF   RECE64-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE64-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE64-TOYAKUFLG
                        IF   (RECE65-SRYCD(IDX4)(1:1) = "6"   )
                        AND  (WRK-ORCSGETGE-GENERICNAME(IDX17)
                                                  NOT =  SPACE)
                          IF    WRK-PARA-PRTKBN  =  "9"
                            MOVE  "1"  TO  RECE65-INGAIFLG(IDX4)
                          ELSE
                            MOVE  "1"  TO  RECE65-INGAIFLG-RECE(IDX4)
                            MOVE  "1"  TO  RECE64-GENERICNAME-FLG
                          END-IF
                          MOVE  WRK-ORCSGETGE-YAKKAKJNCD(IDX17)
                                          TO    RECE65-YAKKAKJNCD(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERIC-KBN(IDX17)
                                          TO    RECE65-GENERIC-KBN(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERICNAME(IDX17)
                                          TO    RECE65-GENERICNAME(IDX4)
                          PERFORM  VARYING  IDX15  FROM  200  BY  -1
                                    UNTIL   IDX15   <     1
                            IF  RECE65-GENERICNAME(IDX4)(IDX15:1)
                                                        NOT =   SPACE
                               COMPUTE RECE65-GENERICYUKOKETA(IDX4) =
                                       IDX15  /  2
                               MOVE    1   TO  IDX15
                            END-IF
                          END-PERFORM
                        END-IF
                    END-IF
                  END-IF
      *
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                  OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                      CONTINUE
                  ELSE
                      MOVE      1         TO    WRK-DAISAN-INGAI(IDX1)
                  END-IF
               END-IF
      *
               IF    ( ACCT-SRYKBN       =     "14"  )
               AND   ( RECE64-ZAITEN     =     ZERO  )
               AND   ( ACCT-ZAIKBN   NOT =     1     )
               AND   ( ACCT-JIHOKBN      =     SPACE )
                  IF     RECE64-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE64-TOYAKUFLG
                        IF   (SRY-SRYSYUKBN  =  "148" OR "149")
                        AND  (RECE62-SRYYM  >=  "202203"      )
                            MOVE   "1"    TO    RECE64-TOYAKUFLG
                        END-IF
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "148" OR "149"
                          IF   RECE64-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE64-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE64-TOYAKUFLG
                        IF   (RECE65-SRYCD(IDX4)(1:1) = "6"   )
                        AND  (WRK-ORCSGETGE-GENERICNAME(IDX17)
                                                  NOT =  SPACE)
                          IF    WRK-PARA-PRTKBN  =  "9"
                            MOVE  "1"  TO  RECE65-INGAIFLG(IDX4)
                          ELSE
                            MOVE  "1"  TO  RECE65-INGAIFLG-RECE(IDX4)
                            MOVE  "1"  TO  RECE64-GENERICNAME-FLG
                          END-IF
                          MOVE  WRK-ORCSGETGE-YAKKAKJNCD(IDX17)
                                          TO    RECE65-YAKKAKJNCD(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERIC-KBN(IDX17)
                                          TO    RECE65-GENERIC-KBN(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERICNAME(IDX17)
                                          TO    RECE65-GENERICNAME(IDX4)
                          PERFORM  VARYING  IDX15  FROM  200  BY  -1
                                    UNTIL   IDX15   <     1
                            IF  RECE65-GENERICNAME(IDX4)(IDX15:1)
                                                        NOT =   SPACE
                               COMPUTE RECE65-GENERICYUKOKETA(IDX4) =
                                       IDX15  /  2
                               MOVE    1   TO  IDX15
                            END-IF
                          END-PERFORM
                        END-IF
                    END-IF
                  END-IF
      *
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                  OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                      CONTINUE
                  ELSE
                      MOVE      1         TO    WRK-DAISAN-INGAI(IDX1)
                  END-IF
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-YKZTEN =  ZERO                          )
                 IF  ( SYS-200501-15-YKZ-PRTKBN  =  "0" )
                 OR  ((SYS-200501-15-YKZ-PRTKBN  =  "1") AND
                      (RECE62-SRYYM  <  "201204"       ))
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "6"
                         MOVE   "1"    TO  RECE65-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE65-RECEPTFLG(IDX4)
                         MOVE    1     TO  FLG-YKZ-PRTKBN
                         PERFORM   2101216-MEISAISU-HENSYU-SEC
                   ELSE
                     IF  FLG-YKZ-PRTKBN  =  1
                       IF (( ACCT-ZAITEN           =  ZERO  ) AND
                           ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                            (SRY-SRYCD(IDX2)(1:3)  =  "008")))
                       OR (  SRY-MEISKYFLG(IDX2)   =  "2"    )
                         MOVE   "1"    TO  RECE65-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE65-RECEPTFLG(IDX4)
                         PERFORM   2101216-MEISAISU-HENSYU-SEC
                       ELSE
                         MOVE   ZERO   TO  FLG-YKZ-PRTKBN
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "6"
                         MOVE   "1"    TO  RECE64-YKZKISAIFLG
                   END-IF
                 END-IF
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-KIZAITEN =  ZERO                        )
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "7"
                   OR    SRY-SRYCD(IDX2)(1:3)  =  "058"
                     IF  ((ACCT-SRYKBN     = "70"                 ) AND
                          (TNS-DATAKBN     =  3                   ))
                     OR  ((ACCT-SRYKBN     = "70"                 ) AND
                          (SRY-SRYCD(IDX2) = "799990070"          ))
                         MOVE   ZERO   TO  FLG-KIZ-PRTKBN
                     ELSE
                         MOVE   "1"    TO  RECE65-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE65-RECEPTFLG(IDX4)
                         MOVE    1     TO  FLG-KIZ-PRTKBN
                         PERFORM   2101216-MEISAISU-HENSYU-SEC
                     END-IF
                   ELSE
                     IF  FLG-KIZ-PRTKBN  =  1
                       IF (( ACCT-ZAITEN           =  ZERO  ) AND
                           ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                            (SRY-SRYCD(IDX2)(1:3)  =  "008")))
                       OR (  SRY-MEISKYFLG(IDX2)   =  "2"    )
                         MOVE   "1"    TO  RECE65-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE65-RECEPTFLG(IDX4)
                         PERFORM   2101216-MEISAISU-HENSYU-SEC
                       ELSE
                         MOVE   ZERO   TO  FLG-KIZ-PRTKBN
                       END-IF
                     END-IF
                   END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)  IS  NUMERIC
               AND    FLG-YKZ-PRTKBN   =   ZERO
               AND    FLG-KIZ-PRTKBN   =   ZERO
      *          IF  SRY-SRYCD(IDX2)(1:3) NOT = "001"
                   MOVE    SRY-SRYCD(IDX2)   TO  WRK-SRYCD
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >    9
                     MOVE   SRY-SRYCD(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  RECE64-RUIKEITOTAL  =
                                RECE64-RUIKEITOTAL  +
                              ( WRK-FUKA-VALUE    * WRK-SRYCD)
                       COMPUTE  WRK-FUKA-KINGAKU    =
                                WRK-FUKA-KINGAKU    +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                  * SRY-SRYSURYO(IDX2))
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE64-RUIKEITOTAL  =
                            RECE64-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >   10
                     MOVE   SRY-SRYSURYO(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  WRK-FUKA-KINGAKU  =
                                WRK-FUKA-KINGAKU  +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX)
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE64-RUIKEITOTAL  =
                            RECE64-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *          END-IF
               END-IF
      *
               MOVE    SRY-SRYSURYO(IDX2) TO    RECE65-SRYSURYO(IDX4)
               MOVE    SRY-SRYKAISU(IDX2) TO    RECE65-SRYKAISU(IDX4)
               MOVE    SRY-MEISKYFLG(IDX2) TO   RECE65-MEISKYFLG(IDX4)
               MOVE    SRY-AUTOKBN(IDX2)  TO    RECE65-AUTOKBN(IDX4)
               MOVE    SRY-INPUTNUM(IDX2) TO    RECE65-INPUTNUM(IDX4)
      *
               IF    ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR "64"
                  IF   SRY-SRYCD(IDX2)(1:1)  =  "7"
                  AND  TNS-DATAKBN           =   3
                         COMPUTE WRK-FILMTEN2   =
                                (TNS-TEN  * SRY-SRYSURYO(IDX2) / 10)
                         IF   TNS-JGNTEN  NOT =  ZERO
                         AND  TNS-JGNTEN   <  WRK-FILMTEN2
                             COMPUTE  WRK-FILMTEN  =
                                      WRK-FILMTEN  +
                                      TNS-JGNTEN
                         ELSE
                             COMPUTE  WRK-FILMTEN  =
                                      WRK-FILMTEN  +
                                      WRK-FILMTEN2
                         END-IF
                  END-IF
               END-IF
      *
               IF      RECE62-RECESYUBETU  =  8888
               AND     SYS-2005-JIHITEKKSIKBN  =  "1"
                 IF      ACCT-SRYKBN   =     "95" OR "96"
                   IF      SRY-SRYCD(IDX2)(1:3)  =  "095" OR "096"
                     IF      SRY-SRYCD(IDX2)(1:5)  =  "09500" OR "09600"
                                                  OR  "09591" OR "09691"
                                                  OR  "09592" OR "09692"
                                                  OR  "09593" OR "09693"
                                                  OR  "09594" OR "09694"
                          CONTINUE
                     ELSE
                       IF     TNS-TEN     NOT =  ZERO
                          ADD     TNS-TEN    TO   RECE64-SYUTEN1
                          MOVE    "1"        TO   RECE62-JIHTEKFLG
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               IF      TNS-SRYKBN         =     "80"
                   IF  TNS-NYUTENTTLKBN   =     130
                       MOVE   "13"        TO    RECE64-SRYKBN
                                                RECE65-SRYKBN
                   END-IF
               END-IF
      *
               IF      TNS-SRYKBN         =     "12"
                 PERFORM  VARYING  IDX31  FROM  1  BY  1
                           UNTIL   IDX31    >  31
                   IF   ACCT-DAY(1 IDX31)   NOT =   ZERO
                     IF   RECE62-NYUDAY-SRYKBN(IDX31) = "90"
                       MOVE   "90"        TO    RECE64-SRYKBN
                                                RECE65-SRYKBN
                                                WRK-NYUSAI-SRYKBN
                     ELSE
                       MOVE   "92"        TO    RECE64-SRYKBN
                                                RECE65-SRYKBN
                                                WRK-NYUSAI-SRYKBN
                     END-IF
                     MOVE     "1"         TO    RECE64-NYUSAIFLG
                     MOVE      31         TO    IDX31
                   END-IF
                 END-PERFORM
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     "099309901"
                IF   ACCT-ZAIKBN  =  1
                  MOVE    "1"             TO  RECE65-RECEDENFLG(IDX4)
                  MOVE    "1"             TO  RECE65-RECEPTFLG(IDX4)
                  MOVE    ZERO            TO  RECE65-SRYSURYO(IDX4)
                ELSE
                  COMPUTE WRK-SRYSURYO2   =     WRK-SRYSURYO            
                                          +     0.99999                   
                  COMPUTE RECE65-SRYSURYO(IDX4)                         
                                          =     WRK-SRYSURYO2           
                                          -     WRK-SRYSURYO            
                  IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO                 
                    MOVE  WRK-TANICD      TO    RECE65-TANICD(IDX4)     
                    MOVE  WRK-TANIMOJISU  TO    RECE65-TANIMOJISU(IDX4) 
                    MOVE  WRK-TANINAME    TO    RECE65-TANINAME(IDX4)   
                    IF    RECE65-RENNUM  >  1                           
                    AND   IDX4           =  1                           
                      MOVE    1           TO    FLG-ZANHAIKI            
                      COMPUTE  WRK-RENNUM  =  RECE65-RENNUM  -  1       
                      MOVE WRK-SRYSURYO2  TO  WRK-SRYSURYO3             
                    ELSE                                                
                      MOVE WRK-SRYSURYO2  TO  RECE65-SRYSURYO(IDX4 - 1) 
                    END-IF
                  ELSE
                    MOVE  "1"             TO  RECE65-RECEDENFLG(IDX4)
                    MOVE  "1"             TO  RECE65-RECEPTFLG(IDX4)
                  END-IF                                                
                END-IF
               ELSE                                                     
                  MOVE    SRY-SRYSURYO(IDX2)                            
                                          TO    WRK-SRYSURYO            
                  IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO    RECE65-TANICD(IDX4)
                                                WRK-TANICD
                  END-IF
                  MOVE    TNS-TANIMOJISU  TO    RECE65-TANIMOJISU(IDX4)
                                                WRK-TANIMOJISU          
                  MOVE    TNS-TANINAME    TO    RECE65-TANINAME(IDX4)
                                                WRK-TANINAME            
               END-IF                                                   
               MOVE       TNS-TENSIKIBETU TO    RECE65-TENSIKIBETU(IDX4)
               MOVE       TNS-TEN         TO    RECE65-TEN(IDX4)
               MOVE    TNS-NYUTENTTLKBN   TO    RECE65-TENTTLKBN(IDX4)
               IF     (SRY-SRYCD    (IDX2)(1:1)     =   "8"  )
               OR     (SRY-SRYCD    (IDX2)(1:3)     =   "008")
                  MOVE ZERO               TO    RECE65-YUKOKETA(IDX4)
               ELSE
                  MOVE TNS-YUKOKETA       TO    RECE65-YUKOKETA(IDX4)
               END-IF
               MOVE    TNS-DATAKBN        TO    RECE65-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN      TO    RECE65-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN      TO    RECE65-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN      TO    RECE65-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO      TO    RECE65-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU       TO    RECE65-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
               MOVE    TNS-SRYSYUKBN  TO RECE65-SRYSYUKBN-X  (IDX4)
               MOVE    TNS-KOKUJISKBKBN1  
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
               MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE65-TIMEKSNKBN   (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-CHUKSNCD   TO RECE65-CHUKSNCD       (IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN    (IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT  (IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN   (IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1  (IDX4)
               MOVE    TNS-SANSOKBN   TO RECE65-SANSOKBN       (IDX4)
               IF      TNS-SRYCD (1:2)   =   "84"
                   PERFORM VARYING IDYY    FROM    1   BY  1
                           UNTIL   IDYY    >       10
                       MOVE    TNS-SSTKIJUNCD (IDYY)
                                           TO  RECE65-SSTKIJUNCD
                                                   (IDX4 IDYY)
                   END-PERFORM
               END-IF
      *
               IF    (TNS-SRYCD       =  "170022290"  OR
                                         "170022390"  OR
                                         "170022490")
               AND   (RECE62-SRYYM   <=  "201003"   )
                      MOVE   202      TO  RECE65-CDKBN-KBNNUM(IDX4)
                      MOVE   999      TO  RECE65-CDKBN-KOUBAN(IDX4)
               END-IF
               IF     TNS-SRYCD       =  "170016010"  OR
                                         "170020270"  OR  "170024470" OR
                                         "170024910"  OR  "170025010" OR
                                         "170025210"  OR  "170025310" OR
                                         "170025410"  OR  "170025510" OR
                                         "170025610"  OR  "170025710" OR
                                         "170025810"  OR  "170025910" OR
                                         "170026010"  OR  "170026110" OR
                                         "170026210"  OR  "170026310" OR
                                         "170026810"  OR
                                         "170000210"  OR  "170016910" OR
                                         "170017010"  OR  "170026710" OR
                                         "170028810"  OR
                                         "170035710"  OR  "170035810" OR
                                         "170035910"  OR  "170036010"
                      MOVE   203      TO  RECE65-CDKBN-KBNNUM(IDX4)
                      MOVE   999      TO  RECE65-CDKBN-KOUBAN(IDX4)
               END-IF
      *
               IF    (TNS-SRYCD       =  "170022290")
               AND   (RECE62-SRYYM   >=  "201004"   )
                      MOVE   "1"      TO  RECE64-GAZOGEN
               END-IF
      *
               MOVE   SRY-SRYCD(IDX2)      TO  WRK-TH-SRYCD
               MOVE   SRY-INPUTNUM(IDX2)   TO  WRK-TH-INPUTNUM
               MOVE   SRY-HOSPNUM          TO  WRK-TH-HOSPNUM
               MOVE   SRY-PTID             TO  WRK-TH-PTID
               MOVE   SRY-ZAINUM           TO  WRK-TH-ZAINUM
               MOVE   SRY-SRYKBN           TO  WRK-TH-SRYKBN
      *        コメント編集
               PERFORM   2101218-COMENT-HENSYU-SEC
      *
               IF      ACCT-JIHOKBN       =     SPACE
                  IF   RECE62-SRYYM      >=     "202004"
                    IF   (SRY-SRYCD(IDX2)(1:1) = "1" OR "8" )
                    AND  (SRY-SRYCD(IDX2)  NOT = "810000001")
                      INITIALIZE               ORCSRECECOMCHKAREA
                      MOVE  RECE62-NYUGAIKBN
                                            TO LNK-RECECOMCHK-NYUGAIKBN
                      MOVE  SRY-SRYCD(IDX2) TO LNK-RECECOMCHK-SRYCD
                      MOVE  RECE62-SRYYM    TO LNK-RECECOMCHK-SRYYM
                      MOVE  TBL-RECECOMCHK  TO LNK-RECECOMCHK-TBL-IN
                      CALL "ORCSRECECOMCHK" USING  ORCSRECECOMCHKAREA
                      IF    LNK-RECECOMCHK-RC  = ZERO
                        MOVE  LNK-RECECOMCHK-TBL-OUT
                                            TO TBL-RECECOMCHK
                      END-IF
                    END-IF
                    PERFORM  2101211-RECE65-COMCNT-HEN2-SEC
                  ELSE
                    PERFORM  2101211-RECE65-COMCNT-HEN-SEC
                  END-IF
               ELSE
                  IF   RECE64-SRYKBN      =     "50"
                     MOVE   "1"   TO    RECE64-FLG-SHUJUTU-COMMENT
                  END-IF
                  IF   RECE64-SRYKBN      =     "54"
                     MOVE   "1"   TO    RECE64-FLG-MASUI-COMMENT
                  END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     "099309901"
                  IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO
                    PERFORM  2101213-RECE65-SURYO-HEN-SEC
      *
                    MOVE    SPACE      TO  RECE65-NAME(IDX4)
                    MOVE    SPACE      TO  RECE65-INPUTCOMENT(IDX4)
      ***           STRING  TNS-NAME          DELIMITED  BY  " "
      ***                   "　"              DELIMITED  BY  SIZE
      ***                   WRK-SRYSURYOW     DELIMITED  BY  " "
      ***                   RECE65-TANINAME(IDX4)
      ***                                     DELIMITED  BY  " "
      ***                   INTO              RECE65-NAME(IDX4)
      ***           END-STRING
                    STRING  "（使用量　"      DELIMITED  BY  SIZE
                            WRK-SRYSURYOW     DELIMITED  BY  " "
                            RECE65-TANINAME(IDX4)
                                              DELIMITED  BY  " "
                            "　残量廃棄）"    DELIMITED  BY  SIZE
                            INTO              RECE65-NAME(IDX4)
                    END-STRING
                    MOVE  RECE65-NAME(IDX4)
                                       TO  RECE65-INPUTCOMENT(IDX4)
      *
      ***           MOVE  "810000001"  TO  RECE65-SRYCD(IDX4)
                    MOVE  ZERO         TO  RECE65-SRYSURYO(IDX4)
                    MOVE  ZERO         TO  RECE65-TANICD(IDX4)
                    MOVE  ZERO         TO  RECE65-TANIMOJISU(IDX4)
                    MOVE  SPACE        TO  RECE65-TANINAME(IDX4)
                    MOVE  ZERO         TO  RECE65-YUKOKETA(IDX4)
                    MOVE  "2"          TO  RECE65-MEISKYFLG(IDX4)
                  END-IF
               END-IF
      *
               IF    (SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                     (SRY-SRYCD    (IDX2)(1:3)     =   "008")
                        MOVE     "1"       TO    RECE64-COMCDFLG
               END-IF
      *
               IF  SRY-SRYCD(IDX2)(1:3)     =   "058"
                 MOVE  TNS-FORMALYUKOKETA TO  RECE65-YUKOKETA(IDX4)
                 MOVE  TNS-FORMALNAME     TO  RECE65-NAME(IDX4)
                                              WRK-FORMALNAME
                 MOVE  "1"                TO  RECE65-RECEDENFLG(IDX4)
      *
                 MOVE     TNS-TEN         TO  WRK-KZI058-TEN
                 IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO  WRK-KZI058-TANICD
                    MOVE  TNS-TANIMOJISU  TO  WRK-KZI058-TANIMOJISU
                    MOVE  TNS-TANINAME    TO  WRK-KZI058-TANINAME
                 END-IF
                 MOVE     ZERO            TO  RECE65-TEN(IDX4)
                 MOVE     ZERO            TO  RECE65-TANICD(IDX4)
                 MOVE     ZERO            TO  RECE65-TANIMOJISU(IDX4)
                 MOVE     SPACE           TO  RECE65-TANINAME(IDX4)
               END-IF
               IF  (SRY-SRYCD(IDX2)(1:1)    =   "7")
               AND (SRY-MEISKYFLG(IDX2)     =   "1")
                 IF   (ACCT-SRYKBN =   "70")
                 AND  (TNS-DATAKBN =    3  )
                    IF    RECE65-RENNUM  >  1
                    AND   IDX4           =  1
                      MOVE    1           TO  FLG-FORMAL-KISAI
                      COMPUTE  WRK-RENNUM2 =  RECE65-RENNUM  -  1
                    ELSE
                      MOVE  "1"           TO  RECE65-RECEPTFLG(IDX4 - 1)
                    END-IF
                 ELSE
                    MOVE  WRK-FORMALNAME  TO  RECE65-RECEDENNAME(IDX4)
                    MOVE  "1"             TO  RECE65-RECEHENFLG(IDX4)
                    IF    WRK-KZI058-TEN  NOT = ZERO
                       MOVE   WRK-KZI058-TEN
                                          TO  RECE65-TEN(IDX4)
                    END-IF
                    IF   (WRK-KZI058-TANICD  NOT = ZERO)
                    AND  (RECE65-TANICD(IDX4)    = ZERO)
                       MOVE   WRK-KZI058-TANICD
                                          TO  RECE65-TANICD(IDX4)
                       MOVE   WRK-KZI058-TANIMOJISU
                                          TO  RECE65-TANIMOJISU(IDX4)
                       MOVE   WRK-KZI058-TANINAME
                                          TO  RECE65-TANINAME(IDX4)
                    END-IF
                 END-IF
               END-IF
      *
               IF  (ACCT-SRYKBN        =  "99"       )
               AND (SRY-RENNUM         =   1         )
               AND (IDX2               =   1         )
               AND (SRY-SRYCD(IDX2)    =  "099999902")
                    MOVE      1         TO  FLG-TAHOKEN
               END-IF
               IF  (FLG-TAHOKEN           =   1              )
               AND (SRY-RENNUM            =   1              )
               AND (IDX2                  =   2              )
               AND (SRY-SRYCD(IDX2)(1:4)  =  "0082"          )
               AND (RECE65-NAME(IDX4)(1:14)
                                          =  "保険名称変更：")
                  MOVE     "1"          TO  RECE65-RECEPTFLG(IDX4)
                  MOVE     "1"          TO  RECE65-RECEDENFLG(IDX4)
      *
                  MOVE      ZERO        TO  IDW3
                  PERFORM   VARYING   IDW   FROM   300   BY  -1
                             UNTIL    IDW     <    15
                       IF  RECE65-NAME(IDX4)(IDW:1)  NOT =  SPACE
                           COMPUTE IDW6       =  (IDW / 2) - 7
                           MOVE    IDW        TO  IDW3
                           MOVE    1          TO  IDW
                       END-IF
                  END-PERFORM
                  IF     IDW3    NOT =  ZERO
                    MOVE  SPACE TO RECE65-NAME(IDX4 - 1)
                    COMPUTE   IDW4  =  IDW3  -  14
                    MOVE  RECE65-NAME(IDX4)(15:IDW4)
                                TO RECE65-NAME(IDX4 - 1)(1:IDW4)
                    COMPUTE   IDW5  =  IDW4  +   1
                    MOVE  "にて診察料算定済"
                                TO RECE65-NAME(IDX4 - 1)(IDW5:16)
                    COMPUTE   RECE65-YUKOKETA(IDX4 - 1) =
                              RECE65-YUKOKETA(IDX4 - 1) -
                              3                         +
                              IDW6
                  END-IF
               END-IF
      *
               IF  RECE65-YUKOKETA(IDX4)  =  ZERO
                   PERFORM   VARYING   IDW   FROM   300   BY  -1
                           UNTIL   IDW   <   1
                       IF   RECE65-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE65-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                   END-PERFORM
               END-IF
      *
      *        特定器材（画像診断のフィルム以外）のとき単価を編集
               IF      SRY-SRYCD (IDX2) (1:1)  =   "7"
                   IF   (  SRY-SRYCD (IDX2)         =
                                    "799990070"            OR
                                    "770020070"            OR
                                    "770030070"               )
      ***          OR   (  TNS-DATAKBN              =    3    )
                       CONTINUE
                   ELSE
      *********        SET     TBL-SANSO           TO  1
      *                SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
      *                     AT  END
      *                         MOVE    ZERO            TO  FLG-SANSO-OK
      *                     WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
      *                                                          (TBL-SANSO)
      *                         MOVE    1               TO  FLG-SANSO-OK
      *                END-SEARCH
      *********        IF      FLG-SANSO-OK        =   "1"
                     IF      RECE65-TEN(IDX4)  =   ZERO
                       CONTINUE
                     ELSE
                       PERFORM 2101212-RECE65-TANKA-HEN-SEC
                       COMPUTE IDW =   RECE65-YUKOKETA(IDX4)  *  2 
                                                   +   3                    
                       MOVE    WRK-CHAR-N (1:WRK-CHAR-N-CNT)
                                                   TO
                                               RECE65-NAME(IDX4)(IDW:)   
                       COMPUTE RECE65-YUKOKETA(IDX4)
                                               =   RECE65-YUKOKETA(IDX4)
                                                   +   1   
                                                   +
                                                  (WRK-CHAR-N-CNT  /  2)
                     END-IF
                   END-IF
               END-IF
      *
               MOVE    ACCT-ZAIKBN  TO  RECE64-ZAIKBN
      *
               IF      ACCT-ZAIKBN       =     1
                 MOVE   ZERO        TO  RECE65-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE65-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE65-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE65-TANINAME(IDX4)
                 IF  (SRY-SRYCD(IDX2)(1:1) = "6" OR "7")
                 OR  (SRY-SRYCD(IDX2)(1:3) = "059"     )
                 OR  (SRY-SRYCD(IDX2)(1:2) = "63"      )
                     MOVE  "1"          TO  RECE64-COMCDFLG
                     MOVE  "810000001"  TO  RECE65-SRYCD(IDX4)
                 END-IF
               END-IF
               IF      ACCT-ZAIKBN       =     2
                 MOVE   ZERO        TO  RECE65-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE65-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE65-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE65-TANINAME(IDX4)
               END-IF
      *
               PERFORM  2101214-SETCOM-HENSYU-SEC
      *
               IF   (RECE62-SRYYM           >= "201810")
               AND  (RECE62-SRYYM           <= "202003")
               AND  (SRY-SRYCD(IDX2)(1:4)    = "8201"  )
                 MOVE   "1"         TO  RECE64-SENTAKUCOMFLG
               END-IF
               IF   (RECE62-SRYYM           >= "202004")
               AND  (SRY-SRYCD(IDX2)(1:1)    = "8"     )
               AND  (SRY-SRYCD(IDX2)(4:1)    = "1"     )
                 MOVE   "1"         TO  RECE64-SENTAKUCOMFLG
                 IF    ( ACCT-SRYKBN          = "70"   )
                 AND   ((SRY-SRYCD(IDX2)(5:1) = "8"   ) OR
                        (SRY-SRYCD(IDX2) = "830100797"))
                   IF   FLG-SENTAKU-SYUGI    =  ZERO
                     MOVE      9    TO  FLG-SENTAKU-COM
                     MOVE     "9"   TO  RECE64-SENTAKUBUIFLG
                   ELSE
                     IF FLG-SENTAKU-COM = 9
                       MOVE   "2"   TO  RECE64-SENTAKUBUIFLG
                     ELSE
                       MOVE   "1"   TO  RECE64-SENTAKUBUIFLG
                     END-IF
                   END-IF
                   ADD   1          TO  RECE64-SENTAKUBUICNT
                 END-IF
               END-IF
               IF   (RECE62-SRYYM           >= "202004")
               AND  (SRY-SRYCD(IDX2)(1:1)    = "1"     )
                       MOVE    1    TO  FLG-SENTAKU-SYUGI
               END-IF
               IF   (RECE62-SRYYM           >= "202204")
               AND  (SRY-SRYCD(IDX2)(1:1)    = "8"     )
               AND  (SRY-SRYCD(IDX2)(4:1)    = "6"     )
                 MOVE   "1"         TO  RECE64-SENTAKUCOMFLG
               END-IF
      *
               IF    (RECE62-SRYYM         >=  "201704")
               AND   (SRY-SRYCD(IDX2)(1:3)  =  "059"   )
                 IF   (RECE62-RECESYUBETU  =
                                    "6666" OR "0000"      )
                 OR   (RECE62-ERR-ERRKBN   >   ZERO       )
                 OR   (ACCT-SRYKBN         =  "95" OR "96")
      ***        OR   ((WRK-PARA-PRTKBN    =  "1"   ) AND
      ***              (ACCT-ZAITEN        =   ZERO )     )
                 OR   ((WRK-PARA-PRTKBN
                                       NOT =  "9"   ) AND
                       (RECE62-RECESYUBETU =  "8888")     )
                 OR   ((TNS-TEN            =   ZERO ) AND
                       (ACCT-ZAIKBN        =   1    )     )
                   CONTINUE
                 ELSE
                   MOVE     15      TO  RECE62-ERR-ERRKBN
                   DISPLAY "059 ERR:SRYCD=" SRY-SRYCD(IDX2)
                 END-IF
               END-IF
      *
              END-IF
             END-IF
            END-IF  
           END-PERFORM
      *
           IF    IDX4    NOT =   ZERO
               MOVE    1     TO    FLG-WRITE65X
           END-IF
      *
           .
       210121-RECE65-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントフラグ編集処理（２０２０年３月まで）
      *****************************************************************
       2101211-RECE65-COMCNT-HEN-SEC               SECTION.
      *
           IF      RECE64-SRYKBN      =     "11" OR "90" OR "92"
              IF   SRY-SRYCD(IDX2)    =  "111012970" OR "111013070"
                                      OR "111013170" OR "111013270"
                                      OR "111013370" OR "111013470"
                                      OR "111013570" OR "111013670"
                                      OR "112019990" OR "112020090"
                                      OR "112020190" OR "112020290"
                                      OR "112020390" OR "112020490"
                                      OR "112020590" OR "112020690"
                                      OR "112020790" OR "112020890"
                                      OR "112020990" OR "112021090"
                                      OR "112021190" OR "112021290"
                 EVALUATE   RECE62-NINPUFLG
                    WHEN        0
                            MOVE    1    TO    RECE62-NINPUFLG
                    WHEN        2
                            MOVE    3    TO    RECE62-NINPUFLG
                 END-EVALUATE
              END-IF
           END-IF
           IF      RECE64-SRYKBN      =     "99"
              IF   SRY-SRYCD(IDX2)    =     "820100348"
                 EVALUATE   RECE62-NINPUFLG
                    WHEN        0
                            MOVE    2    TO    RECE62-NINPUFLG
                    WHEN        1
                            MOVE    3    TO    RECE62-NINPUFLG
                 END-EVALUATE
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "11"
      *       初診（同日複数診療科）
              IF  (SRY-SRYCD(IDX2)    =     "111011810"
                                      OR    "111012610"
                                      OR    "111012810"         )
              AND (FLG-SYODOU-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE64-FLG-SYODOU-COMMENT
                   MOVE   SRY-SRYKA   TO    RECE64-SYODOU-SRYKA(1)
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "830000024"
                   MOVE  SPACE  TO    RECE64-FLG-SYODOU-COMMENT
                   MOVE  SPACE  TO    RECE64-SYODOU-SRYKA(1)
                   MOVE    1    TO    FLG-SYODOU-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "40"
      *       介達牽引（発症日記載）
              IF   RECE62-SRYYM      >=    "200604"
              AND  RECE62-SRYYM      <=    "200803"
                IF   SRY-SRYCD(IDX2)  =     "140048010"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-KAITATU-COMMENT
                END-IF
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201004"
      *         人工腎臓等
                IF   SRY-SRYCD(IDX2)  =  "140007710" OR "140036710"
                                      OR "140051010" OR "140051110"
                                      OR "140008510" OR "140029850"
                                      OR "140008210" OR "140039210"
                                      OR "140052810" OR "140057810"
                                      OR "140057910" OR "140058010"
                                      OR "140058110" OR "140058210"
                                      OR "140058310" OR "140058410"
                                      OR "140058510" OR "140058610"
                                      OR "140059310" OR "140059410"
                                      OR "140059510"
                                      OR "140060210" OR "140060310"
                                      OR "140060410" OR "140060510"
                                      OR "140060610" OR "140060710"
                                      OR "140060810" OR "140060910"
                                      OR "140061010"
                        MOVE   "1"    TO    RECE64-FLG-JINZOU-COMMENT
                END-IF
      *         局所陰圧閉鎖処置
                IF   RECE62-SRYYM      >=    "201204"
                  IF   SRY-SRYCD(IDX2)  =     "140052170"
                                          OR  "140052270"
                                          OR  "140052370"
                        MOVE   "1"    TO    RECE64-FLG-KYOKUIN-COMMENT
                  END-IF
                ELSE
                  IF   SRY-SRYCD(IDX2)  =     "140052410"
                                          OR  "140051810"
                                          OR  "140051910"
                                          OR  "140052010"
                        MOVE   "1"    TO    RECE64-FLG-KYOKUIN-COMMENT
                  END-IF
                END-IF
              END-IF
      *       磁気による膀胱等刺激法
              IF   RECE62-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2)    =     "140055110"         )
                AND (FLG-BOKOHO-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE64-FLG-BOKOHO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)    =     "840000085"
                   MOVE  SPACE  TO    RECE64-FLG-BOKOHO-COMMENT
                   MOVE    1    TO    FLG-BOKOHO-COM
                END-IF
              END-IF
      *       高気圧酸素治療
              IF  (SRY-SRYCD(IDX2)    =     "140057510"        )
              AND (FLG-KIATU-COM      =     ZERO               )
                   MOVE   "1"   TO    RECE64-FLG-KIATU-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =     "140057610"        )
              AND (FLG-KIATU-COM      =     ZERO               )
                   MOVE   "2"   TO    RECE64-FLG-KIATU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000085"
                                      OR    "840000086"
                                      OR    "840000045"
                   MOVE  SPACE  TO    RECE64-FLG-KIATU-COMMENT
                   MOVE    1    TO    FLG-KIATU-COM
              END-IF
      *
      *       心不全に対する遠赤外線温熱療法
              IF   RECE62-SRYYM      >=    "202004"
                IF  (SRY-SRYCD(IDX2)  =    "140061210")
                AND (FLG-SCPRO-COM    =    ZERO       )
                   MOVE   "5"   TO    RECE64-FLG-SCPRO-COMMENT
                END-IF
              END-IF
              IF    SRY-SRYCD(IDX2)   =    "840000076"
                   MOVE  SPACE  TO    RECE64-FLG-SCPRO-COMMENT
                   MOVE    1    TO    FLG-SCPRO-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "80"
      *       リハビリ
              IF   SRY-SRYCD(IDX2)    =     "180706910"   OR
                                            "180022210"   OR
                                            "180706810"   OR
                                            "180022110"   OR
                                            "180707110"   OR
                                            "180022410"   OR
                                            "180707010"   OR
                                            "180022310"   OR
                                            "180707310"   OR
                                            "180022610"   OR
                                            "180707210"   OR
                                            "180022510"   OR
                                            "180707510"   OR
                                            "180022810"   OR
                                            "180707410"   OR
                                            "180022710"   OR
                                            "180708210"   OR
                                            "180023710"   OR
                                            "180708410"   OR
                                            "180023910"   OR
                                            "180708110"   OR
                                            "180023610"   OR
                                            "180708310"   OR
                                            "180023810"   OR
                                            "180024910"   OR
                                            "180024810"   OR
                                            "180025110"   OR
                                            "180025010"   OR
                                            "180025510"   OR
                                            "180025410"
      ****              MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-RIHABIRI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "180027410"           OR
                                            "180027510"           OR
                                            "180029110"           OR
                                            "180029210"           OR
                                            "180028010"           OR
                                            "180028110"           OR
                                            "180029710"           OR
                                            "180029810"           OR
                                            "180027610"           OR
                                            "180027710"           OR
                                            "180029310"           OR
                                            "180029410"           OR
                                            "180030810"           OR
                                            "180032410"           OR
                                            "180032510"           OR
                                            "180032610"           OR
                                            "180033910"           OR
                                            "180034010"           OR
                                            "180034110"           OR
                                            "180034210"           OR
                                            "180034310"           OR
                                            "180034410"           OR
                                            "180044310"           OR
                                            "180044410"           OR
                                            "180044510"           OR
                                            "180050330"           OR
                                            "180050430"           OR
                                            "180050530"           OR
                                            "180050630"           OR
                                            "180050830"           OR
                                            "180051030"           OR
                                            "180027810"           OR
                                            "180027910"           OR
                                            "180029510"           OR
                                            "180029610"           OR
                                            "180032710"           OR
                                            "180034510"           OR
                                            "180034610"           OR
                                            "180034710"           OR
                                            "180045810"           OR
                                            "180045910"           OR
                                            "180046010"           OR
                                            "180052730"           OR
                                            "180052830"           OR
                                            "180052930"           OR
                                            "180053030"           OR
                                            "180053230"           OR
                                            "180053430"           OR
                                            "180028210"           OR
                                            "180028310"           OR
                                            "180028410"           OR
                                            "180044610"           OR
                                            "180044710"           OR
                                            "180044810"           OR
                                            "180044910"           OR
                                            "180045110"           OR
                                            "180045310"           OR
                                            "180051530"           OR
                                            "180051630"           OR
                                            "180051730"           OR
                                            "180051830"           OR
                                            "180052030"           OR
                                            "180052230"           OR
                                            "180033110"
      ****              MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-RIHABIRI-COMMENT
              END-IF
              EVALUATE      SRY-SRYCD(IDX2)
                WHEN     "180029910"
                        MOVE   "2"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030010"
                        MOVE   "3"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030510"
                        MOVE   "4"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030610"
                        MOVE   "5"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030110"
                        MOVE   "6"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030210"
                        MOVE   "7"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030310"
                        MOVE   "8"    TO    RECE64-RIHABIRI-COMMENT
                WHEN     "180030410"
                        MOVE   "9"    TO    RECE64-RIHABIRI-COMMENT
              END-EVALUATE
      *       リハビリ（発症日記載）
              IF   RECE62-SRYYM      >=    "200604"
                IF   SRY-SRYCD(IDX2)  =     "180027410"
                                      OR    "180027510"
                                      OR    "180029110"
                                      OR    "180029210"
                                      OR    "180029910"
                                      OR    "180030010"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-SINDAI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-SINDAI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180028010"
                                      OR    "180028110"
                                      OR    "180029710"
                                      OR    "180029810"
                                      OR    "180030510"
                                      OR    "180030610"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-KOKYUKI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-KOKYUKI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180027610"
                                      OR    "180027710"
                                      OR    "180029310"
                                      OR    "180029410"
                                      OR    "180030110"
                                      OR    "180030210"
                                      OR    "180030810"
                                      OR    "180032410"
                                      OR    "180032510"
                                      OR    "180032610"
                                      OR    "180033910"
                                      OR    "180034010"
                                      OR    "180034110"
                                      OR    "180034210"
                                      OR    "180034310"
                                      OR    "180034410"
                                      OR    "180044310"
                                      OR    "180044410"
                                      OR    "180044510"
                                      OR    "180050330"
                                      OR    "180050430"
                                      OR    "180050530"
                                      OR    "180050630"
                                      OR    "180050830"
                                      OR    "180051030"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-NOUKE-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-NOUKE(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180027810"
                                      OR    "180027910"
                                      OR    "180029510"
                                      OR    "180029610"
                                      OR    "180030310"
                                      OR    "180030410"
                                      OR    "180032710"
                                      OR    "180034510"
                                      OR    "180034610"
                                      OR    "180034710"
                                      OR    "180045810"
                                      OR    "180045910"
                                      OR    "180046010"
                                      OR    "180052730"
                                      OR    "180052830"
                                      OR    "180052930"
                                      OR    "180053030"
                                      OR    "180053230"
                                      OR    "180053430"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-UNDOKI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-UNDOKI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180017910"        )
                AND (RECE62-SRYYM    <=     "201803"           )
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-NANBYO-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-NANBYO(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180028210"
                                      OR    "180028310"
                                      OR    "180028410"         )
                AND (RECE62-SRYYM    <=     "201803"            )
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-SYOGAI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-SYOGAI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180016610"
                                      OR    "180054310"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-SESSYOKU-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-SESSYOKU(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180044610"
                                      OR    "180044710"
                                      OR    "180044810"
                                      OR    "180044910"
                                      OR    "180045110"
                                      OR    "180045310"
                                      OR    "180051530"
                                      OR    "180051630"
                                      OR    "180051730"
                                      OR    "180051830"
                                      OR    "180052030"
                                      OR    "180052230"
                        MOVE   "1"    TO    RECE62-COMCNTFLG
                        MOVE   "1"    TO    RECE64-HAIYO-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE62-RIHA-HAIYO(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
              END-IF
      *
              IF   (RECE62-SRYYM    >=   "201604"             )
              AND  (SRY-SRYCD(IDX2)  =   "180033870"
                                     OR  "180030770"          )
                IF   RECE64-SINDAI-COMMENT = "1"
                    MOVE   "1"    TO    RECE64-SINDAI9-COMMENT
                    PERFORM  VARYING  IDX16  FROM  1  BY  1
                              UNTIL   IDX16   >   31
                      IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                        MOVE  1  TO  RECE62-RIHA-SINDAI9(IDX1 IDX16)
                      END-IF
                    END-PERFORM
                END-IF
                IF   RECE64-KOKYUKI-COMMENT = "1"
                    MOVE   "1"    TO    RECE64-KOKYUKI9-COMMENT
                    PERFORM  VARYING  IDX16  FROM  1  BY  1
                              UNTIL   IDX16   >   31
                      IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                        MOVE  1  TO  RECE62-RIHA-KOKYUKI9(IDX1 IDX16)
                      END-IF
                    END-PERFORM
                END-IF
                IF   RECE64-HAIYO-COMMENT = "1"
                    MOVE   "1"    TO    RECE64-HAIYO9-COMMENT
                    PERFORM  VARYING  IDX16  FROM  1  BY  1
                              UNTIL   IDX16   >   31
                      IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                        MOVE  1  TO  RECE62-RIHA-HAIYO9(IDX1 IDX16)
                      END-IF
                    END-PERFORM
                END-IF
              END-IF
      *
      *       疾患別等専門プログラム加算
      *       経頭蓋磁気刺激療法
              IF    (SRY-SRYCD(IDX2)  =    "180056570")
              AND   (FLG-SCPRO-COM    =    ZERO       )
                    MOVE   "2"    TO    RECE64-FLG-SCPRO-COMMENT
              END-IF
              IF   RECE62-SRYYM      >=    "202004"
                IF  (SRY-SRYCD(IDX2)  =    "180058650")
                AND (FLG-SCPRO-COM    =    ZERO       )
                    MOVE   "4"    TO    RECE64-FLG-SCPRO-COMMENT
                END-IF
              END-IF
              IF    SRY-SRYCD(IDX2)   =    "840000076"
                    MOVE  SPACE   TO    RECE64-FLG-SCPRO-COMMENT
                    MOVE    1     TO    FLG-SCPRO-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "13"
              IF   SRY-SRYCD(IDX2)    =     "113010710"           OR
                                            "113010810"           OR
                                            "120001610"
                   MOVE   "1"   TO    RECE64-FLG-YAKUKAN-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =     "113003310"           OR
                                            "113014810"           OR
                                            "113014910"           OR
                                            "113017610"           OR
                                            "113017710"           OR
                                            "113017810"           OR
                                            "113017910"            )
              AND (RECE62-SRYYM       <=    "202003"               )
                   MOVE   "1"   TO    RECE64-FLG-NYUEIYO-COMMENT
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     "190030310"           OR
                                            "190723610"         )
              AND (FLG-HOUMON-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE64-FLG-HOUMON-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000055"
                   MOVE  SPACE  TO    RECE64-FLG-HOUMON-COMMENT
                   MOVE    1    TO    FLG-HOUMON-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "180000710"
              AND  FLG-SYOBYO-COM     =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-SYOBYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000011"
                                      OR    "840000012"
                                      OR    "840000511"
                                      OR    "840000512"
                   MOVE  SPACE  TO    RECE64-FLG-SYOBYO-COMMENT
                   MOVE    1    TO    FLG-SYOBYO-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "113004310"
              AND  FLG-RYOYO-COM      =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-RYOYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000078"
                                      OR    "840000578"
                   MOVE  SPACE  TO    RECE64-FLG-RYOYO-COMMENT
                   MOVE    1    TO    FLG-RYOYO-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "113006270"
                   MOVE   "1"   TO    RECE64-FLG-TAIIN-COMMENT
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201004"
      *         介護支援連携指導料
                IF   SRY-SRYCD(IDX2)  =     "113011710"
                        MOVE   "1"    TO    RECE64-FLG-KAISIEN-COMMENT
                END-IF
              END-IF
              IF   RECE62-SRYYM      >=    "201004"
              AND  RECE62-SRYYM      <=    "201803"
      *         集団栄養食事指導料
                IF   SRY-SRYCD(IDX2)  =     "113003410"
                        MOVE   "1"    TO    RECE64-FLG-SYUEIYO-COMMENT
                END-IF
              END-IF
      *       人工内耳機器調整加算
              IF   SRY-SRYCD(IDX2)   =  "113030670"
                   MOVE   "1"   TO    RECE64-FLG-JINNAI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)   =  "113030770"
                   MOVE   "2"   TO    RECE64-FLG-JINNAI-COMMENT
              END-IF
      *       心臓ペースメーカー指導管理料（着用型自動除細動器）
      *       心臓ペースメーカー指導管理料（ロ・植込型除細動器移行期加算含む）
      *       がん患者指導管理料２・３
              IF   RECE62-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2) =  "113015010"           )
                AND (RECE62-SRYYM   <=  "201803"              )
                   MOVE   "1"   TO    RECE64-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113015130"
                   MOVE   "2"   TO    RECE64-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113015310"
                   MOVE   "1"   TO    RECE64-FLG-GANSIDO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113015410"
                   MOVE   "2"   TO    RECE64-FLG-GANSIDO-COMMENT
                END-IF
              END-IF
      *       排尿自立指導料
              IF   RECE62-SRYYM    >=     "201604"
              AND  RECE62-SRYYM    <=     "202003"
                IF  (SRY-SRYCD(IDX2)  =     "113022810"        )
                AND (FLG-HAIJRT-COM   =     ZERO               )
                        MOVE   "1"    TO    RECE64-FLG-HAIJRT-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "840000097"
                                      OR    "840000086"
                        MOVE  SPACE   TO    RECE64-FLG-HAIJRT-COMMENT
                        MOVE    1     TO    FLG-HAIJRT-COM
                END-IF
              END-IF
      *       退院時共同指導料２
              IF   RECE62-SRYYM    >=     "201804"
                IF  (SRY-SRYCD(IDX2)  =     "113008910"        )
                AND (FLG-TAIKYO-COM   =     ZERO               )
                        MOVE   "1"    TO    RECE64-FLG-TAIKYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "840000110"
                        MOVE  SPACE   TO    RECE64-FLG-TAIKYO-COMMENT
                        MOVE    1     TO    FLG-TAIKYO-COM
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "14"
              IF   SRY-SRYCD(IDX2)    =     "114008010"
              AND  FLG-HOUSIJI-COM    =     ZERO
                   MOVE   "1"   TO    RECE64-FLG-HOUSIJI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000073"
                   MOVE  SPACE  TO    RECE64-FLG-HOUSIJI-COMMENT
                   MOVE    1    TO    FLG-HOUSIJI-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "114009410"
                   MOVE   "1"   TO    RECE64-FLG-HINKAI-COMMENT
              END-IF
      *
      ***     IF  (SRY-SRYCD(IDX2)    =     "114000110"
      ***                             OR    "114001610"       )
      ***     AND (FLG-OSIN-COM       =     ZERO              )
      ***          MOVE   "1"   TO    RECE64-FLG-OSIN-COMMENT
      ***     END-IF
      ***     IF   SRY-SRYCD(IDX2)    =     "840000039"
      ***          MOVE  SPACE  TO    RECE64-FLG-OSIN-COMMENT
      ***          MOVE    1    TO    FLG-OSIN-COM
      ***     END-IF
      *
              IF   RECE62-SRYYM    >=     "201204"
                IF   SRY-SRYCD(IDX2) =  "114000110"
                                    OR  "114001610"
                   IF    (WRK-SISETU3168  =  1)
                   OR    (WRK-SISETU3055  =  1)
                   OR    (WRK-SISETU3056  =  1)
                       MOVE   "1"   TO    RECE62-COMCNTFLG
                       MOVE   "1"   TO    RECE64-FLG-ZAISIEN-COMMENT
                   END-IF
                   IF  RECE64-FLG-ZAISIEN-COMMENT = SPACE
                     IF  (WRK-SISETU3169  =  1)
                     OR  (WRK-SISETU3057  =  1)
                     OR  (WRK-SISETU3058  =  1)
                       MOVE   "1"   TO    RECE62-COMCNTFLG
                       MOVE   "2"   TO    RECE64-FLG-ZAISIEN-COMMENT
                     END-IF
                   END-IF
                END-IF
              ELSE
                IF   WRK-SISETU613   =  1
                  IF   RECE62-SRYYM   >=  "200604"
                      IF SRY-SRYCD(IDX2) =  "114011570"         OR
                                            "114011670"         OR
                                            "114011770"
                        MOVE   "1"   TO    RECE62-COMCNTFLG
                        MOVE   "1"   TO    RECE64-FLG-ZAISIEN-COMMENT
                      END-IF
                  END-IF
                ELSE
                  IF   WRK-SISETU695   =  1
                    IF   RECE62-SRYYM   >=  "200804"
                      IF SRY-SRYCD(IDX2) =  "114011570"         OR
                                            "114011670"         OR
                                            "114011770"
                        MOVE   "1"   TO    RECE62-COMCNTFLG
                        MOVE   "2"   TO    RECE64-FLG-ZAISIEN-COMMENT
                      END-IF
                    END-IF
                  END-IF
                END-IF
              END-IF
      *
              IF   RECE62-SRYYM    >=     "201204"
                IF   SRY-SRYCD(IDX2) =  "114020910"
                   MOVE   "1"   TO    RECE64-FLG-KAISYOKU-COMMENT
                END-IF
              END-IF
      *       在宅患者共同診療料
              IF   RECE62-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2)    =     "114027610"
                                        OR    "114027710"
                                        OR    "114027810"
                                        OR    "114027910"         )
                AND (FLG-ZAIKYO-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE64-FLG-ZAIKYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)    =     "840000097"
                                        OR    "840000086"
                   MOVE  SPACE  TO    RECE64-FLG-ZAIKYO-COMMENT
                   MOVE    1    TO    FLG-ZAIKYO-COM
                END-IF
              END-IF
      *       遠隔モニタリング加算（在宅酸素療法指導管理料（その他））
      *       遠隔モニタリング加算（在宅持続陽圧呼吸療法指導管理料２）
              IF   SRY-SRYCD(IDX2)    =     "114045470"
                   MOVE   "A"   TO    RECE64-FLG-SINPESU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "114045670"
                   MOVE   "B"   TO    RECE64-FLG-SINPESU-COMMENT
              END-IF
      *       在宅酸素療法指導管理料（その他）
      *       在宅持続陽圧呼吸療法指導管理料２
              IF   SRY-SRYCD(IDX2)    =     "114003710"
                   MOVE   "A"   TO    RECE64-FLG-SINPESUR-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "114040810"
                   MOVE   "B"   TO    RECE64-FLG-SINPESUR-COMMENT
              END-IF
      *       在宅半固形栄養経管栄養法指導管理料
              IF  (SRY-SRYCD(IDX2)    =     "114045510"          )
              AND (FLG-ZAIHANKO-COM   =     ZERO                 )
                   MOVE   "9"    TO   RECE64-FLG-ZAIHANKO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000097"
                   MOVE  SPACE   TO   RECE64-FLG-ZAIHANKO-COMMENT
                   MOVE    1     TO   FLG-ZAIHANKO-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "70"
              IF  (SRY-SRYCD(IDX2)    =  "170011710" OR "170011810"
                                      OR "170011910" OR "170012110"
                                      OR "170015550" OR "170015210"
                                      OR "170020110" OR "170022110"
                                      OR "170022290" OR "170022390"
                                      OR "170022490" OR "170023010"
                                      OR "170023110" OR "170023210"
                                      OR "170023310" OR "170023410"
                                      OR "170023510"               )
              AND (RECE62-SRYYM       <     "201004"               )
                   MOVE   "1"   TO    RECE64-FLG-CTMRI-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =  "170011710" OR "170011810"
                                      OR "170012110" OR "170015210"
                                      OR "170020110" OR "170028610"
                                      OR "170033410" OR "170033510"
                                      OR "170034910" OR "170035010")
              AND (RECE62-SRYYM       >=    "201004"               )
              AND (RECE62-SRYYM       <=    "202003"               )
                   MOVE   "1"   TO    RECE64-FLG-CTMRI-COMMENT
              END-IF
      *
              IF   RECE62-SRYYM  >= "201810"
                IF  (SRY-SRYCD(IDX2)  =     "170016010"        )
                AND (FLG-KINGAZ-COM   =     ZERO               )
                     MOVE   "1"    TO   RECE64-FLG-KINGAZ-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "820100129"
                     MOVE  SPACE   TO   RECE64-FLG-KINGAZ-COMMENT
                     MOVE    1     TO   FLG-KINGAZ-COM
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "80"
      ***     IF  (SRY-SRYCD(IDX2)    =     "180018310"
      ***                             OR    "188003110"         )
      ***     AND (FLG-HOUSEI-COM     =     ZERO                )
      ***          MOVE   "1"   TO    RECE64-FLG-HOUSEI-COMMENT
      ***     END-IF
      ***     IF   SRY-SRYCD(IDX2)    =     "840000079"
      ***          MOVE  SPACE  TO    RECE64-FLG-HOUSEI-COMMENT
      ***          MOVE    1    TO    FLG-HOUSEI-COM
      ***     END-IF
      *
              IF   RECE62-SRYYM      >=    "201204"
                IF   SRY-SRYCD(IDX2)  =  "180039030" OR "180036030"
                                      OR "180039130" OR "180039230"
                                      OR "180039330" OR "180036130"
                                      OR "180039430" OR "180039530"
                                      OR "180048930" OR "180049030"
                   MOVE   "1"   TO    RECE64-FLG-SEIKEA-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "90"  OR  "92"
              IF   SRY-SRYCD(IDX2)    =     "190107070"
                   MOVE   "1"   TO    RECE64-FLG-KAKURI-COMMENT
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201004"
      *         栄養サポートチーム加算
                IF   SRY-SRYCD(IDX2)  =     "190136810"
                        MOVE   "1"    TO    RECE64-FLG-EISAPO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "190147110"
                        MOVE   "2"    TO    RECE64-FLG-EISAPO-COMMENT
                END-IF
      *         呼吸ケアチーム加算
                IF   SRY-SRYCD(IDX2)  =     "190137910"
                        MOVE   "1"    TO    RECE64-FLG-KOKKEA-COMMENT
                END-IF
      *         重症者加算（精神療養病棟入院料）
                IF   SRY-SRYCD(IDX2)  =     "190141370"
                        MOVE   "1"    TO    RECE64-FLG-JYUSYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "190151470"
                        MOVE   "2"    TO    RECE64-FLG-JYUSYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "190195770"
                        MOVE   "3"    TO    RECE64-FLG-JYUSYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "190195870"
                        MOVE   "4"    TO    RECE64-FLG-JYUSYO-COMMENT
                END-IF
              END-IF
      *
              IF   RECE62-SRYYM      >=    "201204"
      *         精神科リエゾンチーム加算
                IF   SRY-SRYCD(IDX2)  =     "190147010"
                        MOVE   "1"    TO    RECE64-FLG-SEIRIE-COMMENT
                END-IF
      *         病棟薬剤業務実施加算
                IF   SRY-SRYCD(IDX2)  =     "190149110"
                        MOVE   "1"    TO    RECE64-FLG-BYOYAK-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "190192110"
                        MOVE   "2"    TO    RECE64-FLG-BYOYAK-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "190192210"
                        MOVE   "3"    TO    RECE64-FLG-BYOYAK-COMMENT
                END-IF
              END-IF
      *       超重症児（者）入院診療加算・準超重症児（者）入院診療加算
              IF   RECE62-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2) =  "190076570"
                                    OR  "190076670"
                                    OR  "190127510"
                                    OR  "190127610"          )
                AND (FLG-CYOJKSN-COM =  ZERO                 )
                  MOVE     ZERO       TO    FLG-CYOJKSN-OK
                  IF   RECE62-SRYYM  =  RECE62-NYUINYMD(1:6)
                    MOVE  RECE62-NYUINYMD(7:2)  TO  IDX25
                    PERFORM  VARYING  IDX26  FROM  1  BY  1
                              UNTIL   IDX26   >   31
                      IF  (ACCT-DAY(1 IDX26) NOT = ZERO )
                      AND (IDX26                >= IDX25)
                        MOVE     1    TO    FLG-CYOJKSN-OK
                      END-IF
                    END-PERFORM
                  ELSE
                        MOVE     1    TO    FLG-CYOJKSN-OK
                  END-IF
                END-IF
                IF  (SRY-SRYCD(IDX2) =  "190076570"          )
                AND (FLG-CYOJKSN-COM =  ZERO                 )
                 IF  FLG-CYOJKSN-OK  =   1
                   MOVE   "1"   TO    RECE64-FLG-CYOJKSN-COMMENT
                   MOVE   "1"   TO    RECE62-COMCNTFLG
                   EVALUATE  RECE62-CYOJKSNFLG
                     WHEN     SPACE
                        MOVE   "X"    TO   RECE62-CYOJKSNFLG
                     WHEN     "Y"
                        MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                   END-EVALUATE
                 ELSE
                   MOVE   "5"   TO    RECE64-FLG-CYOJKSN-COMMENT
                 END-IF
                END-IF
                IF  (SRY-SRYCD(IDX2) =  "190076670"          )
                AND (FLG-CYOJKSN-COM =  ZERO                 )
                 IF  FLG-CYOJKSN-OK  =   1
                   MOVE   "2"   TO    RECE64-FLG-CYOJKSN-COMMENT
                   MOVE   "1"   TO    RECE62-COMCNTFLG
                   EVALUATE  RECE62-CYOJKSNFLG
                     WHEN     SPACE
                        MOVE   "Y"    TO   RECE62-CYOJKSNFLG
                     WHEN     "X"
                        MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                   END-EVALUATE
                 ELSE
                   MOVE   "6"   TO    RECE64-FLG-CYOJKSN-COMMENT
                 END-IF
                END-IF
                IF  (SRY-SRYCD(IDX2) =  "190127510"          )
                AND (FLG-CYOJKSN-COM =  ZERO                 )
                 IF  FLG-CYOJKSN-OK  =   1
                   MOVE   "3"   TO    RECE64-FLG-CYOJKSN-COMMENT
                   MOVE   "1"   TO    RECE62-COMCNTFLG
                   EVALUATE  RECE62-CYOJKSNFLG
                     WHEN     SPACE
                        MOVE   "X"    TO   RECE62-CYOJKSNFLG
                     WHEN     "Y"
                        MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                   END-EVALUATE
                 ELSE
                   MOVE   "7"   TO    RECE64-FLG-CYOJKSN-COMMENT
                 END-IF
                END-IF
                IF  (SRY-SRYCD(IDX2) =  "190127610"          )
                AND (FLG-CYOJKSN-COM =  ZERO                 )
                 IF  FLG-CYOJKSN-OK  =   1
                   MOVE   "4"   TO    RECE64-FLG-CYOJKSN-COMMENT
                   MOVE   "1"   TO    RECE62-COMCNTFLG
                   EVALUATE  RECE62-CYOJKSNFLG
                     WHEN     SPACE
                        MOVE   "Y"    TO   RECE62-CYOJKSNFLG
                     WHEN     "X"
                        MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                   END-EVALUATE
                 ELSE
                   MOVE   "8"   TO    RECE64-FLG-CYOJKSN-COMMENT
                 END-IF
                END-IF
                IF   SRY-SRYCD(IDX2) =  "840000056"
                                     OR "840000556"
                   MOVE    1    TO    FLG-CYOJKSN-COM
                   IF  RECE64-FLG-CYOJKSN-COMMENT =
                                           "1" OR "2" OR "3" OR "4"
                        MOVE   "1"    TO   RECE65-RECEPTFLG(IDX4)
                                           RECE65-RECEDENFLG(IDX4)
                   END-IF
                   IF  RECE64-FLG-CYOJKSN-COMMENT =
                                           "5" OR "6" OR "7" OR "8"
                        MOVE   "1"    TO   RECE65-RECEDENFLG(IDX4)
                   END-IF
                END-IF
              END-IF
      *       排尿自立支援加算
              IF   RECE62-SRYYM      >=    "202004"
                IF  (SRY-SRYCD(IDX2)  =     "190219010"        )
                AND (FLG-HAIJSK-COM   =     ZERO               )
                  MOVE   "1"    TO    RECE64-FLG-HAIJSK-COMMENT
                  PERFORM  VARYING  IDX40  FROM  1  BY  1
                            UNTIL   IDX40    >  31
                    IF  ACCT-DAY(1 IDX40) NOT = ZERO
                      IF  RECE62-HAIJSKYMD  =  SPACE
                        MOVE  RECE62-SRYYM  TO  RECE62-HAIJSKYMD(1:6)
                        MOVE  IDX40         TO  RECE62-HAIJSKYMD(7:2)
                      ELSE
                        MOVE  RECE62-HAIJSKYMD(7:2)  TO  IDX41
                        IF    IDX40  <  IDX41
                          MOVE  IDX40       TO  RECE62-HAIJSKYMD(7:2)
                        END-IF
                      END-IF
                      MOVE    31    TO   IDX40
                    END-IF
                  END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "840000097"
                                      OR    "840000086"
                  MOVE  SPACE   TO    RECE64-FLG-HAIJSK-COMMENT
                  MOVE    1     TO    FLG-HAIJSK-COM
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "60" OR "64"
              IF  (SRY-SRYCD(IDX2)    =     "160162350" OR "160181250"
                                         OR "160116310"               )
              AND (FLG-KENSA-COM      =     ZERO                      )
                   MOVE   "1"    TO    RECE64-FLG-KENSA-COMMENT
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "160162350"
                   MOVE    1    TO    RECE62-KENSA-BNPFLG
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "160181250"
                   MOVE    1    TO    RECE62-KENSA-NTPROFLG
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "160116310"
                   MOVE    1    TO    RECE62-KENSA-ANPFLG
              END-IF
      *
              IF   RECE62-SRYYM  >= "201810"
                IF  (SRY-SRYCD(IDX2)  =     "160000210"
                                      OR    "160177770"         )
                AND (FLG-KENKSN-COM   =     ZERO                )
                     MOVE   "1"    TO   RECE64-FLG-KENKSN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "820100129"
                     MOVE  SPACE   TO   RECE64-FLG-KENKSN-COMMENT
                     MOVE    1     TO   FLG-KENKSN-COM
                END-IF
              END-IF
           END-IF
      *
           PERFORM  2101211-RECE65-COMCNT-KT-SEC
      *
           .
       2101211-RECE65-COMCNT-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントフラグ編集処理（２０２０年４月から）
      *****************************************************************
       2101211-RECE65-COMCNT-HEN2-SEC               SECTION.
      *
           IF      RECE64-SRYKBN      =     "11"
      *       初診（同日複数診療科）
              MOVE   SRY-SRYKA   TO    RECE64-SYODOU-SRYKA(1)
           END-IF
      *
           IF      RECE64-SRYKBN      =     "13"
      *       診療情報提供料
              IF   SRY-SRYCD(IDX2)    =     "180016110" OR "113009510"
                   MOVE    1     TO    FLG-JYOHOTEIKYO
              END-IF
              IF   RECE62-SRYYM      >=     "202010"
              AND  SRY-SRYCD(IDX2)    =     "840000052"
              AND  FLG-JYOHOTEIKYO    =      1
                   MOVE   "1"    TO    RECE65-RECEDENFLG(IDX4)
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "14"
            IF     RECE62-SRYYM   >=  "202204"
              IF  ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                   (SRY-SRYCD(IDX2)(1:3)  =  "008"))
              AND ( FLG-HOUSKSN-COM  =   ZERO      )
                IF  ((SRY-SRYCD(IDX2)(1:1) =  "8"        ) AND
                     (SRY-SRYCD(IDX2)(4:1) =  "1"        ))
                OR  ( SRY-SRYCD(IDX2)      =  "840000073" )
                  CONTINUE
                ELSE
                  PERFORM  VARYING  IDV2  FROM  1  BY  2
                            UNTIL  (IDV2              >   300)
                             OR    (FLG-HOUSKSN-COM   =    1 )
                    IF  RECE65-NAME(IDX4)(IDV2:2)   =  "日"
                      MOVE    1    TO    FLG-HOUSKSN-COM
                    END-IF
                  END-PERFORM
                END-IF
              END-IF
            END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "90"  OR  "92"
      *       超重症児（者）入院診療加算・準超重症児（者）入院診療加算
              IF  (SRY-SRYCD(IDX2) =  "190076570" OR "190076670"
                                   OR "190127510" OR "190127610")
              AND (FLG-CYOJKSN-COM =  ZERO                      )
                MOVE     ZERO       TO    FLG-CYOJKSN-OK
                IF   RECE62-SRYYM  =  RECE62-NYUINYMD(1:6)
                  MOVE  RECE62-NYUINYMD(7:2)  TO  IDX25
                  PERFORM  VARYING  IDX26  FROM  1  BY  1
                            UNTIL   IDX26   >   31
                    IF  (ACCT-DAY(1 IDX26) NOT = ZERO )
                    AND (IDX26                >= IDX25)
                      MOVE     1    TO    FLG-CYOJKSN-OK
                    END-IF
                  END-PERFORM
                ELSE
                      MOVE     1    TO    FLG-CYOJKSN-OK
                END-IF
              END-IF
              IF  (SRY-SRYCD(IDX2) =  "190076570")
              AND (FLG-CYOJKSN-COM =  ZERO       )
                IF  FLG-CYOJKSN-OK  =   1
                  MOVE   "1"   TO    RECE64-FLG-CYOJKSN-COMMENT
                  MOVE   "1"   TO    RECE62-COMCNTFLG
                  EVALUATE  RECE62-CYOJKSNFLG
                    WHEN     SPACE
                       MOVE   "X"    TO   RECE62-CYOJKSNFLG
                    WHEN     "Y"
                       MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                  END-EVALUATE
                END-IF
              END-IF
              IF  (SRY-SRYCD(IDX2) =  "190076670")
              AND (FLG-CYOJKSN-COM =  ZERO       )
                IF  FLG-CYOJKSN-OK  =   1
                  MOVE   "2"   TO    RECE64-FLG-CYOJKSN-COMMENT
                  MOVE   "1"   TO    RECE62-COMCNTFLG
                  EVALUATE  RECE62-CYOJKSNFLG
                    WHEN     SPACE
                       MOVE   "Y"    TO   RECE62-CYOJKSNFLG
                    WHEN     "X"
                       MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                  END-EVALUATE
                END-IF
              END-IF
              IF  (SRY-SRYCD(IDX2) =  "190127510")
              AND (FLG-CYOJKSN-COM =  ZERO       )
                IF  FLG-CYOJKSN-OK  =   1
                  MOVE   "3"   TO    RECE64-FLG-CYOJKSN-COMMENT
                  MOVE   "1"   TO    RECE62-COMCNTFLG
                  EVALUATE  RECE62-CYOJKSNFLG
                    WHEN     SPACE
                       MOVE   "X"    TO   RECE62-CYOJKSNFLG
                    WHEN     "Y"
                       MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                  END-EVALUATE
                END-IF
              END-IF
              IF  (SRY-SRYCD(IDX2) =  "190127610")
              AND (FLG-CYOJKSN-COM =  ZERO       )
                IF  FLG-CYOJKSN-OK  =   1
                  MOVE   "4"   TO    RECE64-FLG-CYOJKSN-COMMENT
                  MOVE   "1"   TO    RECE62-COMCNTFLG
                  EVALUATE  RECE62-CYOJKSNFLG
                    WHEN     SPACE
                       MOVE   "Y"    TO   RECE62-CYOJKSNFLG
                    WHEN     "X"
                       MOVE   "Z"    TO   RECE62-CYOJKSNFLG
                  END-EVALUATE
                END-IF
              END-IF
              IF   SRY-SRYCD(IDX2) =  "840000056" OR "840000556"
                                   OR "850100020" OR "850100021"
                  MOVE  SPACE  TO    RECE64-FLG-CYOJKSN-COMMENT
                  MOVE    1    TO    FLG-CYOJKSN-COM
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "99"
      *       妊婦
              IF   SRY-SRYCD(IDX2)    =     "820100348"
                   MOVE    2     TO    RECE62-NINPUFLG
              END-IF
           END-IF
      *
           PERFORM  2101211-RECE65-COMCNT-KT-SEC
      *
           .
       2101211-RECE65-COMCNT-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントフラグ編集処理（共通）
      *****************************************************************
       2101211-RECE65-COMCNT-KT-SEC               SECTION.
      *
           IF      RECE64-SRYKBN      =     "50"
              IF   RECE64-SYUTEN1     =     ZERO
                   MOVE   "1"    TO    RECE64-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYSYUKBN      =     "510"
                   MOVE   "1"    TO    RECE64-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000042"
                   MOVE   "1"    TO    RECE64-FLG-SHUJUTU-COMMENT
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "54"
              IF   RECE62-SRYYM       <     "201004"
              OR   RECE64-SYUTEN1     =     ZERO
                   MOVE   "1"    TO    RECE64-FLG-MASUI-COMMENT
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "60" OR "64"
              IF  ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                   (SRY-SRYCD(IDX2)(1:3)  =  "008"))
              AND ( FLG-KENSA-COM    =   ZERO      )
                IF  SRY-SRYCD(IDX2)  =   "840000085" OR "840000087"
                  CONTINUE
                ELSE
                  PERFORM  VARYING  IDV2  FROM  1  BY  2
                            UNTIL  (IDV2              >   300)
                             OR    (FLG-KENSA-COM     =    1 )
                    IF  RECE65-NAME(IDX4)(IDV2:2)   =  "日"
                      MOVE  SPACE  TO    RECE64-FLG-KENSA-COMMENT
                      MOVE    1    TO    FLG-KENSA-COM
                    END-IF
                  END-PERFORM
                END-IF
              END-IF
           END-IF
      *
           IF      RECE64-SRYKBN      =     "70"
              IF   SRY-SRYCD(IDX2)    =
                    "700010000" OR "700030000" OR "700050000" OR
                    "700080000" OR "700110000" OR "700140000" OR
                    "700290000" OR "700310000" OR "700330000" OR
                    "700710000" OR "700730000" OR "700750000" OR
                    "700780000" OR "700810000" OR "700840000" OR
                    "700870000" OR "700160000" OR "700180000" OR
                    "700190000" OR "700200000" OR "700210000" OR
                    "700220000" OR "700230000" OR "700240000" OR
                    "700250000" OR "700260000" OR "700270000" OR
                    "700280000" OR "700590000" OR "700600000" OR
                    "700630000" OR "700640000" OR "700650000" OR
                    "700680000" OR "729780000"
                IF    SRY-SRYKAISU(IDX2)  >   1
                   MOVE   "1"    TO    RECE64-FLG-FILM-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF     (RECE64-SRYKBN   =  "14" OR "40" OR "50" OR "54"
                                   OR "60" OR "70" OR "80" OR "64")
           AND    (RECE65-RECEPTFLG(IDX4) = SPACE                 )
              SET     TBL-SANSO    TO      1
              SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
                   AT  END
                       MOVE    ZERO            TO  FLG-SANSO-OK
                   WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
                                                        (TBL-SANSO)
                       MOVE    1               TO  FLG-SANSO-OK
              END-SEARCH
              IF      FLG-SANSO-OK        =    1
                   MOVE   "1"    TO    RECE64-FLG-SANSO-COMMENT
              END-IF
           END-IF
      *
           .
       2101211-RECE65-COMCNT-KT-EXT.
           EXIT.
      *
      *****************************************************************
      *    酸素の単価編集処理
      *****************************************************************
       2101212-RECE65-TANKA-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-TANKA-X
      * 
      *    数字表示用編集（半角）
           MOVE    RECE65-TEN(IDX4)
                                   TO  WRK-TANKA
           MOVE    WRK-TANKA-S1    TO  WRK-TANKA-Z1
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDY3   FROM    2   BY  -1
                     UNTIL     IDY3           =   ZERO
             IF  WRK-TANKA-S2(IDY3:1) NOT =   ZERO
                 MOVE    1               TO  FLG-SP
             END-IF
             IF  FLG-SP                  =   1
                 MOVE    WRK-TANKA-S2(IDY3:1)
                                         TO  WRK-TANKA-Z3(IDY3:1)
             END-IF
           END-PERFORM
           IF  WRK-TANKA-Z3          NOT =   SPACE
               MOVE    "."               TO  WRK-TANKA-Z2
           END-IF
      *        
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-TANKA-X         TO  WRK-CHAR-X
           MOVE    12                  TO  WRK-CHAR-CNT
           MOVE    1                   TO  WRK-CHAR-IDX
           MOVE    ZERO                TO  WRK-CHAR-N-CNT
      *     
           PERFORM VARYING     IDW     FROM    1   BY  1
                   UNTIL       IDW     >   WRK-CHAR-CNT
               IF      WRK-CHAR-X (IDW:1)  =   SPACE
                   CONTINUE
               ELSE        
                   IF    WRK-CHAR-X (IDW:1)  IS  NUMERIC
                       IF      WRK-CHAR-X (IDW:1)  =   "0"
                           MOVE    TBL-SUJI (10)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE
                           MOVE    WRK-CHAR-X (IDW:1)  TO  NUM-IDX
                           MOVE    TBL-SUJI (NUM-IDX)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF                    
                   ELSE
                       IF    WRK-CHAR-X (IDW:1)  =   "."
                           MOVE    "．"   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE    
                           MOVE    "  "   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF
                   END-IF    
                   ADD     2           TO  WRK-CHAR-IDX
                                           WRK-CHAR-N-CNT
               END-IF    
           END-PERFORM
      *
           IF      WRK-CHAR-N-CNT      >   ZERO
                   MOVE    "円"        TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                   ADD     2           TO  WRK-CHAR-N-CNT
           END-IF                             
      *
           .
       2101212-RECE65-TANKA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    残量廃棄の数量編集処理
      *****************************************************************
       2101213-RECE65-SURYO-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-SURYO-X
           MOVE    ZERO            TO  WRK-SURYOST
           MOVE    ZERO            TO  WRK-SURYOKETA
           MOVE    ZERO            TO  WRK-SURYOKETA1
           MOVE    ZERO            TO  WRK-SURYOKETA2
           MOVE    SPACE           TO  WRK-SURYO-N
           MOVE    SPACE           TO  WRK-SRYSURYOW
      *
      *    数字表示用編集（半角）
      ***  MOVE    RECE65-SRYSURYO(IDX4)  TO  WRK-SURYO
           MOVE    WRK-SRYSURYO           TO  WRK-SURYO
           MOVE    WRK-SURYO-S1           TO  WRK-SURYO-Z1
      *
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDW   FROM    5   BY  -1
                      UNTIL    IDW   =   ZERO
             IF  WRK-SURYO-S2(IDW:1) NOT =   ZERO
                 MOVE    1         TO  FLG-SP
             END-IF
             IF  FLG-SP  =   1
                 MOVE    WRK-SURYO-S2(IDW:1)
                                   TO  WRK-SURYO-Z3(IDW:1)
             END-IF
           END-PERFORM
           IF  WRK-SURYO-Z3   NOT =  SPACE
               MOVE    "."         TO  WRK-SURYO-Z2
           END-IF
      *    表示文字数カウント
           PERFORM   VARYING   IDW   FROM    1   BY  1
                      UNTIL    IDW     >    11
             IF  WRK-SURYO-X(IDW:1)  NOT =  SPACE
                 IF  WRK-SURYOST           =   ZERO
                     MOVE    IDW   TO  WRK-SURYOST
                 END-IF
      *          数量桁数カウント(６桁目：ピリオド)
                 ADD     1         TO  WRK-SURYOKETA
                 IF  IDW    <   6
                     ADD     1     TO  WRK-SURYOKETA1
                 END-IF
                 IF  IDW    >   6
                     ADD     1     TO  WRK-SURYOKETA2
                 END-IF
             END-IF
           END-PERFORM
           IF  WRK-SURYOST  =   6
               MOVE   "0"          TO  WRK-SURYO-Z1(5:1)
               MOVE    5           TO  WRK-SURYOST
               MOVE    1           TO  WRK-SURYOKETA1
               ADD     1           TO  WRK-SURYOKETA
           END-IF
      *    全角変換
           IF  WRK-SURYOKETA1   >   ZERO
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z1(WRK-SURYOST:WRK-SURYOKETA1)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA1  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N1
           END-IF
           IF  WRK-SURYOKETA2   >   ZERO
               MOVE    "．"            TO  WRK-SURYO-N2
      *
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z3(1:WRK-SURYOKETA2)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA2  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N3
           END-IF
      *
           STRING      WRK-SURYO-N1    DELIMITED   BY  " "
                       WRK-SURYO-N2    DELIMITED   BY  " "
                       WRK-SURYO-N3    DELIMITED   BY  " "
                       INTO            WRK-SRYSURYOW
           END-STRING
      *
           .
       2101213-RECE65-SURYO-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    関係コメント編集
      *****************************************************************
       2101214-SETCOM-HENSYU-SEC     SECTION.
      *
           IF   RECE65-MEISKYFLG(IDX4)  =  "2"
              IF   (FLG-SETCOM              =  1   )
              AND  (RECE65-RECEDENFLG(IDX4) = SPACE)
                 MOVE  "1"            TO  RECE64-SETCOMFLG
              ELSE
                 MOVE  SPACE          TO  RECE65-MEISKYFLG(IDX4)
              END-IF
           ELSE
              IF   (RECE65-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
              OR   (RECE65-SRYCD(IDX4)(1:3) = "059"            )
                IF  RECE65-SRYCD(IDX4)(1:2) = "63"
                 CONTINUE
                ELSE
                 MOVE   1             TO  FLG-SETCOM
                END-IF
              END-IF
           END-IF
      *
      *****
      *
      ***==２０２０年４月以降に追加となった選択式コメントの対応は不要
      *    特定薬剤治療管理料
           IF    RECE65-SRYCD(IDX4)   = "113000410" OR "113000510" OR
                                        "180000110" OR "180000210" OR
                                        "113023910"
                 MOVE   1             TO  WRK-SETCOM-JIDO
           END-IF
      *    悪性腫瘍特異物質治療管理料
           IF    RECE65-SRYCD(IDX4)   = "113001210" OR "113001310" OR
                                        "113002110"
                 MOVE   3             TO  WRK-SETCOM-JIDO
           END-IF
      *    初診（同日複数診療科）
           IF    RECE65-SRYCD(IDX4)   = "111011810"
                                     OR "111012610"
                                     OR "111012810"
                 MOVE   4             TO  WRK-SETCOM-JIDO
           END-IF
      *    傷病手当金意見書交付料
           IF    RECE65-SRYCD(IDX4)   = "180000710"
                 MOVE   6             TO  WRK-SETCOM-JIDO
           END-IF
      *    療養費同意書交付料
           IF    RECE65-SRYCD(IDX4)   = "113004310"
                 MOVE   7             TO  WRK-SETCOM-JIDO
           END-IF
      *    訪問看護指示料
           IF    RECE65-SRYCD(IDX4)   = "114008010"
                 MOVE   11            TO  WRK-SETCOM-JIDO
           END-IF
      *    在宅半固形栄養経管栄養法指導管理料
           IF    RECE65-SRYCD(IDX4)   = "114045510"
                 MOVE   19            TO  WRK-SETCOM-JIDO
           END-IF
      *    在宅患者共同診療料
           IF    RECE65-SRYCD(IDX4)   = "114027610"
                                     OR "114027710"
                                     OR "114027810"
                                     OR "114027910"
                 MOVE   29            TO  WRK-SETCOM-JIDO
           END-IF
      *    高気圧酸素治療
           IF    RECE65-SRYCD(IDX4)   = "140057510"
                                     OR "140057610"
                 MOVE   35            TO  WRK-SETCOM-JIDO
           END-IF
      *    時間外緊急院内検査加算
      *    外来迅速検体検査加算
           IF   (RECE65-SRYCD(IDX4)   = "160000210"
                                     OR "160177770"         )
           AND  (RECE62-SRYYM        >= "201810"            )
                 MOVE   43            TO  WRK-SETCOM-JIDO
           END-IF
      *    時間外緊急院内画像診断加算
           IF   (RECE65-SRYCD(IDX4)   = "170016010"         )
           AND  (RECE62-SRYYM        >= "201810"            )
                 MOVE   44            TO  WRK-SETCOM-JIDO
           END-IF
      *    経頭蓋磁気刺激療法
           IF   (RECE65-SRYCD(IDX4)   = "180058650")
           AND  (RECE62-SRYYM        >= "202004"   )
                 MOVE   47            TO  WRK-SETCOM-JIDO
           END-IF
      *    時間外緊急院内検査加算
           IF   (RECE65-SRYCD(IDX4)   = "160000210")
           AND  (RECE62-SRYYM        >= "202007"   )
                 MOVE   48            TO  WRK-SETCOM-JIDO
           END-IF
      *    時間外緊急院内画像診断加算
           IF   (RECE65-SRYCD(IDX4)   = "170016010")
           AND  (RECE62-SRYYM        >= "202007"   )
                 MOVE   49            TO  WRK-SETCOM-JIDO
           END-IF
      *    排尿自立指導料
           IF    RECE65-SRYCD(IDX4)   = "113022810"
                 MOVE   100           TO  WRK-SETCOM-JIDO
           END-IF
      *    退院前訪問指導料
           IF    RECE65-SRYCD(IDX4)   = "190030310"
                 MOVE   103           TO  WRK-SETCOM-JIDO
           END-IF
      *    精神科退院前訪問指導料
      ***  IF    RECE65-SRYCD(IDX4)   = "180018310"
      ***                           OR  "188003110"
      ***        MOVE   105           TO  WRK-SETCOM-JIDO
      ***  END-IF
      *    退院時共同指導料２
           IF    RECE65-SRYCD(IDX4)   = "113008910"
                 MOVE   108           TO  WRK-SETCOM-JIDO
           END-IF
      *    心不全に対する遠赤外線温熱療法
           IF    RECE65-SRYCD(IDX4)   = "140061210"
                 MOVE   110           TO  WRK-SETCOM-JIDO
           END-IF
      *
      *    特定薬剤治療管理加算（臓器移植月から３月）
           IF    RECE65-SRYCD(IDX4)   = "113000670" OR "113000770"
                                     OR "113029170" OR "113029270"
                                     OR "113029370"
                 MOVE   1             TO  WRK-SETCOM-JIDO2
           END-IF
      *    疾患別等専門プログラム加算
           IF    RECE65-SRYCD(IDX4)   = "180056570"
                 MOVE   2             TO  WRK-SETCOM-JIDO2
           END-IF
      *
           IF  ((WRK-SETCOM-JIDO    =  1                        ) AND
                (RECE65-SRYCD(IDX4) = "830000014" OR "840000038"
                                                  OR "840000538"))
           OR  ((WRK-SETCOM-JIDO    =  3                        ) AND
                (RECE65-SRYCD(IDX4) = "830000015"               ))
           OR  ((WRK-SETCOM-JIDO    =  4                        ) AND
                (RECE65-SRYCD(IDX4) = "830000024"               ))
           OR  ((WRK-SETCOM-JIDO    =  6                        ) AND
                (RECE65-SRYCD(IDX4) = "840000011"
                                   OR "840000012"
                                   OR "840000511"
                                   OR "840000512"               ))
           OR  ((WRK-SETCOM-JIDO    =  7                        ) AND
                (RECE65-SRYCD(IDX4) = "840000078"
                                   OR "840000578"               ))
           OR  ((WRK-SETCOM-JIDO    =  11                       ) AND
                (RECE65-SRYCD(IDX4) = "840000073"               ))
           OR  ((WRK-SETCOM-JIDO    =  19                       ) AND
                (RECE65-SRYCD(IDX4) = "840000097"               ))
           OR  ((WRK-SETCOM-JIDO    =  29                       ) AND
                (RECE65-SRYCD(IDX4) = "840000097"
                                   OR "840000086"               ))
           OR  ((WRK-SETCOM-JIDO    =  35                       ) AND
                (RECE65-SRYCD(IDX4) = "840000085"
                                   OR "840000086"
                                   OR "840000045"               ))
           OR  ((WRK-SETCOM-JIDO    =  43                       ) AND
                (RECE65-SRYCD(IDX4) = "820100129"
                                   OR "840000044"               ))
           OR  ((WRK-SETCOM-JIDO    =  44                       ) AND
                (RECE65-SRYCD(IDX4) = "820100129"
                                   OR "840000071"               ))
           OR  ((WRK-SETCOM-JIDO    =  47                       ) AND
                (RECE65-SRYCD(IDX4) = "840000076"               ))
           OR  ((WRK-SETCOM-JIDO    =  48                       ) AND
                (RECE65-SRYCD(IDX4) = "840000099"               ))
           OR  ((WRK-SETCOM-JIDO    =  49                       ) AND
                (RECE65-SRYCD(IDX4) = "840000099"               ))
           OR  ((WRK-SETCOM-JIDO    =  100                      ) AND
                (RECE65-SRYCD(IDX4) = "840000097"
                                   OR "840000086"               ))
           OR  ((WRK-SETCOM-JIDO    =  103                      ) AND
                (RECE65-SRYCD(IDX4) = "840000055"               ))
      ***  OR  ((WRK-SETCOM-JIDO    =  105                      ) AND
      ***       (RECE65-SRYCD(IDX4) = "840000079"               ))
           OR  ((WRK-SETCOM-JIDO    =  108                      ) AND
                (RECE65-SRYCD(IDX4) = "840000110"               ))
           OR  ((WRK-SETCOM-JIDO    =  110                      ) AND
                (RECE65-SRYCD(IDX4) = "840000076"               ))
      *
           OR  ((WRK-SETCOM-JIDO2   =  1                        ) AND
                (RECE65-SRYCD(IDX4) = "840000077"               ))
           OR  ((WRK-SETCOM-JIDO2   =  2                        ) AND
                (RECE65-SRYCD(IDX4) = "840000076"               ))
      *
                 MOVE  "1"              TO  RECE64-SETCOMFLG
                 MOVE  "2"              TO  RECE65-MEISKYFLG(IDX4)
                 MOVE   1               TO  RECE65-SETCOMATFLG(IDX4)
                 IF  (WRK-SETCOM-JIDO2   =  1         )
                 AND (RECE65-SRYCD(IDX4) = "840000077")
                   MOVE    2            TO  RECE65-SETCOMATFLG(IDX4)
                 END-IF
                 IF  (WRK-SETCOM-JIDO2   =  2                 )
                 AND (RECE65-SRYCD(IDX4) = "840000076"        )
                   MOVE    2            TO  RECE65-SETCOMATFLG(IDX4)
                 END-IF
      *
           END-IF
      ***==
      *
           IF    RECE65-INGAIFLG(IDX4)  =   "1"
      *
                 MOVE  "1"              TO  RECE64-SETCOMFLG
      *
           END-IF
      *
           .
       2101214-SETCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】保険欄ー一部負担金記載ありコメント編集
      *****************************************************************
       2101215-ICHIBUCOM-HENSYU-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             MOVE    SRY-SRYKBN           TO  WRK-TH-SRYKBN
             PERFORM 950-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "（再掲上）："
             OR  WRK-INPUTCOMENT(1:12)  =  "（再掲下）："
             OR  WRK-INPUTCOMENT(1:12)  =  "（再掲３）："
             OR  WRK-INPUTCOMENT(1:12)  =  "（再掲４）："
             OR  WRK-INPUTCOMENT(1:12)  =  "保険負担金："
               MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲上）："
                     MOVE  ZERO        TO  RECE62-SAIKEI-CHIKAN-KIN1
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE62-SAIKEI-CHIKAN-KIN1
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲下）："
                     MOVE  ZERO        TO  RECE62-SAIKEI-CHIKAN-KIN2
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE62-SAIKEI-CHIKAN-KIN2
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲３）："
                     MOVE  ZERO        TO  RECE62-SAIKEI-CHIKAN-KIN3
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE62-SAIKEI-CHIKAN-KIN3
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲４）："
                     MOVE  ZERO        TO  RECE62-SAIKEI-CHIKAN-KIN4
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE62-SAIKEI-CHIKAN-KIN4
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "保険負担金："
                     MOVE  ZERO        TO  RECE62-HKN-CHIKAN-KIN
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE62-HKN-CHIKAN-KIN
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2101215-ICHIBUCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】公費欄ー一部負担金金額置換コメント編集
      *****************************************************************
       2101215-ICHIBUCOM-HENSYU2-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             MOVE    SRY-SRYKBN           TO  WRK-TH-SRYKBN
             PERFORM 950-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "公１負担金："
             OR  WRK-INPUTCOMENT(1:12)  =  "公２負担金："
             OR  WRK-INPUTCOMENT(1:12)  =  "公３負担金："
             OR  WRK-INPUTCOMENT(1:12)  =  "公４負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公１負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公２負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公３負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公４負担金："
               IF  WRK-INPUTCOMENT(1:12)  =  "公１負担金："
               OR  WRK-INPUTCOMENT(1:12)  =  "公２負担金："
               OR  WRK-INPUTCOMENT(1:12)  =  "公３負担金："
               OR  WRK-INPUTCOMENT(1:12)  =  "公４負担金："
                 MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               END-IF
               IF  WRK-INPUTCOMENT(1:22)  =  "公費請求書公１負担金："
               OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公２負担金："
               OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公３負担金："
               OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公４負担金："
                 MOVE  WRK-INPUTCOMENT(23:14)
                                          TO  WRK-INPUTCOMENT2
               END-IF
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   IF  WRK-INPUTCOMENT(1:12)  =  "公１負担金："
                     MOVE  ZERO     TO  RECE62-KOH-CHIKAN-KIN1
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-KOH-CHIKAN-KIN1
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "公２負担金："
                     MOVE  ZERO     TO  RECE62-KOH-CHIKAN-KIN2
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-KOH-CHIKAN-KIN2
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "公３負担金："
                     MOVE  ZERO     TO  RECE62-KOH-CHIKAN-KIN3
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-KOH-CHIKAN-KIN3
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "公４負担金："
                     MOVE  ZERO     TO  RECE62-KOH-CHIKAN-KIN4
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-KOH-CHIKAN-KIN4
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公１負担金："
                     MOVE  ZERO     TO  RECE62-SEI-CHIKAN-KIN1
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-SEI-CHIKAN-KIN1
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公２負担金："
                     MOVE  ZERO     TO  RECE62-SEI-CHIKAN-KIN2
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-SEI-CHIKAN-KIN2
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公３負担金："
                     MOVE  ZERO     TO  RECE62-SEI-CHIKAN-KIN3
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-SEI-CHIKAN-KIN3
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公４負担金："
                     MOVE  ZERO     TO  RECE62-SEI-CHIKAN-KIN4
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE62-SEI-CHIKAN-KIN4
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2101215-ICHIBUCOM-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】（第三者行為）一部負担金金額置換コメント編集
      *****************************************************************
       2101215-ICHIBUCOM-HENSYU3-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             MOVE    SRY-SRYKBN           TO  WRK-TH-SRYKBN
             PERFORM 950-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "一部負担額："
               MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   MOVE    1    TO   RECE62-DAISAN-CHIKAN
                   MOVE  WRK-INPUTCOMENT-KIN
                                TO   RECE62-DAISAN-FTNMONEY
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2101215-ICHIBUCOM-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    明細数等の編集
      *****************************************************************
       2101216-MEISAISU-HENSYU-SEC                 SECTION.
      *
           COMPUTE   RECE64-MEISAISU    =  RECE64-MEISAISU
                                        -  1
           MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
           COMPUTE   RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                        -  WRK-SRYCD
           COMPUTE   RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                        -  SRY-SRYSURYO(IDX2)
      *
           .
       2101216-MEISAISU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    リハ開始日編集
      *****************************************************************
       2101217-RIHAYMD-HENSYU-SEC                 SECTION.
      *
           MOVE      SPACE   TO  WRK-RIHA-YMD
           MOVE      SPACE   TO  WRK-RIHA-YMD-SEI
      *
           IF    SRY-SRYCD(IDX2) = "840000061" OR "840000561"
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             MOVE    SRY-SRYKBN           TO  WRK-TH-SRYKBN
             PERFORM 950-PTCOM-READ-SEC
      *
             IF    SRY-SRYCD(IDX2) = "840000061"
               MOVE     "4"    TO    WRK-RIHA-YMD(1:1)
             END-IF
             IF    SRY-SRYCD(IDX2) = "840000561"
               MOVE     "5"    TO    WRK-RIHA-YMD(1:1)
             END-IF
             MOVE  PTCOM-INPUTCHI1(1:2)  TO  WRK-RIHA-YMD(2:2)
             MOVE  PTCOM-INPUTCHI2(1:2)  TO  WRK-RIHA-YMD(4:2)
             MOVE  PTCOM-INPUTCHI3(1:2)  TO  WRK-RIHA-YMD(6:2)
      *
             IF    WRK-RIHA-YMD  IS  NUMERIC
               INITIALIZE                   LNK-DAY1-AREA
               INITIALIZE                   STS-AREA-DAY
               MOVE    "12"           TO    LNK-DAY1-IRAI
               MOVE    WRK-RIHA-YMD   TO    LNK-DAY1-WYMD
               CALL    "ORCSDAY"      USING STS-AREA-DAY
                                            LNK-DAY1-AREA
               IF      STS-DAY-RC1    =     ZERO
                 MOVE  LNK-DAY1-YMD   TO  WRK-RIHA-YMD-SEI
               ELSE
                 MOVE  SPACE          TO  WRK-RIHA-YMD
               END-IF
             ELSE
               MOVE    SPACE          TO  WRK-RIHA-YMD
             END-IF
           END-IF
      *
           EVALUATE    FLG-RIHA-OKIKAE
             WHEN         1
               MOVE       1     TO  RECE62-RIHA2-SINDAI(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-SINYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE62-RIHA2-SINYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-SINYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-SINYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         2
               MOVE       1     TO  RECE62-RIHA2-NOUKE(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-NOUYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE62-RIHA2-NOUYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-NOUYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-NOUYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         3
               MOVE       1     TO  RECE62-RIHA2-UNDOKI(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-UNDYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE62-RIHA2-UNDYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-UNDYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-UNDYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         4
               MOVE       1     TO  RECE62-RIHA2-KOKYUKI(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-KOKYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE62-RIHA2-KOKYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-KOKYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-KOKYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         5
               MOVE       1     TO  RECE62-RIHA2-SESSYOKU(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-SESYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE62-RIHA2-SESYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-SESYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-SESYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         6
               MOVE       1     TO  RECE62-RIHA2-HAIYO(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-HAIYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE62-RIHA2-HAIYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-HAIYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-HAIYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         7
               MOVE       1     TO  RECE62-RIHA2-SINDAI9(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-SIN9YMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                      >   2  )
                              OR    (RECE62-RIHA2-SIN9YMD1(IDX1 IDW9)
                                                               = SPACE)
                              OR    (FLG-ARI5                  =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-SIN9YMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-SIN9YMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         8
               MOVE       1     TO  RECE62-RIHA2-KOKYUKI9(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-KOK9YMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                      >   2  )
                              OR    (RECE62-RIHA2-KOK9YMD1(IDX1 IDW9)
                                                               = SPACE)
                              OR    (FLG-ARI5                  =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-KOK9YMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-KOK9YMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         9
               MOVE       1     TO  RECE62-RIHA2-HAIYO9(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE62-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE62-RIHA2-HAI9YMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                      >   2  )
                              OR    (RECE62-RIHA2-HAI9YMD1(IDX1 IDW9)
                                                               = SPACE)
                              OR    (FLG-ARI5                  =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE62-RIHA2-HAI9YMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE62-RIHA2-HAI9YMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
           END-EVALUATE
      *
           .
       2101217-RIHAYMD-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    コメント編集
      *****************************************************************
       2101218-COMENT-HENSYU-SEC                 SECTION.
      *
           IF    ((WRK-TH-SRYCD(1:1)     =   "8"  )  OR
                  (WRK-TH-SRYCD(1:3)     =   "008"))
           AND   ( WRK-TH-INPUTNUM   NOT =   ZERO  )
                   MOVE    WRK-TH-HOSPNUM      TO  PTCOM-HOSPNUM
                   MOVE    WRK-TH-PTID         TO  PTCOM-PTID
                   MOVE    WRK-TH-ZAINUM       TO  PTCOM-ZAINUM
                   MOVE    WRK-TH-SRYCD        TO  PTCOM-SRYCD
                   MOVE    WRK-TH-INPUTNUM     TO  PTCOM-RENNUM
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT   TO  RECE65-NAME(IDX4)
                                                   RECE65-INPUTCOMENT
                                                              (IDX4)
      *
                   IF       WRK-TH-SRYCD(1:1) = "8"
                       IF  (WRK-TH-SRYCD(1:2) =
                                        "84" OR "85" OR "88")
                       OR  (WRK-TH-SRYCD(1:4) = "8311"      )
      *
                         MOVE  SPACE   TO   WRK-INPUTCHI4
                         IF   WRK-TH-SRYCD(1:4)    =  "8801"
                         AND  PTCOM-INPUTCHI1  NOT =  SPACE
                         AND  PTCOM-INPUTCHI4  NOT =  SPACE
                           MOVE   PTCOM-INPUTCHI4  TO  WRK-INPUTCHI4BK
                           PERFORM  21012181-COM88-HENSYU-SEC
                         END-IF
      *
                         IF  PTCOM-INPUTCHI1  NOT =  SPACE
                           INITIALIZE              ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           IF   WRK-INPUTCHI4 = SPACE
                            STRING  PTCOM-INPUTCHI1 DELIMITED  BY  SPACE
                                    PTCOM-INPUTCHI2 DELIMITED  BY  SPACE
                                    PTCOM-INPUTCHI3 DELIMITED  BY  SPACE
                                    PTCOM-INPUTCHI4 DELIMITED  BY  SPACE
                                    INTO   KANACHK-MAE-INPUT
                            END-STRING
                           ELSE
                            STRING  PTCOM-INPUTCHI1 DELIMITED  BY  SPACE
                                    PTCOM-INPUTCHI2 DELIMITED  BY  SPACE
                                    PTCOM-INPUTCHI3 DELIMITED  BY  SPACE
                                    WRK-INPUTCHI4   DELIMITED  BY  SPACE
                                    INTO   KANACHK-MAE-INPUT
                            END-STRING
                           END-IF
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF      KANACHK-RC      =   ZERO
                               MOVE    KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                           RECE65-INPUTCOMENT   (IDX4)
                           END-IF
                         ELSE
                               MOVE    SPACE       TO
                                           RECE65-INPUTCOMENT   (IDX4)
                         END-IF
                         IF  (TNS-FORMALNAME  =   SPACE   )
                         OR  (RECE62-SRYYM    <   "202004")
                           CONTINUE
                         ELSE
                           COMPUTE WRK-INPUTCOMMENT-ST
                                           =   TNS-YUKOKETA  *   2
                                           +   1
                           INITIALIZE              ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI
                           STRING  TNS-FORMALNAME  DELIMITED  BY  SPACE
                                   PTCOM-INPUTCOMENT
                                               (WRK-INPUTCOMMENT-ST:)
                                                   DELIMITED  BY  SPACE
                                   INTO   KANACHK-MAE-INPUT
                           END-STRING
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF      KANACHK-RC      =   ZERO
                               MOVE    KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                                   RECE65-NAME  (IDX4)
                           END-IF
                         END-IF
                       ELSE
                           INITIALIZE                  ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           MOVE    TNS-NAME        TO  KANACHK-MAE-INPUT
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF    ( KANACHK-RC      =   ZERO )
                           AND   ( KANACHK-MAX     >   ZERO )
                               COMPUTE IDXX    =   KANACHK-MAX +   1
                               MOVE    PTCOM-INPUTCOMENT (IDXX:)
                                                       TO
                                           RECE65-INPUTCOMENT   (IDX4)
                           ELSE
                               MOVE    PTCOM-INPUTCOMENT
                                                       TO
                                           RECE65-INPUTCOMENT   (IDX4)
                           END-IF
      *
                           IF      PTCOM-INPUTSTRING  =   SPACE
                             IF  (TNS-FORMALNAME  =   SPACE   )
                             OR  (RECE62-SRYYM    <   "202004")
                               CONTINUE
                             ELSE
                               COMPUTE WRK-INPUTCOMMENT-ST
                                           =   TNS-YUKOKETA  *   2
                                           +   1
                               INITIALIZE              ORCSKANACHKAREA
                               MOVE    "2"         TO  KANACHK-SYORI
                               STRING  TNS-FORMALNAME
                                               DELIMITED  BY  SPACE
                                       PTCOM-INPUTCOMENT
                                                 (WRK-INPUTCOMMENT-ST:)
                                               DELIMITED  BY  SPACE
                                               INTO   KANACHK-MAE-INPUT
                               END-STRING
                               CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                               IF      KANACHK-RC      =   ZERO
                                   MOVE
                                       KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                                   RECE65-NAME  (IDX4)
                               END-IF
                             END-IF
                           ELSE
                             IF  (TNS-FORMALNAME  =   SPACE   )
                             OR  (RECE62-SRYYM    <   "202004")
                               INITIALIZE              ORCSKANACHKAREA
                               MOVE    "2"             TO  KANACHK-SYORI
                               STRING  TNS-NAME
                                               DELIMITED  BY  SPACE
                                       PTCOM-INPUTSTRING
                                               DELIMITED  BY  SPACE
                                               INTO   KANACHK-MAE-INPUT
                               END-STRING
                               CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                               IF      KANACHK-RC      =   ZERO
                                   MOVE
                                       KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                                   RECE65-NAME  (IDX4)
                               END-IF
                             ELSE
                               INITIALIZE              ORCSKANACHKAREA
                               MOVE    "2"             TO  KANACHK-SYORI
                               STRING  TNS-FORMALNAME
                                               DELIMITED  BY  SPACE
                                   PTCOM-INPUTSTRING
                                               DELIMITED  BY  SPACE
                                               INTO   KANACHK-MAE-INPUT
                               END-STRING
                               CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                               IF      KANACHK-RC      =   ZERO
                                   MOVE
                                       KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                                   RECE65-NAME  (IDX4)
                               END-IF
                             END-IF
                             MOVE    PTCOM-INPUTSTRING
                                               TO  RECE65-INPUTCOMENT
                                                                (IDX4)
                           END-IF
                       END-IF
                       IF   (RECE62-SRYYM      >= "202004")
                       AND  (RECE62-SRYYM      <= "202006")
                       AND  (WRK-TH-SRYCD(4:1)  = "1"     )
                       AND  (TNS-FORMALNAME    NOT = SPACE)
                         MOVE   "1"   TO   RECE65-COMCDCHGFLG(IDX4)
                       END-IF
                   END-IF
      *
      ***          MOVE   "1"              TO  RECE64-COMCDFLG
           ELSE
                   MOVE    TNS-NAME        TO  RECE65-NAME(IDX4)
                                               RECE65-INPUTCOMENT
                                                          (IDX4)
                   MOVE    TNS-YUKOKETA    TO  RECE65-YUKOKETA(IDX4)
                   IF      TNS-SRYCD       =  "180706810" OR "180706910"
                                           OR "180707010" OR "180707110"
                                           OR "180707210" OR "180707310"
                                           OR "180707410" OR "180707510"
                         MOVE  "老人"    TO   RECE65-NAME(IDX4)(1:4)
                         MOVE  TNS-NAME  TO   RECE65-NAME(IDX4)(5:) 
                         COMPUTE  RECE65-YUKOKETA(IDX4) =
                                  RECE65-YUKOKETA(IDX4) + 2
                   END-IF
                   IF   (RECE62-SRYYM        >= "202004")
                   AND  (WRK-TH-SRYCD(1:1)    = "8"     )
                   AND  (TNS-FORMALNAME   NOT = SPACE   )
                     MOVE  TNS-FORMALNAME  TO  RECE65-NAME(IDX4)
                                               RECE65-INPUTCOMENT(IDX4)
                     MOVE  ZERO            TO  RECE65-YUKOKETA(IDX4)
                     IF   (WRK-TH-SRYCD(4:1)  = "1"     )
                     AND  (RECE62-SRYYM      <= "202006")
                       MOVE    "1"         TO  RECE65-COMCDCHGFLG(IDX4)
                     END-IF
                   END-IF
           END-IF
      *
           .
       2101218-COMENT-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    コメント８８０１編集
      *****************************************************************
       21012181-COM88-HENSYU-SEC                 SECTION.
      *
           MOVE  ZERO    TO   WRK-SHO
           MOVE  ZERO    TO   WRK-AMARI
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "2"             TO  KANACHK-SYORI 
           STRING  WRK-INPUTCHI4BK DELIMITED  BY  SPACE
                   INTO   KANACHK-MAE-INPUT
           END-STRING
           CALL    "ORCSKANACHK"   USING
                                   ORCSKANACHKAREA
           IF      KANACHK-RC      = ZERO
           AND     KANACHK-MAX NOT = ZERO
             DIVIDE  2  INTO  KANACHK-MAX  GIVING  WRK-SHO
             REMAINDER  WRK-AMARI
             END-DIVIDE
             IF  WRK-AMARI = ZERO
             AND WRK-SHO   <  8
               COMPUTE  IDXC = 8 - WRK-SHO
               PERFORM VARYING IDXD FROM 1 BY 1
                        UNTIL  IDXD   >  IDXC
                 MOVE  "0"  TO  WRK-INPUTCHI4(IDXD:1)
               END-PERFORM
               MOVE  WRK-INPUTCHI4BK
                            TO  WRK-INPUTCHI4(IDXD:10)
             END-IF
           END-IF
      *
           .
       21012181-COM88-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    被保険者資格申立書提出患者のコメント編集
      *****************************************************************
       210121A-MSTCOM-HENSYU-SEC                 SECTION.
      *
           IF  SRY-SRYCD(IDX2) = "099999946"
             MOVE "820000246"      TO  RECE62-ONSHI-MST-SRYCD(1 1)
             MOVE "820000246"      TO  WRK-SRYCD-X
             MOVE  RECE65-SRYYM    TO  WK-TAIHI-SRYYM
             MOVE  WK-TAIHI-DAY    TO  WK-TAIHI-SRYD
             PERFORM  900-TENSU-TBL-SEC
      *******MOVE  TNS-NAME        TO  RECE62-ONSHI-MST-INPUTCOMENT(1 1)
             MOVE  TNS-NAME        TO  RECE62-ONSHI-MST-NAME(1 1)
      *
             IF   RECE62-KANANAME  NOT = SPACE
               MOVE "830000501"    TO  RECE62-ONSHI-MST-SRYCD(2 1)
               MOVE "830000501"    TO  WRK-SRYCD-X
               MOVE  RECE65-SRYYM  TO  WK-TAIHI-SRYYM
               MOVE  WK-TAIHI-DAY  TO  WK-TAIHI-SRYD
               PERFORM  900-TENSU-TBL-SEC
               MOVE  RECE62-KANANAME
                                   TO  RECE62-ONSHI-MST-INPUTCOMENT(2 1)
               STRING   TNS-NAME   DELIMITED   BY  SPACE
                        RECE62-KANANAME
                                   DELIMITED   BY  SPACE
                                   INTO    RECE62-ONSHI-MST-NAME(2 1)
               END-STRING
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000502"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX3
               IF    ONSHI-IDX3  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(3 ONSHI-IDX3)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(3 ONSHI-IDX3)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(3 ONSHI-IDX3)
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000503"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX4
               IF    ONSHI-IDX4  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(4 ONSHI-IDX4)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(4 ONSHI-IDX4)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(4 ONSHI-IDX4)
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000504"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX5
               IF    ONSHI-IDX5  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(5 ONSHI-IDX5)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(5 ONSHI-IDX5)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(5 ONSHI-IDX5)
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000505"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX6
               IF    ONSHI-IDX6  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(6 ONSHI-IDX6)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(6 ONSHI-IDX6)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(6 ONSHI-IDX6)
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000506"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX7
               IF    ONSHI-IDX7  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(7 ONSHI-IDX7)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(7 ONSHI-IDX7)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(7 ONSHI-IDX7)
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000507"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX8
               IF    ONSHI-IDX8  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(8 ONSHI-IDX8)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(8 ONSHI-IDX8)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(8 ONSHI-IDX8)
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX2) = "830000508"
             PERFORM   210121A1-MSTCOM-HENSYU2-SEC
             IF   WRK-ONSHI-INPUTCOMENT  NOT = SPACE
               ADD   1   TO  ONSHI-IDX9
               IF    ONSHI-IDX9  <=  10
                 MOVE  SRY-SRYCD(IDX2)
                         TO  RECE62-ONSHI-MST-SRYCD(9 ONSHI-IDX9)
                 MOVE  WRK-ONSHI-INPUTCOMENT
                         TO  RECE62-ONSHI-MST-INPUTCOMENT(9 ONSHI-IDX9)
                 MOVE  WRK-ONSHI-NAME
                         TO  RECE62-ONSHI-MST-NAME(9 ONSHI-IDX9)
               END-IF
             END-IF
           END-IF
      *
           .
       210121A-MSTCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    被保険者資格申立書提出患者のコメント編集
      *****************************************************************
       210121A1-MSTCOM-HENSYU2-SEC                 SECTION.
      *
           MOVE    SPACE           TO  WRK-ONSHI-INPUTCOMENT
           MOVE    SPACE           TO  WRK-ONSHI-NAME
      *
           MOVE    SRY-HOSPNUM         TO  PTCOM-HOSPNUM
           MOVE    SRY-PTID            TO  PTCOM-PTID
           MOVE    SRY-ZAINUM          TO  PTCOM-ZAINUM
           MOVE    SRY-SRYCD   (IDX2)  TO  PTCOM-SRYCD
           MOVE    SRY-INPUTNUM(IDX2)  TO  PTCOM-RENNUM
           MOVE    SRY-SRYKBN          TO  WRK-TH-SRYKBN
           PERFORM 950-PTCOM-READ-SEC
      *
           MOVE    PTCOM-INPUTCOMENT   TO  WRK-ONSHI-NAME
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "2"             TO  KANACHK-SYORI
           MOVE    TNS-NAME        TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"   USING
                                   ORCSKANACHKAREA
           IF      (KANACHK-RC   =  ZERO)
           AND     (KANACHK-MAX  >  ZERO)
             COMPUTE  IDXX = KANACHK-MAX + 1
             MOVE   PTCOM-INPUTCOMENT(IDXX:)
                                   TO  WRK-ONSHI-INPUTCOMENT
           ELSE
             MOVE   PTCOM-INPUTCOMENT
                                   TO  WRK-ONSHI-INPUTCOMENT
           END-IF
      *
           IF    PTCOM-INPUTSTRING  =  SPACE
             CONTINUE
           ELSE
             INITIALIZE                  ORCSKANACHKAREA
             MOVE    "2"             TO  KANACHK-SYORI
             STRING    TNS-NAME      DELIMITED   BY  SPACE
                       PTCOM-INPUTSTRING
                                     DELIMITED   BY  SPACE
                                     INTO    KANACHK-MAE-INPUT
             END-STRING
             CALL    "ORCSKANACHK"   USING
                                     ORCSKANACHKAREA
             IF       KANACHK-RC  =  ZERO
               MOVE   KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                     TO   WRK-ONSHI-NAME
             END-IF
             MOVE     PTCOM-INPUTSTRING
                                     TO   WRK-ONSHI-INPUTCOMENT
           END-IF
      *
           .
       210121A1-MSTCOM-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    旧資格情報患者のコメント編集
      *****************************************************************
       210121B-KSKCOM-HENSYU-SEC                 SECTION.
      *
           IF  SRY-SRYCD(IDX2) = "099999945"
             MOVE "820000245"      TO  RECE62-ONSHI-KSK-SRYCD
             MOVE "820000245"      TO  WRK-SRYCD-X
             MOVE  RECE65-SRYYM    TO  WK-TAIHI-SRYYM
             MOVE  WK-TAIHI-DAY    TO  WK-TAIHI-SRYD
             PERFORM  900-TENSU-TBL-SEC
      *******MOVE  TNS-NAME        TO  RECE62-ONSHI-KSK-INPUTCOMENT
             MOVE  TNS-NAME        TO  RECE62-ONSHI-KSK-NAME
           END-IF
      *
           .
       210121B-KSKCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       210122-RECE62-HENSYU-SEC               SECTION.
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
           MOVE          ZERO       TO     BUN-IDX6
      ***  IF    (RECE62-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE62-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE62-RJNHKNNUM       NOT =   SPACE)
               MOVE      1          TO     BUN-IDX
               IF   (RECE62-SEIHOFLG             =   "1"  )
               AND  (RECE62-SYUTANARIFLG         =    1   )
               AND  (RECE62-HKNNUMHC(IDX1)   NOT =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 1)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 2)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 3)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 4)     =   SPACE)
                  MOVE   6          TO     BUN-IDX6
               END-IF
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           IF  RECE62-HENTOTALTEN(2)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(2) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(2)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(1)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(1)
                               MOVE      2       TO     BUN-IDX2
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           MOVE          ZERO       TO     BUN-IDX32
           IF  RECE62-HENTOTALTEN(3)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(3) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(3)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(2)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(2)
                               MOVE      3       TO     BUN-IDX3
                               IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                               =   ZERO
                                 MOVE    3       TO     BUN-IDX32
                               END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           MOVE          ZERO       TO     BUN-IDX42
           IF  RECE62-HENTOTALTEN(4)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(4) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(4)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(3)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(3)
                               MOVE      4       TO     BUN-IDX4
                               IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                               =   ZERO
                                 MOVE    4       TO     BUN-IDX42
                               END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス５
           MOVE          ZERO       TO     BUN-IDX5
           MOVE          ZERO       TO     BUN-IDX52
           IF  RECE62-HENTOTALTEN(5)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(5) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(5)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(4)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(4)
                               MOVE      5       TO     BUN-IDX5
                               IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                               =   ZERO
                                 MOVE    5       TO     BUN-IDX52
                               END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *
           MOVE      ZERO       TO     WK-ZAIKAISU
           MOVE      ZERO       TO     WK-ZAITEN
           MOVE      ZERO       TO     WK-SYUTEN
           MOVE      ZERO       TO     WK-KIZAITEN
           MOVE      ZERO       TO     WK-YKZTEN
           MOVE      ZERO       TO     WK-YKZTEN2
      *
           PERFORM   VARYING  IDX3   FROM   1   BY   1
                     UNTIL    (IDX3         >     5)        OR
                              (SRY-SRYCD(IDX3)   =   SPACE)
               IF    SRY-RENNUM     =     1
                   IF  IDX3         =     1
                       MOVE  ACCT-ZAIKAISU     TO   WK-ZAIKAISU
                       MOVE  ACCT-ZAITEN       TO   WK-ZAITEN
                       IF    SRY-SRYKBN  =  "31"  OR  "32"  OR  "33"
                                MOVE   ACCT-YKZTEN    TO   WK-YKZTEN2
                       END-IF
                       IF    SRY-SRYKBN  =  "40"  OR  "50"  OR  "60"
                                        OR  "70"  OR  "80"  OR  "54"
                                        OR  "64"
                                MOVE   ACCT-SYUTEN1   TO   WK-SYUTEN
                                COMPUTE   WK-YKZTEN   =
                                                      ACCT-KIZAITEN  +
                                                      ACCT-YKZTEN
                       END-IF
                   ELSE
                       IF   SRY-SRYKBN   =  "21"  OR  "22"  OR  "23" OR
                                            "31"  OR  "32"  OR  "33" OR
                                            "40"  OR  "50"  OR  "54" OR
                                            "60"  OR  "70"  OR  "80" OR
                                            "13"  OR  "14"  OR  "64" OR
                                            "12"
                           MOVE  ZERO          TO   WK-ZAIKAISU
                           MOVE  ZERO          TO   WK-ZAITEN
                           MOVE  ZERO          TO   WK-SYUTEN
                           MOVE  ZERO          TO   WK-KIZAITEN
                           MOVE  ZERO          TO   WK-YKZTEN
                           MOVE  ZERO          TO   WK-YKZTEN2
                       END-IF
                   END-IF
               ELSE
                     MOVE    ZERO     TO    WK-ZAIKAISU
                     MOVE    ZERO     TO    WK-ZAITEN
                     MOVE    ZERO     TO    WK-SYUTEN
                     MOVE    ZERO     TO    WK-KIZAITEN
                     MOVE    ZERO     TO    WK-YKZTEN
                     MOVE    ZERO     TO    WK-YKZTEN2
               END-IF
               IF  ((ACCT-ZAITEN    NOT =    ZERO) AND
                    (ACCT-ZAIKAISU  NOT =    ZERO))
               OR  ((ACCT-ZAITEN        =    ZERO) AND
                    (ACCT-ZAIKAISU  NOT =    ZERO) AND
                    (FLG-GENTENCD-ARI   =     1  ))
                     PERFORM   2101221-RECE-LEFT-SET-SEC
               END-IF
               IF    SRY-SRYKBN   =   "21"   OR   "22"   OR   "23"   OR
                                      "31"   OR   "32"   OR   "33"   OR
                                      "40"   OR   "50"   OR   "54"   OR
                                      "60"   OR   "70"   OR   "13"   OR
                                      "14"   OR   "64"   OR   "12"
                     MOVE    6      TO    IDX3
               END-IF
           END-PERFORM
      *
           .                                           
      *
       210122-RECE62-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       2101221-RECE-LEFT-SET-SEC               SECTION.
      *
           MOVE        SRY-SRYCD(IDX3)     TO   WRK-SRYCD
           MOVE        RECE65-SRYYM        TO   WK-TAIHI-SRYYM
           MOVE        WK-TAIHI-DAY        TO   WK-TAIHI-SRYD
           PERFORM     900-TENSU-TBL-SEC
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF   (TNS-CHUKSNTUBAN             =   "0")
                   AND  (SRY-SRYCD(IDX3)(1:1)        =   "1")
                   AND  (SRY-SRYCD(IDX3)  NOT =
                         "111013970" AND "111014070" AND
                         "111014170"                        )
                   AND  (TNS-TENSIKIBETU         NOT =    8 )
                        ADD   WK-ZAIKAISU  TO   RECE62-KAISU(1)
                   END-IF
      ***          IF   TNS-DATAKBN  =   2
      ***            EVALUATE    TNS-TIMEKSNKBN
      ***                WHEN    1
      ***                WHEN    5
      ***                    MOVE  "1"     TO   RECE62-SHOSHINTIME
      ***                WHEN    4
      ***                    MOVE  "2"     TO   RECE62-SHOSHINTIME
      ***                WHEN    3
      ***                    MOVE  "3"     TO   RECE62-SHOSHINTIME
      ***            END-EVALUATE
      ***          END-IF
      *************１：時間外　２：深夜　３：休日　４：時間外・深夜
      *************５：時間外・休日　６：休日・深夜
      *************７：時間外・休日・深夜
                   IF   TNS-DATAKBN  =   2
                     EVALUATE    TNS-TIMEKSNKBN
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             EVALUATE   RECE62-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "1"     TO   RECE62-SHOSHINTIME
                               WHEN   "1"
                                  CONTINUE
                               WHEN   "2"
                                  MOVE  "4"     TO   RECE62-SHOSHINTIME
                               WHEN   "3"
                                  MOVE  "5"     TO   RECE62-SHOSHINTIME
                               WHEN   "4"
                                  CONTINUE
                               WHEN   "5"
                                  CONTINUE
                               WHEN   "6"
                                  MOVE  "7"     TO   RECE62-SHOSHINTIME
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                         WHEN    4
                             EVALUATE   RECE62-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "2"     TO   RECE62-SHOSHINTIME
                               WHEN   "1"
                                  MOVE  "4"     TO   RECE62-SHOSHINTIME
                               WHEN   "2"
                                  CONTINUE
                               WHEN   "3"
                                  MOVE  "6"     TO   RECE62-SHOSHINTIME
                               WHEN   "4"
                                  CONTINUE
                               WHEN   "5"
                                  MOVE  "7"     TO   RECE62-SHOSHINTIME
                               WHEN   "6"
                                  CONTINUE
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                         WHEN    3
                             EVALUATE   RECE62-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "3"     TO   RECE62-SHOSHINTIME
                               WHEN   "1"
                                  MOVE  "5"     TO   RECE62-SHOSHINTIME
                               WHEN   "2"
                                  MOVE  "6"     TO   RECE62-SHOSHINTIME
                               WHEN   "3"
                                  CONTINUE
                               WHEN   "4"
                                  MOVE  "7"     TO   RECE62-SHOSHINTIME
                               WHEN   "5"
                                  CONTINUE
                               WHEN   "6"
                                  CONTINUE
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                     END-EVALUATE
                   END-IF
                   IF   ACCT-ZAITEN  NOT =  ZERO
                     IF    TNS-TENSIKIBETU  =   8
                       IF    BUN-IDX        =   1
                           COMPUTE    RECE62-TENSU(1 BUN-IDX)  =
                                      RECE62-TENSU(1 BUN-IDX)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE    RECE62-TENSU(1 BUN-IDX2)  =
                                      RECE62-TENSU(1 BUN-IDX2)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE    RECE62-TENSU(1 BUN-IDX3)  =
                                      RECE62-TENSU(1 BUN-IDX3)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         IF  BUN-IDX32      =   3
                           COMPUTE    RECE62-SKYHENTEN(1 BUN-IDX3)  =
                                      RECE62-SKYHENTEN(1 BUN-IDX3)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE    RECE62-TENSU(1 BUN-IDX4)  =
                                      RECE62-TENSU(1 BUN-IDX4)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         IF  BUN-IDX42      =   4
                           COMPUTE    RECE62-SKYHENTEN(1 BUN-IDX4)  =
                                      RECE62-SKYHENTEN(1 BUN-IDX4)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE    RECE62-TENSU(1 BUN-IDX5)  =
                                      RECE62-TENSU(1 BUN-IDX5)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         IF  BUN-IDX52      =   5
                           COMPUTE    RECE62-SKYHENTEN(1 BUN-IDX5)  =
                                      RECE62-SKYHENTEN(1 BUN-IDX5)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE    RECE62-SYUTANTEN(1)  =
                                      RECE62-SYUTANTEN(1)  -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                       END-IF
                       COMPUTE        RECE62-ALLTENSU(1)   =
                                      RECE62-ALLTENSU(1)   -
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                     ELSE
                       IF    BUN-IDX        =   1
                           COMPUTE    RECE62-TENSU(1 BUN-IDX)  =
                                      RECE62-TENSU(1 BUN-IDX)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE    RECE62-TENSU(1 BUN-IDX2)  =
                                      RECE62-TENSU(1 BUN-IDX2)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE    RECE62-TENSU(1 BUN-IDX3)  =
                                      RECE62-TENSU(1 BUN-IDX3)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         IF  BUN-IDX32      =   3
                           COMPUTE    RECE62-SKYHENTEN(1 BUN-IDX3)  =
                                      RECE62-SKYHENTEN(1 BUN-IDX3)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE    RECE62-TENSU(1 BUN-IDX4)  =
                                      RECE62-TENSU(1 BUN-IDX4)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         IF  BUN-IDX42      =   4
                           COMPUTE    RECE62-SKYHENTEN(1 BUN-IDX4)  =
                                      RECE62-SKYHENTEN(1 BUN-IDX4)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE    RECE62-TENSU(1 BUN-IDX5)  =
                                      RECE62-TENSU(1 BUN-IDX5)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         IF  BUN-IDX52      =   5
                           COMPUTE    RECE62-SKYHENTEN(1 BUN-IDX5)  =
                                      RECE62-SKYHENTEN(1 BUN-IDX5)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE    RECE62-SYUTANTEN(1)  =
                                      RECE62-SYUTANTEN(1)  +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                       END-IF
                       COMPUTE        RECE62-ALLTENSU(1)   =
                                      RECE62-ALLTENSU(1)   +
                                     (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
      *    再診のレセ点数欄の編集
               WHEN    "12"
                   IF    BUN-IDX        =   1
                     COMPUTE        RECE62-NYUSAI-TENSU(BUN-IDX)  =
                                    RECE62-NYUSAI-TENSU(BUN-IDX)  +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-NYUKHNKEI2(BUN-IDX)    =
                                    RECE62-NYUKHNKEI2(BUN-IDX)    +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-NYUTOKKEI2(BUN-IDX)    =
                                    RECE62-NYUTOKKEI2(BUN-IDX)    +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                   END-IF
                   IF    BUN-IDX2       =   2
                     COMPUTE        RECE62-NYUSAI-TENSU(BUN-IDX2) =
                                    RECE62-NYUSAI-TENSU(BUN-IDX2) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-NYUKHNKEI2(BUN-IDX2)   =
                                    RECE62-NYUKHNKEI2(BUN-IDX2)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-NYUTOKKEI2(BUN-IDX2)   =
                                    RECE62-NYUTOKKEI2(BUN-IDX2)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                   END-IF
                   IF    BUN-IDX3       =   3
                     COMPUTE        RECE62-NYUSAI-TENSU(BUN-IDX3) =
                                    RECE62-NYUSAI-TENSU(BUN-IDX3) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-NYUKHNKEI2(BUN-IDX3)   =
                                    RECE62-NYUKHNKEI2(BUN-IDX3)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-NYUTOKKEI2(BUN-IDX3)   =
                                    RECE62-NYUTOKKEI2(BUN-IDX3)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                    IF   BUN-IDX32      =   3
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-SKYHENTEN-KHNKEI2(BUN-IDX3) =
                                    RECE62-SKYHENTEN-KHNKEI2(BUN-IDX3) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-SKYHENTEN-TOKKEI2(BUN-IDX3) =
                                    RECE62-SKYHENTEN-TOKKEI2(BUN-IDX3) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                    END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                     COMPUTE        RECE62-NYUSAI-TENSU(BUN-IDX4) =
                                    RECE62-NYUSAI-TENSU(BUN-IDX4) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-NYUKHNKEI2(BUN-IDX4)   =
                                    RECE62-NYUKHNKEI2(BUN-IDX4)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-NYUTOKKEI2(BUN-IDX4)   =
                                    RECE62-NYUTOKKEI2(BUN-IDX4)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                    IF   BUN-IDX42      =   4
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-SKYHENTEN-KHNKEI2(BUN-IDX4) =
                                    RECE62-SKYHENTEN-KHNKEI2(BUN-IDX4) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-SKYHENTEN-TOKKEI2(BUN-IDX4) =
                                    RECE62-SKYHENTEN-TOKKEI2(BUN-IDX4) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                    END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                     COMPUTE        RECE62-NYUSAI-TENSU(BUN-IDX5) =
                                    RECE62-NYUSAI-TENSU(BUN-IDX5) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-NYUKHNKEI2(BUN-IDX5)   =
                                    RECE62-NYUKHNKEI2(BUN-IDX5)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-NYUTOKKEI2(BUN-IDX5)   =
                                    RECE62-NYUTOKKEI2(BUN-IDX5)   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                    IF   BUN-IDX52      =   5
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-SKYHENTEN-KHNKEI2(BUN-IDX5) =
                                    RECE62-SKYHENTEN-KHNKEI2(BUN-IDX5) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-SKYHENTEN-TOKKEI2(BUN-IDX5) =
                                    RECE62-SKYHENTEN-TOKKEI2(BUN-IDX5) +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                    END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                     EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-SYUTANTEN-NYUKHN2   =
                                    RECE62-SYUTANTEN-NYUKHN2   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-SYUTANTEN-NYUTOK2   =
                                    RECE62-SYUTANTEN-NYUTOK2   +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-EVALUATE
                   END-IF
                   EVALUATE  WRK-NYUSAI-SRYKBN
                       WHEN      "90"
                         COMPUTE    RECE62-ALLTENSU-NYUKHN2    =
                                    RECE62-ALLTENSU-NYUKHN2    +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                       WHEN      "92"
                         COMPUTE    RECE62-ALLTENSU-NYUTOK2    =
                                    RECE62-ALLTENSU-NYUTOK2    +
                                   (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-EVALUATE
      *    指導のレセ点数欄の編集
               WHEN    "13"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE6G-TENSU(2 BUN-IDX)  =
                                  RECE6G-TENSU(2 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE6G-TENSU(2 BUN-IDX2)  =
                                  RECE6G-TENSU(2 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE6G-TENSU(2 BUN-IDX3)  =
                                  RECE6G-TENSU(2 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE    RECE6G-SKYHENTEN(2 BUN-IDX3)  =
                                  RECE6G-SKYHENTEN(2 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE6G-TENSU(2 BUN-IDX4)  =
                                  RECE6G-TENSU(2 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE    RECE6G-SKYHENTEN(2 BUN-IDX4)  =
                                  RECE6G-SKYHENTEN(2 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE6G-TENSU(2 BUN-IDX5)  =
                                  RECE6G-TENSU(2 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE    RECE6G-SKYHENTEN(2 BUN-IDX5)  =
                                  RECE6G-SKYHENTEN(2 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE6G-SYUTANTEN(2)  =
                                  RECE6G-SYUTANTEN(2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE6G-ALLTENSU(2)   =
                                  RECE6G-ALLTENSU(2)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE62-TENSU(2 BUN-IDX)  =
                                  RECE62-TENSU(2 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE62-TENSU(2 BUN-IDX2)  =
                                  RECE62-TENSU(2 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE62-TENSU(2 BUN-IDX3)  =
                                  RECE62-TENSU(2 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE    RECE62-SKYHENTEN(2 BUN-IDX3)  =
                                  RECE62-SKYHENTEN(2 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE62-TENSU(2 BUN-IDX4)  =
                                  RECE62-TENSU(2 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE    RECE62-SKYHENTEN(2 BUN-IDX4)  =
                                  RECE62-SKYHENTEN(2 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE62-TENSU(2 BUN-IDX5)  =
                                  RECE62-TENSU(2 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE    RECE62-SKYHENTEN(2 BUN-IDX5)  =
                                  RECE62-SKYHENTEN(2 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE62-SYUTANTEN(2)  =
                                  RECE62-SYUTANTEN(2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE62-ALLTENSU(2)   =
                                  RECE62-ALLTENSU(2)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE6G-TENSU(3 BUN-IDX)  =
                                  RECE6G-TENSU(3 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE6G-TENSU(3 BUN-IDX2)  =
                                  RECE6G-TENSU(3 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE6G-TENSU(3 BUN-IDX3)  =
                                  RECE6G-TENSU(3 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE    RECE6G-SKYHENTEN(3 BUN-IDX3)  =
                                  RECE6G-SKYHENTEN(3 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE6G-TENSU(3 BUN-IDX4)  =
                                  RECE6G-TENSU(3 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE    RECE6G-SKYHENTEN(3 BUN-IDX4)  =
                                  RECE6G-SKYHENTEN(3 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE6G-TENSU(3 BUN-IDX5)  =
                                  RECE6G-TENSU(3 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE    RECE6G-SKYHENTEN(3 BUN-IDX5)  =
                                  RECE6G-SKYHENTEN(3 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE6G-SYUTANTEN(3)  =
                                  RECE6G-SYUTANTEN(3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE6G-ALLTENSU(3)   =
                                  RECE6G-ALLTENSU(3)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE62-TENSU(3 BUN-IDX)  =
                                  RECE62-TENSU(3 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE62-TENSU(3 BUN-IDX2)  =
                                  RECE62-TENSU(3 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE62-TENSU(3 BUN-IDX3)  =
                                  RECE62-TENSU(3 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE    RECE62-SKYHENTEN(3 BUN-IDX3)  =
                                  RECE62-SKYHENTEN(3 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE62-TENSU(3 BUN-IDX4)  =
                                  RECE62-TENSU(3 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE    RECE62-SKYHENTEN(3 BUN-IDX4)  =
                                  RECE62-SKYHENTEN(3 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE62-TENSU(3 BUN-IDX5)  =
                                  RECE62-TENSU(3 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE    RECE62-SKYHENTEN(3 BUN-IDX5)  =
                                  RECE62-SKYHENTEN(3 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE62-SYUTANTEN(3)  =
                                  RECE62-SYUTANTEN(3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE62-ALLTENSU(3)   =
                                  RECE62-ALLTENSU(3)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF  SRY-SRYCD(IDX3) = "630010002"
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE62-TENSU(4 BUN-IDX)  =
                                     RECE62-TENSU(4 BUN-IDX)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE62-TENSU(4 BUN-IDX2)  =
                                     RECE62-TENSU(4 BUN-IDX2)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE62-TENSU(4 BUN-IDX3)  =
                                     RECE62-TENSU(4 BUN-IDX3)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         IF  BUN-IDX32      =   3
                           COMPUTE   RECE62-SKYHENTEN(4 BUN-IDX3)  =
                                     RECE62-SKYHENTEN(4 BUN-IDX3)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE62-TENSU(4 BUN-IDX4)  =
                                     RECE62-TENSU(4 BUN-IDX4)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         IF  BUN-IDX42      =   4
                           COMPUTE   RECE62-SKYHENTEN(4 BUN-IDX4)  =
                                     RECE62-SKYHENTEN(4 BUN-IDX4)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE62-TENSU(4 BUN-IDX5)  =
                                     RECE62-TENSU(4 BUN-IDX5)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         IF  BUN-IDX52      =   5
                           COMPUTE   RECE62-SKYHENTEN(4 BUN-IDX5)  =
                                     RECE62-SKYHENTEN(4 BUN-IDX5)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE62-SYUTANTEN(4)  =
                                     RECE62-SYUTANTEN(4)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE62-ALLTENSU(4)   =
                                     RECE62-ALLTENSU(4)   -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                   ELSE
                       ADD   WK-ZAIKAISU       TO   RECE62-KAISU(4)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE62-TENSU(4 BUN-IDX)  =
                                     RECE62-TENSU(4 BUN-IDX)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE62-TENSU(4 BUN-IDX2)  =
                                     RECE62-TENSU(4 BUN-IDX2)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE62-TENSU(4 BUN-IDX3)  =
                                     RECE62-TENSU(4 BUN-IDX3)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         IF  BUN-IDX32      =   3
                           COMPUTE   RECE62-SKYHENTEN(4 BUN-IDX3)  =
                                     RECE62-SKYHENTEN(4 BUN-IDX3)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE62-TENSU(4 BUN-IDX4)  =
                                     RECE62-TENSU(4 BUN-IDX4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         IF  BUN-IDX42      =   4
                           COMPUTE   RECE62-SKYHENTEN(4 BUN-IDX4)  =
                                     RECE62-SKYHENTEN(4 BUN-IDX4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE62-TENSU(4 BUN-IDX5)  =
                                     RECE62-TENSU(4 BUN-IDX5)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         IF  BUN-IDX52      =   5
                           COMPUTE   RECE62-SKYHENTEN(4 BUN-IDX5)  =
                                     RECE62-SKYHENTEN(4 BUN-IDX5)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                         END-IF
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE62-SYUTANTEN(4)  =
                                     RECE62-SYUTANTEN(4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE62-ALLTENSU(4)   =
                                     RECE62-ALLTENSU(4)   +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
               WHEN    "22"
                   ADD    WK-ZAIKAISU    TO   RECE62-KAISU(5)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(5 BUN-IDX)  =
                                 RECE62-TENSU(5 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(5 BUN-IDX2)  =
                                 RECE62-TENSU(5 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(5 BUN-IDX3)  =
                                 RECE62-TENSU(5 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(5 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(5 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(5 BUN-IDX4)  =
                                 RECE62-TENSU(5 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(5 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(5 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(5 BUN-IDX5)  =
                                 RECE62-TENSU(5 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(5 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(5 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(5)  =
                                 RECE62-SYUTANTEN(5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(5)   =
                                 RECE62-ALLTENSU(5)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
               WHEN    "23"
                   ADD    WK-ZAIKAISU    TO   RECE62-KAISU(6)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(6 BUN-IDX)  =
                                 RECE62-TENSU(6 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(6 BUN-IDX2)  =
                                 RECE62-TENSU(6 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(6 BUN-IDX3)  =
                                 RECE62-TENSU(6 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(6 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(6 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(6 BUN-IDX4)  =
                                 RECE62-TENSU(6 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(6 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(6 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(6 BUN-IDX5)  =
                                 RECE62-TENSU(6 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(6 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(6 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(6)  =
                                 RECE62-SYUTANTEN(6)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(6)   =
                                 RECE62-ALLTENSU(6)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
      *    調剤のレセ点数欄の編集
               WHEN    "24"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE62-KAISU(7)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(7 BUN-IDX)  =
                                 RECE62-TENSU(7 BUN-IDX)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(7 BUN-IDX2)  =
                                 RECE62-TENSU(7 BUN-IDX2)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(7 BUN-IDX3)  =
                                 RECE62-TENSU(7 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(7 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(7 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(7 BUN-IDX4)  =
                                 RECE62-TENSU(7 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(7 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(7 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(7 BUN-IDX5)  =
                                 RECE62-TENSU(7 BUN-IDX5)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(7 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(7 BUN-IDX5)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(7)  =
                                 RECE62-SYUTANTEN(7)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(7)   =
                                 RECE62-ALLTENSU(7)   +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE62-KAISU(8)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(8 BUN-IDX)  =
                                 RECE62-TENSU(8 BUN-IDX)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(8 BUN-IDX2)  =
                                 RECE62-TENSU(8 BUN-IDX2)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(8 BUN-IDX3)  =
                                 RECE62-TENSU(8 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(8 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(8 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(8 BUN-IDX4)  =
                                 RECE62-TENSU(8 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(8 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(8 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(8 BUN-IDX5)  =
                                 RECE62-TENSU(8 BUN-IDX5)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(8 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(8 BUN-IDX5)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(8)  =
                                 RECE62-SYUTANTEN(8)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(8)   =
                                 RECE62-ALLTENSU(8)   +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(9 BUN-IDX)  =
                                 RECE62-TENSU(9 BUN-IDX)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(9 BUN-IDX2)  =
                                 RECE62-TENSU(9 BUN-IDX2)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(9 BUN-IDX3)  =
                                 RECE62-TENSU(9 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(9 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(9 BUN-IDX3)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(9 BUN-IDX4)  =
                                 RECE62-TENSU(9 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(9 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(9 BUN-IDX4)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(9 BUN-IDX5)  =
                                 RECE62-TENSU(9 BUN-IDX5)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(9 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(9 BUN-IDX5)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(9)  =
                                 RECE62-SYUTANTEN(9)  +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(9)   =
                                 RECE62-ALLTENSU(9)   +
                                (TNS-TEN   *   ACCT-ZAIKAISU)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE62-KAISU(10)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(10 BUN-IDX)  =
                                 RECE62-TENSU(10 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(10 BUN-IDX)  =
                                 RECE6C-TENSU(10 BUN-IDX)  +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(10 BUN-IDX2)  =
                                 RECE62-TENSU(10 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(10 BUN-IDX2) =
                                 RECE6C-TENSU(10 BUN-IDX2) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(10 BUN-IDX3)  =
                                 RECE62-TENSU(10 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(10 BUN-IDX3) =
                                 RECE6C-TENSU(10 BUN-IDX3) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(10 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(10 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(10 BUN-IDX3) =
                                 RECE6C-SKYHENTEN(10 BUN-IDX3) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(10 BUN-IDX4)  =
                                 RECE62-TENSU(10 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(10 BUN-IDX4) =
                                 RECE6C-TENSU(10 BUN-IDX4) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(10 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(10 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(10 BUN-IDX4) =
                                 RECE6C-SKYHENTEN(10 BUN-IDX4) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(10 BUN-IDX5)  =
                                 RECE62-TENSU(10 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(10 BUN-IDX5) =
                                 RECE6C-TENSU(10 BUN-IDX5) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(10 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(10 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(10 BUN-IDX5) =
                                 RECE6C-SKYHENTEN(10 BUN-IDX5) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(10)  =
                                 RECE62-SYUTANTEN(10)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SYUTANTEN(10)  =
                                 RECE6C-SYUTANTEN(10)  +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(10)   =
                                 RECE62-ALLTENSU(10)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   COMPUTE       RECE6C-ALLTENSU(10)   =
                                 RECE6C-ALLTENSU(10)   +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE62-KAISU(11)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(11 BUN-IDX)  =
                                 RECE62-TENSU(11 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(11 BUN-IDX)  =
                                 RECE6C-TENSU(11 BUN-IDX)  +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(11 BUN-IDX2)  =
                                 RECE62-TENSU(11 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(11 BUN-IDX2) =
                                 RECE6C-TENSU(11 BUN-IDX2) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(11 BUN-IDX3)  =
                                 RECE62-TENSU(11 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(11 BUN-IDX3) =
                                 RECE6C-TENSU(11 BUN-IDX3) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(11 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(11 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(11 BUN-IDX3) =
                                 RECE6C-SKYHENTEN(11 BUN-IDX3) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(11 BUN-IDX4)  =
                                 RECE62-TENSU(11 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(11 BUN-IDX4) =
                                 RECE6C-TENSU(11 BUN-IDX4) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(11 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(11 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(11 BUN-IDX4) =
                                 RECE6C-SKYHENTEN(11 BUN-IDX4) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(11 BUN-IDX5)  =
                                 RECE62-TENSU(11 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(11 BUN-IDX5) =
                                 RECE6C-TENSU(11 BUN-IDX5) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(11 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(11 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(11 BUN-IDX5) =
                                 RECE6C-SKYHENTEN(11 BUN-IDX5) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(11)  =
                                 RECE62-SYUTANTEN(11)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SYUTANTEN(11)  =
                                 RECE6C-SYUTANTEN(11)  +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(11)   =
                                 RECE62-ALLTENSU(11)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   COMPUTE       RECE6C-ALLTENSU(11)   =
                                 RECE6C-ALLTENSU(11)   +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE6G-TENSU(12 BUN-IDX)  =
                                 RECE6G-TENSU(12 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE6G-TENSU(12 BUN-IDX2)  =
                                 RECE6G-TENSU(12 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE6G-TENSU(12 BUN-IDX3)  =
                                 RECE6G-TENSU(12 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE6G-SKYHENTEN(12 BUN-IDX3)  =
                                 RECE6G-SKYHENTEN(12 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE6G-TENSU(12 BUN-IDX4)  =
                                 RECE6G-TENSU(12 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE6G-SKYHENTEN(12 BUN-IDX4)  =
                                 RECE6G-SKYHENTEN(12 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE6G-TENSU(12 BUN-IDX5)  =
                                 RECE6G-TENSU(12 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE6G-SKYHENTEN(12 BUN-IDX5)  =
                                 RECE6G-SKYHENTEN(12 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE6G-SYUTANTEN(12)  =
                                 RECE6G-SYUTANTEN(12)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE6G-ALLTENSU(12)   =
                                 RECE6G-ALLTENSU(12)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU     TO   RECE62-KAISU(12)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(12 BUN-IDX)  =
                                 RECE62-TENSU(12 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(12 BUN-IDX)  =
                                 RECE6C-TENSU(12 BUN-IDX)  +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(12 BUN-IDX2)  =
                                 RECE62-TENSU(12 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(12 BUN-IDX2) =
                                 RECE6C-TENSU(12 BUN-IDX2) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(12 BUN-IDX3)  =
                                 RECE62-TENSU(12 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(12 BUN-IDX3) =
                                 RECE6C-TENSU(12 BUN-IDX3) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(12 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(12 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(12 BUN-IDX3) =
                                 RECE6C-SKYHENTEN(12 BUN-IDX3) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(12 BUN-IDX4)  =
                                 RECE62-TENSU(12 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(12 BUN-IDX4) =
                                 RECE6C-TENSU(12 BUN-IDX4) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(12 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(12 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(12 BUN-IDX4) =
                                 RECE6C-SKYHENTEN(12 BUN-IDX4) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(12 BUN-IDX5)  =
                                 RECE62-TENSU(12 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-TENSU(12 BUN-IDX5) =
                                 RECE6C-TENSU(12 BUN-IDX5) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(12 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(12 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SKYHENTEN(12 BUN-IDX5) =
                                 RECE6C-SKYHENTEN(12 BUN-IDX5) +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(12)  =
                                 RECE62-SYUTANTEN(12)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                       COMPUTE   RECE6C-SYUTANTEN(12)  =
                                 RECE6C-SYUTANTEN(12)  +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(12)   =
                                 RECE62-ALLTENSU(12)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   COMPUTE       RECE6C-ALLTENSU(12)   =
                                 RECE6C-ALLTENSU(12)   +
                                (WK-YKZTEN2  *   WK-ZAIKAISU)
                 END-IF
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(13)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(13 BUN-IDX)  =
                                 RECE62-TENSU(13 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(13 BUN-IDX2)  =
                                 RECE62-TENSU(13 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(13 BUN-IDX3)  =
                                 RECE62-TENSU(13 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(13 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(13 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(13 BUN-IDX4)  =
                                 RECE62-TENSU(13 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(13 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(13 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(13 BUN-IDX5)  =
                                 RECE62-TENSU(13 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(13 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(13 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(13)  =
                                 RECE62-SYUTANTEN(13)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(13)   =
                                 RECE62-ALLTENSU(13)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(14 BUN-IDX)  =
                                 RECE62-TENSU(14 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(14 BUN-IDX2)  =
                                 RECE62-TENSU(14 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(14 BUN-IDX3)  =
                                 RECE62-TENSU(14 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(14 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(14 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(14 BUN-IDX4)  =
                                 RECE62-TENSU(14 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(14 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(14 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(14 BUN-IDX5)  =
                                 RECE62-TENSU(14 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(14 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(14 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(14)  =
                                 RECE62-SYUTANTEN(14)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(14)   =
                                 RECE62-ALLTENSU(14)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(15)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(15 BUN-IDX)  =
                                 RECE62-TENSU(15 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(15 BUN-IDX2)  =
                                 RECE62-TENSU(15 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(15 BUN-IDX3)  =
                                 RECE62-TENSU(15 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(15 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(15 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(15 BUN-IDX4)  =
                                 RECE62-TENSU(15 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(15 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(15 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(15 BUN-IDX5)  =
                                 RECE62-TENSU(15 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(15 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(15 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(15)  =
                                 RECE62-SYUTANTEN(15)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(15)   =
                                 RECE62-ALLTENSU(15)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(16 BUN-IDX)  =
                                 RECE62-TENSU(16 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(16 BUN-IDX2)  =
                                 RECE62-TENSU(16 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(16 BUN-IDX3)  =
                                 RECE62-TENSU(16 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(16 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(16 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(16 BUN-IDX4)  =
                                 RECE62-TENSU(16 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(16 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(16 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(16 BUN-IDX5)  =
                                 RECE62-TENSU(16 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(16 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(16 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(16)  =
                                 RECE62-SYUTANTEN(16)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(16)   =
                                 RECE62-ALLTENSU(16)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(17)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(17 BUN-IDX)  =
                                 RECE62-TENSU(17 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(17 BUN-IDX2)  =
                                 RECE62-TENSU(17 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(17 BUN-IDX3)  =
                                 RECE62-TENSU(17 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(17 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(17 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(17 BUN-IDX4)  =
                                 RECE62-TENSU(17 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(17 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(17 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(17 BUN-IDX5)  =
                                 RECE62-TENSU(17 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(17 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(17 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(17)  =
                                 RECE62-SYUTANTEN(17)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(17)   =
                                 RECE62-ALLTENSU(17)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    TNS-KNSJISKBN    =   2
                         COMPUTE   RECE62-KAISU(17)  =
                                   RECE62-KAISU(17)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    TNS-SRYCD        =   "160101210"     OR
                                              "160095710"     OR
                                              "160095810"
                         IF   RECE62-KAISU(17)  NOT =  ZERO
                              COMPUTE   RECE62-KAISU(17)  =
                                        RECE62-KAISU(17)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(18 BUN-IDX)  =
                                 RECE62-TENSU(18 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(18 BUN-IDX2)  =
                                 RECE62-TENSU(18 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(18 BUN-IDX3)  =
                                 RECE62-TENSU(18 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(18 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(18 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(18 BUN-IDX4)  =
                                 RECE62-TENSU(18 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(18 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(18 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(18 BUN-IDX5)  =
                                 RECE62-TENSU(18 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(18 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(18 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(18)  =
                                 RECE62-SYUTANTEN(18)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(18)   =
                                 RECE62-ALLTENSU(18)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE62-KAISU(19)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(19 BUN-IDX)  =
                                 RECE62-TENSU(19 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(19 BUN-IDX2)  =
                                 RECE62-TENSU(19 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(19 BUN-IDX3)  =
                                 RECE62-TENSU(19 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(19 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(19 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(19 BUN-IDX4)  =
                                 RECE62-TENSU(19 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(19 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(19 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(19 BUN-IDX5)  =
                                 RECE62-TENSU(19 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(19 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(19 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(19)  =
                                 RECE62-SYUTANTEN(19)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(19)   =
                                 RECE62-ALLTENSU(19)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(20 BUN-IDX)  =
                                 RECE62-TENSU(20 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(20 BUN-IDX2)  =
                                 RECE62-TENSU(20 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(20 BUN-IDX3)  =
                                 RECE62-TENSU(20 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(20 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(20 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(20 BUN-IDX4)  =
                                 RECE62-TENSU(20 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(20 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(20 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(20 BUN-IDX5)  =
                                 RECE62-TENSU(20 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(20 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(20 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(20)  =
                                 RECE62-SYUTANTEN(20)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(20)   =
                                 RECE62-ALLTENSU(20)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他のレセ点数欄の編集
               WHEN    "80"
                   IF    BUN-IDX        =   1
                         COMPUTE     RECE62-TENSU(21 BUN-IDX) =
                                     RECE62-TENSU(21 BUN-IDX) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX)  =
                                     RECE62-TENSU(2 BUN-IDX)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-TENSU(21 BUN-IDX) =
                                     RECE62-TENSU(21 BUN-IDX) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX2       =   2
                         COMPUTE     RECE62-TENSU(21 BUN-IDX2) =
                                     RECE62-TENSU(21 BUN-IDX2) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX2)  =
                                     RECE62-TENSU(2 BUN-IDX2)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-TENSU(21 BUN-IDX2) =
                                     RECE62-TENSU(21 BUN-IDX2) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX3       =   3
                         COMPUTE     RECE62-TENSU(21 BUN-IDX3) =
                                     RECE62-TENSU(21 BUN-IDX3) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX3)  =
                                     RECE62-TENSU(2 BUN-IDX3)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-TENSU(21 BUN-IDX3) =
                                     RECE62-TENSU(21 BUN-IDX3) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                      IF BUN-IDX32      =   3
                         COMPUTE     RECE62-SKYHENTEN(21 BUN-IDX3) =
                                     RECE62-SKYHENTEN(21 BUN-IDX3) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-SKYHENTEN(2 BUN-IDX3)  =
                                     RECE62-SKYHENTEN(2 BUN-IDX3)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-SKYHENTEN(21 BUN-IDX3) =
                                     RECE62-SKYHENTEN(21 BUN-IDX3) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                      END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                         COMPUTE     RECE62-TENSU(21 BUN-IDX4) =
                                     RECE62-TENSU(21 BUN-IDX4) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX4)  =
                                     RECE62-TENSU(2 BUN-IDX4)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-TENSU(21 BUN-IDX4) =
                                     RECE62-TENSU(21 BUN-IDX4) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                      IF BUN-IDX42      =   4
                         COMPUTE     RECE62-SKYHENTEN(21 BUN-IDX4) =
                                     RECE62-SKYHENTEN(21 BUN-IDX4) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-SKYHENTEN(2 BUN-IDX4)  =
                                     RECE62-SKYHENTEN(2 BUN-IDX4)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-SKYHENTEN(21 BUN-IDX4) =
                                     RECE62-SKYHENTEN(21 BUN-IDX4) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                      END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                         COMPUTE     RECE62-TENSU(21 BUN-IDX5) =
                                     RECE62-TENSU(21 BUN-IDX5) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-TENSU(2 BUN-IDX5)  =
                                     RECE62-TENSU(2 BUN-IDX5)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-TENSU(21 BUN-IDX5) =
                                     RECE62-TENSU(21 BUN-IDX5) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                      IF BUN-IDX52      =   5
                         COMPUTE     RECE62-SKYHENTEN(21 BUN-IDX5) =
                                     RECE62-SKYHENTEN(21 BUN-IDX5) +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-SKYHENTEN(2 BUN-IDX5)  =
                                     RECE62-SKYHENTEN(2 BUN-IDX5)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-SKYHENTEN(21 BUN-IDX5) =
                                     RECE62-SKYHENTEN(21 BUN-IDX5) -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                      END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                         COMPUTE     RECE62-SYUTANTEN(21)  =
                                     RECE62-SYUTANTEN(21)  +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                         IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-SYUTANTEN(2)  =
                                     RECE62-SYUTANTEN(2)  +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-SYUTANTEN(21)  =
                                     RECE62-SYUTANTEN(21)  -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   COMPUTE           RECE62-ALLTENSU(21)   =
                                     RECE62-ALLTENSU(21)   +
                                    (WK-SYUTEN *   WK-ZAIKAISU)
                   IF    TNS-NYUTENTTLKBN   =    130
                           COMPUTE   RECE62-ALLTENSU(2)   =
                                     RECE62-ALLTENSU(2)   +
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE62-ALLTENSU(21)   =
                                     RECE62-ALLTENSU(21)   -
                                    (TNS-TEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE62-TENSU(22 BUN-IDX)  =
                                 RECE62-TENSU(22 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE62-TENSU(22 BUN-IDX2)  =
                                 RECE62-TENSU(22 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE62-TENSU(22 BUN-IDX3)  =
                                 RECE62-TENSU(22 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX32      =   3
                       COMPUTE   RECE62-SKYHENTEN(22 BUN-IDX3)  =
                                 RECE62-SKYHENTEN(22 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE62-TENSU(22 BUN-IDX4)  =
                                 RECE62-TENSU(22 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX42      =   4
                       COMPUTE   RECE62-SKYHENTEN(22 BUN-IDX4)  =
                                 RECE62-SKYHENTEN(22 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE62-TENSU(22 BUN-IDX5)  =
                                 RECE62-TENSU(22 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     IF  BUN-IDX52      =   5
                       COMPUTE   RECE62-SKYHENTEN(22 BUN-IDX5)  =
                                 RECE62-SKYHENTEN(22 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                     END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE62-SYUTANTEN(22)  =
                                 RECE62-SYUTANTEN(22)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE62-ALLTENSU(22)   =
                                 RECE62-ALLTENSU(22)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
           END-EVALUATE
           .
      *
       2101221-RECE-LEFT-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    医療情報連携編集
      *****************************************************************
       210123-IRYORENKEI-HENSYU-SEC               SECTION.
      *
           IF   (ACCT-SRYKBN       =  "14" OR "21" OR "22" OR "23")
           AND  (ACCT-ZAITEN       =  ZERO                        )
           AND  (ACCT-ZAIKBN   NOT =   1                          )
           AND  (ACCT-JIHOKBN      =  SPACE                       )
      *
             INITIALIZE                   SRYACT-REC
             MOVE    ACCT-HOSPNUM     TO  SRY-HOSPNUM
             MOVE    ACCT-NYUGAIKBN   TO  SRY-NYUGAIKBN
             MOVE    ACCT-PTID        TO  SRY-PTID
             MOVE    ACCT-SRYYM       TO  SRY-SRYYM
             MOVE    ACCT-ZAINUM      TO  SRY-ZAINUM
             MOVE    "820000046"      TO  SRY-SRYCD(1)
             MOVE    "820000046"      TO  SRY-SRYCD(2)
             MOVE    "820000046"      TO  SRY-SRYCD(3)
             MOVE    "820000046"      TO  SRY-SRYCD(4)
             MOVE    "820000046"      TO  SRY-SRYCD(5)
             MOVE    SRYACT-REC       TO  MCPDATA-REC
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC   =   ZERO
               MOVE    "tbl_sryact"   TO  MCP-TABLE
               MOVE    "key8"         TO  MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               IF   FLG-SRYACT  =  ZERO
                 CONTINUE
               ELSE
                 MOVE    1            TO  FLG-IRYORENKEI
               END-IF
             END-IF
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
      *
           END-IF
      *
           IF    FLG-IRYORENKEI   =   1
      *
             INITIALIZE                      ORCSGETGENERICAREA
             MOVE    RECE62-HOSPNUM      TO  ORCSGETGE-HOSPNUM
             MOVE    RECE62-PTID         TO  ORCSGETGE-PTID
             MOVE    RECE62-SRYYM        TO  ORCSGETGE-SRYYM
             MOVE    WK-TAIHI-DAY        TO  ORCSGETGE-SRYDD
             MOVE    "1"                 TO  ORCSGETGE-NYUGAIKBN
             MOVE    ACCT-ZAINUM         TO  ORCSGETGE-ZAINUM
             MOVE    WRK-1030-KOUHATUKA  TO  ORCSGETGE-KOUHATUKA
             CALL    "ORCSGETGENERIC"    USING
                                         ORCSGETGENERICAREA
                                         SPA-AREA
             IF      ORCSGETGE-ERRCD     =   ZERO
               PERFORM   VARYING  IDX15    FROM    1   BY  1
                          UNTIL   IDX15     >     50
                 MOVE  ORCSGETGE-YAKKAKJNCD(IDX15)
                            TO  WRK-ORCSGETGE-YAKKAKJNCD(IDX15)
                 MOVE  ORCSGETGE-GENERIC-KBN(IDX15)
                            TO  WRK-ORCSGETGE-GENERIC-KBN(IDX15)
                 MOVE  ORCSGETGE-GENERICNAME(IDX15)
                            TO  WRK-ORCSGETGE-GENERICNAME(IDX15)
               END-PERFORM
             END-IF
      *
           END-IF
      *
           .
      *
       210123-IRYORENKEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントチェック編集
      *****************************************************************
       210124-RECECOMCHK-SEC               SECTION.
      *
           PERFORM   VARYING  IDX15    FROM    1   BY  1
                      UNTIL   IDX15     >    142
             IF   TBL-RECECOMCHK-FLG(IDX15) = "1"
              EVALUATE   IDX15
               WHEN       1
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-SYODOU-COMMENT
               WHEN       5
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-SYOBYO-COMMENT
               WHEN       6
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-RYOYO-COMMENT
               WHEN      17
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-JINNAI-COMMENT
               WHEN      18
                 MOVE      "2"      TO  RECE64-FLG-JINNAI-COMMENT
               WHEN      20
                 MOVE      "2"      TO  RECE64-FLG-SINPESUR-COMMENT
               WHEN      25
                 MOVE      "A"      TO  RECE64-FLG-SINPESU-COMMENT
               WHEN      26
                 MOVE      "A"      TO  RECE64-FLG-SINPESUR-COMMENT
               WHEN      27
                 MOVE      "B"      TO  RECE64-FLG-SINPESU-COMMENT
               WHEN      28
                 MOVE      "B"      TO  RECE64-FLG-SINPESUR-COMMENT
               WHEN      29
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-GANSIDO-COMMENT
               WHEN      30
                 MOVE      "2"      TO  RECE64-FLG-GANSIDO-COMMENT
               WHEN      33
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-HOUSIJI-COMMENT
               WHEN      34
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-HINKAI-COMMENT
               WHEN      38
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KAISYOKU-COMMENT
               WHEN      39
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-ZAIKYO-COMMENT
               WHEN      57
      ***        外来とは項目名が違う
      **>        MOVE      "9"      TO  RECE04-FLG-NINRYO-COMMENT
                 MOVE      "9"      TO  RECE64-FLG-ZAIHANKO-COMMENT
               WHEN      58
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-JINZOU-COMMENT
               WHEN      60
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-BOKOHO-COMMENT
               WHEN      61
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KIATU-COMMENT
               WHEN      62
                 MOVE      "2"      TO  RECE64-FLG-KIATU-COMMENT
               WHEN      63
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-RIHABIRI-COMMENT
               WHEN      65
      ***        外来とは項目名が違う
      **>        MOVE      "2"      TO  RECE04-FLG-IZONSYO-COMMENT
                 MOVE      "2"      TO  RECE64-FLG-SCPRO-COMMENT
               WHEN      67
      ***        外来とは項目名が違う
      **>        MOVE      "4"      TO  RECE04-FLG-IZONSYO-COMMENT
                 MOVE      "4"      TO  RECE64-FLG-SCPRO-COMMENT
               WHEN      68
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-SINDAI-COMMENT
               WHEN      69
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-KOKYUKI-COMMENT
               WHEN      70
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-NOUKE-COMMENT
               WHEN      71
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-UNDOKI-COMMENT
               WHEN      72
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-SESSYOKU-COMMENT
               WHEN      73
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-HAIYO-COMMENT
      *
               WHEN      76
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-YAKUKAN-COMMENT
               WHEN      77
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-HOUMON-COMMENT
               WHEN      78
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KAISIEN-COMMENT
               WHEN      79
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-TAIKYO-COMMENT
               WHEN      80
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KYOKUIN-COMMENT
               WHEN      81
                 MOVE      "5"      TO  RECE64-FLG-SCPRO-COMMENT
               WHEN      82
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-SEIKEA-COMMENT
               WHEN      83
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-NYUKSN-COMMENT
      ***      WHEN      84
      ***        MOVE  TBL-RECECOMCHK-FLG(IDX15)
      ***                           TO  RECE64-FLG-CYOJKSN-COMMENT
      ***      WHEN      85
      ***        MOVE      "2"      TO  RECE64-FLG-CYOJKSN-COMMENT
      ***      WHEN      86
      ***        MOVE      "3"      TO  RECE64-FLG-CYOJKSN-COMMENT
      ***      WHEN      87
      ***        MOVE      "4"      TO  RECE64-FLG-CYOJKSN-COMMENT
               WHEN      88
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-HAIJSK-COMMENT
      *
               WHEN     101
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-ZAISIEN-COMMENT
               WHEN     102
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KENSA-COMMENT
               WHEN     103
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KENSA-COMMENT
               WHEN     104
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KENSA-COMMENT
      *
               WHEN     108
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KENKSN-COMMENT
               WHEN     109
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KINGAZ-COMMENT
      *
               WHEN     112
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KENKSN2-COMMENT
               WHEN     113
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KINGAZ2-COMMENT
               WHEN     114
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-SEIKEA2-COMMENT
               WHEN     115
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-YOUATU-COMMENT
               WHEN     116
                 MOVE      "2"      TO  RECE64-FLG-YOUATU-COMMENT
               WHEN     117
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-HOUSKSN-COMMENT
               WHEN     137
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-TEJHOU-COMMENT
      ***#     WHEN     138
      ***#       MOVE  TBL-RECECOMCHK-FLG(IDX15)
      ***#                          TO  RECE64-FLG-GAIZAI-COMMENT
               WHEN     139
                 MOVE  TBL-RECECOMCHK-FLG(IDX15)
                                    TO  RECE64-FLG-KOUYAK-COMMENT
               WHEN     140
                 MOVE      "2"      TO  RECE64-FLG-KOUYAK-COMMENT
               WHEN     142
                 MOVE      "2"      TO  RECE64-FLG-KYOKUIN-COMMENT
              END-EVALUATE
             END-IF
           END-PERFORM
      *
      ****
      *
           IF    RECE64-FLG-SYODOU-COMMENT   = SPACE
             MOVE   SPACE  TO  RECE64-SYODOU-SRYKA(1)
           END-IF
      *
           IF    RECE64-FLG-HAIJSK-COMMENT   =  "1"
             PERFORM  VARYING  IDX40  FROM  1  BY  1
                       UNTIL   IDX40   >   31
               IF  RECE64-KAISU(1 IDX40) NOT = ZERO
                 IF  RECE62-HAIJSKYMD  =  SPACE
                   MOVE  RECE62-SRYYM  TO  RECE62-HAIJSKYMD(1:6)
                   MOVE  IDX40         TO  RECE62-HAIJSKYMD(7:2)
                 ELSE
                   MOVE  RECE62-HAIJSKYMD(7:2)  TO  IDX41
                   IF    IDX40  <  IDX41
                     MOVE  IDX40       TO  RECE62-HAIJSKYMD(7:2)
                   END-IF
                 END-IF
                 MOVE    31    TO   IDX40
               END-IF
             END-PERFORM
           END-IF
      *
           IF    RECE64-FLG-ZAISIEN-COMMENT  =  "1"
             MOVE   SPACE    TO  RECE64-FLG-ZAISIEN-COMMENT
             IF   (WRK-SISETU3168  =  1)
             OR   (WRK-SISETU3055  =  1)
             OR   (WRK-SISETU3056  =  1)
               MOVE    "1"   TO  RECE62-COMCNTFLG
               MOVE    "1"   TO  RECE64-FLG-ZAISIEN-COMMENT
             ELSE
               IF (WRK-SISETU3169  =  1)
               OR (WRK-SISETU3057  =  1)
               OR (WRK-SISETU3058  =  1)
                 MOVE  "1"   TO  RECE62-COMCNTFLG
                 MOVE  "2"   TO  RECE64-FLG-ZAISIEN-COMMENT
               END-IF
             END-IF
           END-IF
      *
           IF    RECE64-FLG-KENSA-COMMENT    =  "1"
             IF  FLG-KENSA-COM    =  1
               MOVE   SPACE  TO  RECE64-FLG-KENSA-COMMENT
             ELSE
               IF  TBL-RECECOMCHK-FLG(102) = "1"
                 MOVE   1    TO  RECE62-KENSA-BNPFLG
               END-IF
               IF  TBL-RECECOMCHK-FLG(103) = "1"
                 MOVE   1    TO  RECE62-KENSA-NTPROFLG
               END-IF
               IF  TBL-RECECOMCHK-FLG(104) = "1"
                 MOVE   1    TO  RECE62-KENSA-ANPFLG
               END-IF
             END-IF
           END-IF
      *
           IF    RECE64-SINDAI-COMMENT       =  "1"
             MOVE   "1"    TO  RECE62-COMCNTFLG
             PERFORM  VARYING  IDX16  FROM  1  BY  1
                       UNTIL   IDX16   >   31
               IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                 MOVE  1   TO  RECE62-RIHA-SINDAI(IDX1 IDX16)
               END-IF
             END-PERFORM
             IF   (TBL-RECECOMCHK-FLG(74)  =  "1")
             OR   (TBL-RECECOMCHK-FLG(75)  =  "1")
                 IF  TBL-RECECOMCHK-FLG(74)   =  "1"
                   MOVE   "1"  TO  RECE64-SINDAI9-COMMENT
                   IF  RECE62-DAISANFLG(IDX1) =   1
                     MOVE  1   TO  RECE62-RSKSN-SYOKI-SIN-D
                   ELSE
                     MOVE  1   TO  RECE62-RSKSN-SYOKI-SIN
                   END-IF
                 END-IF
                 IF  TBL-RECECOMCHK-FLG(75)   =  "1"
                   MOVE   "1"  TO  RECE64-SINDAI9X-COMMENT
                   IF  RECE62-DAISANFLG(IDX1) =   1
                     MOVE  1   TO  RECE62-RSKSN-SOUKI-SIN-D
                   ELSE
                     MOVE  1   TO  RECE62-RSKSN-SOUKI-SIN
                   END-IF
                 END-IF
                 PERFORM  VARYING  IDX16  FROM  1  BY  1
                           UNTIL   IDX16   >   31
                   IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                     MOVE  1   TO  RECE62-RIHA-SINDAI9(IDX1 IDX16)
                   END-IF
                 END-PERFORM
             END-IF
           END-IF
      *
           IF    RECE64-KOKYUKI-COMMENT      =  "1"
             MOVE   "1"    TO  RECE62-COMCNTFLG
             PERFORM  VARYING  IDX16  FROM  1  BY  1
                       UNTIL   IDX16   >   31
               IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                 MOVE  1   TO  RECE62-RIHA-KOKYUKI(IDX1 IDX16)
               END-IF
             END-PERFORM
             IF   (TBL-RECECOMCHK-FLG(74)  =  "1")
             OR   (TBL-RECECOMCHK-FLG(75)  =  "1")
                 IF  TBL-RECECOMCHK-FLG(74)   =  "1"
                   MOVE   "1"  TO  RECE64-KOKYUKI9-COMMENT
                   IF  RECE62-DAISANFLG(IDX1) =   1
                     MOVE  1   TO  RECE62-RSKSN-SYOKI-KOK-D
                   ELSE
                     MOVE  1   TO  RECE62-RSKSN-SYOKI-KOK
                   END-IF
                 END-IF
                 IF  TBL-RECECOMCHK-FLG(75)   =  "1"
                   MOVE   "1"  TO  RECE64-KOKYUKI9X-COMMENT
                   IF  RECE62-DAISANFLG(IDX1) =   1
                     MOVE  1   TO  RECE62-RSKSN-SOUKI-KOK-D
                   ELSE
                     MOVE  1   TO  RECE62-RSKSN-SOUKI-KOK
                   END-IF
                 END-IF
                 PERFORM  VARYING  IDX16  FROM  1  BY  1
                           UNTIL   IDX16   >   31
                   IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                     MOVE  1   TO  RECE62-RIHA-KOKYUKI9(IDX1 IDX16)
                   END-IF
                 END-PERFORM
             END-IF
           END-IF
      *
           IF    RECE64-NOUKE-COMMENT        =  "1"
             MOVE   "1"    TO  RECE62-COMCNTFLG
             PERFORM  VARYING  IDX16  FROM  1  BY  1
                       UNTIL   IDX16   >   31
               IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                 MOVE  1   TO  RECE62-RIHA-NOUKE(IDX1 IDX16)
               END-IF
             END-PERFORM
           END-IF
      *
           IF    RECE64-UNDOKI-COMMENT       =  "1"
             MOVE   "1"    TO  RECE62-COMCNTFLG
             PERFORM  VARYING  IDX16  FROM  1  BY  1
                       UNTIL   IDX16   >   31
               IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                 MOVE  1   TO  RECE62-RIHA-UNDOKI(IDX1 IDX16)
               END-IF
             END-PERFORM
           END-IF
      *
           IF    RECE64-SESSYOKU-COMMENT     =  "1"
             MOVE   "1"    TO  RECE62-COMCNTFLG
             PERFORM  VARYING  IDX16  FROM  1  BY  1
                       UNTIL   IDX16   >   31
               IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                 MOVE  1   TO  RECE62-RIHA-SESSYOKU(IDX1 IDX16)
               END-IF
             END-PERFORM
           END-IF
      *
           IF    RECE64-HAIYO-COMMENT        =  "1"
             MOVE   "1"    TO  RECE62-COMCNTFLG
             PERFORM  VARYING  IDX16  FROM  1  BY  1
                       UNTIL   IDX16   >   31
               IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                 MOVE  1   TO  RECE62-RIHA-HAIYO(IDX1 IDX16)
               END-IF
             END-PERFORM
             IF   (TBL-RECECOMCHK-FLG(74)  =  "1")
             OR   (TBL-RECECOMCHK-FLG(75)  =  "1")
                 IF  TBL-RECECOMCHK-FLG(74)   =  "1"
                   MOVE   "1"  TO  RECE64-HAIYO9-COMMENT
                   IF  RECE62-DAISANFLG(IDX1) =   1
                     MOVE  1   TO  RECE62-RSKSN-SYOKI-HAI-D
                   ELSE
                     MOVE  1   TO  RECE62-RSKSN-SYOKI-HAI
                   END-IF
                 END-IF
                 IF  TBL-RECECOMCHK-FLG(75)   =  "1"
                   MOVE   "1"  TO  RECE64-HAIYO9X-COMMENT
                   IF  RECE62-DAISANFLG(IDX1) =   1
                     MOVE  1   TO  RECE62-RSKSN-SOUKI-HAI-D
                   ELSE
                     MOVE  1   TO  RECE62-RSKSN-SOUKI-HAI
                   END-IF
                 END-IF
                 PERFORM  VARYING  IDX16  FROM  1  BY  1
                           UNTIL   IDX16   >   31
                   IF  RECE64-KAISU(1 IDX16) NOT = ZERO
                     MOVE  1   TO  RECE62-RIHA-HAIYO9(IDX1 IDX16)
                   END-IF
                 END-PERFORM
             END-IF
           END-IF
      *
           IF    RECE64-FLG-HOUSKSN-COMMENT    =  "1"
             IF  FLG-HOUSKSN-COM    =  1
      ***      MOVE   SPACE  TO  RECE64-FLG-HOUSKSN-COMMENT
               MOVE   "2"    TO  RECE64-FLG-HOUSKSN-COMMENT
             END-IF
           END-IF
      *
           .
      *
       210124-RECECOMCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    特記事項の編集
      *****************************************************************
       21013-TOKKI-HENSYU-SEC                 SECTION.
      *
           MOVE     SPACE            TO      WRK-TOKKI
      *
           EVALUATE    FLG-TOKKI
             WHEN        1
              IF ACCT-JIHOKBN = SPACE
               EVALUATE    ACCT-SRYCDTOTAL
                   WHEN    00000099990101
                       MOVE    "01"      TO      WRK-TOKKI
                   WHEN    00000099990102
                       MOVE    "02"      TO      WRK-TOKKI
                   WHEN    00000099990103
                       MOVE    "03"      TO      WRK-TOKKI
                   WHEN    00000099990104
                       MOVE    "04"      TO      WRK-TOKKI
                   WHEN    00000099990105
                       MOVE    "05"      TO      WRK-TOKKI
                   WHEN    00000099990107
                       MOVE    "07"      TO      WRK-TOKKI
                   WHEN    00000099990108
                       MOVE    "08"      TO      WRK-TOKKI
                   WHEN    00000099990109
                       MOVE    "09"      TO      WRK-TOKKI
                   WHEN    00000099990110
                       MOVE    "10"      TO      WRK-TOKKI
                   WHEN    00000099990111
                       MOVE    "11"      TO      WRK-TOKKI
                   WHEN    00000099990112
                       MOVE    "12"      TO      WRK-TOKKI
                   WHEN    00000099990113
                       MOVE    "13"      TO      WRK-TOKKI
                   WHEN    00000099990114
                       MOVE    "14"      TO      WRK-TOKKI
                   WHEN    00000099990115
                       MOVE    "15"      TO      WRK-TOKKI
                   WHEN    00000099990116
                       MOVE    "16"      TO      WRK-TOKKI
                   WHEN    00000099990117
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN    00000099990118
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN    00000099990119
                       MOVE    "19"      TO      WRK-TOKKI
                   WHEN    00000099990120
                       MOVE    "20"      TO      WRK-TOKKI
                   WHEN    00000099990121
                       MOVE    "21"      TO      WRK-TOKKI
                   WHEN    00000099990122
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN    00000099990123
                       MOVE    "23"      TO      WRK-TOKKI
                   WHEN    00000099990124
                       MOVE    "24"      TO      WRK-TOKKI
                   WHEN    00000099990125
                       MOVE    "25"      TO      WRK-TOKKI
                   WHEN    00000099990126
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN    00000099990127
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN    00000099990128
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN    00000099990129
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN    00000099990130
                       MOVE    "30"      TO      WRK-TOKKI
                   WHEN    00000099990131
                       MOVE    "31"      TO      WRK-TOKKI
                   WHEN    00000099990132
                       MOVE    "32"      TO      WRK-TOKKI
                   WHEN    00000099990133
                       MOVE    "33"      TO      WRK-TOKKI
                   WHEN    00000099990134
                       MOVE    "34"      TO      WRK-TOKKI
                   WHEN    00000099990135
                       MOVE    "35"      TO      WRK-TOKKI
                   WHEN    00000099990136
                       MOVE    "36"      TO      WRK-TOKKI
                   WHEN    00000099990137
                       MOVE    "37"      TO      WRK-TOKKI
                   WHEN    00000099990138
                       MOVE    "38"      TO      WRK-TOKKI
                   WHEN    00000099990139
                       MOVE    "39"      TO      WRK-TOKKI
               END-EVALUATE
              END-IF
             WHEN        2
              IF ACCT-JIHOKBN = SPACE
               EVALUATE    SRY-SRYCD(IDX2)
                   WHEN    "099990101"
                       MOVE    "01"      TO      WRK-TOKKI
                   WHEN    "099990102"
                       MOVE    "02"      TO      WRK-TOKKI
                   WHEN    "099990103"
                       MOVE    "03"      TO      WRK-TOKKI
                   WHEN    "099990104"
                       MOVE    "04"      TO      WRK-TOKKI
                   WHEN    "099990105"
                       MOVE    "05"      TO      WRK-TOKKI
                   WHEN    "099990107"
                       MOVE    "07"      TO      WRK-TOKKI
                   WHEN    "099990108"
                       MOVE    "08"      TO      WRK-TOKKI
                   WHEN    "099990109"
                       MOVE    "09"      TO      WRK-TOKKI
                   WHEN    "099990110"
                       MOVE    "10"      TO      WRK-TOKKI
                   WHEN    "099990111"
                       MOVE    "11"      TO      WRK-TOKKI
                   WHEN    "099990112"
                       MOVE    "12"      TO      WRK-TOKKI
                   WHEN    "099990113"
                       MOVE    "13"      TO      WRK-TOKKI
                   WHEN    "099990114"
                       MOVE    "14"      TO      WRK-TOKKI
                   WHEN    "099990115"
                       MOVE    "15"      TO      WRK-TOKKI
                   WHEN    "099990116"
                       MOVE    "16"      TO      WRK-TOKKI
                   WHEN    "099990117"
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN    "099990118"
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN    "099990119"
                       MOVE    "19"      TO      WRK-TOKKI
                   WHEN    "099990120"
                       MOVE    "20"      TO      WRK-TOKKI
                   WHEN    "099990121"
                       MOVE    "21"      TO      WRK-TOKKI
                   WHEN    "099990122"
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN    "099990123"
                       MOVE    "23"      TO      WRK-TOKKI
                   WHEN    "099990124"
                       MOVE    "24"      TO      WRK-TOKKI
                   WHEN    "099990125"
                       MOVE    "25"      TO      WRK-TOKKI
                   WHEN    "099990126"
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN    "099990127"
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN    "099990128"
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN    "099990129"
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN    "099990130"
                       MOVE    "30"      TO      WRK-TOKKI
                   WHEN    "099990131"
                       MOVE    "31"      TO      WRK-TOKKI
                   WHEN    "099990132"
                       MOVE    "32"      TO      WRK-TOKKI
                   WHEN    "099990133"
                       MOVE    "33"      TO      WRK-TOKKI
                   WHEN    "099990134"
                       MOVE    "34"      TO      WRK-TOKKI
                   WHEN    "099990135"
                       MOVE    "35"      TO      WRK-TOKKI
                   WHEN    "099990136"
                       MOVE    "36"      TO      WRK-TOKKI
                   WHEN    "099990137"
                       MOVE    "37"      TO      WRK-TOKKI
                   WHEN    "099990138"
                       MOVE    "38"      TO      WRK-TOKKI
                   WHEN    "099990139"
                       MOVE    "39"      TO      WRK-TOKKI
               END-EVALUATE
              END-IF
             WHEN        3
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "14"      TO      WRK-TOKKI
              END-IF
             WHEN        4
                       MOVE    "15"      TO      WRK-TOKKI
             WHEN        5
               EVALUATE   FLG-GENBUTU70
                   WHEN     1
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "19"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        6
                       MOVE    "21"      TO      WRK-TOKKI
             WHEN        7
               EVALUATE   FLG-TOKUSITU
                   WHEN     1
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "19"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN        8
               EVALUATE   FLG-TOKUSITU
                   WHEN     1
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "23"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "24"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN        9
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "11"      TO      WRK-TOKKI
              END-IF
             WHEN       10
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "12"      TO      WRK-TOKKI
              END-IF
             WHEN       12
                       MOVE    "01"      TO      WRK-TOKKI
             WHEN       13
                       MOVE    "10"      TO      WRK-TOKKI
             WHEN       14
               EVALUATE   FLG-GENBUTU70-KBN
                   WHEN     11
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN       15
               EVALUATE   FLG-TOKUSITU-KBN
                   WHEN     11
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       16
               EVALUATE   FLG-TOKUSITU-KBN
                   WHEN     11
                       MOVE    "31"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "32"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "33"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "34"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "35"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       17
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "36"      TO      WRK-TOKKI
              END-IF
             WHEN       18
               EVALUATE   FLG-TOKUSITU
                   WHEN     1
                       MOVE    "22"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "34"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       19
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     4
                       IF   (RECE62-SRYYM  >= "202210")
                       AND  (RECE62-HKNNUM  = "039"   )
                         IF  RECE62-HOJOKBN = "2"
                           MOVE   "41"   TO      WRK-TOKKI
                         ELSE
                           MOVE   "42"   TO      WRK-TOKKI
                         END-IF
                       ELSE
                         MOVE  "29"      TO      WRK-TOKKI
                       END-IF
                   WHEN     5
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN       20
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     4
                       IF   (RECE62-SRYYM  >= "202210")
                       AND  (RECE62-HKNNUM  = "039"   )
                         IF  RECE62-HOJOKBN = "2"
                           MOVE   "41"   TO      WRK-TOKKI
                         ELSE
                           MOVE   "42"   TO      WRK-TOKKI
                         END-IF
                       ELSE
                         MOVE  "29"      TO      WRK-TOKKI
                       END-IF
                   WHEN     5
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201808"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       21
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "31"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "32"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "33"      TO      WRK-TOKKI
                   WHEN     4
                       IF   (RECE62-SRYYM  >= "202210")
                       AND  (RECE62-HKNNUM  = "039"   )
                         IF  RECE62-HOJOKBN = "2"
                           MOVE   "43"   TO      WRK-TOKKI
                         ELSE
                           MOVE   "44"   TO      WRK-TOKKI
                         END-IF
                       ELSE
                         MOVE  "34"      TO      WRK-TOKKI
                       END-IF
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201808"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       22
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     4
                       IF   (RECE62-SRYYM  >= "202210")
                       AND  (RECE62-HKNNUM  = "039"   )
                         IF  RECE62-HOJOKBN = "2"
                           MOVE   "41"   TO      WRK-TOKKI
                         ELSE
                           MOVE   "42"   TO      WRK-TOKKI
                         END-IF
                       ELSE
                         MOVE  "29"      TO      WRK-TOKKI
                       END-IF
                   WHEN     5
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201812"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-KANGAN-TOKKI
               END-IF
             WHEN       23
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "31"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "32"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "33"      TO      WRK-TOKKI
                   WHEN     4
                       IF   (RECE62-SRYYM  >= "202210")
                       AND  (RECE62-HKNNUM  = "039"   )
                         IF  RECE62-HOJOKBN = "2"
                           MOVE   "43"   TO      WRK-TOKKI
                         ELSE
                           MOVE   "44"   TO      WRK-TOKKI
                         END-IF
                       ELSE
                         MOVE  "34"      TO      WRK-TOKKI
                       END-IF
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201812"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-KANGAN-TOKKI
               END-IF
             WHEN       24
               EVALUATE   FLG-KANGAN-KBN
                   WHEN     11
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201812"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-KANGAN-TOKKI
               END-IF
             WHEN       25
               EVALUATE   FLG-KANGAN-KBN
                   WHEN     11
                       MOVE    "31"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "32"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "33"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "34"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "35"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE62-SRYYM            >=  "201812"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-KANGAN-TOKKI
               END-IF
             WHEN       26
                       MOVE    "02"      TO      WRK-TOKKI
             WHEN       27
               EVALUATE   FLG-COVID-TASU
                   WHEN     1
                       MOVE    "31"      TO      WRK-TOKKI
                       MOVE    "26"      TO      WRK-TAIHI-TOKKI
                   WHEN     2
                       MOVE    "32"      TO      WRK-TOKKI
                       MOVE    "27"      TO      WRK-TAIHI-TOKKI
                   WHEN     3
                       MOVE    "33"      TO      WRK-TOKKI
                       MOVE    "28"      TO      WRK-TAIHI-TOKKI
                   WHEN     4
                       IF   (RECE62-SRYYM  >= "202210")
                       AND  (RECE62-HKNNUM  = "039"   )
                         IF  RECE62-HOJOKBN = "2"
                           MOVE   "43"   TO      WRK-TOKKI
                           MOVE   "41"   TO      WRK-TAIHI-TOKKI
                         ELSE
                           MOVE   "44"   TO      WRK-TOKKI
                           MOVE   "42"   TO      WRK-TAIHI-TOKKI
                         END-IF
                       ELSE
                         MOVE  "34"      TO      WRK-TOKKI
                         MOVE  "29"      TO      WRK-TAIHI-TOKKI
                       END-IF
               END-EVALUATE
             WHEN       28
               EVALUATE   FLG-COVID-TASU2
                   WHEN     11
                       MOVE    "31"      TO      WRK-TOKKI
                       MOVE    "26"      TO      WRK-TAIHI-TOKKI
                   WHEN     12
                       MOVE    "32"      TO      WRK-TOKKI
                       MOVE    "27"      TO      WRK-TAIHI-TOKKI
                   WHEN     21
                       MOVE    "33"      TO      WRK-TOKKI
                       MOVE    "28"      TO      WRK-TAIHI-TOKKI
                   WHEN     22
                       MOVE    "34"      TO      WRK-TOKKI
                       MOVE    "29"      TO      WRK-TAIHI-TOKKI
                   WHEN     31
                       MOVE    "35"      TO      WRK-TOKKI
                       MOVE    "30"      TO      WRK-TAIHI-TOKKI
               END-EVALUATE
             WHEN       29
                       MOVE    "16"      TO      WRK-TOKKI
      *
             WHEN       96
                       MOVE    "96"      TO      WRK-TOKKI
             WHEN       97
                       MOVE    "97"      TO      WRK-TOKKI
           END-EVALUATE
      *
      *    既に同じ特記事項コードが編集済みのときはセットしない
           EVALUATE  WRK-TOKKI
             WHEN      "15"
               IF  (RECE62-SRYYM   >=  "200608")
               AND (RECE62-SRYYM   <=  "200812")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "16"
               IF  (RECE62-SRYYM   <   "200610")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "17"
             WHEN      "18"
             WHEN      "19"
               IF  (RECE62-SRYYM   >=  "200704")
               AND (RECE62-SRYYM   <=  "201807")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "20"
               IF  (RECE62-SRYYM   >=  "200804")
               AND (RECE62-SRYYM   <=  "201903")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "21"
               IF  (RECE62-SRYYM   <   "200901")
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "22"
               IF  (RECE62-SRYYM   <=  "201807")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "23"
             WHEN      "24"
               IF  (RECE62-SRYYM   <=  "201412")
                   CONTINUE
               ELSE
                   GO  TO  21013-TOKKI-HENSYU-EXT
               END-IF
           END-EVALUATE
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL ( TOKKI-IDX       >   5     )
               IF      RECE62-TOKKI(TOKKI-IDX)   =   SPACE
                   MOVE    WRK-TOKKI       TO  RECE62-TOKKI (TOKKI-IDX)
                   MOVE    5               TO  TOKKI-IDX
               ELSE
                   IF      WRK-TOKKI     =   RECE62-TOKKI   (TOKKI-IDX)
                       MOVE    5                 TO  TOKKI-IDX
                   END-IF 
               END-IF
           END-PERFORM
           .
       21013-TOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    剤の診療内容チェック
      *****************************************************************
       21014-SINRYO-CHECK-SEC                 SECTION.
      *
      ***  PERFORM   VARYING   IDU   FROM   1   BY   1
           PERFORM   VARYING   IDU   FROM   2   BY   1
                      UNTIL  ( IDU   >   TBL-ZAICHECK-MAX )
                       OR    ( FLG-RINYAK  NOT =  ZERO    )
      *
              IF  ( IDU  =  1                                  )
              OR  ((IDU  =  2) AND (ACCT-SRYKBN = "60" OR "64"))
              OR  ((IDU  =  3) AND (ACCT-SRYKBN = "80"        ))
              OR  ((IDU  =  4) AND (ACCT-SRYKBN = "80"        ))
              OR  ((IDU  =  5) AND (ACCT-SRYKBN = "60" OR "64"))
              OR  ((IDU  =  6) AND (ACCT-SRYKBN = "80"        ))
              OR  ((IDU  =  7) AND (ACCT-SRYKBN = "80"        ))
      *
                 INITIALIZE                  SRYACT-REC
                 MOVE RECE62-HOSPNUM     TO  SRY-HOSPNUM
                 MOVE RECE62-NYUGAIKBN   TO  SRY-NYUGAIKBN
                 MOVE RECE62-PTID        TO  SRY-PTID
                 MOVE RECE62-SRYYM       TO  SRY-SRYYM
                 MOVE ACCT-ZAINUM        TO  SRY-ZAINUM
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(1)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(2)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(3)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(4)
                 MOVE TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(5)
                 MOVE SRYACT-REC         TO  MCPDATA-REC
                 MOVE "tbl_sryact"       TO  MCP-TABLE
                 MOVE "key8"             TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF      MCP-RC        =  ZERO
                     MOVE "tbl_sryact"   TO  MCP-TABLE
                     MOVE "key8"         TO  MCP-PATHNAME
                     PERFORM   900-SRYACT-READ-SEC
                     IF     FLG-SRYACT   =  ZERO
                         EVALUATE   IDU
                           WHEN      1
                             MOVE   1   TO  FLG-RINYAK
                           WHEN      2
                           WHEN      3
                           WHEN      4
                           WHEN      5
                           WHEN      6
                           WHEN      7
                             MOVE   2   TO  FLG-RINYAK
                         END-EVALUATE
                     END-IF
                 END-IF
                 MOVE "tbl_sryact"       TO  MCP-TABLE
                 MOVE "key8"             TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
      *
              END-IF
      *
           END-PERFORM
      *
           .
       21014-SINRYO-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点滴手技加算まとめ対象かチェック
      *****************************************************************
       21015-TENTEKIMATOME-CHECK-SEC                 SECTION.
      *
           PERFORM  VARYING  ID4    FROM   1   BY   1
                     UNTIL  (ID4                           >   40 )
                       OR   (WRK-TENTEKI2-ZAINUM(IDX1 ID4) =  ZERO)
                       OR   (FLG-TENTEKIMATOME             =    1 )
      *
             IF    ACCT-ZAINUM  =  WRK-TENTEKI2-ZAINUM(IDX1 ID4)
                  MOVE     1    TO   FLG-TENTEKIMATOME
             END-IF
      *
           END-PERFORM
      *
           .
       21015-TENTEKIMATOME-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    フラグ等のクリア
      *****************************************************************
       21016-FLG-KURIA-SEC                 SECTION.
      *
           MOVE   ZERO   TO   FLG-RINYAK
      *
           MOVE   ZERO   TO   WRK-SRYSURYO
           MOVE   ZERO   TO   WRK-SRYSURYO2
           MOVE   ZERO   TO   WRK-SRYSURYO3
           MOVE   ZERO   TO   WRK-TANICD
           MOVE   ZERO   TO   WRK-TANIMOJISU
           MOVE   SPACE  TO   WRK-TANINAME
           MOVE   ZERO   TO   FLG-HOUSIJI-COM
                              FLG-SYOBYO-COM
                              FLG-RYOYO-COM
                              FLG-SYODOU-COM
                              FLG-OSIN-COM
                              FLG-HOUSEI-COM
                              FLG-HOUMON-COM
                              FLG-TAHOKEN
                              FLG-KENSA-COM
                              FLG-ZAIKYO-COM
                              FLG-BOKOHO-COM
                              FLG-CYOJKSN-COM
                              FLG-HAIJRT-COM
                              FLG-TAIKYO-COM
                              FLG-ZAIHANKO-COM
                              FLG-KIATU-COM
                              FLG-SCPRO-COM
                              FLG-KENKSN-COM
                              FLG-KINGAZ-COM
                              FLG-HAIJSK-COM
                              FLG-SENTAKU-SYUGI
                              FLG-SENTAKU-COM
                              FLG-JYOHOTEIKYO
                              FLG-HOUSKSN-COM
      *
           MOVE   ZERO   TO   WRK-FILMTEN
      *
           MOVE   SPACE  TO   WRK-FORMALNAME
           MOVE   ZERO   TO   WRK-KZI058-TEN
                              WRK-KZI058-TANICD
                              WRK-KZI058-TANIMOJISU
           MOVE   SPACE  TO   WRK-KZI058-TANINAME
           MOVE   ZERO   TO   FLG-WRITE65
           MOVE   ZERO   TO   FLG-TENTEKI
           MOVE   ZERO   TO   FLG-SETCOM
           MOVE   ZERO   TO   WRK-SETCOM-JIDO
           MOVE   ZERO   TO   WRK-SETCOM-JIDO2
           MOVE   ZERO   TO   FLG-KIN-OKIKAE
           MOVE   ZERO   TO   FLG-KIN-OKIKAE2
           MOVE   ZERO   TO   FLG-KIN-OKIKAE3
           MOVE   ZERO   TO   FLG-ONSHI-HEN
           MOVE   ZERO   TO   FLG-ONSHI-HEN2
           MOVE   ZERO   TO   FLG-RIHA-OKIKAE
           MOVE   ZERO   TO   FLG-HENSYU-NG
           MOVE   ZERO   TO   FLG-HENSYU-NG2
           MOVE   ZERO   TO   FLG-HENSYU-ARI
           MOVE   ZERO   TO   FLG-YKZ-PRTKBN
           MOVE   ZERO   TO   FLG-KIZ-PRTKBN
           MOVE   SPACE  TO   WRK-NYUSAI-SRYKBN
           MOVE   ZERO   TO   FLG-TOK11
           MOVE   ZERO   TO   FLG-TOK12
           MOVE   ZERO   TO   FLG-TOK36
           MOVE   ZERO   TO   FLG-TOK11-COM
      *
           .
       21016-FLG-KURIA-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2102-RECE64-HENSYU2-SEC                SECTION.
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    RECE62-HOSPNUM        TO      NACCT-HOSPNUM
           MOVE    RECE62-NYUGAIKBN      TO      NACCT-NYUGAIKBN
           MOVE    RECE62-PTID           TO      NACCT-PTID
      ***  MOVE    RECE62-SRYKA(IDX)     TO      NACCT-SRYKA
           MOVE    RECE62-SRYYM          TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC             =       ZERO
      *
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  900-NYUINACCT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACCT  =  1)
      *
                 IF     NACCT-ZAISKBKBN    =    "1"  
                   IF     NACCT-SRYCDTOTAL   NOT =    099999916         
                       PERFORM      210201-NYUINKHN-GET-SEC
                   END-IF                                               
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                        IF     NACCT-SRYCDTOTAL    =    099999916       
                           MOVE   NACCT-DAY(IDY)                        
                                           TO   WRK-DAY1-SENTEI(IDY)    
                        ELSE                                            
                           IF    RECE62-KANGOGEN-SRYCD(IDY)  =  SPACE
                             MOVE  WRK-KHNTEN-MOTO  TO  WRK-KHNTEN
                             MOVE  WRK-SENTEI-KHNTEN-MOTO
                                                 TO  WRK-SENTEI-KHNTEN
                           ELSE
                             MOVE  WRK-KHNTEN-GEN   TO  WRK-KHNTEN
                             MOVE  WRK-SENTEI-KHNTEN-GEN
                                                 TO  WRK-SENTEI-KHNTEN
                           END-IF
                           MOVE   NACCT-DAY(IDY)  TO   WRK-DAY1(IDY) 
                           IF (NACCT-SRYKBN     =  "90"       )
                           OR (NACCT-SRYCDTOTAL =   190799410 )
                           OR (NACCT-SRYCDTOTAL =   190799510 )
                              MOVE  903  TO  WRK-DAY1-NYUTENTTLKBN(IDY) 
                           ELSE                                         
                              MOVE  920  TO  WRK-DAY1-NYUTENTTLKBN(IDY) 
                           END-IF                                       
                           MOVE   WRK-KHNTEN
                                         TO  WRK-DAY1-KHNTEN(IDY) 
                           MOVE   WRK-KHN-ZAITEN-GEN
                                         TO  WRK-DAY1-ZAITEN-GEN(IDY)
                           MOVE   WRK-KSNTEN
                                         TO  WRK-DAY1-KSNTEN(IDY)
                           MOVE   WRK-SENTEI-KHNTEN                     
                                         TO   WRK-DAY1-SENTEI-KHNTEN    
                                                               (IDY)    
                           MOVE   WRK-SENTEI-ZAITEN-MOTO
                                         TO   WRK-DAY1-SENTEI-ZAITEN    
                                                               (IDY)    
                           MOVE   WRK-SENTEI-ZAITEN-GEN
                                         TO   WRK-DAY1-SENTEI-ZAITEN-GEN
                                                               (IDY)
                           MOVE   WRK-SENTEI-SRYCD                      
                                         TO   WRK-DAY1-SENTEI-SRYCD     
                                                               (IDY)    
                           MOVE   WRK-SENTEI-SRYCD2                     
                                         TO   WRK-DAY1-SENTEI-SRYCD2    
                                                               (IDY)    
                           MOVE   WRK-SENTEI-SRYCD3
                                         TO   WRK-DAY1-SENTEI-SRYCD3
                                                               (IDY)
                           MOVE   WRK-NYUKHNKSNKBN                      
                                      TO  WRK-DAY1-NYUKHNKSNKBN(IDY)    
                           MOVE   WRK-CHUKSNCD
                                      TO  WRK-DAY1-CHUKSNCD(IDY)
                           MOVE   WRK-NYUKHNKBN
                                      TO  WRK-DAY1-NYUKHNKBN(IDY)
                           MOVE   WRK-NYUINKHN
                                      TO  WRK-DAY1-NYUINKHN(IDY)
                           MOVE   WRK-HYOKETU-SRYCD
                                         TO   WRK-DAY1-HYOKETU-SRYCD
                                                               (IDY)
                           MOVE   WRK-KSN-SRYCD
                                         TO   WRK-DAY1-KSN-SRYCD
                                                               (IDY)
                           MOVE   WRK-HYOKETU-TEN
                                         TO   WRK-DAY1-HYOKETU-TEN
                                                               (IDY)
                        END-IF                                          
                     ELSE
                        IF  RECE62-NYUINDAY-KBN(IDY)  =  "1"
                           IF (NACCT-SRYKBN     =  "90"       )
                           OR (NACCT-SRYCDTOTAL =   190799410 )
                           OR (NACCT-SRYCDTOTAL =   190799510 )
                              MOVE  903  TO  WRK-DAY1-NYUTENTTLKBN(IDY)
                           ELSE
                              MOVE  920  TO  WRK-DAY1-NYUTENTTLKBN(IDY)
                           END-IF
                        END-IF
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN    =    "2"  
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY2(IDY) 
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF   ( NACCT-ZAISKBKBN    =    "4"       )
                 AND  ( NACCT-SRYCDTOTAL   =    197000570 )
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY4(IDY) 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY4X(IDY)
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN    =    "5"  
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
                     IF   NACCT-DAY(IDY)   NOT =  ZERO 
                             MOVE   NACCT-DAY(IDY)  TO   WRK-DAY5(IDY) 
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
                 MOVE    "key7"                TO      MCP-PATHNAME
                 PERFORM        900-NYUINACCT-READ-SEC
               END-PERFORM
      *
           END-IF
      *
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             IF    WRK-DAY2(IDY) >=  4
                CONTINUE
             ELSE
                MOVE   ZERO    TO   WRK-DAY1-KSN-SRYCD(IDY)
                MOVE   ZERO    TO   WRK-DAY1-HYOKETU-SRYCD(IDY)
             END-IF
           END-PERFORM
      *
           PERFORM      210202-SENTEI-KEISU-GET-SEC
      *
      *    入院料と異なる食事算定保険組み合わせ取得
           PERFORM      210225-SKJHKN-GET-SEC
      *
           MOVE    ZERO    TO    WRK-ZAINUM-CNT2
           MOVE    ZERO    TO    FLG-DOJITU
           INITIALIZE            WRK-SKJ-DOJITU-TABLE
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    RECE62-HOSPNUM        TO      NACCT-HOSPNUM
           MOVE    RECE62-NYUGAIKBN      TO      NACCT-NYUGAIKBN
           MOVE    RECE62-PTID           TO      NACCT-PTID
      ***  MOVE    RECE62-SRYKA(IDX)     TO      NACCT-SRYKA
           MOVE    RECE62-SRYYM          TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
      *
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  900-NYUINACCT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACCT  =  1)
      *
                 IF     NACCT-ZAISKBKBN    =    "1"  OR  "2"  OR
                                                "4"  OR  "6"  OR
                                                "7"
      *
                   MOVE     ZERO       TO    CNT-ZAIREN
                   IF   NACCT-ZAISKBKBN  = "6"
                      ADD    1         TO    WRK-ZAINUM-CNT2
                   END-IF
      *
                   PERFORM  VARYING  IDX1    FROM    1   BY  1
                             UNTIL   IDX1    >       10
                             OR      RECE62-HKNCOMBI (IDX1)  =   ZERO 
      *
                      INITIALIZE          WRK-DAY-TABLE2
                                          WRK-GAI-TABLE
                                          WRK-GAI-TABLE2
                                          WRK-SKJ-TABLE
                                          WRK-SKJ-TABLE2
                      MOVE     ZERO       TO    CNT-DAY21
                                                CNT-DAY21-SENTEI        
                                                CNT-DAY21-X
                                                CNT-DAY21-SENTEI-X
                                                CNT-DAY21-Y
                                                CNT-DAY21-SENTEI-Y
                                                CNT-DAY22
                                                CNT-DAY24
                      MOVE     ZERO       TO    FLG-DAY21
                                                FLG-DAY21-SENTEI        
                                                FLG-DAY22
                                                FLG-DAY24
                                                FLG-MIJISI
                                                FLG-MIJISI-SENTEI       
                      MOVE     ZERO       TO    WRK-ZAITEN-W
                                                WRK-ZAITEN-W2
                                                WRK-SENTEI-ZAITEN-W     
                                                WRK-SENTEI-SRYCD-W      
                                                WRK-SENTEI-SRYCD2-W     
                                                WRK-SENTEI-SRYCD3-W
                                                WRK-KANGOGEN-SRYCD-W
                                                WRK-KANGOGEN-SRYCD-W2
                      MOVE     ZERO       TO    WRK-NYUTENTTLKBN
      *
                      PERFORM  VARYING  IDY    FROM    1   BY  1
                                  UNTIL   IDY     >       31
      *
                         IF  RECE62-HKNCOMBI (IDX1)  =  WRK-DAY5(IDY)
                            IF   NACCT-ZAITEN    NOT =  ZERO
                            AND  NACCT-DAY(IDY)  NOT =  ZERO
                            AND  NACCT-ZAISKBKBN NOT =  "4"
                              IF NACCT-ZAISKBKBN     =  "1"
                                 IF  WRK-DAY2(IDY) =  ZERO
                                  IF  WRK-DAY1-SENTEI(IDY) =  ZERO      
                                     MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY21(IDY) 
                                     ADD    1   TO   CNT-DAY21
                                     MOVE   1   TO   FLG-DAY21
                                     MOVE   1   TO   FLG-MIJISI
                                     IF RECE62-KANGOGEN-SRYCD(IDY)
                                                             =  SPACE
                                       MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY21-X(IDY)
                                       ADD  1   TO   CNT-DAY21-X
                                     ELSE
                                       MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY21-Y(IDY)
                                       COMPUTE  WRK-KEISAN2    =
                                                WRK-DAY1-ZAITEN-GEN(IDY)
                                                               +  0.5
                                       MOVE   WRK-KEISAN2
                                            TO   WRK-ZAITEN-W
                                       MOVE   RECE62-KANGOGEN-SRYCD(IDY)
                                            TO   WRK-KANGOGEN-SRYCD-W
                                       ADD  1   TO   CNT-DAY21-Y
                                     END-IF
                                  ELSE                                  
                                     MOVE   NACCT-DAY(IDY)              
                                            TO   WRK-DAY21-SENTEI(IDY)  
                                     MOVE   WRK-DAY1-SENTEI-ZAITEN(IDY) 
                                            TO   WRK-SENTEI-ZAITEN-W    
                                     MOVE   WRK-DAY1-SENTEI-SRYCD(IDY)  
                                            TO   WRK-SENTEI-SRYCD-W     
                                     MOVE   WRK-DAY1-SENTEI-SRYCD2(IDY) 
                                            TO   WRK-SENTEI-SRYCD2-W    
                                     MOVE   WRK-DAY1-SENTEI-SRYCD3(IDY)
                                            TO   WRK-SENTEI-SRYCD3-W
                                     ADD    1   TO   CNT-DAY21-SENTEI   
                                     MOVE   1   TO   FLG-DAY21-SENTEI   
                                     MOVE   1   TO   FLG-MIJISI-SENTEI  
                                     IF RECE62-KANGOGEN-SRYCD(IDY)
                                                             =  SPACE
                                       MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY21-SENTEI-X(IDY)
                                       ADD  1   TO   CNT-DAY21-SENTEI-X
                                     ELSE
                                       MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY21-SENTEI-Y(IDY)
                                       COMPUTE  WRK-KEISAN2    =
                                         WRK-DAY1-SENTEI-ZAITEN-GEN(IDY)
                                                               +  0.5
                                       MOVE   WRK-KEISAN2
                                            TO   WRK-ZAITEN-W2
                                       MOVE   RECE62-KANGOGEN-SRYCD(IDY)
                                            TO   WRK-KANGOGEN-SRYCD-W2
                                       ADD  1   TO   CNT-DAY21-SENTEI-Y
                                     END-IF
                                  END-IF                                
                                 END-IF
                              ELSE
                                IF  ((WRK-DAY1(IDY)   NOT  =  ZERO  ) OR
                                     (RECE62-NYUINDAY-KBN(IDY) = "1"))
                                AND ((WRK-DAY2(IDY)   =  ZERO       ) OR
                                     (WRK-DAY2(IDY)  >=   4         ))
                                    MOVE   NACCT-DAY(IDY)  
                                               TO   WRK-DAY21(IDY) 
                                    MOVE   WRK-DAY1-NYUTENTTLKBN(IDY)
                                               TO   WRK-NYUTENTTLKBN
                                    ADD    1     TO   CNT-DAY21
                                    MOVE   1     TO   FLG-DAY21
                                END-IF
                              END-IF
                            END-IF
      *                     *外泊
                            IF  ((WRK-DAY1(IDY)   NOT  =  ZERO  ) OR
                                 (RECE62-NYUINDAY-KBN(IDY) = "1"))
                            AND ( NACCT-ZAITEN         =  ZERO   )
                            AND ( NACCT-ZAISKBKBN      =  "2"    )
                            AND ( NACCT-DAY(IDY)  NOT  =  ZERO   )
                               MOVE   NACCT-DAY(IDY)  
                                            TO   WRK-DAY22(IDY) 
                               MOVE   WRK-DAY1-NYUTENTTLKBN(IDY)
                                        TO  WRK-DAY22-NYUTENTTLKBN(IDY)
                               MOVE   WRK-DAY1-NYUKHNKSNKBN(IDY)        
                                        TO  WRK-DAY22-NYUKHNKSNKBN(IDY) 
                               MOVE   WRK-DAY1-CHUKSNCD(IDY)
                                        TO  WRK-DAY22-CHUKSNCD(IDY)
                               MOVE   WRK-DAY1-NYUKHNKBN(IDY)
                                        TO  WRK-DAY22-NYUKHNKBN(IDY)
                               MOVE   WRK-DAY1-NYUINKHN(IDY)
                                        TO  WRK-DAY22-NYUINKHN(IDY)
                               PERFORM      210203-NYUINACCT-GET-SEC
      *************************ADD    1     TO   CNT-DAY22
      *************************MOVE   1     TO   FLG-DAY22
                            END-IF
      *                     *食事
                            PERFORM      210226-SKJ-HENSYU-SEC
                         ELSE
      *                     *食事
                            PERFORM      210227-SKJ-HENSYU2-SEC
                         END-IF
      *
                      END-PERFORM
      *
                      IF   FLG-DAY21    =   1
                        ADD     1     TO   CNT-ZAIREN
                        IF   RECE62-SRYYM       >= "201804"
                        AND  NACCT-ZAISKBKBN     = "1"
                        AND  CNT-DAY21-Y     NOT = ZERO
                         IF  CNT-DAY21 = CNT-DAY21-Y
                           MOVE      2    TO    FLG-HENSYU
                           PERFORM   210205-RECE64-TENSOU2-SEC
                           PERFORM   210206-RECE65-HENSYU2-SEC
                           PERFORM   RECE64-WRITE-SEC
                         ELSE
                           MOVE      3    TO    FLG-HENSYU
                           PERFORM   210205-RECE64-TENSOU2-SEC
                           PERFORM   210206-RECE65-HENSYU2-SEC
                           PERFORM   RECE64-WRITE-SEC
                           MOVE      4    TO    FLG-HENSYU
                           PERFORM   210205-RECE64-TENSOU2-SEC
                           PERFORM   210206-RECE65-HENSYU2-SEC
                           PERFORM   RECE64-WRITE-SEC
                         END-IF
                        ELSE
                         MOVE      1      TO    FLG-HENSYU
                         PERFORM   210205-RECE64-TENSOU2-SEC
                         PERFORM   210206-RECE65-HENSYU2-SEC
                         PERFORM   RECE64-WRITE-SEC
                         IF    FLG-MIJISI  =  1  
                            PERFORM VARYING SYUKEI-IDX3 FROM 1 BY 1
                               UNTIL  SYUKEI-IDX3           > 4
      *
                             IF    WRK-SYS-MIJISI(SYUKEI-IDX3) = 1
                               PERFORM  VARYING  IDY  FROM  1  BY  1
                                      UNTIL   IDY     >       31
                                IF   WRK-DAY21(IDY)  NOT =  ZERO
                                  EVALUATE WRK-DAY1-NYUTENTTLKBN(IDY)
                                    WHEN   903
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21(IDY)  
                                           TO   WRK-MIJ-DAY90
                                                (IDX1 SYUKEI-IDX3 IDY) 
                                      END-IF
                                    WHEN   920
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21(IDY)  
                                           TO   WRK-MIJ-DAY92
                                                (IDX1 SYUKEI-IDX3 IDY)
                                      END-IF
                                  END-EVALUATE
                                END-IF
                               END-PERFORM
                             END-IF
      *
                            END-PERFORM
                         END-IF
                        END-IF
                      END-IF
      *
                      IF   FLG-DAY21-SENTEI    =   1
                        ADD     1     TO   CNT-ZAIREN
                        IF   RECE62-SRYYM           >= "201804"
                        AND  NACCT-ZAISKBKBN         = "1"
                        AND  CNT-DAY21-SENTEI-Y  NOT = ZERO
                         IF  CNT-DAY21-SENTEI = CNT-DAY21-SENTEI-Y
                           MOVE      2    TO    FLG-HENSYU
                           PERFORM   210207-RECE64-TENSOU2-SEN-SEC
                           PERFORM   210208-RECE65-HENSYU2-SEN-SEC
                           PERFORM   RECE64-WRITE-SEC
                         ELSE
                           MOVE      3    TO    FLG-HENSYU
                           PERFORM   210207-RECE64-TENSOU2-SEN-SEC
                           PERFORM   210208-RECE65-HENSYU2-SEN-SEC
                           PERFORM   RECE64-WRITE-SEC
                           MOVE      4    TO    FLG-HENSYU
                           PERFORM   210207-RECE64-TENSOU2-SEN-SEC
                           PERFORM   210208-RECE65-HENSYU2-SEN-SEC
                           PERFORM   RECE64-WRITE-SEC
                         END-IF
                        ELSE
                         MOVE      1      TO    FLG-HENSYU
                         PERFORM   210207-RECE64-TENSOU2-SEN-SEC
                         PERFORM   210208-RECE65-HENSYU2-SEN-SEC
                         PERFORM   RECE64-WRITE-SEC
                         IF    FLG-MIJISI-SENTEI  =  1  
                            PERFORM VARYING SYUKEI-IDX3 FROM 1 BY 1
                               UNTIL  SYUKEI-IDX3           > 4
      *
                             IF    WRK-SYS-MIJISI(SYUKEI-IDX3) = 1
                               PERFORM  VARYING  IDY  FROM  1  BY  1
                                      UNTIL   IDY     >       31
                                IF  WRK-DAY21-SENTEI(IDY)  NOT =  ZERO
                                  EVALUATE WRK-DAY1-NYUTENTTLKBN(IDY)
                                    WHEN   903
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21-SENTEI(IDY)  
                                           TO   WRK-MIJ-DAY90
                                                (IDX1 SYUKEI-IDX3 IDY) 
                                      END-IF
                                    WHEN   920
                                      IF  WRK-SYS-MIJISI-FLG
                                             (SYUKEI-IDX3 IDY)  = 1
                                         MOVE   RECE62-HKNCOMBI (IDX1)
                                           TO   WRK-MIJ-HKNCOMBI(IDX1)
                                         MOVE   WRK-DAY21-SENTEI(IDY)  
                                           TO   WRK-MIJ-DAY92
                                                (IDX1 SYUKEI-IDX3 IDY)
                                      END-IF
                                  END-EVALUATE
                                END-IF
                               END-PERFORM
                             END-IF
      *
                            END-PERFORM
                         END-IF
                        END-IF
                      END-IF
      *
                      IF   FLG-DAY22    =   1
                         PERFORM    210209-NYUINACCT-HEN-SEC
                         ADD    1     TO   CNT-ZAIREN
                         PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                            UNTIL  SYUKEI-IDX3           > 20
                             OR    WRK-GAI2-DAY(SYUKEI-IDX3) = ZERO
      *
                             PERFORM   210210-RECE64-TENSOU2-GAI-SEC
                             PERFORM   210211-RECE65-HENSYU2-GAI-SEC
                             PERFORM   RECE64-WRITE-SEC
      *
                         END-PERFORM
                      END-IF
      *
                      IF   FLG-DAY24    =   1
                       IF   RECE62-SRYYM  >= "200604"
                         CONTINUE
                       ELSE
                         PERFORM    210212-NYUINACCT-HEN2-SEC
                         ADD    1     TO   CNT-ZAIREN
                         PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                            UNTIL  SYUKEI-IDX3           >  31
                             OR    WRK-SKJ2-ZAITEN(SYUKEI-IDX3) = ZERO
      *
                             PERFORM   210213-RECE64-TENSOU2-SKJ-SEC
                             PERFORM   210214-RECE65-HENSYU2-SKJ-SEC
                             PERFORM   RECE64-WRITE-SEC
      *
                         END-PERFORM
                       END-IF
                      END-IF
      *
                   END-PERFORM
      *
                 END-IF
      *
                 MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
                 MOVE    "key7"                TO      MCP-PATHNAME
                 PERFORM        900-NYUINACCT-READ-SEC
               END-PERFORM
      *
           END-IF
      *
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
      *
      *    未実施減算
           PERFORM  VARYING  IDX1  FROM  1  BY  1
                    UNTIL  IDX1         >  10
      *
             IF    WRK-MIJ-HKNCOMBI(IDX1)  NOT =  ZERO 
      *
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                      UNTIL  SYUKEI-IDX3  >   4
      *
                 PERFORM   VARYING   IDY   FROM   1   BY   1
                         UNTIL   IDY    >  31
                    IF   WRK-MIJ-DAY90(IDX1 SYUKEI-IDX3 IDY)  
                                                  NOT =  ZERO
                        ADD   1   TO  WRK-MIJ-CNT90(IDX1 SYUKEI-IDX3)
                    END-IF
                    IF   WRK-MIJ-DAY92(IDX1 SYUKEI-IDX3 IDY)  
                                                  NOT =  ZERO
                        ADD   1   TO  WRK-MIJ-CNT92(IDX1 SYUKEI-IDX3)
                    END-IF
                 END-PERFORM
      *
               END-PERFORM
      *
             END-IF
      *
           END-PERFORM
      *
      *
           PERFORM      210215-MIJISI-GET-SEC
      *
           MOVE     ZERO       TO    CNT-ZAIREN
      *
           PERFORM  VARYING  IDX1  FROM  1  BY  1
                    UNTIL  IDX1         >  10
      *
             IF    WRK-MIJ-HKNCOMBI(IDX1)  NOT =  ZERO  
      *
               ADD       1      TO     CNT-ZAIREN
      *
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                      UNTIL  SYUKEI-IDX3  >   4
      *
                 IF   WRK-MIJ-CNT90(IDX1 SYUKEI-IDX3)  NOT =  ZERO
                       MOVE      1      TO     FLG-MIJISI2
                       PERFORM   210216-RECE64-TENSOU2-MIJ-SEC
                       PERFORM   210217-RECE65-TENSOU2-MIJ-SEC
                       PERFORM   RECE65-WRITE-SEC
                       PERFORM   RECE64-WRITE-SEC
                 END-IF
      *
               END-PERFORM
      *
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                    UNTIL  SYUKEI-IDX3  >   4
      *
                 IF   WRK-MIJ-CNT92(IDX1 SYUKEI-IDX3)  NOT =  ZERO
                       MOVE      2      TO     FLG-MIJISI2
                       PERFORM   210216-RECE64-TENSOU2-MIJ-SEC
                       PERFORM   210217-RECE65-TENSOU2-MIJ-SEC
                       PERFORM   RECE65-WRITE-SEC
                       PERFORM   RECE64-WRITE-SEC
                 END-IF
      *
               END-PERFORM
      *
             END-IF
      *
           END-PERFORM
      *
      *    同日再入院
      *
           IF   RECE62-SRYYM   >=  "200604"
              IF   FLG-DOJITU   =   1
                 PERFORM  VARYING  IDX1  FROM  1  BY  1
                           UNTIL   IDX1    >  10
                    PERFORM   210223-NYUINACCT-SYU2-DOU-SEC
                 END-PERFORM
              END-IF
           END-IF
      *
      *    入院時生活療養費負担額取得
           IF     RECE62-SRYYM   >=  "201604"
             INITIALIZE                   ORCSNYULIFE2-AREA
             MOVE    RECE62-HOSPNUM   TO  LNK-NYULIFE2-HOSPNUM
             MOVE    RECE62-PTID      TO  LNK-NYULIFE2-PTID
             MOVE    RECE62-SRYYM     TO  LNK-NYULIFE2-SANTEIYM
             CALL    "ORCSNYULIFE2"       USING
                                          ORCSNYULIFE2-AREA
                                          SPA-AREA
             IF      LNK-NYULIFE2-RC  =   ZERO
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                         UNTIL   SYUKEI-IDX3   >   31
                 MOVE  LNK-NYULIFE2-KBN(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KBN(SYUKEI-IDX3)
                 PERFORM  VARYING  IDX30  FROM  1  BY  1
                           UNTIL   IDX30   >    3
                  IF  LNK-NYULIFE2-SKJFTN-SRYCD(SYUKEI-IDX3 IDX30)
                                                        NOT =  SPACE
                    MOVE  LNK-NYULIFE2-SKJFTN-SRYCD(SYUKEI-IDX3 IDX30)
                             TO  WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                  END-IF
                  IF  LNK-NYULIFE2-SKJFTN-MONEY(SYUKEI-IDX3 IDX30)
                                                        NOT =  ZERO
                    MOVE  LNK-NYULIFE2-SKJFTN-MONEY(SYUKEI-IDX3 IDX30)
                             TO  WRK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                  END-IF
                 END-PERFORM
                 MOVE    LNK-NYULIFE2-KANFTN-SRYCD(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                 MOVE    LNK-NYULIFE2-KANFTN-MONEY(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
               END-PERFORM
             END-IF
      *
      *      食事負担据え置き対象取得
             IF  (RECE62-HKNNUM(1:2) =  "98"  OR "90"  OR "91" )
             OR  (RECE62-HKNNUM      =  "068" OR "069" OR "040")
               CONTINUE
             ELSE
               INITIALIZE                   ORCSSKJKEEP-AREA
               MOVE    RECE62-HOSPNUM   TO  LNK-SKJKEEP-HOSPNUM
               MOVE    RECE62-PTID      TO  LNK-SKJKEEP-PTID
               MOVE    RECE62-SRYYM     TO  LNK-SKJKEEP-SANTEIYM
               CALL    "ORCSSKJKEEP"        USING
                                            ORCSSKJKEEP-AREA
                                            SPA-AREA
               IF      LNK-SKJKEEP-RC   =   ZERO
                 PERFORM  VARYING  IDX30  FROM  1  BY  1
                           UNTIL   IDX30   >   31
                   MOVE  LNK-SKJKEEP-KBN(IDX30)
                               TO  WRK-SKJKEEP-KBN(IDX30)
                   IF    WRK-SKJKEEP-KBN(IDX30) = "2"
                   AND   RECE62-TEISYOTOKU3-SKJKBN(IDX30)
                                            NOT =  SPACE
                   AND   RECE62-SRYYM          >= "201710"
                      MOVE  SPACE   TO  WRK-SKJKEEP-KBN(IDX30)
                   END-IF
                 END-PERFORM
                 MOVE    LNK-SKJKEEP-SEI-NYUINYMD
                               TO  RECE62-SEISIN-NYUINYMD
               END-IF
             END-IF
           ELSE
            IF    RECE62-SRYYM   >=  "200610"
             INITIALIZE                   ORCSNYULIFE-AREA
             MOVE    RECE62-HOSPNUM   TO  LNK-NYULIFE-HOSPNUM
             MOVE    RECE62-PTID      TO  LNK-NYULIFE-PTID
             MOVE    RECE62-SRYYM     TO  LNK-NYULIFE-SANTEIYM
             CALL    "ORCSNYULIFE"        USING
                                          ORCSNYULIFE-AREA
                                          SPA-AREA
             IF      LNK-NYULIFE-RC   =   ZERO
               PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                         UNTIL   SYUKEI-IDX3   >   31
                 MOVE  LNK-NYULIFE-KBN(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KBN(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                 MOVE  LNK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
                             TO  WRK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
               END-PERFORM
             END-IF
            END-IF
           END-IF
      *
      *    ２００６年４月以降の食事療養
           IF   RECE62-SRYYM   >=  "200604"
      *
              MOVE     ZERO     TO    CNT-ZAIREN
      *
              PERFORM  VARYING  IDX1  FROM  1  BY  1
                        UNTIL   IDX1    >  10
      *
                IF    WRK-SKJ200604-HKNCOMBI(IDX1)  NOT =  ZERO
      *
                   PERFORM 210224-SKJFTN-HANTEI-SEC
      *
                   ADD       1      TO     CNT-ZAIREN
      *
                   PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                             UNTIL   SYUKEI-IDX3    >  31
      *
                     IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)
                                                        NOT =  ZERO
                     OR   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 4)
                                                        NOT =  ZERO
                        PERFORM 210213X-RECE64-TENSOU2-SKJ2-SEC
                        PERFORM 210214X-RECE65-HENSYU2-SKJ2-SEC
                        PERFORM RECE65-WRITE-SEC
                        PERFORM RECE64-WRITE-SEC
                        IF  (RECE62-SRYYM                >=  "201604")
                        AND (WRK-SKJKEEP-KBN(SYUKEI-IDX3) =  "2"     )
                        AND (FLG-SKJFTNNASI               =   ZERO   )
                         IF  WRK-NYULIFE-KBN(SYUKEI-IDX3) NOT = SPACE
                          IF WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                                   =  "197003710"
                           MOVE    1   TO  RECE62-SEISIN-SKJFLG
                           MOVE    1   TO  RECE62-SEISIN-SKJSAN
                                                  (IDX1 SYUKEI-IDX3)
                          END-IF
                         ELSE
                           MOVE    1   TO  RECE62-SEISIN-SKJFLG
                           MOVE    1   TO  RECE62-SEISIN-SKJSAN
                                                  (IDX1 SYUKEI-IDX3)
                         END-IF
                        END-IF
                     END-IF
      *
                     IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                       IF    WRK-SKJ200604-DAY-KAN(IDX1 SYUKEI-IDX3)
                                                        NOT =  ZERO
                         PERFORM 210219-RECE64-TENSOU2-KAN-SEC
                         PERFORM 210220-RECE65-HENSYU2-KAN-SEC
                         PERFORM RECE65-WRITE-SEC
                         PERFORM RECE64-WRITE-SEC
                       END-IF
      *
                       IF  FLG-SKJFTNNASI  =  ZERO
                        IF   WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                                        NOT =  SPACE
                        AND  WRK-NYULIFE-SKJFTN-MONEY(SYUKEI-IDX3)
                                                        NOT =  ZERO
                        AND  WRK-SKJ200604-SURYOUTOTALFTN
                                                (IDX1 SYUKEI-IDX3)
                                                        NOT =  ZERO
                          MOVE    1    TO   FLG-SKJ200610FTN
                          PERFORM 210221-RECE64-TENSOU2-SFTN-SEC
                          PERFORM 210222-RECE65-HENSYU2-SFTN-SEC
                          PERFORM RECE65-WRITE-SEC
                          PERFORM RECE64-WRITE-SEC
                        END-IF
                        IF   WRK-SKJ200604-DAY-KAN(IDX1 SYUKEI-IDX3)
                                                        NOT =  ZERO
                        AND  WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                                                        NOT =  SPACE
                        AND  WRK-NYULIFE-KANFTN-MONEY(SYUKEI-IDX3)
                                                        NOT =  ZERO
                          MOVE    2    TO   FLG-SKJ200610FTN
                          PERFORM 210221-RECE64-TENSOU2-SFTN-SEC
                          PERFORM 210222-RECE65-HENSYU2-SFTN-SEC
                          PERFORM RECE65-WRITE-SEC
                          PERFORM RECE64-WRITE-SEC
                        END-IF
                       END-IF
                     END-IF
      *
                   END-PERFORM
      *
                END-IF
      *
              END-PERFORM
      *
           END-IF
      *
           .
       2102-RECE64-HENSYU2-EXT.
           EXIT.
      *
      **************************************************************
      *    入院基本料の取得
      **************************************************************
       210201-NYUINKHN-GET-SEC           SECTION.
      *
           MOVE    ZERO               TO   WRK-KHNTEN
                                           WRK-KHNTEN-MOTO
                                           WRK-KHNTEN-GEN
      *****                                WRK-KHN-ZAITEN
                                           WRK-KHN-ZAITEN-MOTO
                                           WRK-KHN-ZAITEN-GEN
                                           WRK-NYUKHNKSNKBN    
                                           WRK-KSNTEN
                                           WRK-KSN-SRYCD
      *
           MOVE    SPACE              TO   WRK-CHUKSNCD
           MOVE    ZERO               TO   WRK-NYUKHNKBN
           MOVE    SPACE              TO   WRK-NYUINKHN
      *
           MOVE    ZERO               TO   WRK-SENTEI-KHNTEN
                                           WRK-SENTEI-KHNTEN-MOTO
                                           WRK-SENTEI-KHNTEN-GEN
      *****                                WRK-SENTEI-ZAITEN
                                           WRK-SENTEI-ZAITEN-MOTO
                                           WRK-SENTEI-ZAITEN-GEN
                                           WRK-SENTEI-SRYCD
                                           WRK-SENTEI-SRYCD2
                                           WRK-SENTEI-SRYCD3
                                           NYUINACT-IDX
      *
           MOVE    SPACE              TO   WRK-GAIHAKU-SRYCD
           MOVE    ZERO               TO   WRK-GAIHAKU-KHNTEN
      *
           MOVE    ZERO               TO   WRK-HYOKETU-TEN
                                           WRK-HYOKETU-SRYCD
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC             =    ZERO
               MOVE    "tbl_nyuinact"      TO      MCP-TABLE
               MOVE    "key9"              TO      MCP-PATHNAME
               PERFORM 900-NYUINACT-READ-SEC
           ELSE
               MOVE    1              TO   FLG-NYUINACT
           END-IF
           IF      FLG-NYUINACT        =   ZERO
               MOVE      ZERO         TO   FLG-NYUKHN  
               PERFORM   VARYING  IDX2  FROM 1  BY  1
                 UNTIL  (FLG-NYUKHN         =      1)    OR
                        (IDX2               >      5)    OR
                        (NSRY-SRYCD(IDX2)   =  SPACE)
                     MOVE    NSRY-SRYCD(IDX2)    TO  WRK-SRYCD
                     MOVE    NACCT-SRYYM         TO  WK-TAIHI-SRYYM
                     MOVE    1                   TO  WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF   FLG-TENSU      =    ZERO
                       IF   TNS-DATAKBN    =    1
                          IF  (RECE62-SRYYM    >= "202004")
                          AND (TNS-SRYCD    NOT = SPACE   )
                          AND (TNS-NYUKHNKSNKBN = ZERO    )
                            INITIALIZE              SNTENSU-AREA
                            MOVE  TNS-SRYCD     TO  SNTENSU-SRYCD
                            MOVE  RECE62-SRYYM
                                         TO   SNTENSU-BASEYMD(1:6)
                            MOVE  "01"   TO   SNTENSU-BASEYMD(7:2)
                            CALL  "ORCSNTENSU"  USING
                                                SNTENSU-AREA
                                                TNS-TENSU-REC
                                                SPA-AREA
                          END-IF
                          MOVE   TNS-TEN   TO   WRK-KHNTEN-MOTO
      *                   夜間看護体制特定日減算
                          COMPUTE  WRK-KHNTEN-GEN   =
                                  (WRK-KHNTEN-MOTO  * 0.95)
                          MOVE   TNS-NYUKHNKSNKBN                  
                                           TO   WRK-NYUKHNKSNKBN   
      *                   入院基本料加算区分置き換え
                          IF  RECE62-SRYYM >= "201804"
      *                     療養病棟入院基本料
      *                                   （特別入院基本料）
                            IF   (TNS-NYUKHNKSNKBN = 27 )
                            AND  (TNS-CDKBN-KBNNUM = 101)
                              MOVE   901   TO   WRK-NYUKHNKSNKBN
                            END-IF
      *                     有床診療所療養病床入院基本料
      *                                   （特別入院基本料）
                            IF   (TNS-NYUKHNKSNKBN = 27 )
                            AND  (TNS-CDKBN-KBNNUM = 109)
                              MOVE   909   TO   WRK-NYUKHNKSNKBN
                            END-IF
                          END-IF
                          MOVE   TNS-CHUKSNCD
                                           TO   WRK-CHUKSNCD
                          MOVE   TNS-NYUKHNKBN
                                           TO   WRK-NYUKHNKBN
                          MOVE   NSRY-SRYCD(IDX2)
                                           TO   WRK-NYUINKHN
                          MOVE   NSRY-SRYCD(IDX2)
                                           TO   WRK-SENTEI-SRYCD
      *                   看護比率基準未達時の入院基本点数の取得
                          IF    RECE62-SRYYM  <=  "201203"
                           PERFORM 2102011-GAIHAKU-NYUINKHN-SEC
                          END-IF
                          IF   WRK-GAIHAKU-KHNTEN  NOT =  ZERO
                                 MOVE   WRK-GAIHAKU-KHNTEN
                                           TO   WRK-KHNTEN-MOTO
                          END-IF     
                          MOVE   IDX2      TO   NYUINACT-IDX
      ***                 MOVE   1         TO   FLG-NYUKHN
                       ELSE
                          EVALUATE  TNS-TENSIKIBETU
                            WHEN     3
                                MOVE  TNS-TEN  TO  WRK-KSNTEN
                                MOVE  NSRY-SRYCD(IDX2)
                                               TO  WRK-KSN-SRYCD
                            WHEN     8
                                COMPUTE  WRK-KSNTEN = TNS-TEN * -1
                                MOVE  NSRY-SRYCD(IDX2)
                                               TO  WRK-KSN-SRYCD
                            WHEN     6
                                MOVE  TNS-TEN  TO  WRK-HYOKETU-TEN
                                MOVE  NSRY-SRYCD(IDX2)
                                               TO  WRK-HYOKETU-SRYCD
                          END-EVALUATE
                       END-IF
                     END-IF                  
               END-PERFORM
      *
               COMPUTE  WRK-KHN-ZAITEN-MOTO     =
                        NACCT-ZAITEN
               COMPUTE  WRK-KHN-ZAITEN-GEN      =
                        WRK-KHNTEN-GEN          +
                        WRK-KSNTEN
               IF     WRK-HYOKETU-TEN    NOT =   ZERO
      *          標欠：％減算
                 COMPUTE    WRK-KEISAN2             =
                          ( WRK-KHN-ZAITEN-GEN      -
                           (WRK-KHN-ZAITEN-GEN      *
                            (WRK-HYOKETU-TEN   /  100))) + 0.5
                 MOVE   WRK-KEISAN2   TO   WRK-KHN-ZAITEN-GEN
               END-IF
      *
               IF    NYUINACT-IDX    NOT   =   ZERO
      *
                 MOVE    SPACE                TO  SENTEICDCHG-REC
                 INITIALIZE                       SENTEICDCHG-REC
                 MOVE    NSRY-SRYCD(NYUINACT-IDX)
                                              TO  SENCHG-IPNSRYCD
                 MOVE    SENTEICDCHG-REC      TO  MCPDATA-REC
                 MOVE    "tbl_senteicdchg"    TO  MCP-TABLE
                 MOVE    "key2"               TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF      MCP-RC             =    ZERO
                     MOVE    "tbl_senteicdchg"    TO  MCP-TABLE
                     MOVE    "key2"               TO  MCP-PATHNAME
                     PERFORM  900-SENTEICDCHG-READ-SEC
                 ELSE
                     MOVE    1                TO  FLG-SENTEICDCHG
                 END-IF
      *
                 IF  FLG-SENTEICDCHG   =   ZERO
                  IF    SENCHG-IPNSRYCD  =  SENCHG-SENTEISRYCD
      *             夜勤時間経過減算の選定対応
      *             "190131410","190165810","190165910","190131310"
                    IF   RECE62-SRYYM >= "201404"
                       COMPUTE  WRK-SENTEI-KHNTEN-MOTO  =
                               (WRK-KHNTEN-MOTO * 0.85) +  0.5
      *                夜間看護体制特定日減算
                       COMPUTE  WRK-SENTEI-KHNTEN-GEN   =
                               (WRK-SENTEI-KHNTEN-MOTO  * 0.95)
                       COMPUTE  WRK-SENTEI-ZAITEN-MOTO  =
                                WRK-SENTEI-KHNTEN-MOTO  +
                                WRK-KSNTEN
                       COMPUTE  WRK-SENTEI-ZAITEN-GEN   =
                                WRK-SENTEI-KHNTEN-GEN   +
                                WRK-KSNTEN
                       IF     WRK-HYOKETU-TEN    NOT =   ZERO
      *                  標欠：％減算
                         COMPUTE    WRK-SENTEI-ZAITEN-MOTO  =
                                  ( WRK-SENTEI-ZAITEN-MOTO  -
                                   (WRK-SENTEI-ZAITEN-MOTO  *
                                    (WRK-HYOKETU-TEN   /  100))) + 0.5
                         COMPUTE    WRK-KEISAN2             =
                                  ( WRK-SENTEI-ZAITEN-GEN   -
                                   (WRK-SENTEI-ZAITEN-GEN   *
                                    (WRK-HYOKETU-TEN   /  100))) + 0.5
                         MOVE   WRK-KEISAN2   TO   WRK-SENTEI-ZAITEN-GEN
                       END-IF
                       MOVE  SENCHG-SENTEISRYCD  TO   WRK-SENTEI-SRYCD2
                       MOVE  190122890           TO   WRK-SENTEI-SRYCD3
                    END-IF
                  ELSE
                    MOVE     SENCHG-SENTEISRYCD  TO   WRK-SRYCD
                    MOVE     NACCT-SRYYM         TO   WK-TAIHI-SRYYM
                    MOVE     1                   TO   WK-TAIHI-SRYD
                    PERFORM  900-TENSU-TBL-SEC
                    IF       FLG-TENSU      =    ZERO
                       MOVE   TNS-TEN   TO   WRK-SENTEI-KHNTEN-MOTO
      *                夜間看護体制特定日減算
                       COMPUTE  WRK-SENTEI-KHNTEN-GEN   =
                               (WRK-SENTEI-KHNTEN-MOTO  * 0.95)
                       COMPUTE  WRK-SENTEI-ZAITEN-MOTO  =
                                WRK-SENTEI-KHNTEN-MOTO  +
                                WRK-KSNTEN
                       COMPUTE  WRK-SENTEI-ZAITEN-GEN   =
                                WRK-SENTEI-KHNTEN-GEN   +
                                WRK-KSNTEN
                       IF     WRK-HYOKETU-TEN    NOT =   ZERO
      *                  標欠：％減算
                         COMPUTE    WRK-SENTEI-ZAITEN-MOTO  =
                                  ( WRK-SENTEI-ZAITEN-MOTO  -
                                   (WRK-SENTEI-ZAITEN-MOTO  *
                                    (WRK-HYOKETU-TEN   /  100))) + 0.5
                         COMPUTE    WRK-KEISAN2             =
                                  ( WRK-SENTEI-ZAITEN-GEN   -
                                   (WRK-SENTEI-ZAITEN-GEN   *
                                    (WRK-HYOKETU-TEN   /  100))) + 0.5
                         MOVE   WRK-KEISAN2   TO   WRK-SENTEI-ZAITEN-GEN
                       END-IF
                       MOVE  SENCHG-SENTEISRYCD  TO   WRK-SENTEI-SRYCD2
                       MOVE  ZERO                TO   WRK-SENTEI-SRYCD3
                    END-IF  
                  END-IF
                 END-IF
      *
                 MOVE    "tbl_senteicdchg"       TO      MCP-TABLE
                 MOVE    "key2"                  TO      MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
      *
               END-IF
      *
           END-IF
      *
           MOVE    "tbl_nyuinact"      TO      MCP-TABLE
           MOVE    "key9"              TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210201-NYUINKHN-GET-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊時の入院基本料取得
      **************************************************************
       2102011-GAIHAKU-NYUINKHN-SEC           SECTION.
      *
           EVALUATE  TNS-SRYCD
               WHEN  "190078210"
                     MOVE  "190077410"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078310"
                     MOVE  "190077510"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078410"
                     MOVE  "190077610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078510"
                     MOVE  "190077710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078610"
                     MOVE  "190077810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078710"
                     MOVE  "190077910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078810"
                     MOVE  "190078010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190078910"
                     MOVE  "190078110"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190082410"
                     MOVE  "190081710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082510"
                     MOVE  "190081810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082610"
                     MOVE  "190081910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082710"
                     MOVE  "190082010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082810"
                     MOVE  "190082110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190082910"
                     MOVE  "190082210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190083010"
                     MOVE  "190082310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190084310"
                     MOVE  "190083610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084410"
                     MOVE  "190083710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084510"
                     MOVE  "190083810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084610"
                     MOVE  "190083910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084710"
                     MOVE  "190084010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084810"
                     MOVE  "190084110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190084910"
                     MOVE  "190084210"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190087410"
                     MOVE  "190085910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087510"
                     MOVE  "190086010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087610"
                     MOVE  "190086110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087710"
                     MOVE  "190086210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087810"
                     MOVE  "190086310"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190087910"
                     MOVE  "190086410"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088010"
                     MOVE  "190086510"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088110"
                     MOVE  "190086610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088210"
                     MOVE  "190086710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088310"
                     MOVE  "190086810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088410"
                     MOVE  "190086910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088510"
                     MOVE  "190087010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088610"
                     MOVE  "190087110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088710"
                     MOVE  "190087210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190088810"
                     MOVE  "190087310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190094710"
                     MOVE  "190093710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190094810"
                     MOVE  "190093810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190094910"
                     MOVE  "190093910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190095010"
                     MOVE  "190094010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190095110"
                     MOVE  "190094110"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190797410"
                     MOVE  "190796610"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797510"
                     MOVE  "190796710"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797610"
                     MOVE  "190796810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797710"
                     MOVE  "190796910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797810"
                     MOVE  "190797010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190797910"
                     MOVE  "190797110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190798010"
                     MOVE  "190797210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190798110"
                     MOVE  "190797310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190803510"
                     MOVE  "190802810"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803610"
                     MOVE  "190802910"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803710"
                     MOVE  "190803010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803810"
                     MOVE  "190803110"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190803910"
                     MOVE  "190803210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190804010"
                     MOVE  "190803310"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190804110"
                     MOVE  "190803410"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190091210"
                     MOVE  "190090210"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190091310"
                     MOVE  "190090310"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190109670"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190808870"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190117070"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190813270"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *
               WHEN  "190117670"
                     MOVE  "190097010"      TO   WRK-GAIHAKU-SRYCD
               WHEN  "190813870"
                     MOVE  "190805710"      TO   WRK-GAIHAKU-SRYCD
      *        診療所老人医療管理料
               WHEN  "190774210"
                     MOVE  "190774110"      TO   WRK-GAIHAKU-SRYCD
      *        老人性認知症疾患治療病棟入院料１
               WHEN  "190740010"
                     MOVE  "190739910"      TO   WRK-GAIHAKU-SRYCD
      *        老人性認知症疾患治療病棟入院料２
               WHEN  "190813510"
                     MOVE  "190813410"      TO   WRK-GAIHAKU-SRYCD
           END-EVALUATE
      *
           IF   (RECE62-SRYYM      >= "200604"   )
           AND  (WRK-GAIHAKU-SRYCD  = "190774110" OR
                                      "190739910" OR
                                      "190813410")
               MOVE    SPACE    TO    WRK-GAIHAKU-SRYCD
           END-IF
      *
           IF    WRK-GAIHAKU-SRYCD    NOT =   SPACE
               MOVE    WRK-GAIHAKU-SRYCD   TO  WRK-SRYCD
               MOVE    NACCT-SRYYM         TO  WK-TAIHI-SRYYM
               MOVE    1                   TO  WK-TAIHI-SRYD
               PERFORM    900-TENSU-TBL-SEC
               IF   FLG-TENSU      =    ZERO
                     MOVE     TNS-TEN      TO  WRK-GAIHAKU-KHNTEN
               END-IF                  
           END-IF
      *
           .
       2102011-GAIHAKU-NYUINKHN-EXT.
           EXIT.
      *
      **************************************************************
      *    選定外泊時の係数取得
      **************************************************************
       210202-SENTEI-KEISU-GET-SEC           SECTION.
      *
           MOVE      ZERO           TO     WRK-SENTEI-KEISU
      *
           IF   RECE62-SRYYM    <=    "200303"
               MOVE   0.1           TO     WRK-SENTEI-KEISU
           END-IF
      *
           IF ( RECE62-SRYYM    >=    "200304" )   AND
              ( RECE62-SRYYM    <=    "200403" )
               MOVE   0.05           TO    WRK-SENTEI-KEISU
           END-IF
      *
           IF   RECE62-SRYYM    >=    "200404"
               MOVE   ZERO          TO     WRK-SENTEI-KEISU
           END-IF
      *
           .
      *
       210202-SENTEI-KEISU-GET-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料計算
      **************************************************************
       210203-NYUINACCT-GET-SEC           SECTION.
      *
      *    入院料と外泊を比較して点数算定
      *
           EVALUATE   WRK-DAY22-NYUTENTTLKBN(IDY)
               WHEN   903
                  IF    WRK-DAY1-SENTEI(IDY)   NOT  =  ZERO
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    1     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   3
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    3     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                       IF   RECE62-SRYYM    >=    "201004"
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.6 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.3 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    5     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       ELSE
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
      ****                       (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    5     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   5
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.9 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    12    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   6
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.8 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.45)
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    17    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   7
                       IF    RECE62-SRYYM    >=    "201604"
                         CONTINUE
                       ELSE
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    21    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   8
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    25    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   9
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    29    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
      ***            WHEN   11
      ***                COMPUTE   WRK-TENSU-KEISAN2 =
      ***                         (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
      ***                                                      * 0.7 )
      ***                PERFORM    2102032-NYUINACCT-HEN1-SEC
      ***                MOVE    37    TO    SYUKEI-IDX
      ***                PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   13
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
                                                               * 0.9 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
                                                               * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    45    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   14
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    49    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   15
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.65)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    53    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   16
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    57    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   17
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
                                                               * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    61    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  ELSE
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                                        +  0.5
                         MOVE    1     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   2
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.3)
                                                        +  0.5
                         MOVE    2     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.6 )
                         ELSE
                          IF   RECE62-SRYYM    >=    "200404"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.3 )
                          ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.15)
                          END-IF
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    4     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   5
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.9 )
                         ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    11    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   6
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.8 )
                         ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.45)
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    15    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   7
                       IF    RECE62-SRYYM    >=    "201604"
                         CONTINUE
                       ELSE
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    19    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   8
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    23    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   9
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    27    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
      ***            WHEN   11
      ***                COMPUTE    WRK-TENSU-KEISAN2 =
      ***                          (WRK-DAY1-KHNTEN(IDY) * 0.92
      ***                                                * 0.7 )
      ***                PERFORM    2102032-NYUINACCT-HEN1-SEC
      ***                MOVE    35    TO    SYUKEI-IDX
      ***                PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   13
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92
                                                         * 0.9 )
                         ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92
                                                         * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    43    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   14
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    47    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   15
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.65)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    51    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   16
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    55    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   17
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92
                                                         * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    59    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  END-IF
               WHEN   920
                  IF    WRK-DAY1-SENTEI(IDY)   NOT  =  ZERO
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    6     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   3
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE    8     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                       IF   RECE62-SRYYM    >=    "201004"
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.6 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.3 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   10     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       ELSE
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
      ****                       (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                 (WRK-DAY1-KHNTEN(IDY)  
                                              *  WRK-SENTEI-KEISU)
                                                        +  0.5
                         MOVE   10     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   5
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.9 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   14     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   6
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.8 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.45)
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   18     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   7
                       IF    RECE62-SRYYM    >=    "201604"
                         CONTINUE
                       ELSE
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   22     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   8
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   26     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   9
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   30     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
      ***            WHEN   11
      ***                COMPUTE   WRK-TENSU-KEISAN2 =
      ***                         (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
      ***                                                      * 0.7 )
      ***                PERFORM    2102032-NYUINACCT-HEN1-SEC
      ***                MOVE   38     TO    SYUKEI-IDX
      ***                PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   13
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
                                                               * 0.9 )
                         ELSE
                           COMPUTE WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
                                                               * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   46     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   14
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   50     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   15
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.65)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   54     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   16
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   58     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   17
                         COMPUTE   WRK-TENSU-KEISAN2 =
                                  (WRK-DAY1-SENTEI-KHNTEN(IDY) * 0.92
                                                               * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   62     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  ELSE
                    EVALUATE   WRK-DAY22(IDY)
                     WHEN   1
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.15)
                                                        +  0.5
                         MOVE    6     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   2
                         COMPUTE  WRK-DAY22-NYUKHNRYO(IDY) =
                                 (WRK-DAY1-KHNTEN(IDY)  *  0.3)
                                                        +  0.5
                         MOVE    7     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   4
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.6 )
                         ELSE
                          IF   RECE62-SRYYM    >=    "200404"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.3 )
                          ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.15)
                          END-IF
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    9     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   5
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.9 )
                         ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    13    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   6
                         IF    RECE62-SRYYM    >=    "201604"
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.8 )
                         ELSE
                            COMPUTE WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.45)
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    16    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   7
                       IF    RECE62-SRYYM    >=    "201604"
                         CONTINUE
                       ELSE
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    20    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                       END-IF
                     WHEN   8
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    24    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   9
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    28    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
      ***            WHEN   11
      ***                COMPUTE    WRK-TENSU-KEISAN2 =
      ***                          (WRK-DAY1-KHNTEN(IDY) * 0.92
      ***                                                * 0.7 )
      ***                PERFORM    2102032-NYUINACCT-HEN1-SEC
      ***                MOVE    36    TO    SYUKEI-IDX
      ***                PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   13
                         IF    RECE62-SRYYM    >=    "201604"
                           COMPUTE  WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92
                                                         * 0.9 )
                         ELSE
                           COMPUTE  WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92
                                                         * 0.7 )
                         END-IF
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE    44    TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   14
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   48     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   15
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.65)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   52     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   16
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.85)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   56     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                     WHEN   17
                         COMPUTE    WRK-TENSU-KEISAN2 =
                                   (WRK-DAY1-KHNTEN(IDY) * 0.92
                                                         * 0.95)
                         PERFORM    2102032-NYUINACCT-HEN1-SEC
                         MOVE   60     TO    SYUKEI-IDX
                         PERFORM    2102031-NYUINACCT-SYU-SEC
                    END-EVALUATE
                  END-IF
           END-EVALUATE
      *
           .
       210203-NYUINACCT-GET-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料集計
      **************************************************************
       2102031-NYUINACCT-SYU-SEC           SECTION.
      *
           IF  ( WRK-DAY22-NYUKHNRYO(IDY)  NOT =  ZERO     )
      *
           OR  ((WRK-DAY22-NYUKHNRYO(IDY)      =  ZERO    )  AND
                (SYUKEI-IDX   =   3  OR  5  OR  8  OR  10
                                     OR 12  OR 14         )  AND
                (RECE62-SRYYM    <=    "201603"           ))
           OR  ((WRK-DAY22-NYUKHNRYO(IDY)      =  ZERO    )  AND
                (SYUKEI-IDX   =   3  OR  8                )  AND
                (RECE62-SRYYM    >=    "201604"           ))
      *
             MOVE     ZERO     TO    FLG-ARI
             PERFORM  VARYING  SYUKEI-IDX2    FROM    1   BY  1
                  UNTIL  SYUKEI-IDX2           > 10
                   OR    WRK-GAI-DAY(SYUKEI-IDX SYUKEI-IDX2) = ZERO
                   OR    FLG-ARI               = 1
              IF  (WRK-GAI-ZAITEN(SYUKEI-IDX SYUKEI-IDX2)
                                        =  WRK-DAY22-NYUKHNRYO(IDY)  )
              AND (WRK-GAI-KANGOGEN-SRYCD(SYUKEI-IDX SYUKEI-IDX2)
                                        =  RECE62-KANGOGEN-SRYCD(IDY))
                 ADD   1  TO   WRK-GAI-ZAIKAISU(SYUKEI-IDX SYUKEI-IDX2)
                 MOVE  1  TO                                            
                           WRK-GAI-KAISU   (SYUKEI-IDX SYUKEI-IDX2 IDY) 
                 MOVE  1  TO   FLG-ARI
              END-IF
             END-PERFORM  
             IF  FLG-ARI  =  ZERO  
                 MOVE  IDY 
                          TO   WRK-GAI-DAY     (SYUKEI-IDX SYUKEI-IDX2)
                 MOVE  WRK-DAY22-NYUKHNRYO(IDY)
                          TO   WRK-GAI-ZAITEN  (SYUKEI-IDX SYUKEI-IDX2) 
                 MOVE  RECE62-KANGOGEN-SRYCD(IDY)
                          TO   WRK-GAI-KANGOGEN-SRYCD
                                               (SYUKEI-IDX SYUKEI-IDX2)
                 ADD   1  TO   WRK-GAI-ZAIKAISU(SYUKEI-IDX SYUKEI-IDX2)
                 MOVE  1  TO                                            
                           WRK-GAI-KAISU   (SYUKEI-IDX SYUKEI-IDX2 IDY) 
             END-IF
      *
             ADD    1     TO   CNT-DAY22
             MOVE   1     TO   FLG-DAY22
      *
           END-IF
      *
           .
      *
       2102031-NYUINACCT-SYU-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料編集１
      **************************************************************
       2102032-NYUINACCT-HEN1-SEC           SECTION.
      *
           COMPUTE   WRK-TENSU-KEISAN2           =
                     WRK-TENSU-KEISAN2           +
                     WRK-DAY1-KSNTEN(IDY)
           IF  WRK-DAY1-HYOKETU-TEN(IDY)  NOT =  ZERO
             COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                   ( WRK-TENSU-KEISAN2           -
                    (WRK-TENSU-KEISAN2           *
                    (WRK-DAY1-HYOKETU-TEN(IDY)   / 100)))
                                                 + 0.5
           ELSE
             COMPUTE WRK-DAY22-NYUKHNRYO(IDY)    =
                     WRK-TENSU-KEISAN2           + 0.5
           END-IF
      *
           .
      *
       2102032-NYUINACCT-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院料と異なる食事算定保険組み合わせ取得
      *****************************************************************
       210225-SKJHKN-GET-SEC                SECTION.
      *
           IF   RECE62-SRYYM  >=  "201710"
             INITIALIZE                   ORCSNYUINDAY-AREA
             PERFORM    VARYING   IDX35   FROM   1   BY   1
                         UNTIL    IDX35    >    31
               MOVE  RECE62-DOUJITSU-HKNCOMBI(IDX35)
                           TO  LNK-NYUINDAY-DOUJITSU-HKNCOMBI(IDX35)
             END-PERFORM
      *
             INITIALIZE                   ORCSSKJHKN-AREA
             MOVE    RECE62-HOSPNUM   TO  LNK-SKJHKN-HOSPNUM
             MOVE    RECE62-PTID      TO  LNK-SKJHKN-PTID
             MOVE    RECE62-SRYYM     TO  LNK-SKJHKN-SANTEIYM
             CALL    "ORCSSKJHKN"     USING   ORCSSKJHKN-AREA
                                              ORCSNYUINDAY-AREA
                                              SPA-AREA
             IF      LNK-SKJHKN-RC    =   ZERO
                PERFORM    VARYING   IDY   FROM   1   BY   1
                            UNTIL    IDY    >    31
                  MOVE  LNK-SKJHKN-HKNCOMBINUM(IDY 1) TO
                                          WRK-SKJHKN-HKNCOMBI(IDY)
                  MOVE  LNK-SKJHKN-HKNCOMBINUM(IDY 2) TO
                                          WRK-SKJHKN-HKNCOMBI-DOU(IDY)
                END-PERFORM
             END-IF
           END-IF
      *
           .
       210225-SKJHKN-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事編集
      *****************************************************************
       210226-SKJ-HENSYU-SEC                SECTION.
      *
           IF  ((WRK-DAY1(IDY)         NOT =  ZERO) OR
                (RECE62-NYUINDAY-KBN(IDY)  =  "1" ))
           AND ( NACCT-ZAITEN              =  ZERO )
           AND ( NACCT-ZAISKBKBN           =  "4"  )
           AND ( NACCT-DAY(IDY)        NOT =  ZERO )
           AND ( WRK-SHOKUJIRYOYO(IDY) NOT =  ZERO )
           AND ((WRK-DAY2(IDY)             =  ZERO) OR
                (WRK-DAY2(IDY)            >=   4  ))
             IF   RECE62-SRYYM  >= "200604"
               IF  NACCT-SRYCDTOTAL = 099999918 OR 099999919
                                                OR 099999920
                 IF    WRK-SKJHKN-HKNCOMBI(IDY)  =  SPACE
                   MOVE  NACCT-DAY(IDY)  TO  WRK-DAY24(IDY)
                   PERFORM  210204-NYUINACCT-SYU2-SEC
                 ELSE
                   PERFORM  210227-SKJ-HENSYU2-SEC
                 END-IF
               END-IF
             ELSE
               IF  NACCT-SRYCDTOTAL = 099999913
                 MOVE  NACCT-DAY(IDY)  TO  WRK-DAY24(IDY)
                 PERFORM  210204-NYUINACCT-SYU2-SEC
                 ADD    1     TO   CNT-DAY24
                 MOVE   1     TO   FLG-DAY24
               END-IF
             END-IF
           END-IF
           IF  ( RECE62-SRYYM             >=  "200610"     )
           AND ((WRK-DAY1(IDY)         NOT =  ZERO        ) OR
                (RECE62-NYUINDAY-KBN(IDY)  =  "1"         ))
           AND ( NACCT-ZAITEN              =  ZERO         )
           AND ( NACCT-ZAISKBKBN           =  "4"          )
      ***  AND ( NACCT-DAY(IDY)        NOT =  ZERO         )
           AND ( WRK-SHOKUJIRYOYO(IDY) NOT =  ZERO         )
           AND ( NACCT-SRYCDTOTAL = 099999918 OR 099999919
                                              OR 099999920 )
           AND ((WRK-DAY2(IDY)             =  ZERO        ) OR
                (WRK-DAY2(IDY)            >=   4          ))
               PERFORM  210218-NYUINACCT-SYU2-KAN-SEC
           END-IF
      *
           .
       210226-SKJ-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事編集
      *****************************************************************
       210227-SKJ-HENSYU2-SEC                SECTION.
      *
           IF  ( RECE62-SRYYM             >=  "200604"     )
           AND ( NACCT-ZAITEN              =  ZERO         )
           AND ( NACCT-ZAISKBKBN           =  "4"          )
           AND ( NACCT-DAY(IDY)        NOT =  ZERO         )
           AND ( WRK-SHOKUJIRYOYO(IDY) NOT =  ZERO         )
           AND ((WRK-DAY2(IDY)             =  ZERO        ) OR
                (WRK-DAY2(IDY)            >=   4          ))
           AND ((WRK-DAY1(IDY)         NOT =  ZERO        ) OR
                (RECE62-NYUINDAY-KBN(IDY)  =  "1"         ))
           AND ( NACCT-SRYCDTOTAL = 099999918 OR 099999919
                                              OR 099999920 )
      *
             IF  ( WRK-SKJHKN-HKNCOMBI(IDY)      = SPACE )
             OR  ((WRK-SKJHKN-HKNCOMBI(IDY)  NOT = SPACE) AND
                  (RECE62-HKNCOMBI(IDX1)     NOT =
                                WRK-SKJHKN-HKNCOMBI(IDY)))
               IF ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                   (RECE62-HKNCOMBI(IDX1)        =
                                     RECE62-DOUJITSU-HKNCOMBI(IDY)) AND
                   (WRK-SKJHKN-HKNCOMBI-DOU(IDY)       = SPACE    ))
               OR ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                   (WRK-SKJHKN-HKNCOMBI-DOU(IDY)   NOT = SPACE    ) AND
                   (RECE62-HKNCOMBI(IDX1)        =
                                     WRK-SKJHKN-HKNCOMBI-DOU(IDY) ))
                 MOVE    1    TO  FLG-DOJITU
                 MOVE    1    TO  WRK-SKJ-DOJITU-KBN (IDX1 IDY)
                 EVALUATE   NACCT-SRYCDTOTAL
                   WHEN  099999918
                     MOVE  NACCT-DAY(IDY)
                              TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                   WHEN  099999919
                     MOVE  NACCT-DAY(IDY)
                              TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                   WHEN  099999920
                     MOVE  NACCT-DAY(IDY)
                              TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                 END-EVALUATE
                 MOVE  RECE62-HKNCOMBI(IDX1)
                              TO  WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
               END-IF
             END-IF
      *
             IF   (WRK-SKJHKN-HKNCOMBI(IDY)  NOT = SPACE)
             AND  (RECE62-HKNCOMBI(IDX1)         =
                                WRK-SKJHKN-HKNCOMBI(IDY))
               IF ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                   (RECE62-HKNCOMBI(IDX1)        =
                                     RECE62-DOUJITSU-HKNCOMBI(IDY)) AND
                   (WRK-SKJHKN-HKNCOMBI-DOU(IDY)       = SPACE    ))
               OR ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                   (WRK-SKJHKN-HKNCOMBI-DOU(IDY)   NOT = SPACE    ) AND
                   (RECE62-HKNCOMBI(IDX1)        =
                                     WRK-SKJHKN-HKNCOMBI-DOU(IDY) ))
               OR ( RECE62-DOUJITSU-HKNCOMBI(IDY)      = ZERO      )
                 MOVE  NACCT-DAY(IDY)  TO  WRK-DAY24(IDY)
                 PERFORM  210204-NYUINACCT-SYU2-SEC
               END-IF
      *
               IF ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                   (RECE62-HKNCOMBI(IDX1)    NOT =
                                     RECE62-DOUJITSU-HKNCOMBI(IDY)) AND
                   (WRK-SKJHKN-HKNCOMBI-DOU(IDY)       = SPACE    ))
               OR ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                   (WRK-SKJHKN-HKNCOMBI-DOU(IDY)   NOT = SPACE    ) AND
                   (RECE62-HKNCOMBI(IDX1)    NOT =
                                     WRK-SKJHKN-HKNCOMBI-DOU(IDY) ))
                 MOVE    1    TO  FLG-DOJITU
                 MOVE    2    TO  WRK-SKJ-DOJITU-KBN (IDX1 IDY)
                 EVALUATE   NACCT-SRYCDTOTAL
                   WHEN  099999918
                     MOVE  NACCT-DAY(IDY)
                              TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                   WHEN  099999919
                     MOVE  NACCT-DAY(IDY)
                              TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                   WHEN  099999920
                     MOVE  NACCT-DAY(IDY)
                              TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                 END-EVALUATE
                 MOVE  RECE62-HKNCOMBI(IDX1)
                              TO  WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
               END-IF
             END-IF
      *
           END-IF
      *
           .
       210227-SKJ-HENSYU2-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の集計
      **************************************************************
       210204-NYUINACCT-SYU2-SEC           SECTION.
      *
           IF   RECE62-SRYYM  >= "200604"
            IF  ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                 (RECE62-HKNCOMBI(IDX1)   NOT =
                                   RECE62-DOUJITSU-HKNCOMBI(IDY)) AND
                 (WRK-SKJHKN-HKNCOMBI-DOU(IDY)       = SPACE    ))
            OR  ((RECE62-DOUJITSU-HKNCOMBI(IDY)  NOT = ZERO     ) AND
                 (WRK-SKJHKN-HKNCOMBI-DOU(IDY)   NOT = SPACE    ) AND
                 (RECE62-HKNCOMBI(IDX1)   NOT =
                                   WRK-SKJHKN-HKNCOMBI-DOU(IDY) ))
             MOVE    1    TO  FLG-DOJITU
             MOVE    2    TO  WRK-SKJ-DOJITU-KBN (IDX1 IDY)
             EVALUATE   NACCT-SRYCDTOTAL
               WHEN  099999918
                 MOVE  NACCT-DAY(IDY) TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
               WHEN  099999919
                 MOVE  NACCT-DAY(IDY) TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
               WHEN  099999920
                 MOVE  NACCT-DAY(IDY) TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
             END-EVALUATE
             MOVE  RECE62-HKNCOMBI(IDX1)
                                  TO  WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
            ELSE
             EVALUATE   WRK-SHOKUJIRYOYO(IDY)
              WHEN  1
                 EVALUATE   WRK-DAY24(IDY)
                   WHEN  1
                     MOVE    RECE62-HKNCOMBI(IDX1)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE  ZERO    TO  WRK-DAY4(IDY)
                     END-IF
                   WHEN  2
                     MOVE    RECE62-HKNCOMBI(IDX1)  TO
                                         WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE  ZERO    TO  WRK-DAY4(IDY)
                     END-IF
                   WHEN  3
                     MOVE    RECE62-HKNCOMBI(IDX1)  TO
                                         WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE  ZERO    TO  WRK-DAY4(IDY)
                     END-IF
                 END-EVALUATE
              WHEN  2
                 EVALUATE   WRK-DAY24(IDY)
                   WHEN  1
                   WHEN  2
                     MOVE    RECE62-HKNCOMBI(IDX1)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   WHEN  3
                     MOVE    RECE62-HKNCOMBI(IDX1)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                 END-EVALUATE
             END-EVALUATE
            END-IF
           ELSE
             EVALUATE   WRK-DAY24(IDY)
              WHEN  1
                EVALUATE   WRK-SHOKUJIRYOYO(IDY)
                  WHEN  1
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                               (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *
                  WHEN  2
      *              入院時食事療養（２）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000710"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000710"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
                END-EVALUATE
              WHEN  2
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              特別食加算
                     MOVE  "197000470"    TO   WRK-SKJ-SRYCD-OCC(IDY 3)
                     MOVE  "197000470"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
              WHEN  3
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                                 (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                 (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              複数献立加算
                     MOVE  "197000670"    TO   WRK-SKJ-SRYCD-OCC(IDY 5)
                     MOVE  "197000670"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
              WHEN  4
      *              入院時食事療養（１）
                     ADD    1             TO   WRK-SKJ-ZAIKAISU(IDY)
                     MOVE  "197000110"    TO   WRK-SKJ-SRYCD-OCC(IDY 1)
                     MOVE  "197000110"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              特別管理加算
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE  "197000270"    TO   WRK-SKJ-SRYCD-OCC
                                                                (IDY 2)
                        MOVE  "197000270"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              特別食加算
                     MOVE  "197000470"    TO   WRK-SKJ-SRYCD-OCC(IDY 3)
                     MOVE  "197000470"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
      *              食堂加算
                     IF    WRK-DAY4(IDY)  NOT =  ZERO
                        MOVE  "197000570"    TO   WRK-SKJ-SRYCD-OCC
                                                                 (IDY 4)
                        MOVE  "197000570"    TO   WRK-SRYCD-X
                        MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                        MOVE   1             TO   WK-TAIHI-SRYD
                        PERFORM    900-TENSU-TBL-SEC
                        IF       FLG-TENSU      =    ZERO
                           ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                        END-IF
                     END-IF
      *              複数献立加算
                     MOVE  "197000670"    TO   WRK-SKJ-SRYCD-OCC(IDY 5)
                     MOVE  "197000670"    TO   WRK-SRYCD-X
                     MOVE   RECE62-SRYYM  TO   WK-TAIHI-SRYYM
                     MOVE   1             TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        ADD     TNS-TEN   TO   WRK-SKJ-ZAITEN(IDY)
                     END-IF
             END-EVALUATE
           END-IF
      *
           .
       210204-NYUINACCT-SYU2-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の集計（同日再入院分）
      **************************************************************
       210223-NYUINACCT-SYU2-DOU-SEC           SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             EVALUATE  WRK-SKJ-DOJITU-KBN(IDX1 IDY)
               WHEN         1
                 MOVE  WRK-DAY4X(IDY)
                                   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                 EVALUATE  RECE62-DOUJITSU-SKJKBN(IDY)
                   WHEN     "0"
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                   WHEN     "1"
                     CONTINUE
                   WHEN     "2"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY)  NOT = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                   WHEN     "3"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY)  NOT = ZERO
                     OR   WRK-SKJ-DOJITU-HIRU(IDX1 IDY)  NOT = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                 END-EVALUATE
               WHEN         2
                 MOVE  WRK-DAY4X(IDY)
                                   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                 EVALUATE  RECE62-DOUJITSU-SKJKBN(IDY)
                   WHEN     "0"
                     CONTINUE
                   WHEN     "1"
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-ASA (IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                   WHEN     "2"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-HIRU(IDX1 IDY)
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                   WHEN     "3"
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) = ZERO
                     AND  WRK-SKJ-DOJITU-HIRU(IDX1 IDY) = ZERO
                       MOVE ZERO   TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                     MOVE   ZERO   TO  WRK-SKJ-DOJITU-YORU(IDX1 IDY)
                 END-EVALUATE
             END-EVALUATE
           END-PERFORM
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             IF   WRK-SKJ-DOJITU-KBN(IDX1 IDY)  NOT = ZERO
               EVALUATE   WRK-SHOKUJIRYOYO(IDY)
                 WHEN  1
                   IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  2
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     END-IF
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  3
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  2
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     END-IF
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  3
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                     IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  2
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 2)
                     END-IF
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                   IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  3
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                     IF   WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)  NOT =  ZERO
                       ADD   1       TO  WRK-SKJ200604-DAY(IDX1 IDY 3)
                       MOVE ZERO  TO  WRK-SKJ-DOJITU-SHOKUDO(IDX1 IDY)
                     END-IF
                   END-IF
                 WHEN  2
                   IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   END-IF
                   IF   WRK-SKJ-DOJITU-ASA (IDX1 IDY) =  3
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                   END-IF
                   IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   END-IF
                   IF   WRK-SKJ-DOJITU-HIRU(IDX1 IDY) =  3
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                   END-IF
                   IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  1 OR 2
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 1)
                   END-IF
                   IF   WRK-SKJ-DOJITU-YORU(IDX1 IDY) =  3
                     MOVE WRK-SKJ-DOJITU-HKNCOMBI(IDX1 IDY)
                                     TO  WRK-SKJ200604-HKNCOMBI(IDX1)
                     MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
                     ADD     1       TO  WRK-SKJ200604-DAY(IDX1 IDY 4)
                   END-IF
               END-EVALUATE
             END-IF
           END-PERFORM
      *
           .
       210223-NYUINACCT-SYU2-DOU-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の集計（環境）
      **************************************************************
       210218-NYUINACCT-SYU2-KAN-SEC           SECTION.
      *
           EVALUATE   WRK-SHOKUJIRYOYO(IDY)
             WHEN  1
               MOVE    RECE62-HKNCOMBI(IDX1)
                               TO  WRK-SKJ200604-HKNCOMBI(IDX1)
               MOVE    1       TO  WRK-SKJ200604-KBN(IDX1 IDY)
               MOVE    1       TO  WRK-SKJ200604-DAY-KAN(IDX1 IDY)
             WHEN  2
               MOVE    RECE62-HKNCOMBI(IDX1)
                               TO  WRK-SKJ200604-HKNCOMBI(IDX1)
               MOVE    2       TO  WRK-SKJ200604-KBN(IDX1 IDY)
               MOVE    1       TO  WRK-SKJ200604-DAY-KAN(IDX1 IDY)
           END-EVALUATE
      *
           .
       210218-NYUINACCT-SYU2-KAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210205-RECE64-TENSOU2-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE64-KOHBUNRI
           MOVE    NACCT-SRYKBN         TO   RECE64-SRYKBN
           IF      NACCT-ZAISKBKBN  =  "1"
             IF  (NACCT-SRYCDTOTAL =   190799410)
             OR  (NACCT-SRYCDTOTAL =   190799510)
                MOVE    "90"            TO   RECE64-SRYKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN  =  "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO   RECE64-SRYKBN
               WHEN      920
                MOVE    "92"            TO   RECE64-SRYKBN
             END-EVALUATE
           END-IF
           MOVE    NACCT-ZAISKBKBN      TO   RECE64-ZAISKBKBN
           IF      NACCT-ZAISKBKBN  =  "7"
                MOVE     "80"           TO   RECE64-SRYKBN
                MOVE    SPACE           TO   RECE64-ZAISKBKBN
           END-IF
      *
           EVALUATE  FLG-HENSYU
             WHEN      1
             WHEN      2
               MOVE    ZERO               TO   WRK-ZAINUM-CNT
               MOVE    ZERO               TO   WRK-ZAINUM-CNT3
               EVALUATE  NACCT-ZAISKBKBN
                 WHEN    "1"
                   PERFORM  VARYING  IDX2  FROM  1  BY  1
                             UNTIL   IDX2   >   31
                              OR     WRK-ZAINUM-CNT  NOT =  ZERO
                     IF  WRK-DAY21(IDX2)  NOT =  ZERO
                         MOVE    IDX2     TO   WRK-ZAINUM-CNT
                     END-IF
                   END-PERFORM
                   COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
                   MOVE    WRK-ZAINUM     TO   RECE64-ZAINUM
                WHEN     "6"
                   COMPUTE WRK-ZAINUM  = 99993000  +  WRK-ZAINUM-CNT2
                   MOVE    WRK-ZAINUM     TO   RECE64-ZAINUM
                WHEN     "7"
                   PERFORM  VARYING  IDX2  FROM  1  BY  1
                             UNTIL   IDX2   >   31
                              OR     WRK-ZAINUM-CNT3 NOT =  ZERO
                     IF  WRK-DAY21(IDX2)  NOT =  ZERO
                         MOVE    IDX2     TO   WRK-ZAINUM-CNT3
                     END-IF
                   END-PERFORM
                   COMPUTE WRK-ZAINUM  = 99993900  +  WRK-ZAINUM-CNT3
                   MOVE    WRK-ZAINUM     TO   RECE64-ZAINUM
                WHEN     OTHER
                   MOVE    NACCT-ZAINUM   TO   RECE64-ZAINUM
               END-EVALUATE
             WHEN      3
               MOVE    ZERO               TO   WRK-ZAINUM-CNT
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL   IDX2   >   31
                          OR     WRK-ZAINUM-CNT  NOT =  ZERO
                 IF  WRK-DAY21-X(IDX2)  NOT =  ZERO
                     MOVE    IDX2         TO   WRK-ZAINUM-CNT
                 END-IF
               END-PERFORM
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM         TO   RECE64-ZAINUM
             WHEN      4
               MOVE    ZERO               TO   WRK-ZAINUM-CNT
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL   IDX2   >   31
                          OR     WRK-ZAINUM-CNT  NOT =  ZERO
                 IF  WRK-DAY21-Y(IDX2)  NOT =  ZERO
                     MOVE    IDX2         TO   WRK-ZAINUM-CNT
                 END-IF
               END-PERFORM
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM         TO   RECE64-ZAINUM
           END-EVALUATE
      *
           MOVE    CNT-ZAIREN           TO   RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO   RECE64-PTNUM
           MOVE    NACCT-SRYKA          TO   RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO   RECE64-HKNCOMBI
           MOVE    SPACE                TO   RECE64-JIHOKBN
      *
           EVALUATE  FLG-HENSYU
             WHEN      1
               MOVE  NACCT-ZAITEN       TO   RECE64-ZAITEN
               MOVE  NACCT-MEISAISU     TO   RECE64-MEISAISU
               MOVE  CNT-DAY21          TO   RECE64-ZAIKAISU
      *********MOVE  NACCT-SYUTEN1      TO   RECE64-SYUTEN1
               MOVE  NACCT-ZAITEN       TO   RECE64-SYUTEN1
               MOVE  NACCT-SRYCDTOTAL   TO   RECE64-SRYCDTOTAL
               IF    NACCT-ZAISKBKBN  =  "7"
                   MOVE   199000510     TO   RECE64-SRYCDTOTAL
               END-IF
             WHEN      2
               MOVE  WRK-ZAITEN-W       TO   RECE64-ZAITEN
               COMPUTE  RECE64-MEISAISU    =  NACCT-MEISAISU  +  1
               MOVE  CNT-DAY21          TO   RECE64-ZAIKAISU
               MOVE  WRK-ZAITEN-W       TO   RECE64-SYUTEN1
               COMPUTE  RECE64-SRYCDTOTAL  =  NACCT-SRYCDTOTAL
                                           +  WRK-KANGOGEN-SRYCD-W
             WHEN      3
               MOVE  NACCT-ZAITEN       TO   RECE64-ZAITEN
               MOVE  NACCT-MEISAISU     TO   RECE64-MEISAISU
               MOVE  CNT-DAY21-X        TO   RECE64-ZAIKAISU
      *********MOVE  NACCT-SYUTEN1      TO   RECE64-SYUTEN1
               MOVE  NACCT-ZAITEN       TO   RECE64-SYUTEN1
               MOVE  NACCT-SRYCDTOTAL   TO   RECE64-SRYCDTOTAL
             WHEN      4
               MOVE  WRK-ZAITEN-W       TO   RECE64-ZAITEN
               COMPUTE  RECE64-MEISAISU    =  NACCT-MEISAISU  +  1
               MOVE  CNT-DAY21-Y        TO   RECE64-ZAIKAISU
               MOVE  WRK-ZAITEN-W       TO   RECE64-SYUTEN1
               COMPUTE  RECE64-SRYCDTOTAL  =  NACCT-SRYCDTOTAL
                                           +  WRK-KANGOGEN-SRYCD-W
           END-EVALUATE
      *
      *****MOVE    NACCT-SURYOUTOTAL    TO   RECE64-SURYOUTOTAL
           MOVE    RECE64-MEISAISU      TO   RECE64-SURYOUTOTAL
           MOVE    NACCT-SYUTEN2        TO   RECE64-SYUTEN2
           MOVE    NACCT-YKZTEN         TO   RECE64-YKZTEN
           MOVE    NACCT-KIZAITEN       TO   RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO   RECE64-DRCD
           MOVE    SPACE                TO   RECE64-ZAIREQFLG
           MOVE    ZERO                 TO   RECE64-TEIGENRATE
      *
           MOVE    ZERO                 TO   WK-TAIHI-DAY
           MOVE    ZERO                 TO   WK-TAIHI-FLG
           PERFORM  VARYING  IDX2  FROM  1  BY  1
                     UNTIL   IDX2   >   31
             EVALUATE  FLG-HENSYU
               WHEN      1
               WHEN      2
                 MOVE   WRK-DAY21(IDX2) TO   RECE64-KAISU (1 IDX2)
               WHEN      3
                 MOVE   WRK-DAY21-X(IDX2)
                                        TO   RECE64-KAISU (1 IDX2)
               WHEN      4
                 MOVE   WRK-DAY21-Y(IDX2)
                                        TO   RECE64-KAISU (1 IDX2)
             END-EVALUATE
             IF    (WK-TAIHI-FLG               =  ZERO)
             AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                 MOVE   IDX2            TO   WK-TAIHI-DAY
                 MOVE   1               TO   WK-TAIHI-FLG
             END-IF
             IF     RECE64-KAISU(1 IDX2)   NOT =  ZERO
               MOVE     RECE64-HKNCOMBI
                                        TO   RECE64-HKNCOMBI-DAY(IDX2)
             END-IF
           END-PERFORM
      *
           .
       210205-RECE64-TENSOU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210206-RECE65-HENSYU2-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
      *
               MOVE    "tbl_nyuinact"   TO   MCP-TABLE
               MOVE    "key9"           TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACT  =  1)
                   PERFORM   2102061-RECE65-TENSOU2-SEC
                   IF      NACCT-ZAISKBKBN      =       "7"
                      PERFORM   2102062-RECE62-HENSYU2-SEC
                   END-IF
                   PERFORM   RECE65-WRITE-SEC
                   MOVE    "tbl_nyuinact"     TO   MCP-TABLE
                   MOVE    "key9"             TO   MCP-PATHNAME
                   PERFORM        900-NYUINACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210206-RECE65-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102061-RECE65-TENSOU2-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
      *
           EVALUATE  FLG-HENSYU
             WHEN      1
             WHEN      2
               EVALUATE  NACCT-ZAISKBKBN
                 WHEN    "1"
                   COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
                   MOVE    WRK-ZAINUM   TO      RECE65-ZAINUM
                WHEN     "6"
                   COMPUTE WRK-ZAINUM  = 99993000  +  WRK-ZAINUM-CNT2
                   MOVE    WRK-ZAINUM   TO      RECE65-ZAINUM
                WHEN     "7"
                   COMPUTE WRK-ZAINUM  = 99993900  +  WRK-ZAINUM-CNT3
                   MOVE    WRK-ZAINUM   TO      RECE65-ZAINUM
                WHEN     OTHER
                   MOVE    NSRY-ZAINUM  TO      RECE65-ZAINUM
               END-EVALUATE
             WHEN      3
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM       TO      RECE65-ZAINUM
             WHEN      4
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM       TO      RECE65-ZAINUM
           END-EVALUATE
      *
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           MOVE    NSRY-SRYKBN          TO      RECE65-SRYKBN
           MOVE    NSRY-SRYSYUKBN       TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           IF      NACCT-ZAISKBKBN  =  "1"
             IF  (NACCT-SRYCDTOTAL =   190799410)
             OR  (NACCT-SRYCDTOTAL =   190799510)
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN  =  "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
               WHEN      920
                MOVE    "92"            TO      RECE65-SRYKBN
                MOVE    "920"           TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
             END-EVALUATE
           END-IF
           IF      NACCT-ZAISKBKBN  =  "7"
                MOVE     "80"           TO      RECE65-SRYKBN
                MOVE     "800"          TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           END-IF
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (NSRY-SRYCD(IDX2)  =   SPACE)
             IF    NSRY-SRYCD(IDX2)(1:1)  =  "0" OR "1" OR "8"
               ADD     1                   TO  IDX4
               MOVE    NSRY-SRYCD(IDX2)    TO  RECE65-SRYCD(IDX4)
               IF      NACCT-ZAISKBKBN  =  "7"
                  MOVE     "199000510"     TO  RECE65-SRYCD(IDX4)
               END-IF
               MOVE    NSRY-SRYSURYO(IDX2) TO  RECE65-SRYSURYO(IDX4)
               MOVE    NSRY-SRYKAISU(IDX2) TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE               TO  RECE65-MEISKYFLG(IDX4)
               MOVE    NSRY-AUTOKBN(IDX2)  TO  RECE65-AUTOKBN(IDX4)
               MOVE    NSRY-INPUTNUM(IDX2) TO  RECE65-INPUTNUM(IDX4)
               MOVE    NSRY-SRYCD(IDX2)    TO  WRK-SRYCD
               IF      NACCT-ZAISKBKBN  =  "7"
                  MOVE     199000510       TO  WRK-SRYCD
               END-IF
               MOVE    RECE65-SRYYM        TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               PERFORM 21020611-RECE65-TENSOU2X-SEC
               IF    ((NSRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (NSRY-SRYCD    (IDX2)(1:3)     =   "008"))
               AND   ( NSRY-INPUTNUM (IDX2)      NOT =   ZERO  )
                   MOVE    NSRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    NSRY-PTID             TO  PTCOM-PTID
                   MOVE    NSRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    NSRY-SRYCD (IDX2)     TO  PTCOM-SRYCD
                   MOVE    NSRY-INPUTNUM(IDX2)   TO  PTCOM-RENNUM
                   MOVE    NSRY-SRYKBN           TO  WRK-TH-SRYKBN
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT     TO  RECE65-NAME(IDX4)
               ELSE
                   IF   RECE62-SRYYM  >= "200604"
                     CONTINUE
                   ELSE
                     IF   RECE64-ZAISKBKBN = "1"
                     AND  RECE64-SRYKBN    = "90"
                     AND  TNS-DATAKBN      =  1
                     AND  TNS-ROUTEKKBN    =  2
                       IF   RECE65-NAME(IDX4)(1:4) = "老人"
                         CONTINUE
                       ELSE
                         MOVE  "老人"    TO   RECE65-NAME(IDX4)(1:4)
                         MOVE  TNS-NAME  TO   RECE65-NAME(IDX4)(5:) 
                         COMPUTE  RECE65-YUKOKETA(IDX4) =
                                  RECE65-YUKOKETA(IDX4) + 2
                       END-IF
                     END-IF
                   END-IF
               END-IF
      *
               IF    NACCT-ZAISKBKBN    NOT =    "1"
                 MOVE    NSRY-SRYCD(IDX2)  TO  WRK-SRYCD
                 IF      NACCT-ZAISKBKBN  =  "7"
                    MOVE     199000510     TO  WRK-SRYCD
                 END-IF
                 MOVE    ZERO              TO  WRK-FUKA-KINGAKU
                 PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                           UNTIL   FUKA-IDX   >    9
                   MOVE   WRK-SRYCD(FUKA-IDX:1)
                                           TO  WRK-FUKA-VALUE
                   IF  WRK-FUKA-VALUE  =  ZERO
                     CONTINUE
                   ELSE
                     COMPUTE  RECE64-RUIKEITOTAL  =
                              RECE64-RUIKEITOTAL  +
                            ( WRK-FUKA-VALUE    * WRK-SRYCD)
                     COMPUTE  WRK-FUKA-KINGAKU    =
                              WRK-FUKA-KINGAKU    +
                            ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                * NSRY-SRYSURYO(IDX2))
                   END-IF
                 END-PERFORM
                 COMPUTE  RECE64-RUIKEITOTAL  =
                          RECE64-RUIKEITOTAL  +
                          WRK-FUKA-KINGAKU
      *
                 MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                 PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                           UNTIL   FUKA-IDX   >    8
                   MOVE   NSRY-SRYSURYO(IDX2)(FUKA-IDX:1)
                                  TO    WRK-FUKA-VALUE
                   IF  WRK-FUKA-VALUE  =  ZERO
                     CONTINUE
                   ELSE
                     COMPUTE  WRK-FUKA-KINGAKU  =
                              WRK-FUKA-KINGAKU  +
                            ((WRK-FUKA-VALUE^4) * FUKA-IDX)
                   END-IF
                 END-PERFORM
                 COMPUTE  RECE64-RUIKEITOTAL  =
                          RECE64-RUIKEITOTAL  +
                          WRK-FUKA-KINGAKU
               END-IF
             END-IF
      *
             IF    (IDX2  =  1             )
             AND   (FLG-HENSYU  =  2  OR  4)
               ADD     1                     TO  IDX4
               MOVE    WRK-KANGOGEN-SRYCD-W  TO  RECE65-SRYCD(IDX4)
               MOVE    1                     TO  RECE65-SRYSURYO(IDX4)
               MOVE    ZERO                  TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE                 TO  RECE65-MEISKYFLG(IDX4)
               MOVE    SPACE                 TO  RECE65-AUTOKBN(IDX4)
               MOVE    ZERO                  TO  RECE65-INPUTNUM(IDX4)
               MOVE    WRK-KANGOGEN-SRYCD-W  TO  WRK-SRYCD
               MOVE    RECE65-SRYYM          TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY          TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               PERFORM 21020611-RECE65-TENSOU2X-SEC
             END-IF
           END-PERFORM
      *
           .
       2102061-RECE65-TENSOU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21020611-RECE65-TENSOU2X-SEC                SECTION.
      *
           MOVE  TNS-TANICD           TO  RECE65-TANICD(IDX4)
           MOVE  TNS-TANIMOJISU       TO  RECE65-TANIMOJISU(IDX4)
           MOVE  TNS-TANINAME         TO  RECE65-TANINAME(IDX4)
           MOVE  TNS-TENSIKIBETU      TO  RECE65-TENSIKIBETU(IDX4)
           MOVE  TNS-TEN              TO  RECE65-TEN(IDX4)
           MOVE  TNS-NYUTENTTLKBN     TO  RECE65-TENTTLKBN(IDX4)
           MOVE  TNS-YUKOKETA         TO  RECE65-YUKOKETA(IDX4)
           MOVE  TNS-DATAKBN          TO  RECE65-DATAKBN(IDX4)
           MOVE  TNS-HOUKNSKBN        TO  RECE65-HOUKNSKBN(IDX4)
           MOVE  TNS-KNSJISKBN        TO  RECE65-KNSJISKBN(IDX4)
           MOVE  TNS-CDKBN-KBN        TO  RECE65-CDKBN-KBN(IDX4)
           MOVE  TNS-CDKBN-SYO        TO  RECE65-CDKBN-SYO(IDX4)
           MOVE  TNS-CDKBN-BU         TO  RECE65-CDKBN-BU(IDX4)
           MOVE  TNS-CDKBN-KBNNUM     TO  RECE65-CDKBN-KBNNUM(IDX4)
           MOVE  TNS-CDKBN-KBNNUM-EDA TO  RECE65-CDKBN-KBNNUM-EDA(IDX4)
           MOVE  TNS-CDKBN-KOUBAN     TO  RECE65-CDKBN-KOUBAN(IDX4)
           MOVE  TNS-KOUHYOJYUNNUM    TO  RECE65-KOUHYOJYUNNUM(IDX4)
           MOVE  TNS-SRYSYUKBN        TO  RECE65-SRYSYUKBN-X(IDX4)
           MOVE  TNS-KOKUJISKBKBN1    TO  RECE65-KOKUJISKBKBN1(IDX4)
           MOVE  TNS-KOKUJISKBKBN2    TO  RECE65-KOKUJISKBKBN2(IDX4)
           MOVE  TNS-TUSOKUGAIKBN     TO  RECE65-TUSOKUGAIKBN (IDX4)
           MOVE  TNS-TIMEKSNKBN       TO  RECE65-TIMEKSNKBN(IDX4)
           MOVE  TNS-KZMCOMPSIKIBETU  TO  RECE65-KZMCOMPSIKIBETU(IDX4)
           MOVE  TNS-CHUKSNCD         TO  RECE65-CHUKSNCD(IDX4)
           MOVE  TNS-CHUKSNTUBAN      TO  RECE65-CHUKSNTUBAN(IDX4)
           MOVE  TNS-KENTAICOMMENT    TO  RECE65-KENTAICOMMENT(IDX4)
           MOVE  TNS-KNSJISGRPKBN     TO  RECE65-KNSJISGRPKBN(IDX4)
           MOVE  TNS-TOKUKIZAISBT1    TO  RECE65-TOKUKIZAISBT1(IDX4)
           MOVE  TNS-SANSOKBN         TO  RECE65-SANSOKBN(IDX4)
           MOVE  TNS-NAME             TO  RECE65-NAME(IDX4)
      *
           .
       21020611-RECE65-TENSOU2X-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（療養担当手当）
      *****************************************************************
       2102062-RECE62-HENSYU2-SEC                SECTION.
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
           MOVE          ZERO       TO     BUN-IDX6
      ***  IF    (RECE62-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE62-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE62-RJNHKNNUM       NOT =   SPACE)
               MOVE      1          TO     BUN-IDX
               IF   (RECE62-SEIHOFLG             =   "1"  )
               AND  (RECE62-SYUTANARIFLG         =    1   )
               AND  (RECE62-HKNNUMHC(IDX1)   NOT =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 1)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 2)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 3)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 4)     =   SPACE)
                  MOVE   6          TO     BUN-IDX6
               END-IF
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           IF  RECE62-HENTOTALTEN(2)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(2) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(2)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(1)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(1)
                               MOVE      2       TO     BUN-IDX2
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           MOVE          ZERO       TO     BUN-IDX32
           IF  RECE62-HENTOTALTEN(3)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(3) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(3)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(2)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(2)
                               MOVE      3       TO     BUN-IDX3
                               IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                               =   ZERO
                                 MOVE    3       TO     BUN-IDX32
                               END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           MOVE          ZERO       TO     BUN-IDX42
           IF  RECE62-HENTOTALTEN(4)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(4) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(4)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(3)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(3)
                               MOVE      4       TO     BUN-IDX4
                               IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                               =   ZERO
                                 MOVE    4       TO     BUN-IDX42
                               END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス５
           MOVE          ZERO       TO     BUN-IDX5
           MOVE          ZERO       TO     BUN-IDX52
           IF  RECE62-HENTOTALTEN(5)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(5) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(5)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(4)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(4)
                               MOVE      5       TO     BUN-IDX5
                               IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                               =   ZERO
                                 MOVE    5       TO     BUN-IDX52
                               END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *
      *    その他のレセ点数欄の編集
           IF    BUN-IDX        =   1
                   COMPUTE   RECE62-TENSU(21 BUN-IDX)  =
                             RECE62-TENSU(21 BUN-IDX)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
           IF    BUN-IDX2       =   2
                   COMPUTE   RECE62-TENSU(21 BUN-IDX2)  =
                             RECE62-TENSU(21 BUN-IDX2)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
           IF    BUN-IDX3       =   3
                   COMPUTE   RECE62-TENSU(21 BUN-IDX3)  =
                             RECE62-TENSU(21 BUN-IDX3)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
             IF  BUN-IDX32      =   3
                   COMPUTE   RECE62-SKYHENTEN(21 BUN-IDX3)  =
                             RECE62-SKYHENTEN(21 BUN-IDX3)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
             END-IF
           END-IF
           IF    BUN-IDX4       =   4
                   COMPUTE   RECE62-TENSU(21 BUN-IDX4)  =
                             RECE62-TENSU(21 BUN-IDX4)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
             IF  BUN-IDX42      =   4
                   COMPUTE   RECE62-SKYHENTEN(21 BUN-IDX4)  =
                             RECE62-SKYHENTEN(21 BUN-IDX4)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
             END-IF
           END-IF
           IF    BUN-IDX5       =   5
                   COMPUTE   RECE62-TENSU(21 BUN-IDX5)  =
                             RECE62-TENSU(21 BUN-IDX5)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
             IF  BUN-IDX52      =   5
                   COMPUTE   RECE62-SKYHENTEN(21 BUN-IDX5)  =
                             RECE62-SKYHENTEN(21 BUN-IDX5)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
             END-IF
           END-IF
           IF    BUN-IDX6       =   6
                   COMPUTE   RECE62-SYUTANTEN(21)  =
                             RECE62-SYUTANTEN(21)  +
                            (NACCT-ZAITEN   *   CNT-DAY21)
           END-IF
           COMPUTE           RECE62-ALLTENSU(21)   =
                             RECE62-ALLTENSU(21)   +
                            (NACCT-ZAITEN   *   CNT-DAY21)
      *
           .
       2102062-RECE62-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210207-RECE64-TENSOU2-SEN-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE64-KOHBUNRI
           MOVE    NACCT-SRYKBN         TO   RECE64-SRYKBN
           IF      NACCT-ZAISKBKBN  =  "1"
             IF  (NACCT-SRYCDTOTAL =   190799410)
             OR  (NACCT-SRYCDTOTAL =   190799510)
                MOVE    "90"            TO   RECE64-SRYKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN  =  "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO   RECE64-SRYKBN
               WHEN      920
                MOVE    "92"            TO   RECE64-SRYKBN
             END-EVALUATE
           END-IF
           MOVE    NACCT-ZAISKBKBN      TO   RECE64-ZAISKBKBN
      *
           EVALUATE  FLG-HENSYU
             WHEN      1
             WHEN      2
               MOVE    ZERO               TO   WRK-ZAINUM-CNT
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL   IDX2   >   31
                          OR     WRK-ZAINUM-CNT  NOT =  ZERO
                 IF  WRK-DAY21-SENTEI(IDX2)   NOT =   ZERO
                     MOVE    IDX2         TO   WRK-ZAINUM-CNT
                 END-IF
               END-PERFORM
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM         TO   RECE64-ZAINUM
             WHEN      3
               MOVE    ZERO               TO   WRK-ZAINUM-CNT
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL   IDX2   >   31
                          OR     WRK-ZAINUM-CNT  NOT =  ZERO
                 IF  WRK-DAY21-SENTEI-X(IDX2)  NOT =  ZERO
                     MOVE    IDX2         TO   WRK-ZAINUM-CNT
                 END-IF
               END-PERFORM
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM         TO   RECE64-ZAINUM
             WHEN      4
               MOVE    ZERO               TO   WRK-ZAINUM-CNT
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL   IDX2   >   31
                          OR     WRK-ZAINUM-CNT  NOT =  ZERO
                 IF  WRK-DAY21-SENTEI-Y(IDX2)  NOT =  ZERO
                     MOVE    IDX2         TO   WRK-ZAINUM-CNT
                 END-IF
               END-PERFORM
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM         TO   RECE64-ZAINUM
           END-EVALUATE
      *
           MOVE    CNT-ZAIREN             TO   RECE64-ZAIREN
           MOVE    RECE62-PTNUM           TO   RECE64-PTNUM
           MOVE    NACCT-SRYKA            TO   RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)  TO   RECE64-HKNCOMBI
           MOVE    SPACE                  TO   RECE64-JIHOKBN
      *
           EVALUATE  FLG-HENSYU
             WHEN      1
               MOVE  WRK-SENTEI-ZAITEN-W  TO   RECE64-ZAITEN
               MOVE  NACCT-MEISAISU       TO   RECE64-MEISAISU
               MOVE  CNT-DAY21-SENTEI     TO   RECE64-ZAIKAISU
               MOVE  WRK-SENTEI-ZAITEN-W  TO   RECE64-SYUTEN1
               COMPUTE  RECE64-SRYCDTOTAL  =   NACCT-SRYCDTOTAL
                                           -   WRK-SENTEI-SRYCD-W
                                           +   WRK-SENTEI-SRYCD2-W
                                           +   WRK-SENTEI-SRYCD3-W
             WHEN      2
               MOVE  WRK-ZAITEN-W2        TO   RECE64-ZAITEN
               COMPUTE  RECE64-MEISAISU    =   NACCT-MEISAISU  +  1
               MOVE  CNT-DAY21-SENTEI     TO   RECE64-ZAIKAISU
               MOVE  WRK-ZAITEN-W2        TO   RECE64-SYUTEN1
               COMPUTE  RECE64-SRYCDTOTAL  =   NACCT-SRYCDTOTAL
                                           -   WRK-SENTEI-SRYCD-W
                                           +   WRK-SENTEI-SRYCD2-W
                                           +   WRK-SENTEI-SRYCD3-W
                                           +   WRK-KANGOGEN-SRYCD-W2
             WHEN      3
               MOVE  WRK-SENTEI-ZAITEN-W  TO   RECE64-ZAITEN
               MOVE  NACCT-MEISAISU       TO   RECE64-MEISAISU
               MOVE  CNT-DAY21-SENTEI-X   TO   RECE64-ZAIKAISU
               MOVE  WRK-SENTEI-ZAITEN-W  TO   RECE64-SYUTEN1
               COMPUTE  RECE64-SRYCDTOTAL  =   NACCT-SRYCDTOTAL
                                           -   WRK-SENTEI-SRYCD-W
                                           +   WRK-SENTEI-SRYCD2-W
                                           +   WRK-SENTEI-SRYCD3-W
             WHEN      4
               MOVE  WRK-ZAITEN-W2        TO   RECE64-ZAITEN
               COMPUTE  RECE64-MEISAISU    =   NACCT-MEISAISU  +  1
               MOVE  CNT-DAY21-SENTEI-Y   TO   RECE64-ZAIKAISU
               MOVE  WRK-ZAITEN-W2        TO   RECE64-SYUTEN1
               COMPUTE  RECE64-SRYCDTOTAL  =   NACCT-SRYCDTOTAL
                                           -   WRK-SENTEI-SRYCD-W
                                           +   WRK-SENTEI-SRYCD2-W
                                           +   WRK-SENTEI-SRYCD3-W
                                           +   WRK-KANGOGEN-SRYCD-W2
           END-EVALUATE
           IF   WRK-SENTEI-SRYCD3-W  NOT = ZERO
               ADD   1                    TO   RECE64-MEISAISU
           END-IF
      *
      *****MOVE    NACCT-SURYOUTOTAL    TO     RECE64-SURYOUTOTAL
           MOVE    RECE64-MEISAISU      TO     RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO     RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO     RECE64-SYUTEN2
           MOVE    ZERO                 TO     RECE64-YKZTEN
           MOVE    ZERO                 TO     RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO     RECE64-DRCD
           MOVE    SPACE                TO     RECE64-ZAIREQFLG
           MOVE    ZERO                 TO     RECE64-TEIGENRATE
      *
           MOVE    ZERO                 TO     WK-TAIHI-DAY
           MOVE    ZERO                 TO     WK-TAIHI-FLG
           PERFORM  VARYING  IDX2  FROM  1  BY  1
                     UNTIL   IDX2   >   31
             EVALUATE  FLG-HENSYU
               WHEN      1
               WHEN      2
                 MOVE   WRK-DAY21-SENTEI(IDX2)
                                        TO   RECE64-KAISU (1 IDX2)
               WHEN      3
                 MOVE   WRK-DAY21-SENTEI-X(IDX2)
                                        TO   RECE64-KAISU (1 IDX2)
               WHEN      4
                 MOVE   WRK-DAY21-SENTEI-Y(IDX2)
                                        TO   RECE64-KAISU (1 IDX2)
             END-EVALUATE
             IF    (WK-TAIHI-FLG               =  ZERO)
             AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                 MOVE   IDX2            TO   WK-TAIHI-DAY
                 MOVE   1               TO   WK-TAIHI-FLG
             END-IF
             IF     RECE64-KAISU(1 IDX2)   NOT =  ZERO
               MOVE     RECE64-HKNCOMBI
                                        TO   RECE64-HKNCOMBI-DAY(IDX2)
             END-IF
           END-PERFORM
      *
           .
       210207-RECE64-TENSOU2-SEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210208-RECE65-HENSYU2-SEN-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
      *
               MOVE    "tbl_nyuinact"     TO   MCP-TABLE
               MOVE    "key9"             TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACT  =  1)
                   PERFORM   2102081-RECE65-TENSOU2-SEN-SEC
                   PERFORM   RECE65-WRITE-SEC
                   MOVE    "tbl_nyuinact"     TO   MCP-TABLE
                   MOVE    "key9"             TO   MCP-PATHNAME
                   PERFORM        900-NYUINACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210208-RECE65-HENSYU2-SEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102081-RECE65-TENSOU2-SEN-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
      *
           EVALUATE  FLG-HENSYU
             WHEN      1
             WHEN      2
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM       TO      RECE65-ZAINUM
             WHEN      3
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM       TO      RECE65-ZAINUM
             WHEN      4
               COMPUTE WRK-ZAINUM  = 99999800  +  WRK-ZAINUM-CNT
               MOVE    WRK-ZAINUM       TO      RECE65-ZAINUM
           END-EVALUATE
      *
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           MOVE    NSRY-SRYKBN          TO      RECE65-SRYKBN
           MOVE    NSRY-SRYSYUKBN       TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           IF      NACCT-ZAISKBKBN  =  "1"
             IF  (NACCT-SRYCDTOTAL =   190799410)
             OR  (NACCT-SRYCDTOTAL =   190799510)
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
             END-IF
           END-IF
           IF      NACCT-ZAISKBKBN  =  "6"
             EVALUATE  WRK-NYUTENTTLKBN
               WHEN      903
                MOVE    "90"            TO      RECE65-SRYKBN
                MOVE    "900"           TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
               WHEN      920
                MOVE    "92"            TO      RECE65-SRYKBN
                MOVE    "920"           TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
             END-EVALUATE
           END-IF
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (NSRY-SRYCD(IDX2)  =   SPACE)
             IF    NSRY-SRYCD(IDX2)(1:1)  =  "0" OR "1" OR "8"
               ADD     1                   TO  IDX4
               IF    IDX2  =  1
                 MOVE  WRK-SENTEI-SRYCD2-W TO  RECE65-SRYCD(IDX4)
               ELSE
                 MOVE  NSRY-SRYCD(IDX2)    TO  RECE65-SRYCD(IDX4)
               END-IF
               MOVE    NSRY-SRYSURYO(IDX2) TO  RECE65-SRYSURYO(IDX4)
               MOVE    NSRY-SRYKAISU(IDX2) TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE               TO  RECE65-MEISKYFLG(IDX4)
               MOVE    NSRY-AUTOKBN(IDX2)  TO  RECE65-AUTOKBN(IDX4)
               MOVE    NSRY-INPUTNUM(IDX2) TO  RECE65-INPUTNUM(IDX4)
               IF    IDX2  =  1
                 MOVE  WRK-SENTEI-SRYCD2-W TO  WRK-SRYCD
               ELSE
                 MOVE  NSRY-SRYCD(IDX2)    TO  WRK-SRYCD
               END-IF
               MOVE    RECE65-SRYYM        TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               PERFORM 21020611-RECE65-TENSOU2X-SEC
               IF    ((NSRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (NSRY-SRYCD    (IDX2)(1:3)     =   "008"))
               AND   ( NSRY-INPUTNUM (IDX2)      NOT =   ZERO  )
                   MOVE    NSRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    NSRY-PTID             TO  PTCOM-PTID
                   MOVE    NSRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    NSRY-SRYCD (IDX2)     TO  PTCOM-SRYCD
                   MOVE    NSRY-INPUTNUM(IDX2)   TO  PTCOM-RENNUM
                   MOVE    NSRY-SRYKBN           TO  WRK-TH-SRYKBN
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT     TO  RECE65-NAME(IDX4)
               ELSE
                   IF   RECE62-SRYYM  >= "200604"
                     CONTINUE
                   ELSE
                     IF   RECE64-ZAISKBKBN = "1"
                     AND  RECE64-SRYKBN    = "90"
                     AND  TNS-DATAKBN      =  1
                     AND  TNS-ROUTEKKBN    =  2
                       IF   RECE65-NAME(IDX4)(7:4) = "老人"
                         CONTINUE
                       ELSE
                         MOVE  TNS-NAME(1:6)
                                         TO   RECE65-NAME(IDX4)(1:6)
                         MOVE  "老人"    TO   RECE65-NAME(IDX4)(7:4)
                         MOVE  TNS-NAME(7:)
                                         TO   RECE65-NAME(IDX4)(11:)
                         COMPUTE  RECE65-YUKOKETA(IDX4) =
                                  RECE65-YUKOKETA(IDX4) + 2
                       END-IF
                     END-IF
                   END-IF
               END-IF
             END-IF
      *
             IF    (IDX2  =  1                     )
             AND   (WRK-SENTEI-SRYCD3-W  NOT = ZERO)
               ADD     1                     TO  IDX4
               MOVE    WRK-SENTEI-SRYCD3-W   TO  RECE65-SRYCD(IDX4)
               MOVE    1                     TO  RECE65-SRYSURYO(IDX4)
               MOVE    ZERO                  TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE                 TO  RECE65-MEISKYFLG(IDX4)
               MOVE    SPACE                 TO  RECE65-AUTOKBN(IDX4)
               MOVE    ZERO                  TO  RECE65-INPUTNUM(IDX4)
               MOVE    WRK-SENTEI-SRYCD3-W   TO  WRK-SRYCD
               MOVE    RECE65-SRYYM          TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY          TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               PERFORM 21020611-RECE65-TENSOU2X-SEC
             END-IF
      *
             IF    (IDX2  =  1             )
             AND   (FLG-HENSYU  =  2  OR  4)
               ADD     1                     TO  IDX4
               MOVE    WRK-KANGOGEN-SRYCD-W2 TO  RECE65-SRYCD(IDX4)
               MOVE    1                     TO  RECE65-SRYSURYO(IDX4)
               MOVE    ZERO                  TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE                 TO  RECE65-MEISKYFLG(IDX4)
               MOVE    SPACE                 TO  RECE65-AUTOKBN(IDX4)
               MOVE    ZERO                  TO  RECE65-INPUTNUM(IDX4)
               MOVE    WRK-KANGOGEN-SRYCD-W2 TO  WRK-SRYCD
               MOVE    RECE65-SRYYM          TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY          TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               PERFORM 21020611-RECE65-TENSOU2X-SEC
             END-IF
           END-PERFORM
      *
           .
       2102081-RECE65-TENSOU2-SEN-EXT.
           EXIT.
      *
      **************************************************************
      *    外泊の入院基本料編集
      **************************************************************
       210209-NYUINACCT-HEN-SEC           SECTION.
      *
           MOVE     ZERO     TO     SYUKEI-IDX3
      *
           PERFORM    VARYING  SYUKEI-IDX     FROM    1   BY  1
                  UNTIL  SYUKEI-IDX            > 62
      *
             PERFORM  VARYING  SYUKEI-IDX2    FROM    1   BY  1
                  UNTIL  SYUKEI-IDX2           > 10
                   OR    WRK-GAI-DAY(SYUKEI-IDX SYUKEI-IDX2) = ZERO
      *
               ADD      1      TO     SYUKEI-IDX3
      *
               MOVE   WRK-GAI-DAY(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-DAY     (SYUKEI-IDX3)
               IF     WRK-GAI-KANGOGEN-SRYCD(SYUKEI-IDX SYUKEI-IDX2)
                                                NOT = SPACE
                 MOVE   WRK-GAI-KANGOGEN-SRYCD(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-KANGOGEN-SRYCD-9
                                                          (SYUKEI-IDX3)
               ELSE
                 MOVE   ZERO        TO   WRK-GAI2-KANGOGEN-SRYCD-9
                                                          (SYUKEI-IDX3)
               END-IF
               EVALUATE  SYUKEI-IDX
                  WHEN     1
                     MOVE   "190107290" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     2
                     MOVE   "190107390" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     3
                     MOVE   "190111590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     6
                     MOVE   "190107490" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     7
                     MOVE   "190107590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     8
                     MOVE   "190111590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN     4
                  WHEN     9
                  WHEN    11
                  WHEN    13
                  WHEN    15
                  WHEN    16
                  WHEN    19
                  WHEN    20
                  WHEN    47
                  WHEN    48
                  WHEN    51
                  WHEN    52
                  WHEN    55
                  WHEN    56
                     PERFORM  2102091-NYUINACCT-HEN-TAIN-SEC
                  WHEN     5
                  WHEN    10
                  WHEN    12
                  WHEN    14
      **>         WHEN    17
      **>         WHEN    18
      **>         WHEN    21
      **>         WHEN    22
                  WHEN    49
                  WHEN    50
                  WHEN    53
                  WHEN    54
                  WHEN    57
                  WHEN    58
                     PERFORM  2102092-NYUINACCT-HEN-TAIN2-SEC
                  WHEN    23  THRU  30
      ***         WHEN    35  THRU  38
                  WHEN    43  THRU  46
                  WHEN    59  THRU  62
                     PERFORM  2102093-NYUINACCT-HEN-GEN-SEC
               END-EVALUATE
               MOVE   WRK-GAI-ZAITEN(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-ZAITEN  (SYUKEI-IDX3)
               MOVE   WRK-GAI-ZAIKAISU(SYUKEI-IDX SYUKEI-IDX2)
                                    TO   WRK-GAI2-ZAIKAISU(SYUKEI-IDX3)
               EVALUATE  SYUKEI-IDX
                  WHEN     1
                  WHEN     2
                  WHEN     3
                  WHEN     4
                  WHEN     5
                  WHEN    11
                  WHEN    12
                  WHEN    15
                  WHEN    17
                  WHEN    19
                  WHEN    21
                  WHEN    23
                  WHEN    25
                  WHEN    27
                  WHEN    29
      ***         WHEN    35
      ***         WHEN    37
                  WHEN    43
                  WHEN    45
                  WHEN    47
                  WHEN    49
                  WHEN    51
                  WHEN    53
                  WHEN    55
                  WHEN    57
                  WHEN    59
                  WHEN    61
                     MOVE    1      TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)  TO   SYUKEI-IDX4
                     IF WRK-GAI2-SRYCD2-9(SYUKEI-IDX3)       NOT = ZERO
                        MOVE    3   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                     IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
                        MOVE    3   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                     IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
                        MOVE    3   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                  WHEN     6
                  WHEN     7
                  WHEN     8
                  WHEN     9
                  WHEN    10
                  WHEN    13
                  WHEN    14
                  WHEN    16
                  WHEN    18
                  WHEN    20
                  WHEN    22
                  WHEN    24
                  WHEN    26
                  WHEN    28
                  WHEN    30
      ***         WHEN    36
      ***         WHEN    38
                  WHEN    44
                  WHEN    46
                  WHEN    48
                  WHEN    50
                  WHEN    52
                  WHEN    54
                  WHEN    56
                  WHEN    58
                  WHEN    60
                  WHEN    62
                     MOVE    2      TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)  TO   SYUKEI-IDX4
                     IF WRK-GAI2-SRYCD2-9(SYUKEI-IDX3)       NOT = ZERO
                        MOVE    4   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                     IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
                        MOVE    4   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
                     IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
                        MOVE    4   TO   WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)
                     END-IF
               END-EVALUATE
               MOVE  WRK-GAI-KAISU-T(SYUKEI-IDX SYUKEI-IDX2)            
                                    TO   WRK-GAI2-KAISU-T(SYUKEI-IDX3)  
      *
             END-PERFORM
      *
           END-PERFORM  
      *
      *    日付順に並び替え
      *
           PERFORM    VARYING   SYUKEI-IDX     FROM    1   BY  1
                  UNTIL  ( SYUKEI-IDX                   >   20  )
                    OR   ( WRK-GAI2-DAY(SYUKEI-IDX)     =  ZERO )
      *
             COMPUTE    SYUKEI-IDX2  =  SYUKEI-IDX  +  1
      *
             PERFORM  VARYING  SYUKEI-IDX3  FROM  SYUKEI-IDX2  BY  1
                        UNTIL  ( SYUKEI-IDX3                >   20  )
                          OR   ( WRK-GAI2-DAY(SYUKEI-IDX3)  =  ZERO )
      *
                IF       WRK-GAI2-DAY(SYUKEI-IDX)  >
                                           WRK-GAI2-DAY(SYUKEI-IDX3)
                   MOVE  WRK-GAI-T2(SYUKEI-IDX)  
                                           TO  WRK-GAI-DATA
                   MOVE  WRK-GAI-T2(SYUKEI-IDX3)  
                                           TO  WRK-GAI-T2(SYUKEI-IDX)
                   MOVE  WRK-GAI-DATA      TO  WRK-GAI-T2(SYUKEI-IDX3)
                END-IF
      *
             END-PERFORM
      *
           END-PERFORM
      *
           .
      *
       210209-NYUINACCT-HEN-EXT.
           EXIT.
      *
      **************************************************************
      *    他医療機関受診時の診療行為コード取得
      **************************************************************
       2102091-NYUINACCT-HEN-TAIN-SEC           SECTION.
      *
           MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)   TO   SYUKEI-IDX4
      *
           IF    RECE62-SRYYM   >=  "201804"
              EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *        特定入院料
               WHEN   200  THRU  257
               WHEN   260  THRU  263
               WHEN   902
      *          認知症治療病棟入院料、精神療養病棟入院料
      *          地域移行機能強化病棟入院料
                 IF  WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
                                         = 255 OR 254 OR 257
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                      MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                      MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    15
                    WHEN    16
                      MOVE "190182990" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    47
                    WHEN    48
                      MOVE "190214390" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    51
                    WHEN    52
                      MOVE "190213990" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    55
                    WHEN    56
                      MOVE "190214190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 ELSE
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                      MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                      MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    47
                    WHEN    48
                      MOVE "190214390" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    51
                    WHEN    52
                      MOVE "190213990" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
      *        療養病棟入院基本料
               WHEN    11  THRU   14
               WHEN    51
               WHEN   901
                 EVALUATE   SYUKEI-IDX
                  WHEN     4
                  WHEN     9
                    MOVE   "190108890" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    11
                  WHEN    13
                    MOVE   "190142190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    47
                  WHEN    48
                    MOVE   "190214290" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    51
                  WHEN    52
                    MOVE   "190213890" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        有床診療所療養病床入院基本料
               WHEN    26
               WHEN    53
               WHEN   909
                 EVALUATE   SYUKEI-IDX
                  WHEN     4
                  WHEN     9
                    MOVE   "190108890" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    11
                  WHEN    13
                    MOVE   "190142190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    15
                  WHEN    16
                    MOVE   "190109090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    47
                  WHEN    48
                    MOVE   "190214290" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    51
                  WHEN    52
                    MOVE   "190213890" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    55
                  WHEN    56
                    MOVE   "190214090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        短期滞在手術基本料２・短期滞在手術基本料３
               WHEN   258  THRU  259
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                  WHEN    11
                  WHEN    13
                    MOVE   "190141590" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    47
                  WHEN    48
                    MOVE   "190213790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
              END-EVALUATE
           ELSE
            IF   RECE62-SRYYM   >=  "201604"
              EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *        特定入院料
               WHEN   201  THRU  206
               WHEN   208  THRU  210
               WHEN   212  THRU  217
               WHEN   221
               WHEN   227  THRU  229
               WHEN   232  THRU  236
               WHEN   238  THRU  239
               WHEN   241  THRU  249
               WHEN   250  THRU  254
               WHEN   257  THRU  267
      *        --- H28.4 TUIKA ---
               WHEN   268  THRU  270
      *          認知症治療病棟入院料、精神療養病棟入院料
      *          地域移行機能強化病棟入院料
                 IF  WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
                                         = 221 OR 232 OR 217 OR 268
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                      MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                      MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    15
                    WHEN    16
                      MOVE "190182990" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 ELSE
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                      MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                      MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
      *        療養病棟入院基本料
               WHEN   004  THRU  008
               WHEN   010  THRU  012
               WHEN   152
               WHEN   173  THRU  190
               WHEN   196
               WHEN   199
      *        --- H28.4 TUIKA ---
               WHEN   048  THRU  049
               WHEN   051  THRU  054
               WHEN   057  THRU  068
                 EVALUATE   SYUKEI-IDX
                  WHEN     4
                  WHEN     9
                    MOVE   "190108890" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    11
                  WHEN    13
                    MOVE   "190142190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        有床診療所療養病床入院基本料
               WHEN   153  THRU  158
                 EVALUATE   SYUKEI-IDX
                  WHEN     4
                  WHEN     9
                    MOVE   "190108890" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    11
                  WHEN    13
                    MOVE   "190142190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    15
                  WHEN    16
                    MOVE   "190109090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        短期滞在手術基本料２・短期滞在手術基本料３
               WHEN   226
               WHEN   240
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                  WHEN    11
                  WHEN    13
                    MOVE   "190141590" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
              END-EVALUATE
            ELSE
              EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *        特定入院基本料
               WHEN   099  THRU  100
                 IF   RECE62-SRYYM   >=  "201004"
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                     MOVE "190108890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                     MOVE "190142190" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
      *        特定入院料
               WHEN   201  THRU  219
               WHEN   221  THRU  222
               WHEN   224
               WHEN   227  THRU  229
               WHEN   230  THRU  239
               WHEN   241  THRU  249
               WHEN   250  THRU  255
      *        (H26-ADD-ST)
               WHEN   256
               WHEN   257  THRU  259
               WHEN   260  THRU  261
               WHEN   262  THRU  265
               WHEN   266  THRU  267
      *        (H26-ADD-ED)
      *          認知症治療病棟入院料
                 IF    WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4) = 221 OR 232
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                        MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                        MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    15
                    WHEN    16
                        MOVE "190153190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    19
                    WHEN    20
                        MOVE "190153390" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 ELSE
      *            精神科救急入院料、精神科急性期治療病棟入院料
      *            精神科救急・合併症入院料、精神療養病棟入院料
                   IF  WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4) =
                          229 OR 238 OR 215 OR 216 OR 217 OR 239 OR 252
                     EVALUATE   SYUKEI-IDX
                      WHEN     4
                      WHEN     9
                        MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                      WHEN    11
                      WHEN    13
                        MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                      WHEN    15
                      WHEN    16
                        MOVE "190153190" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     END-EVALUATE
                   ELSE
                     EVALUATE   SYUKEI-IDX
                      WHEN     4
                      WHEN     9
                        MOVE "190108790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                      WHEN    11
                      WHEN    13
                        MOVE "190142090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     END-EVALUATE
                   END-IF
                 END-IF
      *        療養病棟入院基本料
               WHEN   013  THRU  021
               WHEN   101  THRU  109
               WHEN   147  THRU  152
               WHEN   173  THRU  190
               WHEN   196
      *        (H26-ADD-ST)
               WHEN   199
               WHEN   004  THRU  008
               WHEN   010  THRU  012
      *        (H26-ADD-ED)
                 EVALUATE   SYUKEI-IDX
                   WHEN     4
                   WHEN     9
                     MOVE "190108890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    11
                   WHEN    13
                     MOVE "190142190" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *
               WHEN   075  THRU  080
                 EVALUATE   SYUKEI-IDX
                   WHEN     4
                   WHEN     9
                     MOVE "190108990" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        有床診療所療養病床入院基本料
               WHEN   085  THRU  086
               WHEN   132  THRU  133
               WHEN   153  THRU  158
                 IF    WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4) =
                          153 OR 154 OR 155 OR 156 OR 157 OR 158
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                        MOVE "190109090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                        MOVE "190142290" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    19
                    WHEN    20
                        MOVE "190153290" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 ELSE
                   EVALUATE   SYUKEI-IDX
                    WHEN     4
                    WHEN     9
                        MOVE "190109090" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    11
                    WHEN    13
                        MOVE "190142290" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
      *        短期滞在手術基本料２・短期滞在手術基本料３
               WHEN   226
               WHEN   240
                 CONTINUE
      *        精神病棟入院基本料
               WHEN   031
               WHEN   033
               WHEN   034
               WHEN   035
               WHEN   038
               WHEN   170
               WHEN   191
      *        (H26-ADD-ST)
               WHEN   017  THRU  020
      *        (H26-ADD-ED)
                 EVALUATE   SYUKEI-IDX
                   WHEN    11
                   WHEN    13
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    19
                   WHEN    20
                     MOVE "190153090" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        結核病棟入院基本料
               WHEN   022
               WHEN   023
               WHEN   024
               WHEN   025
               WHEN   026
               WHEN   029
               WHEN   136
               WHEN   168
               WHEN   169
      *        (H26-ADD-ST)
               WHEN   013  THRU  016
      *        (H26-ADD-ED)
                 EVALUATE   SYUKEI-IDX
                   WHEN    11
                   WHEN    13
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    19
                   WHEN    20
                     MOVE "190153090" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        有床診療所入院基本料
               WHEN   081
               WHEN   083
               WHEN   172
      *        (H26-ADD-ST)
               WHEN   032  THRU  037
      *        (H26-ADD-ED)
                 EVALUATE   SYUKEI-IDX
                   WHEN    11
                   WHEN    13
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    19
                   WHEN    20
                     MOVE "190153090" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
      *        他
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                   WHEN    11
                   WHEN    13
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
              END-EVALUATE
            END-IF
           END-IF
           .
      *
       2102091-NYUINACCT-HEN-TAIN-EXT.
           EXIT.
      *
      **************************************************************
      *    他医療機関受診時の診療行為コード取得（選定療養）
      **************************************************************
       2102092-NYUINACCT-HEN-TAIN2-SEC           SECTION.
      *
           MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)   TO   SYUKEI-IDX4
      *
           IF    RECE62-SRYYM   >=  "201804"
              EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *        特定入院料
               WHEN   200  THRU  257
               WHEN   260  THRU  263
               WHEN   902
                 CONTINUE
      *        療養病棟入院基本料
               WHEN    11  THRU   14
               WHEN    51
               WHEN   901
                 CONTINUE
      *        有床診療所療養病床入院基本料
               WHEN    26
               WHEN    53
               WHEN   909
                 CONTINUE
      *        短期滞在手術基本料２・短期滞在手術基本料３
               WHEN   258  THRU  259
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                  WHEN    12
                  WHEN    14
                    MOVE   "190141590" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                  WHEN    49
                  WHEN    50
                    MOVE   "190213790" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
              END-EVALUATE
           ELSE
            IF   RECE62-SRYYM   >=  "201604"
              EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *        特定入院料
               WHEN   201  THRU  206
               WHEN   208  THRU  210
               WHEN   212  THRU  217
               WHEN   221
               WHEN   227  THRU  229
               WHEN   232  THRU  236
               WHEN   238  THRU  239
               WHEN   241  THRU  249
               WHEN   250  THRU  254
               WHEN   257  THRU  267
      *        --- H28.4 TUIKA ---
               WHEN   268  THRU  270
                 CONTINUE
      *        療養病棟入院基本料
               WHEN   004  THRU  008
               WHEN   010  THRU  012
               WHEN   152
               WHEN   173  THRU  190
               WHEN   196
               WHEN   199
      *        --- H28.4 TUIKA ---
               WHEN   048  THRU  049
               WHEN   051  THRU  054
               WHEN   057  THRU  068
                 CONTINUE
      *        有床診療所療養病床入院基本料
               WHEN   153  THRU  158
                 CONTINUE
      *        短期滞在手術基本料２・短期滞在手術基本料３
               WHEN   226
               WHEN   240
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                  WHEN    12
                  WHEN    14
                    MOVE   "190141590" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
              END-EVALUATE
            ELSE
              EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
               WHEN   099  THRU  100
                 IF   RECE62-SRYYM   >=  "201004"
                   EVALUATE   SYUKEI-IDX
                    WHEN     5
                    WHEN    10
                     MOVE "190108890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    WHEN    12
                    WHEN    14
                     MOVE "190142190" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 END-IF
               WHEN   201  THRU  219
               WHEN   221  THRU  222
               WHEN   224
               WHEN   227  THRU  229
               WHEN   230  THRU  239
               WHEN   241  THRU  249
               WHEN   250  THRU  255
      *        (H26-ADD-ST)
               WHEN   256
               WHEN   257  THRU  259
               WHEN   260  THRU  261
               WHEN   262  THRU  265
               WHEN   266  THRU  267
      *        (H26-ADD-ED)
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
                     MOVE "999999982" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    12
                   WHEN    14
                     MOVE "999999992" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   013  THRU  021
               WHEN   101  THRU  109
               WHEN   147  THRU  152
               WHEN   173  THRU  190
               WHEN   196
      *        (H26-ADD-ST)
               WHEN   199
               WHEN   004  THRU  008
               WHEN   010  THRU  012
      *        (H26-ADD-ED)
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
                     MOVE "999999983" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    12
                   WHEN    14
                     MOVE "999999993" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   075  THRU  080
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
                     MOVE "190116890" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   085  THRU  086
               WHEN   132  THRU  133
               WHEN   153  THRU  158
                 EVALUATE   SYUKEI-IDX
                   WHEN     5
                   WHEN    10
                     MOVE "999999984" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   WHEN    12
                   WHEN    14
                     MOVE "999999994" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
               WHEN   226
               WHEN   240
                 CONTINUE
               WHEN   OTHER
                 EVALUATE   SYUKEI-IDX
                   WHEN    12
                   WHEN    14
                     MOVE "190141590" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 END-EVALUATE
              END-EVALUATE
            END-IF
           END-IF
           .
      *
       2102092-NYUINACCT-HEN-TAIN2-EXT.
           EXIT.
      *
      **************************************************************
      *    減算の診療行為コード取得
      **************************************************************
       2102093-NYUINACCT-HEN-GEN-SEC           SECTION.
      *
           MOVE   WRK-GAI2-DAY(SYUKEI-IDX3)   TO   SYUKEI-IDX4
      *
           IF    RECE62-SRYYM   >=  "201804"
             EVALUATE  SYUKEI-IDX
              WHEN     23
              WHEN     24
              WHEN     25
              WHEN     26
      ***     WHEN     35
      ***     WHEN     36
      ***     WHEN     37
      ***     WHEN     38
               EVALUATE   WRK-DAY22-CHUKSNCD(SYUKEI-IDX4)
                 WHEN   "9017"
                   EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
                     WHEN    27
                     WHEN    40
                       MOVE "190161570" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     WHEN   OTHER
                       MOVE "190161470" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 WHEN   "9026"
                     MOVE   "190161870" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9030"
                     MOVE   "190162070" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9090"
                     MOVE   "190198570" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
               END-EVALUATE
               IF   SYUKEI-IDX = 35 OR 36 OR 37 OR 38
                     MOVE   "190141590" TO WRK-GAI2-SRYCD2(SYUKEI-IDX3)
               END-IF
              WHEN     27
              WHEN     28
              WHEN     29
              WHEN     30
              WHEN     43
              WHEN     44
              WHEN     45
              WHEN     46
              WHEN     59
              WHEN     60
              WHEN     61
              WHEN     62
               EVALUATE   WRK-DAY22-CHUKSNCD(SYUKEI-IDX4)
                 WHEN   "9017"
                   EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
                     WHEN    27
                     WHEN    40
                       MOVE "190161770" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     WHEN   OTHER
                       MOVE "190161670" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 WHEN   "9026"
                     MOVE   "190161970" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9030"
                     MOVE   "190162170" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9090"
                     MOVE   "190198670" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
               END-EVALUATE
               IF   SYUKEI-IDX = 43 OR 44 OR 45 OR 46
                     MOVE   "190141590" TO WRK-GAI2-SRYCD2(SYUKEI-IDX3)
               END-IF
               IF   SYUKEI-IDX = 59 OR 60 OR 61 OR 62
                     MOVE   "190213790" TO WRK-GAI2-SRYCD2(SYUKEI-IDX3)
               END-IF
             END-EVALUATE
           ELSE
            IF   RECE62-SRYYM   >=  "201604"
             EVALUATE  SYUKEI-IDX
              WHEN     23
              WHEN     24
              WHEN     25
              WHEN     26
      ***     WHEN     35
      ***     WHEN     36
      ***     WHEN     37
      ***     WHEN     38
               EVALUATE   WRK-DAY22-CHUKSNCD(SYUKEI-IDX4)
                 WHEN   "9017"
                   EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
                     WHEN     9
                     WHEN    42   THRU   44
                     WHEN    47
                     WHEN   166   THRU  167
                     WHEN   197   THRU  198
                       MOVE "190161570" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     WHEN   OTHER
                       MOVE "190161470" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 WHEN   "9026"
                     MOVE   "190161870" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9030"
                     MOVE   "190162070" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9090"
                     MOVE   "190198570" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
               END-EVALUATE
               IF   SYUKEI-IDX = 35 OR 36 OR 37 OR 38
                     MOVE   "190141590" TO WRK-GAI2-SRYCD2(SYUKEI-IDX3)
               END-IF
              WHEN     27
              WHEN     28
              WHEN     29
              WHEN     30
              WHEN     43
              WHEN     44
              WHEN     45
              WHEN     46
               EVALUATE   WRK-DAY22-CHUKSNCD(SYUKEI-IDX4)
                 WHEN   "9017"
                   EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
                     WHEN     9
                     WHEN    42   THRU   44
                     WHEN    47
                     WHEN   166   THRU  167
                     WHEN   197   THRU  198
                       MOVE "190161770" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                     WHEN   OTHER
                       MOVE "190161670" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-EVALUATE
                 WHEN   "9026"
                     MOVE   "190161970" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9030"
                     MOVE   "190162170" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9090"
                     MOVE   "190198670" TO WRK-GAI2-SRYCD(SYUKEI-IDX3)
               END-EVALUATE
               IF   SYUKEI-IDX = 43 OR 44 OR 45 OR 46
                     MOVE   "190141590" TO WRK-GAI2-SRYCD2(SYUKEI-IDX3)
               END-IF
             END-EVALUATE
            ELSE
             EVALUATE  SYUKEI-IDX
              WHEN     23
              WHEN     24
              WHEN     25
              WHEN     26
      ***     WHEN     35
      ***     WHEN     36
      ***     WHEN     37
      ***     WHEN     38
               EVALUATE   WRK-DAY22-CHUKSNCD(SYUKEI-IDX4)
                 WHEN   "9017"
                   IF   RECE62-SRYYM   >=  "201404"
                    IF  (WRK-DAY22-NYUKHNKBN(SYUKEI-IDX4)
                                             =   79 OR 88  )
                    OR  (WRK-DAY22-NYUINKHN(SYUKEI-IDX4)
                                             =  "190799510")
                      MOVE "190161570" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    ELSE
                      MOVE "190161470" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    END-IF
                   ELSE
                      MOVE "190161470" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-IF
                 WHEN   "9018"
                   MOVE   "190161570"  TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9026"
                   MOVE   "190161870"  TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9030"
                   MOVE   "190162070"  TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
               END-EVALUATE
               IF   SYUKEI-IDX = 35 OR 36 OR 37 OR 38
                 EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *           特定入院基本料
                  WHEN   099  THRU  100
                   MOVE   "190142190"  TO  WRK-GAI2-SRYCD2(SYUKEI-IDX3)
      *           他
                  WHEN   OTHER
                   MOVE   "190141590"  TO  WRK-GAI2-SRYCD2(SYUKEI-IDX3)
                 END-EVALUATE
               END-IF
              WHEN     27
              WHEN     28
              WHEN     29
              WHEN     30
              WHEN     43
              WHEN     44
              WHEN     45
              WHEN     46
               EVALUATE   WRK-DAY22-CHUKSNCD(SYUKEI-IDX4)
                 WHEN   "9017"
                   IF   RECE62-SRYYM   >=  "201404"
                    IF  (WRK-DAY22-NYUKHNKBN(SYUKEI-IDX4)
                                             =   79 OR 88  )
                    OR  (WRK-DAY22-NYUINKHN(SYUKEI-IDX4)
                                             =  "190799510")
                      MOVE "190161770" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    ELSE
                      MOVE "190161670" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                    END-IF
                   ELSE
                      MOVE "190161670" TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                   END-IF
                 WHEN   "9018"
                   MOVE   "190161770"  TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9026"
                   MOVE   "190161970"  TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
                 WHEN   "9030"
                   MOVE   "190162170"  TO  WRK-GAI2-SRYCD(SYUKEI-IDX3)
               END-EVALUATE
               IF   SYUKEI-IDX = 43 OR 44 OR 45 OR 46
                 EVALUATE   WRK-DAY22-NYUKHNKSNKBN(SYUKEI-IDX4)
      *           特定入院基本料
                  WHEN   099  THRU  100
                   MOVE   "190142190"  TO  WRK-GAI2-SRYCD2(SYUKEI-IDX3)
      *           他
                  WHEN   OTHER
                   MOVE   "190141590"  TO  WRK-GAI2-SRYCD2(SYUKEI-IDX3)
                 END-EVALUATE
               END-IF
             END-EVALUATE
            END-IF
           END-IF
           .
      *
       2102093-NYUINACCT-HEN-GEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210210-RECE64-TENSOU2-GAI-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 3
              MOVE    "90"              TO      RECE64-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE64-SRYKBN
           END-IF 
           MOVE    NACCT-ZAISKBKBN      TO      RECE64-ZAISKBKBN
           COMPUTE WRK-ZAINUM    =  99999900  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    NACCT-SRYKA          TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           MOVE    WRK-GAI2-ZAITEN(SYUKEI-IDX3) 
                                        TO      RECE64-ZAITEN
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 2
              MOVE    1                 TO      RECE64-MEISAISU
              MOVE    WRK-GAI2-SRYCD-9 (SYUKEI-IDX3)
                                        TO      RECE64-SRYCDTOTAL
              MOVE    1                 TO      RECE64-SURYOUTOTAL
           ELSE
              MOVE    1                 TO      RECE64-MEISAISU
              MOVE    WRK-GAI2-SRYCD-9 (SYUKEI-IDX3)
                                        TO      RECE64-SRYCDTOTAL
              MOVE    1                 TO      RECE64-SURYOUTOTAL
              MOVE    WRK-GAI2-DAY(SYUKEI-IDX3)  TO   SYUKEI-IDX4
              IF WRK-GAI2-SRYCD2-9(SYUKEI-IDX3)       NOT = ZERO
                ADD   1   TO   RECE64-MEISAISU
                ADD   WRK-GAI2-SRYCD2-9(SYUKEI-IDX3)
                          TO   RECE64-SRYCDTOTAL
                ADD   1   TO   RECE64-SURYOUTOTAL
              END-IF
              IF WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
                ADD   1   TO   RECE64-MEISAISU
                ADD   WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)
                          TO   RECE64-SRYCDTOTAL
                ADD   1   TO   RECE64-SURYOUTOTAL
              END-IF
              IF WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
                ADD   1   TO   RECE64-MEISAISU
                ADD   WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)
                          TO   RECE64-SRYCDTOTAL
                ADD   1   TO   RECE64-SURYOUTOTAL
              END-IF
           END-IF
           IF  WRK-GAI2-KANGOGEN-SRYCD-9(SYUKEI-IDX3) NOT = ZERO
                ADD   1   TO   RECE64-MEISAISU
                ADD   WRK-GAI2-KANGOGEN-SRYCD-9(SYUKEI-IDX3)
                          TO   RECE64-SRYCDTOTAL
                ADD   1   TO   RECE64-SURYOUTOTAL
           END-IF
           MOVE    ZERO                 TO      RECE64-RUIKEITOTAL
           MOVE    WRK-GAI2-ZAIKAISU(SYUKEI-IDX3)
                                        TO      RECE64-ZAIKAISU
           MOVE    WRK-GAI2-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-GAI2-KAISU(SYUKEI-IDX3 IDX2)             
                                        TO    RECE64-KAISU (1 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
                   IF      RECE64-KAISU(1 IDX2)  NOT = ZERO
                       MOVE     RECE64-HKNCOMBI
                                        TO    RECE64-HKNCOMBI-DAY(IDX2)
                   END-IF
           END-PERFORM
           .
       210210-RECE64-TENSOU2-GAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210211-RECE65-HENSYU2-GAI-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_nyuinact"     TO   MCP-TABLE
               MOVE    "key9"             TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
           ELSE
               MOVE     1               TO      FLG-NYUINACT
           END-IF
           IF  FLG-NYUINACT   =   ZERO
               PERFORM   2102111-RECE65-TENSOU2-GAI-SEC
               PERFORM   RECE65-WRITE-SEC
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210211-RECE65-HENSYU2-GAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102111-RECE65-TENSOU2-GAI-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM    =  99999900  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 3
              MOVE    "90"              TO      RECE65-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE65-SRYKBN
           END-IF 
           IF      WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =   1 OR 3
              MOVE    "900"             TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           ELSE
              MOVE    "920"             TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           END-IF 
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO  IDX11
           IF  WRK-GAI2-KANGOGEN-SRYCD-9(SYUKEI-IDX3) NOT = ZERO
             ADD     1                  TO  IDX11
             MOVE    WRK-GAI2-KANGOGEN-SRYCD-9(SYUKEI-IDX3)
                                        TO  WRK-SRYCD2
             PERFORM 21021111-RECE65-TENSOU2-G2-SEC
           END-IF
      *
           ADD       1                  TO  IDX11
           MOVE      WRK-GAI2-SRYCD(SYUKEI-IDX3)
                                        TO  WRK-SRYCD2
           PERFORM   21021111-RECE65-TENSOU2-G2-SEC
      *
           IF  WRK-GAI2-SRYKBNFLG(SYUKEI-IDX3)  =  3 OR 4
             MOVE    WRK-GAI2-DAY(SYUKEI-IDX3)
                                        TO  SYUKEI-IDX4
             IF   WRK-GAI2-SRYCD2-9(SYUKEI-IDX3)       NOT = ZERO
               ADD       1              TO  IDX11
               MOVE      WRK-GAI2-SRYCD2-9(SYUKEI-IDX3)
                                        TO  WRK-SRYCD2
               PERFORM   21021111-RECE65-TENSOU2-G2-SEC
             END-IF
             IF   WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)      NOT = ZERO
               ADD       1              TO  IDX11
               MOVE      WRK-DAY1-KSN-SRYCD(SYUKEI-IDX4)
                                        TO  WRK-SRYCD2
               PERFORM   21021111-RECE65-TENSOU2-G2-SEC
             END-IF
             IF   WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)  NOT = ZERO
               ADD       1              TO  IDX11
               MOVE      WRK-DAY1-HYOKETU-SRYCD(SYUKEI-IDX4)
                                        TO  WRK-SRYCD2
               PERFORM   21021111-RECE65-TENSOU2-G2-SEC
             END-IF
           END-IF
      *
           .
       2102111-RECE65-TENSOU2-GAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21021111-RECE65-TENSOU2-G2-SEC                SECTION.
      *
           MOVE    WRK-SRYCD2       TO  RECE65-SRYCD(IDX11)
           MOVE    1                TO  RECE65-SRYSURYO(IDX11)
           MOVE    ZERO             TO  RECE65-SRYKAISU(IDX11)
           MOVE    SPACE            TO  RECE65-MEISKYFLG(IDX11)
           MOVE    SPACE            TO  RECE65-AUTOKBN(IDX11)
           MOVE    ZERO             TO  RECE65-INPUTNUM(IDX11)
           MOVE    WRK-SRYCD2       TO  WRK-SRYCD
           MOVE    RECE65-SRYYM     TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY     TO  WK-TAIHI-SRYD
           PERFORM 900-TENSU-TBL-SEC
           MOVE    IDX11            TO  IDX4
           PERFORM 21020611-RECE65-TENSOU2X-SEC
      *
           .
       21021111-RECE65-TENSOU2-G2-EXT.
           EXIT.
      *
      **************************************************************
      *    食事療養費の編集
      **************************************************************
       210212-NYUINACCT-HEN2-SEC           SECTION.
      *
           PERFORM    VARYING  SYUKEI-IDX     FROM    1   BY  1
                  UNTIL  SYUKEI-IDX            >  31
      *
             IF    WRK-SKJ-ZAITEN(SYUKEI-IDX)  NOT =  ZERO
      *
               MOVE     ZERO     TO    FLG-ARI
               PERFORM  VARYING  SYUKEI-IDX2    FROM    1   BY  1
                      UNTIL  SYUKEI-IDX2           > 31
                       OR    WRK-SKJ2-ZAITEN(SYUKEI-IDX2) = ZERO
                       OR    FLG-ARI               = 1
                  IF  ( WRK-SKJ2-ZAITEN   (SYUKEI-IDX2)
                                     =  WRK-SKJ-ZAITEN   (SYUKEI-IDX) )
                  AND ( WRK-SKJ2-SRYCD-T  (SYUKEI-IDX2)
                                     =  WRK-SKJ-SRYCD-T  (SYUKEI-IDX) )
                     ADD   WRK-SKJ-ZAIKAISU(SYUKEI-IDX)  TO  
                                       WRK-SKJ2-ZAIKAISU (SYUKEI-IDX2)
                     MOVE  1  TO  WRK-SKJ2-KAISU(SYUKEI-IDX2 SYUKEI-IDX)
                     MOVE  1  TO   FLG-ARI
                  END-IF
               END-PERFORM  
               IF  FLG-ARI  =  ZERO  
                     MOVE  WRK-SKJ-ZAITEN   (SYUKEI-IDX)  TO  
                                       WRK-SKJ2-ZAITEN   (SYUKEI-IDX2)
                     ADD   WRK-SKJ-ZAIKAISU (SYUKEI-IDX)  TO  
                                       WRK-SKJ2-ZAIKAISU (SYUKEI-IDX2)
                     MOVE  WRK-SKJ-SRYCD-T  (SYUKEI-IDX)  TO  
                                       WRK-SKJ2-SRYCD-T  (SYUKEI-IDX2)
                     PERFORM  VARYING  SYUKEI-IDX3  FROM  1  BY  1
                            UNTIL  SYUKEI-IDX3     >   5
                        IF  WRK-SKJ-SRYCD(SYUKEI-IDX SYUKEI-IDX3) 
                                             NOT =   ZERO
                           ADD   1  TO  WRK-SKJ2-MEISAISU(SYUKEI-IDX2)
                           ADD   WRK-SKJ-SRYCD(SYUKEI-IDX SYUKEI-IDX3)
                                    TO  WRK-SKJ2-SRYCDTOTAL(SYUKEI-IDX2)
                        END-IF
                     END-PERFORM
                     MOVE  1  TO  WRK-SKJ2-KAISU(SYUKEI-IDX2 SYUKEI-IDX)
               END-IF
      *
             END-IF
      *
           END-PERFORM
      *
           .
      *
       210212-NYUINACCT-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210213-RECE64-TENSOU2-SKJ-SEC               SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    NACCT-SRYKBN         TO      RECE64-SRYKBN
           MOVE    NACCT-ZAISKBKBN      TO      RECE64-ZAISKBKBN
           COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    NACCT-SRYKA          TO      RECE64-SRYKA
           MOVE    RECE62-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           MOVE    WRK-SKJ2-ZAITEN(SYUKEI-IDX3) 
                                        TO      RECE64-ZAITEN
           MOVE    WRK-SKJ2-MEISAISU(SYUKEI-IDX3)
                                        TO      RECE64-MEISAISU
           MOVE    WRK-SKJ2-ZAIKAISU(SYUKEI-IDX3)
                                        TO      RECE64-ZAIKAISU
           MOVE    WRK-SKJ2-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
           MOVE    WRK-SKJ2-SRYCDTOTAL(SYUKEI-IDX3)
                                        TO      RECE64-SRYCDTOTAL
           MOVE    WRK-SKJ2-MEISAISU(SYUKEI-IDX3)
                                        TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    NACCT-DRCD           TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-SKJ2-KAISU(SYUKEI-IDX3 IDX2)             
                                        TO   RECE64-KAISU (1 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
                   IF      RECE64-KAISU(1 IDX2)  NOT = ZERO
                       MOVE     RECE64-HKNCOMBI
                                        TO   RECE64-HKNCOMBI-DAY(IDX2)
                   END-IF
           END-PERFORM
           .
       210213-RECE64-TENSOU2-SKJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210213X-RECE64-TENSOU2-SKJ2-SEC               SECTION.
      *
           IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)  NOT =  ZERO
             ADD  1  TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
             ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
                          WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
           END-IF
           IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)  NOT =  ZERO
             ADD  1  TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
             ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
           END-IF
           IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)  NOT =  ZERO
             ADD  1  TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
             ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
           END-IF
           IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 4)  NOT =  ZERO
             ADD  1  TO   WRK-SKJ200604-MEISAISU(IDX1 SYUKEI-IDX3)
             ADD  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 4)
                     TO   WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
                          WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
           END-IF
      *
           IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
             EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
              WHEN      1
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)  NOT =  ZERO
                  ADD   197001310
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)  NOT =  ZERO
                  ADD   197001570
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)  NOT =  ZERO
                  ADD   197001670
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 4)  NOT =  ZERO
                  ADD   197003510
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
              WHEN      2
                ADD     197001710
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
             END-EVALUATE
           ELSE
             EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
              WHEN      1
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)  NOT =  ZERO
                  ADD   197000110
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 2)  NOT =  ZERO
                  ADD   197000470
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 3)  NOT =  ZERO
                  ADD   197000570
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 4)  NOT =  ZERO
                  ADD   197003110
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
              WHEN      2
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 1)  NOT =  ZERO
                  ADD   197000710
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
                IF   WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 4)  NOT =  ZERO
                  ADD   197003210
                     TO   WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                END-IF
             END-EVALUATE
           END-IF
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO  RECE64-KOHBUNRI
           MOVE    "97"                 TO  RECE64-SRYKBN
           MOVE    "4"                  TO  RECE64-ZAISKBKBN
           IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                COMPUTE WRK-ZAINUM  =  99996100  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO  RECE64-ZAINUM
           ELSE
                COMPUTE WRK-ZAINUM  =  99996000  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO  RECE64-ZAINUM
           END-IF
      ***  COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
      ***  MOVE    WRK-ZAINUM           TO  RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO  RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO  RECE64-PTNUM
      *
           MOVE    "00"                 TO  RECE64-SRYKA
           MOVE    WRK-SKJ200604-HKNCOMBI   (IDX1)
                                        TO  RECE64-HKNCOMBI
           MOVE    SPACE                TO  RECE64-JIHOKBN
      *
           MOVE    WRK-SKJ200604-SRYCDTOTAL (IDX1 SYUKEI-IDX3)
                                        TO  RECE64-SRYCDTOTAL
           MOVE    WRK-SKJ200604-MEISAISU   (IDX1 SYUKEI-IDX3)
                                        TO  RECE64-MEISAISU
           MOVE    1                    TO  RECE64-ZAIKAISU
           MOVE    WRK-SKJ200604-SURYOUTOTAL(IDX1 SYUKEI-IDX3)
                                        TO  RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO  RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO  RECE64-SYUTEN2
           MOVE    ZERO                 TO  RECE64-YKZTEN
           MOVE    ZERO                 TO  RECE64-KIZAITEN
           MOVE    SPACE                TO  RECE64-DRCD
           MOVE    SPACE                TO  RECE64-ZAIREQFLG
           MOVE    ZERO                 TO  RECE64-TEIGENRATE
           MOVE    1                    TO  RECE64-KAISU(1 SYUKEI-IDX3)
           MOVE    SYUKEI-IDX3          TO  WK-TAIHI-DAY
           IF      RECE64-KAISU(1 SYUKEI-IDX3)  NOT = ZERO
             MOVE  RECE64-HKNCOMBI      TO
                                       RECE64-HKNCOMBI-DAY(SYUKEI-IDX3)
           END-IF
           .
       210213X-RECE64-TENSOU2-SKJ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（環境）（Ｆ００４）
      *****************************************************************
       210219-RECE64-TENSOU2-KAN-SEC               SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO  RECE64-KOHBUNRI
           MOVE    "97"                 TO  RECE64-SRYKBN
           MOVE    "4"                  TO  RECE64-ZAISKBKBN
           COMPUTE WRK-ZAINUM  =  99996300  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO  RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO  RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO  RECE64-PTNUM
      *
           MOVE    "00"                 TO  RECE64-SRYKA
           MOVE    WRK-SKJ200604-HKNCOMBI   (IDX1)
                                        TO  RECE64-HKNCOMBI
           MOVE    SPACE                TO  RECE64-JIHOKBN
      *
           EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
             WHEN      1
                MOVE    197001410       TO  RECE64-SRYCDTOTAL
             WHEN      2
                MOVE    197001810       TO  RECE64-SRYCDTOTAL
           END-EVALUATE
           MOVE    1                    TO  RECE64-MEISAISU
           MOVE    1                    TO  RECE64-ZAIKAISU
           MOVE    1                    TO  RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO  RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO  RECE64-SYUTEN2
           MOVE    ZERO                 TO  RECE64-YKZTEN
           MOVE    ZERO                 TO  RECE64-KIZAITEN
           MOVE    SPACE                TO  RECE64-DRCD
           MOVE    SPACE                TO  RECE64-ZAIREQFLG
           MOVE    ZERO                 TO  RECE64-TEIGENRATE
           MOVE    1                    TO  RECE64-KAISU(1 SYUKEI-IDX3)
           MOVE    SYUKEI-IDX3          TO  WK-TAIHI-DAY
           IF      RECE64-KAISU(1 SYUKEI-IDX3)  NOT = ZERO
             MOVE  RECE64-HKNCOMBI      TO
                                       RECE64-HKNCOMBI-DAY(SYUKEI-IDX3)
           END-IF
           .
       210219-RECE64-TENSOU2-KAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（食事負担）（Ｆ００４）
      *****************************************************************
       210221-RECE64-TENSOU2-SFTN-SEC               SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO  RECE64-KOHBUNRI
           MOVE    "97"                 TO  RECE64-SRYKBN
           MOVE    "4"                  TO  RECE64-ZAISKBKBN
           EVALUATE  FLG-SKJ200610FTN
             WHEN        1
               COMPUTE WRK-ZAINUM  =  99996200  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE64-ZAINUM
             WHEN        2
               COMPUTE WRK-ZAINUM  =  99996400  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE64-ZAINUM
           END-EVALUATE
           MOVE    CNT-ZAIREN           TO  RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO  RECE64-PTNUM
      *
           MOVE    "00"                 TO  RECE64-SRYKA
           MOVE    WRK-SKJ200604-HKNCOMBI   (IDX1)
                                        TO  RECE64-HKNCOMBI
           MOVE    SPACE                TO  RECE64-JIHOKBN
      *
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                        TO  WRK-SRYCD-X
                MOVE    WRK-SRYCD       TO  RECE64-SRYCDTOTAL
             WHEN         2
                MOVE    WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                                        TO  WRK-SRYCD-X
                MOVE    WRK-SRYCD       TO  RECE64-SRYCDTOTAL
           END-EVALUATE
           MOVE    1                    TO  RECE64-MEISAISU
           MOVE    1                    TO  RECE64-ZAIKAISU
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
                                        TO  RECE64-SURYOUTOTAL
             WHEN         2
                MOVE    1               TO  RECE64-SURYOUTOTAL
           END-EVALUATE
           MOVE    ZERO                 TO  RECE64-RUIKEITOTAL
           MOVE    ZERO                 TO  RECE64-SYUTEN2
           MOVE    ZERO                 TO  RECE64-YKZTEN
           MOVE    ZERO                 TO  RECE64-KIZAITEN
           MOVE    SPACE                TO  RECE64-DRCD
           MOVE    SPACE                TO  RECE64-ZAIREQFLG
           MOVE    ZERO                 TO  RECE64-TEIGENRATE
           MOVE    1                    TO  RECE64-KAISU(1 SYUKEI-IDX3)
           MOVE    SYUKEI-IDX3          TO  WK-TAIHI-DAY
           IF      RECE64-KAISU(1 SYUKEI-IDX3)  NOT = ZERO
             MOVE  RECE64-HKNCOMBI      TO
                                       RECE64-HKNCOMBI-DAY(SYUKEI-IDX3)
           END-IF
           .
       210221-RECE64-TENSOU2-SFTN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210214-RECE65-HENSYU2-SKJ-SEC               SECTION.
      *
           INITIALIZE                      NYUINACT-REC
           MOVE    NACCT-HOSPNUM      TO   NSRY-HOSPNUM
           MOVE    NACCT-NYUGAIKBN    TO   NSRY-NYUGAIKBN
           MOVE    NACCT-PTID         TO   NSRY-PTID
      ***  MOVE    NACCT-SRYKA        TO   NSRY-SRYKA
           MOVE    NACCT-SRYYM        TO   NSRY-SRYYM
           MOVE    NACCT-ZAINUM       TO   NSRY-ZAINUM
           MOVE    NYUINACT-REC       TO   MCPDATA-REC
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_nyuinact"     TO   MCP-TABLE
               MOVE    "key9"             TO   MCP-PATHNAME
               PERFORM  900-NYUINACT-READ-SEC
           ELSE
               MOVE     1               TO      FLG-NYUINACT
           END-IF
           IF  FLG-NYUINACT   =   ZERO
               PERFORM   2102141-RECE65-TENSOU2-SKJ-SEC
               PERFORM   RECE65-WRITE-SEC
           END-IF
      *
           MOVE    "tbl_nyuinact"     TO   MCP-TABLE
           MOVE    "key9"             TO   MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       210214-RECE65-HENSYU2-SKJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       2102141-RECE65-TENSOU2-SKJ-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    NSRY-RENNUM          TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    NSRY-SRYKA           TO      RECE65-SRYKA
           MOVE    NSRY-SRYKBN          TO      RECE65-SRYKBN
           MOVE    NSRY-SRYSYUKBN       TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           MOVE    NSRY-JIHIMONEYTOTAL  TO      RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    
      *
              IF   WRK-SKJ2-SRYCD(SYUKEI-IDX3 IDX2)  NOT =   ZERO
      *
                ADD     1                    TO    IDX4  
                MOVE    WRK-SKJ2-SRYCD(SYUKEI-IDX3 IDX2)
                                             TO  RECE65-SRYCD(IDX4)
                MOVE    1                    TO  RECE65-SRYSURYO(IDX4)
                MOVE    ZERO                 TO  RECE65-SRYKAISU(IDX4)
                MOVE    SPACE                TO  RECE65-MEISKYFLG(IDX4)
                MOVE    SPACE                TO  RECE65-AUTOKBN(IDX4)
                MOVE    ZERO                 TO  RECE65-INPUTNUM(IDX4)
                MOVE    WRK-SKJ2-SRYCD(SYUKEI-IDX3 IDX2)
                                             TO  WRK-SRYCD
                MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
                MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
                PERFORM 900-TENSU-TBL-SEC
                PERFORM 21020611-RECE65-TENSOU2X-SEC
      *
              END-IF
      *
           END-PERFORM
      *
           .
       2102141-RECE65-TENSOU2-SKJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       210214X-RECE65-HENSYU2-SKJ2-SEC               SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                COMPUTE WRK-ZAINUM  =  99996100  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO   RECE65-ZAINUM
           ELSE
                COMPUTE WRK-ZAINUM  =  99996000  +  SYUKEI-IDX3
                MOVE    WRK-ZAINUM      TO   RECE65-ZAINUM
           END-IF
      ***  COMPUTE WRK-ZAINUM    =  99999920  +  SYUKEI-IDX3
      ***  MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           MOVE    1                    TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    "00"                 TO   RECE65-SRYKA
           MOVE    "97"                 TO   RECE65-SRYKBN
           MOVE    "970"                TO   RECE65-SRYSYUKBN
                                             RECE64-SRYSYUKBN
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO      IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
      **>              UNTIL     IDX2     >     3
                       UNTIL     IDX2     >     4
      *
             EVALUATE   IDX2
               WHEN    1
                 MOVE     1     TO   IDX30
               WHEN    2
                 MOVE     4     TO   IDX30
               WHEN    3
                 MOVE     2     TO   IDX30
               WHEN    4
                 MOVE     3     TO   IDX30
             END-EVALUATE
      *
      **>    IF  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2)  NOT =  ZERO
             IF  WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX30) NOT =  ZERO
      *
               ADD     1                    TO  IDX4
               IF   WRK-NYULIFE-KBN(SYUKEI-IDX3)  NOT =  SPACE
                EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
                 WHEN      1
      **>          EVALUATE    IDX2
      **>            WHEN       1
      **>                MOVE  "197001310"  TO  RECE65-SRYCD(IDX4)
      **>            WHEN       2
      **>                MOVE  "197001570"  TO  RECE65-SRYCD(IDX4)
      **>            WHEN       3
      **>                MOVE  "197001670"  TO  RECE65-SRYCD(IDX4)
      **>          END-EVALUATE
                   EVALUATE    IDX30
                     WHEN       1
                         MOVE  "197001310"  TO  RECE65-SRYCD(IDX4)
                     WHEN       2
                         MOVE  "197001570"  TO  RECE65-SRYCD(IDX4)
                     WHEN       3
                         MOVE  "197001670"  TO  RECE65-SRYCD(IDX4)
                     WHEN       4
                         MOVE  "197003510"  TO  RECE65-SRYCD(IDX4)
                   END-EVALUATE
                 WHEN      2
                         MOVE  "197001710"  TO  RECE65-SRYCD(IDX4)
                END-EVALUATE
               ELSE
                EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
                 WHEN      1
      **>          EVALUATE    IDX2
      **>            WHEN       1
      **>                MOVE  "197000110"  TO  RECE65-SRYCD(IDX4)
      **>            WHEN       2
      **>                MOVE  "197000470"  TO  RECE65-SRYCD(IDX4)
      **>            WHEN       3
      **>                MOVE  "197000570"  TO  RECE65-SRYCD(IDX4)
      **>          END-EVALUATE
                   EVALUATE    IDX30
                     WHEN       1
                         MOVE  "197000110"  TO  RECE65-SRYCD(IDX4)
                     WHEN       2
                         MOVE  "197000470"  TO  RECE65-SRYCD(IDX4)
                     WHEN       3
                         MOVE  "197000570"  TO  RECE65-SRYCD(IDX4)
                     WHEN       4
                         MOVE  "197003110"  TO  RECE65-SRYCD(IDX4)
                   END-EVALUATE
                 WHEN      2
      **>                MOVE  "197000710"  TO  RECE65-SRYCD(IDX4)
                   EVALUATE    IDX30
                     WHEN       1
                         MOVE  "197000710"  TO  RECE65-SRYCD(IDX4)
                     WHEN       4
                         MOVE  "197003210"  TO  RECE65-SRYCD(IDX4)
                   END-EVALUATE
                END-EVALUATE
               END-IF
      **>      MOVE    WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2)
               MOVE    WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX30)
                                            TO  RECE65-SRYSURYO(IDX4)
               MOVE    ZERO                 TO  RECE65-SRYKAISU(IDX4)
               MOVE    SPACE                TO  RECE65-MEISKYFLG(IDX4)
               MOVE    SPACE                TO  RECE65-AUTOKBN(IDX4)
               MOVE    ZERO                 TO  RECE65-INPUTNUM(IDX4)
      *
               MOVE    RECE65-SRYCD(IDX4)   TO  WRK-SRYCD
               MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
               MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
               PERFORM 900-TENSU-TBL-SEC
               PERFORM 21020611-RECE65-TENSOU2X-SEC
      *
               COMPUTE RECE64-ZAITEN =
                       RECE64-ZAITEN +
      **>         (TNS-TEN * WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2))
                  (TNS-TEN * WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX30))
               COMPUTE RECE64-SYUTEN1 =
                       RECE64-SYUTEN1 +
      **>         (TNS-TEN * WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX2))
                  (TNS-TEN * WRK-SKJ200604-DAY(IDX1 SYUKEI-IDX3 IDX30))
             END-IF
      *
           END-PERFORM
      *
           .
       210214X-RECE65-HENSYU2-SKJ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（環境）（Ｆ００５）
      *****************************************************************
       210220-RECE65-HENSYU2-KAN-SEC               SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           COMPUTE WRK-ZAINUM   =  99996300  +  SYUKEI-IDX3
           MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           MOVE    1                    TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    "00"                 TO   RECE65-SRYKA
           MOVE    "97"                 TO   RECE65-SRYKBN
           MOVE    "970"                TO   RECE65-SRYSYUKBN
                                             RECE64-SRYSYUKBN
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
      *
           EVALUATE   WRK-SKJ200604-KBN(IDX1 SYUKEI-IDX3)
             WHEN      1
                 MOVE  "197001410"      TO  RECE65-SRYCD(1)
             WHEN      2
                 MOVE  "197001810"      TO  RECE65-SRYCD(1)
           END-EVALUATE
           MOVE    1                    TO  RECE65-SRYSURYO(1)
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
      *
           MOVE    RECE65-SRYCD(1)      TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM 900-TENSU-TBL-SEC
           MOVE    1                    TO  IDX4
           PERFORM 21020611-RECE65-TENSOU2X-SEC
      *
           MOVE    TNS-TEN              TO  RECE64-ZAITEN
           MOVE    TNS-TEN              TO  RECE64-SYUTEN1
      *
           .
       210220-RECE65-HENSYU2-KAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（食事負担）（Ｆ００５）
      *****************************************************************
       210222-RECE65-HENSYU2-SFTN-SEC               SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           EVALUATE  FLG-SKJ200610FTN
             WHEN        1
               COMPUTE WRK-ZAINUM  =  99996200  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE65-ZAINUM
             WHEN        2
               COMPUTE WRK-ZAINUM  =  99996400  +  SYUKEI-IDX3
               MOVE    WRK-ZAINUM       TO  RECE65-ZAINUM
           END-EVALUATE
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           MOVE    1                    TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    "00"                 TO   RECE65-SRYKA
           MOVE    "97"                 TO   RECE65-SRYKBN
           MOVE    "970"                TO   RECE65-SRYSYUKBN
                                             RECE64-SRYSYUKBN
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
      *
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-NYULIFE-SKJFTN-SRYCD(SYUKEI-IDX3)
                                        TO  RECE65-SRYCD(1)
             WHEN         2
                MOVE    WRK-NYULIFE-KANFTN-SRYCD(SYUKEI-IDX3)
                                        TO  RECE65-SRYCD(1)
           END-EVALUATE
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
                MOVE    WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3)
                                        TO  RECE65-SRYSURYO(1)
             WHEN         2
                MOVE    1               TO  RECE65-SRYSURYO(1)
           END-EVALUATE
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
      *
           MOVE    RECE65-SRYCD(1)      TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM 900-TENSU-TBL-SEC
           MOVE    1                    TO  IDX4
           PERFORM 21020611-RECE65-TENSOU2X-SEC
      *
           EVALUATE   FLG-SKJ200610FTN
             WHEN         1
               COMPUTE RECE64-ZAITEN =
                       RECE64-ZAITEN +
                 (TNS-TEN *
                       WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3))
               COMPUTE RECE64-SYUTEN1 =
                       RECE64-SYUTEN1 +
                 (TNS-TEN *
                       WRK-SKJ200604-SURYOUTOTALFTN(IDX1 SYUKEI-IDX3))
             WHEN         2
               MOVE    TNS-TEN         TO  RECE64-ZAITEN
               MOVE    TNS-TEN         TO  RECE64-SYUTEN1
           END-EVALUATE
      *
           .
       210222-RECE65-HENSYU2-SFTN-EXT.
           EXIT.
      *
      *****************************************************************
      *    未実施減算額取得
      *****************************************************************
       210215-MIJISI-GET-SEC                 SECTION.
      *
           PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                        UNTIL     GENSAN-IDX   >   4
                MOVE   ZERO   TO  WRK-SYS-MIJISI-ZAITEN(GENSAN-IDX)
           END-PERFORM
      *
           PERFORM  VARYING   GENSAN-IDX  FROM  1  BY  1
                        UNTIL     GENSAN-IDX   >   4
      *
              IF    WRK-SYS-MIJISI(GENSAN-IDX)  =   1    
                 EVALUATE    GENSAN-IDX
                   WHEN   2
      *
      ***            IF    RECE62-RJNHKNNUM    =    SPACE
                       MOVE    "190080570"   TO   WRK-SRYCD-X
      ***            ELSE
      ***              MOVE    "190799770"   TO   WRK-SRYCD-X
      ***            END-IF
                     MOVE    RECE62-SRYYM    TO   WK-TAIHI-SRYYM
                     MOVE    1               TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        MOVE    TNS-TEN   TO   WRK-SYS-MIJISI-ZAITEN
                                                      (GENSAN-IDX)
                     END-IF
      *
                   WHEN   3
      *
      ***            IF    RECE62-RJNHKNNUM    =    SPACE
                       MOVE    "190111690"   TO   WRK-SRYCD-X
      ***            ELSE
      ***              MOVE    "190809090"   TO   WRK-SRYCD-X
      ***            END-IF
                     MOVE    RECE62-SRYYM    TO   WK-TAIHI-SRYYM
                     MOVE    1               TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        MOVE    TNS-TEN   TO   WRK-SYS-MIJISI-ZAITEN
                                                      (GENSAN-IDX)
                     END-IF
      *
                   WHEN   4
      *
      ***            IF    RECE62-RJNHKNNUM    =    SPACE
                       MOVE    "190111790"   TO   WRK-SRYCD-X
      ***            ELSE
      ***              MOVE    "190809190"   TO   WRK-SRYCD-X
      ***            END-IF
                     MOVE    RECE62-SRYYM    TO   WK-TAIHI-SRYYM
                     MOVE    1               TO   WK-TAIHI-SRYD
                     PERFORM    900-TENSU-TBL-SEC
                     IF       FLG-TENSU      =    ZERO
                        MOVE    TNS-TEN   TO   WRK-SYS-MIJISI-ZAITEN
                                                      (GENSAN-IDX)
                     END-IF
      *
                 END-EVALUATE
              END-IF
      *
           END-PERFORM
      *
           .
       210215-MIJISI-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       210216-RECE64-TENSOU2-MIJ-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           IF      FLG-MIJISI2   =   1
              MOVE    "90"              TO      RECE64-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE64-SRYKBN
           END-IF 
           MOVE    "6"                  TO      RECE64-ZAISKBKBN
           IF      FLG-MIJISI2   =   1
             COMPUTE WRK-ZAINUM    =  99999960  +  SYUKEI-IDX3
           ELSE
             COMPUTE WRK-ZAINUM    =  99999970  +  SYUKEI-IDX3
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           MOVE    "00"                 TO      RECE64-SRYKA
           MOVE    WRK-MIJ-HKNCOMBI(IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           EVALUATE   SYUKEI-IDX3
               WHEN  2
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-ZAITEN
                 MOVE    1              TO      RECE64-MEISAISU
                 IF      FLG-MIJISI2   =   1
                    MOVE    WRK-MIJ-CNT90(IDX1 2)
                                        TO      RECE64-ZAIKAISU
                 ELSE
                    MOVE    WRK-MIJ-CNT92(IDX1 2)
                                        TO      RECE64-ZAIKAISU
                 END-IF
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    190080570   TO      RECE64-SRYCDTOTAL
      ***        ELSE
      ***           MOVE    190799770   TO      RECE64-SRYCDTOTAL
      ***        END-IF
               WHEN  3
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-ZAITEN
                 MOVE    1              TO      RECE64-MEISAISU
                 IF      FLG-MIJISI2   =   1
                    MOVE    WRK-MIJ-CNT90(IDX1 3)
                                        TO      RECE64-ZAIKAISU
                 ELSE
                    MOVE    WRK-MIJ-CNT92(IDX1 3)
                                        TO      RECE64-ZAIKAISU
                 END-IF
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    190111690   TO      RECE64-SRYCDTOTAL
      ***        ELSE
      ***           MOVE    190809090   TO      RECE64-SRYCDTOTAL
      ***        END-IF
               WHEN  4
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-ZAITEN
                 MOVE    1              TO      RECE64-MEISAISU
                 IF      FLG-MIJISI2   =   1
                    MOVE    WRK-MIJ-CNT90(IDX1 4)
                                        TO      RECE64-ZAIKAISU
                 ELSE
                    MOVE    WRK-MIJ-CNT92(IDX1 4)
                                        TO      RECE64-ZAIKAISU
                 END-IF
                 MOVE    WRK-SYS-MIJISI-ZAITEN(SYUKEI-IDX3)
                                        TO      RECE64-SYUTEN1
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    190111790   TO      RECE64-SRYCDTOTAL
      ***        ELSE
      ***           MOVE    190809190   TO      RECE64-SRYCDTOTAL
      ***        END-IF
           END-EVALUATE
           MOVE    1                    TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    SPACE                TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           IF      FLG-MIJISI2   =   1
              PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-MIJ-DAY90(IDX1 SYUKEI-IDX3 IDX2)
                                      TO      RECE64-KAISU (1 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
                   IF      RECE64-KAISU(1 IDX2)  NOT = ZERO
                       MOVE     RECE64-HKNCOMBI
                                        TO    RECE64-HKNCOMBI-DAY(IDX2)
                   END-IF
              END-PERFORM
           ELSE
              PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-MIJ-DAY92(IDX1 SYUKEI-IDX3 IDX2)
                                      TO      RECE64-KAISU (1 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
                   IF      RECE64-KAISU(1 IDX2)  NOT = ZERO
                       MOVE     RECE64-HKNCOMBI
                                        TO    RECE64-HKNCOMBI-DAY(IDX2)
                   END-IF
              END-PERFORM
           END-IF
      *
           .
       210216-RECE64-TENSOU2-MIJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       210217-RECE65-TENSOU2-MIJ-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE65-KOHBUNRI
           IF      FLG-MIJISI2   =   1
             COMPUTE WRK-ZAINUM    =  99999960  +  SYUKEI-IDX3
           ELSE
             COMPUTE WRK-ZAINUM    =  99999970  +  SYUKEI-IDX3
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE65-ZAIREN
           MOVE    1                    TO      RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO      RECE65-PTNUM
      *
           MOVE    "00"                 TO      RECE65-SRYKA
           IF      FLG-MIJISI2   =   1
              MOVE    "90"              TO      RECE65-SRYKBN
           ELSE
              MOVE    "92"              TO      RECE65-SRYKBN
           END-IF 
           IF      FLG-MIJISI2   =   1
              MOVE    "900"             TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           ELSE
              MOVE    "920"             TO      RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
           END-IF 
           MOVE    ZERO                 TO      RECE65-JIHIMONEY
      *
           EVALUATE   SYUKEI-IDX3
               WHEN  2
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    "190080570" TO      RECE65-SRYCD(1)
      ***        ELSE
      ***           MOVE    190799770   TO      RECE65-SRYCD(1)
      ***        END-IF
               WHEN  3
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    "190111690" TO      RECE65-SRYCD(1)
      ***        ELSE
      ***           MOVE    190809090   TO      RECE65-SRYCD(1)
      ***        END-IF
               WHEN  4
      ***        IF    RECE62-RJNHKNNUM    =    SPACE
                    MOVE    "190111790" TO      RECE65-SRYCD(1)
      ***        ELSE
      ***           MOVE    190809190   TO      RECE65-SRYCD(1)
      ***        END-IF
           END-EVALUATE
      *
           MOVE    1                    TO  RECE65-SRYSURYO(1)
           MOVE    ZERO                 TO  RECE65-SRYKAISU(1)
           MOVE    SPACE                TO  RECE65-MEISKYFLG(1)
           MOVE    SPACE                TO  RECE65-AUTOKBN(1)
           MOVE    ZERO                 TO  RECE65-INPUTNUM(1)
           MOVE    RECE65-SRYCD(1)      TO  WRK-SRYCD
           MOVE    RECE65-SRYYM         TO  WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO  WK-TAIHI-SRYD
           PERFORM 900-TENSU-TBL-SEC
           MOVE    1                    TO  IDX4
           PERFORM 21020611-RECE65-TENSOU2X-SEC
      *
           MOVE    RECE65-SRYCD(1)     TO  WRK-SRYCD
           COMPUTE RECE64-RUIKEITOTAL  =
                   RECE64-RUIKEITOTAL  +   WRK-SRYCD
           MOVE     ZERO    TO    WRK-FUKA-KINGAKU
           PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                     UNTIL   FUKA-IDX   >    9
             MOVE   WRK-SRYCD(FUKA-IDX:1)
                                     TO  WRK-FUKA-VALUE
             IF  WRK-FUKA-VALUE  =  ZERO
               CONTINUE
             ELSE
               COMPUTE  WRK-FUKA-KINGAKU    =
                        WRK-FUKA-KINGAKU    +
                      ((WRK-FUKA-VALUE^5) * FUKA-IDX)
             END-IF
           END-PERFORM
           COMPUTE  RECE64-RUIKEITOTAL  =
                    RECE64-RUIKEITOTAL  +
                    WRK-FUKA-KINGAKU
      *
           .
       210217-RECE65-TENSOU2-MIJ-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事負担判定
      *****************************************************************
       210224-SKJFTN-HANTEI-SEC                SECTION.
      *
           MOVE   ZERO   TO  FLG-SKJFTNNASI
      *
           IF  (RECE62-HKNCOMBIFLG(IDX1)  =  3                    )
           AND (RECE62-KOHNUMHC(IDX1 1)   =
                "024" OR "079" OR "051" OR "052" OR "015" OR "016"
                                                          OR "054")
             INITIALIZE                  LNK-ORCSJGNGET-REC
             MOVE  RECE62-HOSPNUM    TO  LNK-ORCSJGNGET-HOSPNUM
             MOVE  RECE62-NYUGAIKBN  TO  LNK-ORCSJGNGET-NYUGAIKBN
             MOVE  RECE62-PTID       TO  LNK-ORCSJGNGET-PTID
             MOVE  RECE62-KOHNUMHC(IDX1 1)
                                     TO  LNK-ORCSJGNGET-KOHHKNNUM
             MOVE  RECE62-KOHIDHC(IDX1 1)
                                     TO  LNK-ORCSJGNGET-KOHID
             MOVE  RECE62-SRYYM      TO  LNK-ORCSJGNGET-SRYYM
             MOVE  RECE62-SRYYM      TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
             MOVE  "31"              TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
             CALL  "ORCSJGNGET"      USING
                                     LNK-ORCSJGNGET-REC
                                     SPA-AREA
             IF   LNK-ORCSJGNGET-RC  =  ZERO
               IF  (RECE62-KOHNUMHC(IDX1 1)    =  "024" OR "079")
               AND (LNK-ORCSJGNGET-TAFTNRUIKEI =   ZERO         )
                  MOVE    1     TO    FLG-SKJFTNNASI
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 1)    =  "051"         )
               AND (LNK-ORCSJGNGET-NYUJGNGAK   =   ZERO         )
                  MOVE    1     TO    FLG-SKJFTNNASI
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 1)    =  "015" OR "016")
               AND (LNK-ORCSJGNGET-NYUJGNGAK   =   ZERO         )
               AND (LNK-ORCSJGNGET-TAFTNRUIKEI
                                 NOT = 9999999 AND 999999       )
                  MOVE    1     TO    FLG-SKJFTNNASI
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 1)    = "052"   )
               AND (RECE62-SRYYM               < "201501")
               AND (LNK-ORCSJGNGET-NYUJGNGAK   =  ZERO   )
                  MOVE    1     TO    FLG-SKJFTNNASI
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 1)    = "052"   )
               AND (RECE62-SRYYM              >= "201501")
               AND (LNK-ORCSJGNGET-NYUJGNGAK   =  ZERO   )
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(1))
                 AND (RECE62-KOHFTNJANUM(1)(5:1) =  "7"            )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(2))
                 AND (RECE62-KOHFTNJANUM(2)(5:1) =  "7"            )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(3))
                 AND (RECE62-KOHFTNJANUM(3)(5:1) =  "7"            )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(4))
                 AND (RECE62-KOHFTNJANUM(4)(5:1) =  "7"            )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (LNK-ORCSJGNGET-TAFTNRUIKEI
                                   NOT = 9999999 AND 999999)
                 AND (RECE62-SRYYM              >= "202004")
                   IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(1))
                   AND (RECE62-KOHFTNJANUM(1)(5:1) =  "8"            )
                      MOVE    1     TO    FLG-SKJFTNNASI
                   END-IF
                   IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(2))
                   AND (RECE62-KOHFTNJANUM(2)(5:1) =  "8"            )
                      MOVE    1     TO    FLG-SKJFTNNASI
                   END-IF
                   IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(3))
                   AND (RECE62-KOHFTNJANUM(3)(5:1) =  "8"            )
                      MOVE    1     TO    FLG-SKJFTNNASI
                   END-IF
                   IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(4))
                   AND (RECE62-KOHFTNJANUM(4)(5:1) =  "8"            )
                      MOVE    1     TO    FLG-SKJFTNNASI
                   END-IF
                 END-IF
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 1)    = "054"   )
               AND (RECE62-SRYYM              >= "201501")
               AND (LNK-ORCSJGNGET-NYUJGNGAK   =  ZERO   )
               AND (LNK-ORCSJGNGET-TAFTNRUIKEI
                                 NOT = 9999999 AND 999999)
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(1))
                 AND (RECE62-KOHFTNJANUM(1)(5:3) =  "601" OR "602" )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(2))
                 AND (RECE62-KOHFTNJANUM(2)(5:3) =  "601" OR "602" )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(3))
                 AND (RECE62-KOHFTNJANUM(3)(5:3) =  "601" OR "602" )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(4))
                 AND (RECE62-KOHFTNJANUM(4)(5:3) =  "601" OR "602" )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(1))
                 AND (RECE62-KOHFTNJANUM(1)(5:1) =  "8"            )
                 AND (RECE62-SRYYM              >= "201804"        )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(2))
                 AND (RECE62-KOHFTNJANUM(2)(5:1) =  "8"            )
                 AND (RECE62-SRYYM              >= "201804"        )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(3))
                 AND (RECE62-KOHFTNJANUM(3)(5:1) =  "8"            )
                 AND (RECE62-SRYYM              >= "201804"        )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
                 IF  (RECE62-KOHIDHC(IDX1 1)     =  RECE62-KOHID(4))
                 AND (RECE62-KOHFTNJANUM(4)(5:1) =  "8"            )
                 AND (RECE62-SRYYM              >= "201804"        )
                    MOVE    1     TO    FLG-SKJFTNNASI
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF  ((RECE62-HKNNUM       =   "002"                ) AND
                (RECE62-HOJOKBN      =
                 "1" OR "2" OR "3" OR "A" OR "B" OR "C" OR "D"
                            OR "E" OR "F" OR "G" OR "H" OR "I"))
           OR  ((RECE62-HKNNUM       =
                       "031" OR "032" OR "033" OR "034"       ) AND
                (RECE62-HOJOKBN      =
                                      "2" OR "B" OR "E" OR "H"))
                  MOVE    1     TO    FLG-SKJFTNNASI
           END-IF
      *
           IF ((RECE62-HKNNUMHC(IDX1)        =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 1)  NOT =
                "010" AND "038" AND "024" AND "079" AND
                "051" AND "052" AND "015" AND "016" AND
                "054"                                ) AND
               (RECE62-KOHNUMHC(IDX1 2)      =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 3)      =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 4)      =  SPACE))
           OR ((RECE62-HKNNUMHC(IDX1)    NOT =  SPACE) AND
               (RECE62-SRYYM            >= "201101"  ) AND
               (RECE62-SRYYM            <= "201202"  ) AND
               (WK-GENGAKUKBN            =  3  OR  4 ) AND
               (FLG-SAIGAI-TAISYO            =  1    ))
           OR ((RECE62-HKNNUMHC(IDX1)        =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 1)  NOT =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 2)      =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 3)      =  SPACE) AND
               (RECE62-KOHNUMHC(IDX1 4)      =  SPACE) AND
               (RECE62-SRYYM            >= "201101"  ) AND
               (RECE62-SRYYM            <= "201202"  ) AND
               (WK-GENGAKUKBN            =  3  OR  4 ) AND
               (FLG-SAIGAI-TAISYO            =  1    ))
                  MOVE    1     TO    FLG-SKJFTNNASI
           END-IF
      *
           .
       210224-SKJFTN-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2103-RECE64-HENSYU3-SEC                SECTION.
      *
      *    点滴の計算
      *
           MOVE    ZERO                TO  CNT-ZAIREN
      *
           MOVE    RECE62-HOSPNUM      TO  SPA-HOSPNUM
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE62-HKNCOMBI (IDX1)  =   ZERO
      *
              ADD      1                  TO  CNT-ZAIREN
      *
              PERFORM   21031-RECE62-HENSYU3-IDX-SEC
      *
              INITIALIZE                  ORCSTENTEKAREA
              MOVE    "2"                 TO  ORCSTEN-KBN
              MOVE    RECE62-PTID         TO  ORCSTEN-PTID
              MOVE    RECE62-SRYYM        TO  ORCSTEN-SRYYM
              MOVE    RECE62-HKNCOMBI (IDX1)
                                          TO  ORCSTEN-HKNCOMBI
              CALL    "ORCSTENTEK"        USING
                                          SPA-AREA
                                          ORCSTENTEKAREA
      *
      *       IF      ORCSTEN-ERRCD       =   ZERO
      *
      *           薬剤
                  PERFORM  VARYING  IDY    FROM    1   BY  1
                              UNTIL   IDY     >       31
      *
                    MOVE   SPACE  TO   WRK-FORMALNAME
                    MOVE   ZERO   TO   FLG-SETCOM
                    IF  ORCSTEN-ZAITEN(IDY)  NOT =  ZERO
      *
                       MOVE   1      TO   FLG-SIKIBETU
      *
                       INITIALIZE         WRK-ORCSTEN-TABLE
                       MOVE   ZERO   TO   IDX6
                       PERFORM  VARYING  IDX5    FROM    1   BY  1
                              UNTIL   IDX5     >       50
                                OR    ORCSTEN-SRYCD(IDY IDX5)  = SPACE
                          ADD   1   TO   IDX6
                          MOVE  ORCSTEN-SRYCD(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SRYCD(IDX6)
                          MOVE  ORCSTEN-SURYO(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SURYO(IDX6)
                          IF  ORCSTEN-HAIK-SRYCD(IDY IDX5) NOT = SPACE
                             ADD   1   TO   IDX6
                             MOVE  ORCSTEN-HAIK-SRYCD(IDY IDX5)
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             MOVE  ORCSTEN-HAIK-SURYO(IDY IDX5)
                                       TO   WRK-ORCSTEN-SURYO(IDX6)
                          END-IF 
                          PERFORM  VARYING  IDX9    FROM    1   BY  1
      ***                   UNTIL  IDX9     >      5
                            UNTIL  IDX9     >     20
                              OR   ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                                              = SPACE
                             ADD   1   TO   IDX6
                             IF    ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)(1:1)
                                                  =  "8"
                             AND   ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                              NOT =  "810000001"
                             AND   RECE62-SRYYM  >=  "202204"
                               MOVE  ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             ELSE
                               MOVE  "810000001"
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             END-IF
                             MOVE  1   TO   WRK-ORCSTEN-SURYO(IDX6)
                             MOVE  ORCSTEN-COM-MEI(IDY IDX5 IDX9)
                                       TO   WRK-ORCSTEN-COM-MEI(IDX6)
                                            WRK-ORCSTEN-COM-MEI2(IDX6)
      *
                             IF    ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)(1:1)
                                                  =  "8"
                             AND   ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                              NOT =  "810000001"
                             AND   RECE62-SRYYM  >=  "202204"
                               MOVE  ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                                   TO  WRK-SRYCD
                               MOVE  RECE62-SRYYM  TO  WK-TAIHI-SRYYM
                               MOVE  1             TO  WK-TAIHI-SRYD
                               PERFORM   900-TENSU-TBL-SEC
      *
                               MOVE   ORCSTEN-COM-SRYCD(IDY IDX5 IDX9)
                                                 TO  WRK-TH-SRYCD
                               MOVE   ORCSTEN-COM-RENNUM(IDY IDX5 IDX9)
                                                 TO  WRK-TH-INPUTNUM
                               MOVE   ORCSTEN-COM-INPUTCHI
                                                      (IDY IDX5 IDX9 1)
                                                 TO  WRK-TH-INPUTCHI1
                               MOVE   ORCSTEN-COM-INPUTCHI
                                                      (IDY IDX5 IDX9 2)
                                                 TO  WRK-TH-INPUTCHI2
                               MOVE   ORCSTEN-COM-INPUTCHI
                                                      (IDY IDX5 IDX9 3)
                                                 TO  WRK-TH-INPUTCHI3
                               MOVE   ORCSTEN-COM-INPUTCHI
                                                      (IDY IDX5 IDX9 4)
                                                 TO  WRK-TH-INPUTCHI4
                               MOVE   ORCSTEN-COM-INPUTSTRING
                                                      (IDY IDX5 IDX9)
                                                 TO  WRK-TH-INPUTSTRING
                               PERFORM   21036-COMENT-HENSYU2-SEC
                             END-IF
                          END-PERFORM
                       END-PERFORM
      *
                       PERFORM   21032-RECE64-TENSOU3-SEC
      *
      *                ORCSTEN-COMMNT-GがOCC5からOCC20に拡張された
      *                ため、退避領域WRK-ORCSTEN-Tを拡張したが、
      *                出力は350のまま変更なしとする。
      *                変更した場合、他に影響を及ぼす可能性あり。
      *                最大1100まで退避領域に入る可能性はあるが、
      *                変更しなくても問題ないと推測
                       MOVE      350  TO   IDX5
                       PERFORM   21033-RECE65-TENSOU3-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
      *
                       PERFORM   RECE64-WRITE-SEC
      *
                    END-IF
      *
                  END-PERFORM
      *
      *           器材
                  PERFORM  VARYING  IDY    FROM    1   BY  1
                              UNTIL   IDY     >       50
                                OR    ORCSTEN-KIZ-ZAITEN(IDY)  =  ZERO
      *
                       MOVE   SPACE  TO   WRK-FORMALNAME
                       MOVE   ZERO   TO   FLG-SETCOM
                       MOVE   2      TO   FLG-SIKIBETU
      *
                       INITIALIZE         WRK-ORCSTEN-TABLE
                       MOVE   ZERO   TO   IDX6
                       PERFORM  VARYING  IDX5    FROM    1   BY  1
                              UNTIL   IDX5     >       10
                                OR    ORCSTEN-KIZ-SRYCD(IDY IDX5)
                                                               = SPACE
                          ADD   1   TO   IDX6
                          MOVE  ORCSTEN-KIZ-SRYCD(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SRYCD(IDX6)
                          MOVE  ORCSTEN-KIZ-SURYO(IDY IDX5)  TO  
                                      WRK-ORCSTEN-SURYO(IDX6)
                          PERFORM  VARYING  IDX9    FROM    1   BY  1
      ***                   UNTIL  IDX9     >      5
                            UNTIL  IDX9     >     20
                              OR   ORCSTEN-KIZ-COM-SRYCD(IDY IDX5 IDX9)
                                                              = SPACE
                             ADD   1   TO   IDX6
                             IF    ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)(1:1)
                                                  =  "8"
                             AND   ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)
                                              NOT =  "810000001"
                             AND   RECE62-SRYYM  >=  "202204"
                               MOVE  ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             ELSE
                               MOVE  "810000001"
                                       TO   WRK-ORCSTEN-SRYCD(IDX6)
                             END-IF
                             MOVE  1   TO   WRK-ORCSTEN-SURYO(IDX6)
                             MOVE  ORCSTEN-KIZ-COM-MEI(IDY IDX5 IDX9)
                                       TO   WRK-ORCSTEN-COM-MEI(IDX6)
                                            WRK-ORCSTEN-COM-MEI2(IDX6)
      *
                             IF    ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)(1:1)
                                                  =  "8"
                             AND   ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)
                                              NOT =  "810000001"
                             AND   RECE62-SRYYM  >=  "202204"
                               MOVE  ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)
                                                   TO  WRK-SRYCD
                               MOVE  RECE62-SRYYM  TO  WK-TAIHI-SRYYM
                               MOVE  1             TO  WK-TAIHI-SRYD
                               PERFORM   900-TENSU-TBL-SEC
      *
                               MOVE   ORCSTEN-KIZ-COM-SRYCD
                                                   (IDY IDX5 IDX9)
                                                 TO  WRK-TH-SRYCD
                               MOVE   ORCSTEN-KIZ-RENNUM(IDY IDX5 IDX9)
                                                 TO  WRK-TH-INPUTNUM
                               MOVE   ORCSTEN-KIZ-INPUTCHI
                                                      (IDY IDX5 IDX9 1)
                                                 TO  WRK-TH-INPUTCHI1
                               MOVE   ORCSTEN-KIZ-INPUTCHI
                                                      (IDY IDX5 IDX9 2)
                                                 TO  WRK-TH-INPUTCHI2
                               MOVE   ORCSTEN-KIZ-INPUTCHI
                                                      (IDY IDX5 IDX9 3)
                                                 TO  WRK-TH-INPUTCHI3
                               MOVE   ORCSTEN-KIZ-INPUTCHI
                                                      (IDY IDX5 IDX9 4)
                                                 TO  WRK-TH-INPUTCHI4
                               MOVE   ORCSTEN-KIZ-INPUTSTRING
                                                      (IDY IDX5 IDX9)
                                                 TO  WRK-TH-INPUTSTRING
                               PERFORM   21036-COMENT-HENSYU2-SEC
                             END-IF
                          END-PERFORM
                       END-PERFORM
                       PERFORM  VARYING  IDX5    FROM    1   BY  1
                              UNTIL   IDX5     >       31
                          MOVE  ORCSTEN-KIZ-DAY  (IDY IDX5)  TO  
                                      WRK-ORCSTEN-DAY  (IDX5)
                          MOVE  ORCSTEN-KIZ-DAY2 (IDY IDX5 1)  TO
                                      WRK-ORCSTEN-DAY1 (IDX5)
                          MOVE  ORCSTEN-KIZ-DAY2 (IDY IDX5 2)  TO
                                      WRK-ORCSTEN-DAY2 (IDX5)
                          ADD   ORCSTEN-KIZ-DAY  (IDY IDX5)  TO
                                      WRK-ORCSTEN-ZAIKAISU
                          MOVE  ORCSTEN-KIZ-SRYKA(IDY IDX5)  TO
                                      WRK-ORCSTEN-KIZ-SRYKA(IDX5)
                       END-PERFORM
      *
                       PERFORM   21032-RECE64-TENSOU3-SEC
      *
      *                ORCSTEN-KIZ-COMMNT-GがOCC5からOCC20に拡張された
      *                ため、退避領域WRK-ORCSTEN-Tを拡張したが、
      *                出力は60のまま変更なしとする。
      *                変更した場合、他に影響を及ぼす可能性あり。
      *                最大210まで退避領域に入る可能性はあるが、
      *                変更しなくても問題ないと推測
                       MOVE      60   TO   IDX5
                       PERFORM   21033-RECE65-TENSOU3-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
      *
                       PERFORM   RECE64-WRITE-SEC
      *
                  END-PERFORM
      *
      *       END-IF
      *
           END-PERFORM
      *
      ***
      *
      *    点滴手技加算
      *
           MOVE    ZERO                TO  CNT-ZAIREN
      *
           PERFORM  VARYING  IDX1  FROM  1   BY  1
                     UNTIL   IDX1   >   10
      *
             IF   WRK-TENTEKI2-HKNCOMBI(IDX1)  NOT =  ZERO
      *
               ADD       1             TO  CNT-ZAIREN
      *
               PERFORM   21031-RECE62-HENSYU3-IDX-SEC
      *
               IF   WRK-TENTEKI2-T-ERRCD(IDX1)     =  ZERO
                 PERFORM  VARYING  IDY    FROM    1   BY  1
                           UNTIL   IDY     >     31
                    MOVE    ZERO     TO   FLG-SETCOM
                    IF  WRK-TENTEKI2-T-ZAITEN(IDX1 IDY)  NOT =  ZERO
                       MOVE      3   TO   FLG-SIKIBETU
                       PERFORM   21032X-RECE64-TENSOU3-SEC
                       MOVE      WRK-TENTEKI2-T-SRYCD-X(IDX1 IDY)
                                     TO   WRK-TENTEKI2-SRYCD-X
                       PERFORM   21035-RECE65-TENTEKI2-HEN-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
                       PERFORM   RECE64-WRITE-SEC
                    END-IF
                 END-PERFORM
               END-IF
      *
               IF   WRK-TENTEKI2-C-ERRCD(IDX1)     =  ZERO
                 PERFORM  VARYING  IDY    FROM    1   BY  1
                           UNTIL   IDY     >     31
                    MOVE    ZERO     TO   FLG-SETCOM
                    IF  WRK-TENTEKI2-C-ZAITEN(IDX1 IDY)  NOT =  ZERO
                       MOVE      4   TO   FLG-SIKIBETU
                       PERFORM   21032X-RECE64-TENSOU3-SEC
                       MOVE      WRK-TENTEKI2-C-SRYCD-X(IDX1 IDY)
                                     TO   WRK-TENTEKI2-SRYCD-X
                       PERFORM   21035-RECE65-TENTEKI2-HEN-SEC
                       PERFORM   21034-RECE62-HENSYU3-SEC
                       PERFORM   RECE64-WRITE-SEC
                    END-IF
                 END-PERFORM
               END-IF
      *
             END-IF
      *
           END-PERFORM
      *
           .
       2103-RECE64-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       21031-RECE62-HENSYU3-IDX-SEC               SECTION.
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
           MOVE          ZERO       TO     BUN-IDX6
      ***  IF    (RECE62-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE62-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE62-RJNHKNNUM       NOT =   SPACE)
               MOVE          1          TO     BUN-IDX
               IF   (RECE62-SEIHOFLG             =   "1"  )
               AND  (RECE62-SYUTANARIFLG         =    1   )
               AND  (RECE62-HKNNUMHC(IDX1)   NOT =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 1)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 2)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 3)     =   SPACE)
               AND  (RECE62-KOHNUMHC(IDX1 4)     =   SPACE)
                  MOVE   6          TO     BUN-IDX6
               END-IF
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           IF  RECE62-HENTOTALTEN(2)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(2) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(2)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(1)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(1)
                           MOVE      2       TO     BUN-IDX2
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           MOVE          ZERO       TO     BUN-IDX32
           IF  RECE62-HENTOTALTEN(3)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(3) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(3)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(2)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(2)
                           MOVE      3       TO     BUN-IDX3
                           IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                             =   ZERO
                             MOVE    3       TO     BUN-IDX32
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           MOVE          ZERO       TO     BUN-IDX42
           IF  RECE62-HENTOTALTEN(4)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(4) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(4)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(3)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(3)
                           MOVE      4       TO     BUN-IDX4
                           IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                             =   ZERO
                             MOVE    4       TO     BUN-IDX42
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *    インデックス５
           MOVE          ZERO       TO     BUN-IDX5
           MOVE          ZERO       TO     BUN-IDX52
           IF  RECE62-HENTOTALTEN(5)       =      ZERO
               CONTINUE
           ELSE
             IF ( RECE62-SRYYM    >=    "200804"                    )
             OR ((RECE62-SRYYM    <     "200804"                   ) AND
                 (RECE62-HENTOTALTEN(5) NOT = ZERO                 ) AND
                 (RECE62-HENTOTALTEN(1) NOT = RECE62-HENTOTALTEN(5)))
                   MOVE       IDX1              TO   HC-IDX
                   PERFORM    VARYING   IDX2    FROM   1   BY   1
                      UNTIL   (IDX2      >       4)
                    IF     RECE62-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE62-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE62-KOHNUM(4)
                      AND  RECE62-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE62-KOHID(4)
                           MOVE      5       TO     BUN-IDX5
                           IF   RECE62-SKYHENTEN-FLG(HC-IDX IDX2)
                                                             =   ZERO
                             MOVE    5       TO     BUN-IDX52
                           END-IF
                      END-IF
                    END-IF
                   END-PERFORM
             END-IF
           END-IF
      *
           .                                           
      *
       21031-RECE62-HENSYU3-IDX-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21032-RECE64-TENSOU3-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    "33"                 TO      RECE64-SRYKBN
           MOVE    SPACE                TO      RECE64-ZAISKBKBN
           IF    FLG-SIKIBETU  =  1
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99997000
                                   +  (WRK-KEISAN + IDY)
           ELSE
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  50) -  50
             COMPUTE WRK-ZAINUM    =  99997400
                                   +  (WRK-KEISAN + IDY)
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           IF    FLG-SIKIBETU  =  1
             MOVE  ORCSTEN-YK-SRYKA(IDY)
                                        TO      RECE64-SRYKA
           ELSE
             PERFORM  VARYING  IDX2  FROM  1  BY  1
                       UNTIL   IDX2   >   31
               IF   WRK-ORCSTEN-DAY(IDX2)  NOT =   ZERO
                  MOVE  WRK-ORCSTEN-KIZ-SRYKA(IDX2)
                                        TO      RECE64-SRYKA
                  MOVE  31              TO      IDX2
               END-IF
             END-PERFORM
           END-IF
      *
           MOVE    RECE62-HKNCOMBI (IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
           IF    FLG-SIKIBETU  =  1
             MOVE  ORCSTEN-ZAITEN(IDY)  TO      RECE64-ZAITEN
           ELSE
             MOVE  ORCSTEN-KIZ-ZAITEN(IDY)  
                                        TO      RECE64-ZAITEN
           END-IF
           MOVE    ZERO                 TO      RECE64-SRYCDTOTAL
           MOVE    ZERO                 TO      RECE64-SURYOUTOTAL
           MOVE    ZERO                 TO      RECE64-MEISAISU
           IF    FLG-SIKIBETU  =  1
             MOVE  1                    TO      RECE64-ZAIKAISU
           ELSE
             MOVE  WRK-ORCSTEN-ZAIKAISU TO      RECE64-ZAIKAISU
           END-IF
           MOVE    ZERO                 TO      RECE64-SYUTEN1
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           IF    FLG-SIKIBETU  =  1
             MOVE  ORCSTEN-ZAITEN(IDY)  TO      RECE64-YKZTEN
             MOVE  ZERO                 TO      RECE64-KIZAITEN
           ELSE
             MOVE  ZERO                 TO      RECE64-YKZTEN
             MOVE  ORCSTEN-KIZ-ZAITEN(IDY)
                                        TO      RECE64-KIZAITEN
           END-IF
           MOVE    SPACE                TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
      *
           IF    FLG-SIKIBETU  =  1
             MOVE    1                  TO      RECE64-KAISU (1 IDY)
             IF  ORCSTEN-DOU-ZAITEN(IDY 1)  NOT = ZERO
               MOVE     1               TO      RECE64-KAISU (2 IDY)
             ELSE
               IF  ORCSTEN-DOU-ZAITEN(IDY 2)  NOT = ZERO
                 MOVE   1               TO      RECE64-KAISU (3 IDY)
               END-IF
             END-IF
             MOVE    IDY                TO      WK-TAIHI-DAY
             IF      RECE64-KAISU(1 IDY)  NOT = ZERO
               MOVE  RECE64-HKNCOMBI    TO      RECE64-HKNCOMBI-DAY(IDY)
             END-IF
           ELSE
             MOVE        ZERO           TO      WK-TAIHI-DAY
             MOVE        ZERO           TO      WK-TAIHI-FLG
             PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    WRK-ORCSTEN-DAY(IDX2)  TO
                                            RECE64-KAISU (1 IDX2)
                   MOVE    WRK-ORCSTEN-DAY1(IDX2) TO
                                            RECE64-KAISU (2 IDX2)
                   MOVE    WRK-ORCSTEN-DAY2(IDX2) TO
                                            RECE64-KAISU (3 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE64-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
                   IF      RECE64-KAISU(1 IDX2)  NOT = ZERO
                       MOVE     RECE64-HKNCOMBI
                                        TO  RECE64-HKNCOMBI-DAY(IDX2)
                   END-IF
             END-PERFORM
           END-IF
           .
       21032-RECE64-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21032X-RECE64-TENSOU3-SEC                SECTION.
      *
           PERFORM 500-RECE64-KEY-HENSYU-SEC
           MOVE    ZERO                 TO      RECE64-KOHBUNRI
           MOVE    "33"                 TO      RECE64-SRYKBN
           MOVE    SPACE                TO      RECE64-ZAISKBKBN
           IF    FLG-SIKIBETU  =  3
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995000
                                   +  (WRK-KEISAN + IDY)
           ELSE
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995400
                                   +  (WRK-KEISAN + IDY)
           END-IF
           MOVE    WRK-ZAINUM           TO      RECE64-ZAINUM
           MOVE    CNT-ZAIREN           TO      RECE64-ZAIREN
           MOVE    RECE62-PTNUM         TO      RECE64-PTNUM
      *
           IF    FLG-SIKIBETU  =  3
             MOVE  WRK-TENTEKI2-T-SRYKA(IDX1 IDY)
                                        TO      RECE64-SRYKA
           ELSE
             MOVE  WRK-TENTEKI2-C-SRYKA(IDX1 IDY)
                                        TO      RECE64-SRYKA
           END-IF
      *
           MOVE    RECE62-HKNCOMBI (IDX1)
                                        TO      RECE64-HKNCOMBI
           MOVE    SPACE                TO      RECE64-JIHOKBN
      *
           IF    FLG-SIKIBETU  =  3
             MOVE  WRK-TENTEKI2-T-ZAITEN(IDX1 IDY)
                                        TO      RECE64-ZAITEN
                                                RECE64-SYUTEN1
           ELSE
             MOVE  WRK-TENTEKI2-C-ZAITEN(IDX1 IDY)
                                        TO      RECE64-ZAITEN
                                                RECE64-SYUTEN1
           END-IF
           MOVE    1                    TO      RECE64-ZAIKAISU
      *
           MOVE    ZERO                 TO      RECE64-SYUTEN2
           MOVE    ZERO                 TO      RECE64-YKZTEN
           MOVE    ZERO                 TO      RECE64-KIZAITEN
           MOVE    SPACE                TO      RECE64-DRCD
           MOVE    SPACE                TO      RECE64-ZAIREQFLG
           MOVE    ZERO                 TO      RECE64-TEIGENRATE
      *
           MOVE    1                    TO      RECE64-KAISU (1 IDY)
           IF    FLG-SIKIBETU  =  3
             IF    WRK-TENTEKI2-T-SAINYUIN(IDX1 IDY) = SPACE
               MOVE    1                TO      RECE64-KAISU (2 IDY)
             ELSE
               MOVE    1                TO      RECE64-KAISU (3 IDY)
             END-IF
           ELSE
             IF    WRK-TENTEKI2-C-SAINYUIN(IDX1 IDY) = SPACE
               MOVE    1                TO      RECE64-KAISU (2 IDY)
             ELSE
               MOVE    1                TO      RECE64-KAISU (3 IDY)
             END-IF
           END-IF
           MOVE    IDY                  TO      WK-TAIHI-DAY
           IF      RECE64-KAISU(1 IDY)  NOT = ZERO
             MOVE  RECE64-HKNCOMBI      TO      RECE64-HKNCOMBI-DAY(IDY)
           END-IF
           .
       21032X-RECE64-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21033-RECE65-TENSOU3-SEC                SECTION.
      *
           MOVE    1                       TO   IDX2
           MOVE    ZERO                    TO   WRK-RENNUM
           MOVE    ZERO                    TO   WRK-TANICD
           MOVE    ZERO                    TO   WRK-TANIMOJISU
           MOVE    SPACE                   TO   WRK-TANINAME
           MOVE    ZERO                    TO   WRK-KZI058-TEN
           MOVE    ZERO                    TO   WRK-KZI058-TANICD
           MOVE    ZERO                    TO   WRK-KZI058-TANIMOJISU
           MOVE    SPACE                   TO   WRK-KZI058-TANINAME
      *
           MOVE    ZERO                    TO   WRK-SRYSURYO
           MOVE    ZERO                    TO   WRK-SRYSURYO2
      *
           PERFORM
                  UNTIL     (IDX2      >   IDX5)    OR
                            (WRK-ORCSTEN-SRYCD(IDX2)  =   SPACE)
      *
             PERFORM 500-RECE65-KEY-HENSYU-SEC
              MOVE    ZERO                 TO   RECE65-KOHBUNRI
              IF    FLG-SIKIBETU  =  1
                COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
                COMPUTE WRK-ZAINUM    =  99997000
                                      +  (WRK-KEISAN + IDY)
              ELSE
                COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  50) -  50
                COMPUTE WRK-ZAINUM    =  99997400
                                      +  (WRK-KEISAN + IDY)
              END-IF
              MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
              MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
              ADD     1                    TO   WRK-RENNUM
              MOVE    WRK-RENNUM           TO   RECE65-RENNUM
              MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
              MOVE    RECE64-SRYKA         TO   RECE65-SRYKA
              MOVE    "33"                 TO   RECE65-SRYKBN
              MOVE    "330"                TO   RECE65-SRYSYUKBN
                                                RECE64-SRYSYUKBN
              MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
              MOVE    ZERO                 TO      IDX4
              PERFORM
                     UNTIL  (IDX4      >=   5  )    OR
                            (IDX2      >   IDX5)    OR
                            (WRK-ORCSTEN-SRYCD(IDX2)  =   SPACE)
      *
                IF   WRK-ORCSTEN-SRYCD(IDX2)(1:1) =   "0" OR  "6" OR  
                                                      "7" OR  "8"
      *
                  ADD   1                   TO  IDX4    
      *
                  MOVE  WRK-ORCSTEN-SRYCD(IDX2) 
                                            TO  RECE65-SRYCD(IDX4)
                  MOVE  WRK-ORCSTEN-SURYO(IDX2) 
                                            TO  RECE65-SRYSURYO(IDX4)
                  MOVE  ZERO                TO  RECE65-SRYKAISU(IDX4)
                  MOVE  SPACE               TO  RECE65-MEISKYFLG(IDX4)
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)  =  "099309901"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"    )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008"  )
                    MOVE  "2"               TO  RECE65-MEISKYFLG(IDX4)
                  END-IF
                  MOVE  SPACE               TO  RECE65-AUTOKBN(IDX4)
                  MOVE  ZERO                TO  RECE65-INPUTNUM(IDX4)
                  MOVE  WRK-ORCSTEN-SRYCD(IDX2) 
                                            TO  WRK-SRYCD
                  MOVE  RECE65-SRYYM        TO  WK-TAIHI-SRYYM
                  MOVE  WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
                  PERFORM    900-TENSU-TBL-SEC
                  IF  WRK-ORCSTEN-SRYCD(IDX2)  =  "099309901"
                    IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO
                      COMPUTE  WRK-SRYSURYO  =  WRK-SRYSURYO2
                                             -  RECE65-SRYSURYO(IDX4)
                      MOVE   WRK-TANICD     TO  RECE65-TANICD(IDX4)
                      MOVE   WRK-TANIMOJISU TO  RECE65-TANIMOJISU(IDX4)
                      MOVE   WRK-TANINAME   TO  RECE65-TANINAME(IDX4)
                    ELSE
                      MOVE   "1"            TO  RECE65-RECEDENFLG(IDX4)
                      MOVE   "1"            TO  RECE65-RECEPTFLG(IDX4)
                    END-IF
                  ELSE
                      COMPUTE WRK-SRYSURYO2  =  WRK-ORCSTEN-SURYO(IDX2)
                                             +  0.99999
                      IF   TNS-TANICD  NOT = SPACE AND "000"
                       MOVE TNS-TANICD      TO  RECE65-TANICD(IDX4)
                                                WRK-TANICD
                      END-IF
                      MOVE  TNS-TANIMOJISU  TO  RECE65-TANIMOJISU(IDX4)
                                                WRK-TANIMOJISU
                      MOVE  TNS-TANINAME    TO  RECE65-TANINAME(IDX4)
                                                WRK-TANINAME
                  END-IF
                  MOVE  TNS-TENSIKIBETU     TO  RECE65-TENSIKIBETU(IDX4)
                  MOVE  TNS-TEN             TO  RECE65-TEN(IDX4)
                  MOVE  TNS-NYUTENTTLKBN    TO  RECE65-TENTTLKBN(IDX4)
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008")
                     MOVE   ZERO            TO  RECE65-YUKOKETA(IDX4)
                  ELSE
                     MOVE   TNS-YUKOKETA    TO  RECE65-YUKOKETA(IDX4)
                  END-IF
                  MOVE  TNS-DATAKBN         TO  RECE65-DATAKBN (IDX4)
                  MOVE  TNS-HOUKNSKBN       TO  RECE65-HOUKNSKBN(IDX4)
                  MOVE  TNS-KNSJISKBN       TO  RECE65-KNSJISKBN(IDX4)
                  MOVE  TNS-CDKBN-KBN       TO  RECE65-CDKBN-KBN(IDX4)
                  MOVE  TNS-CDKBN-SYO       TO  RECE65-CDKBN-SYO(IDX4)
                  MOVE  TNS-CDKBN-BU        TO  RECE65-CDKBN-BU(IDX4)
                  MOVE  TNS-CDKBN-KBNNUM   
                                      TO RECE65-CDKBN-KBNNUM(IDX4)
                  MOVE  TNS-CDKBN-KBNNUM-EDA
                                      TO RECE65-CDKBN-KBNNUM-EDA(IDX4)
                  MOVE  TNS-CDKBN-KOUBAN
                                      TO RECE65-CDKBN-KOUBAN(IDX4)
                  MOVE  TNS-KOUHYOJYUNNUM  
                                      TO RECE65-KOUHYOJYUNNUM(IDX4)
      *
                  MOVE  TNS-SRYSYUKBN TO RECE65-SRYSYUKBN-X(IDX4)
                  MOVE  TNS-KOKUJISKBKBN1
                                      TO RECE65-KOKUJISKBKBN1(IDX4)
                  MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE65-KOKUJISKBKBN2(IDX4)
                  MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE65-TUSOKUGAIKBN (IDX4)
                  MOVE    TNS-TIMEKSNKBN
                                      TO RECE65-TIMEKSNKBN   (IDX4)
                  MOVE  TNS-KZMCOMPSIKIBETU
                                      TO RECE65-KZMCOMPSIKIBETU(IDX4)
                  MOVE  TNS-CHUKSNCD  TO RECE65-CHUKSNCD(IDX4)
                  MOVE  TNS-CHUKSNTUBAN
                                      TO RECE65-CHUKSNTUBAN(IDX4)
                  MOVE  TNS-KENTAICOMMENT
                                      TO RECE65-KENTAICOMMENT(IDX4)
                  MOVE  TNS-KNSJISGRPKBN
                                      TO RECE65-KNSJISGRPKBN(IDX4)
                  MOVE  TNS-TOKUKIZAISBT1
                                      TO RECE65-TOKUKIZAISBT1(IDX4)
                  MOVE  TNS-SANSOKBN  TO RECE65-SANSOKBN     (IDX4)
                  IF      TNS-SRYCD (1:2)   =   "84"
                      PERFORM VARYING IDYY    FROM    1   BY  1
                              UNTIL   IDYY    >       10
                          MOVE    TNS-SSTKIJUNCD (IDYY)
                                              TO  RECE65-SSTKIJUNCD
                                                   (IDX4 IDYY)
                      END-PERFORM
                  END-IF
      *
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008")
                     MOVE   WRK-ORCSTEN-COM-MEI(IDX2)
                                      TO RECE65-INPUTCOMENT(IDX4)
                     MOVE   WRK-ORCSTEN-COM-MEI2(IDX2)
                                      TO RECE65-NAME(IDX4)
                  ELSE
                     MOVE   TNS-NAME  TO RECE65-NAME(IDX4)
                                         RECE65-INPUTCOMENT(IDX4)
                  END-IF
      *
                  IF  WRK-ORCSTEN-SRYCD(IDX2)  =  "099309901"
                     IF  RECE65-SRYSURYO(IDX4)  NOT = ZERO
                       PERFORM  2101213-RECE65-SURYO-HEN-SEC
      *
                       MOVE    SPACE      TO  RECE65-NAME(IDX4)
                       MOVE    SPACE      TO  RECE65-INPUTCOMENT(IDX4)
      ***              STRING  TNS-NAME          DELIMITED  BY  " "
      ***                      "　"              DELIMITED  BY  SIZE
      ***                      WRK-SRYSURYOW     DELIMITED  BY  " "
      ***                      RECE65-TANINAME(IDX4)
      ***                                        DELIMITED  BY  " "
      ***                      INTO              RECE65-NAME(IDX4)
      ***              END-STRING
                       STRING  "（使用量　"      DELIMITED  BY  SIZE
                               WRK-SRYSURYOW     DELIMITED  BY  " "
                               RECE65-TANINAME(IDX4)
                                                 DELIMITED  BY  " "
                               "　残量廃棄）"    DELIMITED  BY  SIZE
                               INTO              RECE65-NAME(IDX4)
                       END-STRING
                       MOVE  RECE65-NAME(IDX4)
                                          TO  RECE65-INPUTCOMENT(IDX4)
      *
      ***              MOVE  "810000001"  TO  RECE65-SRYCD(IDX4)
                       MOVE  ZERO         TO  RECE65-SRYSURYO(IDX4)
                       MOVE  ZERO         TO  RECE65-TANICD(IDX4)
                       MOVE  ZERO         TO  RECE65-TANIMOJISU(IDX4)
                       MOVE  SPACE        TO  RECE65-TANINAME(IDX4)
                       MOVE  ZERO         TO  RECE65-YUKOKETA(IDX4)
                     END-IF
                  END-IF
      *
                  IF   WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "058"
                    MOVE  TNS-FORMALYUKOKETA TO  RECE65-YUKOKETA(IDX4)
                    MOVE  TNS-FORMALNAME     TO  RECE65-NAME(IDX4)
                                                 WRK-FORMALNAME
                    MOVE  "1"                TO  RECE65-RECEDENFLG(IDX4)
      *
                    MOVE     TNS-TEN         TO  WRK-KZI058-TEN
                    IF   TNS-TANICD  NOT = SPACE AND "000"
                       MOVE  TNS-TANICD      TO  WRK-KZI058-TANICD
                       MOVE  TNS-TANIMOJISU  TO  WRK-KZI058-TANIMOJISU
                       MOVE  TNS-TANINAME    TO  WRK-KZI058-TANINAME
                    END-IF
                    MOVE     ZERO            TO  RECE65-TEN(IDX4)
                    MOVE     ZERO            TO  RECE65-TANICD(IDX4)
                    MOVE     ZERO            TO  RECE65-TANIMOJISU(IDX4)
                    MOVE     SPACE           TO  RECE65-TANINAME(IDX4)
                  END-IF
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "7")
                  AND (WRK-FORMALNAME     NOT =  SPACE      )
                    MOVE  WRK-FORMALNAME  TO  RECE65-RECEDENNAME(IDX4)
                    MOVE  "1"             TO  RECE65-RECEHENFLG(IDX4)
                    MOVE  SPACE           TO  WRK-FORMALNAME
                    IF    WRK-KZI058-TEN  NOT = ZERO
                       MOVE   WRK-KZI058-TEN
                                          TO  RECE65-TEN(IDX4)
                    END-IF
                    IF   (RECE65-TANICD(IDX4)    = ZERO)
                    AND  (WRK-KZI058-TANICD  NOT = ZERO)
                       MOVE   WRK-KZI058-TANICD
                                          TO  RECE65-TANICD(IDX4)
                       MOVE   WRK-KZI058-TANIMOJISU
                                          TO  RECE65-TANIMOJISU(IDX4)
                       MOVE   WRK-KZI058-TANINAME
                                          TO  RECE65-TANINAME(IDX4)
                    END-IF
                  END-IF
      *
                  IF   RECE65-YUKOKETA(IDX4)  =  ZERO
                     PERFORM   VARYING   IDW   FROM   300   BY  -1
                                UNTIL    IDW   <   1
                       IF   RECE65-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE65-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                     END-PERFORM
                  END-IF
      *
                  IF  (WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-ORCSTEN-SRYCD(IDX2)(1:3)  =   "008")
                        MOVE     "1"             TO  RECE64-COMCDFLG
                  END-IF
      *
                  MOVE  WRK-ORCSTEN-SRYCD(IDX2)  TO  WRK-SRYCD
                  COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                              +  WRK-SRYCD
                  COMPUTE  RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                              +  WRK-ORCSTEN-SURYO(IDX2)
                  COMPUTE  RECE64-MEISAISU    =  RECE64-MEISAISU
                                              +  1
      *
                  MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                  PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                            UNTIL   FUKA-IDX   >    9
                    MOVE   WRK-ORCSTEN-SRYCD(IDX2)(FUKA-IDX:1)
                                            TO  WRK-FUKA-VALUE
                    IF  WRK-FUKA-VALUE  =  ZERO
                      CONTINUE
                    ELSE
                      COMPUTE  RECE64-RUIKEITOTAL  =
                               RECE64-RUIKEITOTAL  +
                             ( WRK-FUKA-VALUE    * WRK-SRYCD)
                      COMPUTE  WRK-FUKA-KINGAKU    =
                               WRK-FUKA-KINGAKU    +
                             ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                   * WRK-ORCSTEN-SURYO(IDX2))
                    END-IF
                  END-PERFORM
                  COMPUTE  RECE64-RUIKEITOTAL  =
                           RECE64-RUIKEITOTAL  +
                           WRK-FUKA-KINGAKU
      *
      *           特定器材の単価編集
                  IF      WRK-ORCSTEN-SRYCD(IDX2)(1:1)  =   "7"
                    IF  WRK-ORCSTEN-SRYCD(IDX2)       =
                                       "799990070"            OR
                                       "770020070"            OR
                                       "770030070"
                      CONTINUE
                    ELSE
                      IF      RECE65-TEN(IDX4)  =   ZERO
                        CONTINUE
                      ELSE
                        PERFORM 2101212-RECE65-TANKA-HEN-SEC
                        COMPUTE IDW =   RECE65-YUKOKETA(IDX4)  *  2
                                    +   3
                        MOVE    WRK-CHAR-N (1:WRK-CHAR-N-CNT)
                                   TO   RECE65-NAME(IDX4)(IDW:)
                        COMPUTE RECE65-YUKOKETA(IDX4)  =
                                RECE65-YUKOKETA(IDX4)  +
                                  1                    +
                               (WRK-CHAR-N-CNT  /  2)
                      END-IF
                    END-IF
                  END-IF
      **
                  IF   RECE65-MEISKYFLG(IDX4)  =  "2"
                     IF   (FLG-SETCOM              =  1   )
                     AND  (RECE65-RECEDENFLG(IDX4) = SPACE)
                        MOVE  "1"            TO  RECE64-SETCOMFLG
                     ELSE
                        MOVE  SPACE          TO  RECE65-MEISKYFLG(IDX4)
                     END-IF
                  ELSE
                     IF   (RECE65-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
                     OR   (RECE65-SRYCD(IDX4)(1:3) = "059"            )
                        MOVE   1             TO  FLG-SETCOM
                     END-IF
                  END-IF
      **
                END-IF  
      *
                ADD        1                TO  IDX2
      *
              END-PERFORM
      *
              PERFORM   RECE65-WRITE-SEC
      *
           END-PERFORM
      *
           .
       21033-RECE65-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21035-RECE65-TENTEKI2-HEN-SEC                SECTION.
      *
           INITIALIZE             WRK-TENTEKI2-SRYCD2-X
      *
           MOVE      ZERO    TO   IDX4
           PERFORM  VARYING  IDX2   FROM    1    BY   1
                     UNTIL  (IDX2                     >      5  )
                       OR   (WRK-TENTEKI2-SRYCD(IDX2)  =   SPACE)
                       OR   (IDX4                     >=   100  )
               ADD    1      TO   IDX4
               MOVE   WRK-TENTEKI2-SRYCD(IDX2)
                             TO   WRK-TENTEKI2-SRYCD2(IDX4)
               PERFORM  VARYING  IDX5   FROM    1    BY   1
                         UNTIL  (IDX5                       >     5  )
                           OR   (WRK-TENTEKI2-COM-SRYCD(IDX2 IDX5)
                                                             =  SPACE)
                           OR   (IDX4                       >=  100  )
                     ADD    1   TO   IDX4
      ***            MOVE  "810000001"
                     MOVE  WRK-TENTEKI2-COM-SRYCD(IDX2 IDX5)
                                TO   WRK-TENTEKI2-SRYCD2(IDX4)
                     MOVE  WRK-TENTEKI2-COM-ZAINUM(IDX2 IDX5)
                                TO   WRK-TENTEKI2-ZAINUM2(IDX4)
                     MOVE  WRK-TENTEKI2-COM-RENNUM(IDX2 IDX5)
                                TO   WRK-TENTEKI2-RENNUM2(IDX4)
                     MOVE  WRK-TENTEKI2-COM-FLG(IDX2 IDX5)
                                TO   WRK-TENTEKI2-COM-FLG2(IDX4)
                     MOVE  WRK-TENTEKI2-COM-MOJI(IDX2 IDX5)
                                TO   WRK-TENTEKI2-COM-MOJI2(IDX4)
               END-PERFORM
           END-PERFORM
      *
           MOVE    1                       TO   IDX2
           MOVE    ZERO                    TO   WRK-RENNUM
      *
           PERFORM   UNTIL  (WRK-TENTEKI2-SRYCD2(IDX2)  =   SPACE)
                      OR    (IDX2                       >   100  )
      *
              PERFORM   21033X-RECE65-TENSOU3-SEC
      *
           END-PERFORM
      *
           .
       21035-RECE65-TENTEKI2-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       21033X-RECE65-TENSOU3-SEC                SECTION.
      *
           PERFORM 500-RECE65-KEY-HENSYU-SEC
           MOVE    ZERO                 TO   RECE65-KOHBUNRI
           IF    FLG-SIKIBETU  =  3
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995000
                                   +  (WRK-KEISAN + IDY)
           ELSE
             COMPUTE WRK-KEISAN    =  (CNT-ZAIREN *  31) -  31
             COMPUTE WRK-ZAINUM    =  99995400
                                   +  (WRK-KEISAN + IDY)
           END-IF
           MOVE    WRK-ZAINUM           TO   RECE65-ZAINUM
           MOVE    CNT-ZAIREN           TO   RECE65-ZAIREN
           ADD     1                    TO   WRK-RENNUM
           MOVE    WRK-RENNUM           TO   RECE65-RENNUM
           MOVE    RECE62-PTNUM         TO   RECE65-PTNUM
      *
           MOVE    RECE64-SRYKA         TO   RECE65-SRYKA
           MOVE    "33"                 TO   RECE65-SRYKBN
           IF    FLG-SIKIBETU  =  3
              MOVE    "330"             TO   RECE65-SRYSYUKBN
                                             RECE64-SRYSYUKBN
           ELSE
              MOVE    "340"             TO   RECE65-SRYSYUKBN
                                             RECE64-SRYSYUKBN
           END-IF
           MOVE    ZERO                 TO   RECE65-JIHIMONEY
      *
           MOVE    ZERO                 TO   IDX4
           PERFORM   UNTIL  (WRK-TENTEKI2-SRYCD2(IDX2)  =   SPACE)
                      OR    (IDX4                      >=     5  )
                      OR    (IDX2                      >    100  )
      *
                  ADD   1                   TO  IDX4
      *
                  MOVE  WRK-TENTEKI2-SRYCD2(IDX2)
                                            TO  RECE65-SRYCD(IDX4)
                  MOVE  1                   TO  RECE65-SRYSURYO(IDX4)
                  MOVE  ZERO                TO  RECE65-SRYKAISU(IDX4)
                  MOVE  SPACE               TO  RECE65-MEISKYFLG(IDX4)
                  IF   WRK-TENTEKI2-COM-FLG2(IDX2) = "1"
                    MOVE  "2"               TO  RECE65-MEISKYFLG(IDX4)
                  END-IF
                  MOVE  SPACE               TO  RECE65-AUTOKBN(IDX4)
                  MOVE  ZERO                TO  RECE65-INPUTNUM(IDX4)
                  MOVE  WRK-TENTEKI2-SRYCD2(IDX2)
                                            TO  WRK-SRYCD
                  MOVE  RECE65-SRYYM        TO  WK-TAIHI-SRYYM
                  MOVE  WK-TAIHI-DAY        TO  WK-TAIHI-SRYD
                  PERFORM 900-TENSU-TBL-SEC
                  PERFORM 21020611-RECE65-TENSOU2X-SEC
                  IF  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-TENTEKI2-SRYCD2(IDX2)(1:3)  =   "008")
                     MOVE   ZERO            TO  RECE65-YUKOKETA(IDX4)
                  END-IF
                  IF      TNS-SRYCD (1:2)   =   "84"
                      PERFORM VARYING IDYY    FROM    1   BY  1
                              UNTIL   IDYY    >       10
                         MOVE    TNS-SSTKIJUNCD (IDYY)
                                              TO  RECE65-SSTKIJUNCD
                                                   (IDX4 IDYY)
                      END-PERFORM
                  END-IF
      *
                  MOVE   WRK-TENTEKI2-SRYCD2(IDX2)
                                              TO  WRK-TH-SRYCD
                  MOVE   WRK-TENTEKI2-RENNUM2(IDX2)
                                              TO  WRK-TH-INPUTNUM
                  MOVE   RECE62-HOSPNUM       TO  WRK-TH-HOSPNUM
                  MOVE   RECE62-PTID          TO  WRK-TH-PTID
                  MOVE   WRK-TENTEKI2-ZAINUM2(IDX2)
                                              TO  WRK-TH-ZAINUM
                  MOVE   "33"                 TO  WRK-TH-SRYKBN
      *           コメント編集
                  PERFORM   2101218-COMENT-HENSYU-SEC
                  IF   (RECE62-SRYYM           >= "201810")
                  AND  (RECE62-SRYYM           <= "202003")
                  AND  (WRK-TENTEKI2-SRYCD2(IDX2)(1:4)
                                                = "8201"  )
                    MOVE   "1"   TO  RECE64-SENTAKUCOMFLG
                  END-IF
                  IF   (RECE62-SRYYM                  >= "202004")
                  AND  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1) = "8"     )
                  AND  (WRK-TENTEKI2-SRYCD2(IDX2)(4:1) = "1"     )
                    MOVE   "1"   TO  RECE64-SENTAKUCOMFLG
                  END-IF
                  IF   (RECE62-SRYYM                  >= "202204")
                  AND  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1) = "8"     )
                  AND  (WRK-TENTEKI2-SRYCD2(IDX2)(4:1) = "6"     )
                    MOVE   "1"   TO  RECE64-SENTAKUCOMFLG
                  END-IF
      *
                  IF   RECE65-YUKOKETA(IDX4)  =  ZERO
                     PERFORM   VARYING   IDW   FROM   300   BY  -1
                                UNTIL    IDW   <   1
                       IF   RECE65-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE65-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                     END-PERFORM
                  END-IF
      *
                  IF  (WRK-TENTEKI2-SRYCD2(IDX2)(1:1)  =   "8"  )
                  OR  (WRK-TENTEKI2-SRYCD2(IDX2)(1:3)  =   "008")
                        MOVE     "1"             TO  RECE64-COMCDFLG
                  END-IF
      *
                  MOVE  WRK-TENTEKI2-SRYCD2(IDX2)  TO  WRK-SRYCD
                  COMPUTE  RECE64-SRYCDTOTAL  =  RECE64-SRYCDTOTAL
                                              +  WRK-SRYCD
                  COMPUTE  RECE64-SURYOUTOTAL =  RECE64-SURYOUTOTAL
                                              +  1
                  COMPUTE  RECE64-MEISAISU    =  RECE64-MEISAISU
                                              +  1
      *
                  MOVE  ZERO          TO WRK-FUKA-KINGAKU
                  PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                            UNTIL   FUKA-IDX   >    9
                    MOVE   WRK-TENTEKI2-SRYCD2(IDX2)(FUKA-IDX:1)
                                            TO  WRK-FUKA-VALUE
                    IF  WRK-FUKA-VALUE  =  ZERO
                      CONTINUE
                    ELSE
                      COMPUTE  RECE64-RUIKEITOTAL  =
                               RECE64-RUIKEITOTAL  +
                             ( WRK-FUKA-VALUE    * WRK-SRYCD)
                      COMPUTE  WRK-FUKA-KINGAKU    =
                               WRK-FUKA-KINGAKU    +
                             ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                 * 1)
                    END-IF
                  END-PERFORM
                  COMPUTE  RECE64-RUIKEITOTAL  =
                           RECE64-RUIKEITOTAL  +
                           WRK-FUKA-KINGAKU
      *
                  IF   RECE65-MEISKYFLG(IDX4)  =  "2"
                     IF   (FLG-SETCOM              =  1   )
                     AND  (RECE65-RECEDENFLG(IDX4) = SPACE)
                        MOVE  "1"            TO  RECE64-SETCOMFLG
                     ELSE
                        MOVE  SPACE          TO  RECE65-MEISKYFLG(IDX4)
                     END-IF
                  ELSE
                     IF   (RECE65-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
                     OR   (RECE65-SRYCD(IDX4)(1:3) = "059"            )
                        MOVE   1             TO  FLG-SETCOM
                     END-IF
                  END-IF
      *
                  ADD        1               TO  IDX2
      *
           END-PERFORM
      *
           IF     IDX4    NOT =  ZERO
              PERFORM   RECE65-WRITE-SEC
           END-IF
      *
           .
       21033X-RECE65-TENSOU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       21034-RECE62-HENSYU3-SEC               SECTION.
      *
      *    その他注射のレセ点数欄の編集
           ADD   RECE64-ZAIKAISU    TO   RECE62-KAISU(12)
      *
           IF    BUN-IDX        =   1
                 COMPUTE   RECE62-TENSU(12 BUN-IDX)  =
                           RECE62-TENSU(12 BUN-IDX)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-TENSU(12 BUN-IDX)  =
                           RECE6C-TENSU(12 BUN-IDX)  +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
           END-IF
           IF    BUN-IDX2       =   2
                 COMPUTE   RECE62-TENSU(12 BUN-IDX2)  =
                           RECE62-TENSU(12 BUN-IDX2)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-TENSU(12 BUN-IDX2) =
                           RECE6C-TENSU(12 BUN-IDX2) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
           END-IF
           IF    BUN-IDX3       =   3
                 COMPUTE   RECE62-TENSU(12 BUN-IDX3)  =
                           RECE62-TENSU(12 BUN-IDX3)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-TENSU(12 BUN-IDX3) =
                           RECE6C-TENSU(12 BUN-IDX3) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
             IF  BUN-IDX32      =   3
                 COMPUTE   RECE62-SKYHENTEN(12 BUN-IDX3)  =
                           RECE62-SKYHENTEN(12 BUN-IDX3)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-SKYHENTEN(12 BUN-IDX3) =
                           RECE6C-SKYHENTEN(12 BUN-IDX3) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
             END-IF
           END-IF
           IF    BUN-IDX4       =   4
                 COMPUTE   RECE62-TENSU(12 BUN-IDX4)  =
                           RECE62-TENSU(12 BUN-IDX4)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-TENSU(12 BUN-IDX4) =
                           RECE6C-TENSU(12 BUN-IDX4) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
             IF  BUN-IDX42      =   4
                 COMPUTE   RECE62-SKYHENTEN(12 BUN-IDX4)  =
                           RECE62-SKYHENTEN(12 BUN-IDX4)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-SKYHENTEN(12 BUN-IDX4) =
                           RECE6C-SKYHENTEN(12 BUN-IDX4) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
             END-IF
           END-IF
           IF    BUN-IDX5       =   5
                 COMPUTE   RECE62-TENSU(12 BUN-IDX5)  =
                           RECE62-TENSU(12 BUN-IDX5)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-TENSU(12 BUN-IDX5) =
                           RECE6C-TENSU(12 BUN-IDX5) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
             IF  BUN-IDX52      =   5
                 COMPUTE   RECE62-SKYHENTEN(12 BUN-IDX5)  =
                           RECE62-SKYHENTEN(12 BUN-IDX5)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-SKYHENTEN(12 BUN-IDX5) =
                           RECE6C-SKYHENTEN(12 BUN-IDX5) +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
             END-IF
           END-IF
           IF    BUN-IDX6       =   6
                 COMPUTE   RECE62-SYUTANTEN(12)  =
                           RECE62-SYUTANTEN(12)  +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
                 COMPUTE   RECE6C-SYUTANTEN(12)  =
                           RECE6C-SYUTANTEN(12)  +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
           END-IF
           COMPUTE         RECE62-ALLTENSU(12)   =
                           RECE62-ALLTENSU(12)   +
                           (RECE64-ZAITEN  *  RECE64-ZAIKAISU)
           COMPUTE         RECE6C-ALLTENSU(12)   =
                           RECE6C-ALLTENSU(12)   +
                           (RECE64-YKZTEN  *  RECE64-ZAIKAISU)
      *
           .                                           
      *
       21034-RECE62-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    コメント編集
      *****************************************************************
       21036-COMENT-HENSYU2-SEC               SECTION.
      *
           IF  WRK-TH-INPUTNUM  NOT =  ZERO
             IF  (WRK-TH-SRYCD(1:2) = "84" OR "85" OR "88")
             OR  (WRK-TH-SRYCD(1:4) = "8311"              )
      *
               MOVE  SPACE   TO   WRK-INPUTCHI4
               IF   WRK-TH-SRYCD(1:4)     =  "8801"
               AND  WRK-TH-INPUTCHI1  NOT =  SPACE
               AND  WRK-TH-INPUTCHI4  NOT =  SPACE
                 MOVE   WRK-TH-INPUTCHI4   TO   WRK-INPUTCHI4BK
                 PERFORM  21012181-COM88-HENSYU-SEC
               END-IF
      *
               IF   WRK-TH-INPUTCHI1  NOT =  SPACE
                 INITIALIZE                  ORCSKANACHKAREA
                 MOVE    "2"             TO  KANACHK-SYORI
                 IF   WRK-INPUTCHI4 = SPACE
                   STRING WRK-TH-INPUTCHI1   DELIMITED  BY  SPACE
                          WRK-TH-INPUTCHI2   DELIMITED  BY  SPACE
                          WRK-TH-INPUTCHI3   DELIMITED  BY  SPACE
                          WRK-TH-INPUTCHI4   DELIMITED  BY  SPACE
                          INTO   KANACHK-MAE-INPUT
                   END-STRING
                 ELSE
                   STRING WRK-TH-INPUTCHI1   DELIMITED  BY  SPACE
                          WRK-TH-INPUTCHI2   DELIMITED  BY  SPACE
                          WRK-TH-INPUTCHI3   DELIMITED  BY  SPACE
                          WRK-INPUTCHI4      DELIMITED  BY  SPACE
                          INTO   KANACHK-MAE-INPUT
                   END-STRING
                 END-IF
                 CALL    "ORCSKANACHK"   USING
                                         ORCSKANACHKAREA
                 IF   KANACHK-RC = ZERO
                   MOVE   KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                   TO    WRK-ORCSTEN-COM-MEI(IDX6)
                 END-IF
               ELSE
                 MOVE     SPACE    TO    WRK-ORCSTEN-COM-MEI(IDX6)
               END-IF
      *
               IF   TNS-FORMALNAME  NOT = SPACE
                 COMPUTE WRK-INPUTCOMMENT-ST = TNS-YUKOKETA * 2
                                             + 1
                 INITIALIZE              ORCSKANACHKAREA
                 MOVE    "2"       TO    KANACHK-SYORI
                 STRING TNS-FORMALNAME  DELIMITED  BY  SPACE
                        WRK-ORCSTEN-COM-MEI2(IDX6)(WRK-INPUTCOMMENT-ST:)
                                        DELIMITED  BY  SPACE
                        INTO   KANACHK-MAE-INPUT
                 END-STRING
                 CALL    "ORCSKANACHK"   USING
                                         ORCSKANACHKAREA
                 IF   KANACHK-RC = ZERO
                   MOVE   KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                   TO    WRK-ORCSTEN-COM-MEI2(IDX6)
                 END-IF
               END-IF
             ELSE
               INITIALIZE              ORCSKANACHKAREA
               MOVE    "2"       TO    KANACHK-SYORI
               MOVE    TNS-NAME  TO    KANACHK-MAE-INPUT
               CALL    "ORCSKANACHK"   USING
                                       ORCSKANACHKAREA
               IF  (KANACHK-RC  = ZERO)
               AND (KANACHK-MAX > ZERO)
                 COMPUTE IDXX    =     KANACHK-MAX + 1
                 MOVE    WRK-ORCSTEN-COM-MEI2(IDX6)(IDXX:)
                                 TO    WRK-ORCSTEN-COM-MEI(IDX6)
               END-IF
      *
               IF   WRK-TH-INPUTSTRING   =  SPACE
                 IF  TNS-FORMALNAME  NOT = SPACE
                   COMPUTE WRK-INPUTCOMMENT-ST = TNS-YUKOKETA * 2
                                               + 1
                   INITIALIZE              ORCSKANACHKAREA
                   MOVE    "2"       TO    KANACHK-SYORI
                   STRING TNS-FORMALNAME  DELIMITED  BY  SPACE
                          WRK-ORCSTEN-COM-MEI2(IDX6)
                                                 (WRK-INPUTCOMMENT-ST:)
                                          DELIMITED  BY  SPACE
                          INTO   KANACHK-MAE-INPUT
                   END-STRING
                   CALL    "ORCSKANACHK"   USING
                                           ORCSKANACHKAREA
                   IF   KANACHK-RC = ZERO
                     MOVE   KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                     TO    WRK-ORCSTEN-COM-MEI2(IDX6)
                   END-IF
                 END-IF
               ELSE
                 IF  TNS-FORMALNAME  = SPACE
                   INITIALIZE              ORCSKANACHKAREA
                   MOVE    "2"       TO    KANACHK-SYORI
                   STRING TNS-NAME        DELIMITED  BY  SPACE
                          WRK-TH-INPUTSTRING
                                          DELIMITED  BY  SPACE
                          INTO   KANACHK-MAE-INPUT
                   END-STRING
                   CALL    "ORCSKANACHK"   USING
                                           ORCSKANACHKAREA
                   IF   KANACHK-RC = ZERO
                     MOVE   KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                     TO    WRK-ORCSTEN-COM-MEI2(IDX6)
                   END-IF
                 ELSE
                   INITIALIZE              ORCSKANACHKAREA
                   MOVE    "2"       TO    KANACHK-SYORI
                   STRING TNS-FORMALNAME  DELIMITED  BY  SPACE
                          WRK-TH-INPUTSTRING
                                          DELIMITED  BY  SPACE
                          INTO   KANACHK-MAE-INPUT
                   END-STRING
                   CALL    "ORCSKANACHK"   USING
                                           ORCSKANACHKAREA
                   IF   KANACHK-RC = ZERO
                     MOVE   KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                     TO    WRK-ORCSTEN-COM-MEI2(IDX6)
                   END-IF
                 END-IF
                 MOVE  WRK-TH-INPUTSTRING
                                     TO    WRK-ORCSTEN-COM-MEI(IDX6)
               END-IF
             END-IF
           ELSE
             IF  TNS-FORMALNAME  NOT = SPACE
               MOVE  TNS-FORMALNAME  TO   WRK-ORCSTEN-COM-MEI(IDX6)
                                          WRK-ORCSTEN-COM-MEI2(IDX6)
             END-IF
           END-IF
      *
           .
      *
       21036-COMENT-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルへの負担金セット（Ｆ００２）
      *****************************************************************
       2104-FTN-SET-SEC                SECTION.
      *
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN2
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN4
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN5
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN6
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN7
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN8
           MOVE    ZERO                 TO      WRK-CHIHOU-KIN10
      *
           MOVE    ZERO                 TO      WRK-CHK-ICHIBUGAKU
                                                WRK-CHK-ICHIBUGAKU2
                                                WRK-CHK-FTNGAKU
                                                WRK-CHK-KOHFTNGAKU
      *
           MOVE    ZERO                 TO      FLG-GENBUTU-TAISYOOK
      *
           MOVE    ZERO                 TO      FLG-GENBUTU70
           MOVE    ZERO                 TO      FLG-GENBUTU70-KBN
           MOVE    ZERO                 TO      FLG-KOUREI-GENEKIKBN
           MOVE    ZERO                 TO      FLG-KOHYONKAIME
           MOVE    ZERO                 TO      FLG-ZEROKOGAITO
           MOVE    ZERO                 TO      FLG-RJNGENMEN-CHIARI
           INITIALIZE                           WRK-TAIHI-GENKIN-TBL
           MOVE    ZERO                 TO      FLG-ZENKI-TOKUREI
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU2
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU3
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU4
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU4X
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU4Y
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU5
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU5X
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU7
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU8
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU9
           MOVE    ZERO                 TO      FLG-ZENKOKUKOHI-NISYU-SC
           MOVE    ZERO                 TO      FLG-KEISAN-TOK1
                                                FLG-KEISAN-TOK2
           MOVE    ZERO                 TO      WRK-KINGAKU-TOK1
                                                WRK-KINGAKU-TOK1X
                                                WRK-KINGAKU-TOK3
                                                WRK-KINGAKU-TOK4
                                                WRK-KINGAKU-TOK5
                                                WRK-KINGAKU-TOK7
                                                WRK-KINGAKU-TOK8
                                                WRK-KINGAKU-TOK9
           MOVE    ZERO                 TO      FLG-XX8-TUUKA
                                                FLG-XX5-TUUKA
                                                FLG-XX3-TUUKA
                                                FLG-XX6-TUUKA
                                                FLG-XX10-TUUKA
                                                FLG-XX11-TUUKA
                                                FLG-XX2-TUUKA
                                                FLG-XX4-TUUKA
                                                FLG-XX7-TUUKA
                                                FLG-XX7A-TUUKA
           MOVE    ZERO                 TO      FLG-KOUGAKU
      *
           MOVE    ZERO                 TO      FLG-SYUNOU-ARI
           MOVE    ZERO                 TO      FLG-SYUNOUTENSU-NG
      *
           MOVE    ZERO                 TO      FLG-KOUREI-KBN
      *
           MOVE    ZERO                 TO      FLG-WRKFILE-CLEAR
           MOVE    ZERO                 TO      FLG-SKY-TOKKOH
      *
           MOVE    ZERO                 TO      FLG-GENMEN-ARI
           MOVE    ZERO                 TO      FLG-GENMEN-NASI
           MOVE    ZERO                 TO      FLG-GENMEN-ARI2
           MOVE    ZERO                 TO      FLG-GENMEN-NASI2
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-KIN
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-SKJ
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-KIN2
           MOVE    ZERO                 TO      WRK-GENMEN-NASI-SKJ2
           INITIALIZE                           WRK-GENMEN-KOH-T
      *
           MOVE    ZERO                 TO      WRK-CYOKI-JGNGAK
           MOVE    ZERO                 TO      WRK-CYOKI-KOH-FTN
           MOVE    ZERO                 TO      WRK-CYOKI-KOH-FTN2
           MOVE    ZERO                 TO      WRK-CYOKI-KOH-FTN4
      *
           MOVE    ZERO                 TO      FLG-KOKI-HIGAITO
           MOVE    ZERO                 TO      FLG-CHIIKI2
      *
           MOVE    SPACE                TO      WRK-SENIN-HOJOKBN
      *
           IF  (RECE62-NYUINRYOFLG   =   "1"     )
           AND (RECE62-KOUREI        =   "1"     )
           AND (RECE62-SRYYM        >=   "200904")
           AND (RECE62-SRYYM        <=   "201203")
             INITIALIZE                        SYUNOU-REC
             MOVE    RECE62-HOSPNUM       TO   SYU-HOSPNUM
             MOVE    RECE62-NYUGAIKBN     TO   SYU-NYUGAIKBN
             MOVE    RECE62-PTID          TO   SYU-PTID
             MOVE    RECE62-SRYYM         TO   SYU-SRYYMD(1:6)
             MOVE    "__"                 TO   SYU-SRYYMD(7:2)
             MOVE    SYUNOU-REC           TO   MCPDATA-REC
             MOVE    "tbl_syunou"         TO   MCP-TABLE
             MOVE    "key17"              TO   MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC               =    ZERO
               MOVE  "tbl_syunou"         TO   MCP-TABLE
               MOVE  "key17"              TO   MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
               PERFORM  UNTIL  (FLG-SYUNOU     = 1)
                         OR    (FLG-KOUREI-KBN = 1)
                 PERFORM  VARYING  IDX1  FROM  1  BY  1
                           UNTIL  (IDX1    >  10               )
                            OR    (RECE62-HKNCOMBI(IDX1) = ZERO)
                            OR    (FLG-KOUREI-KBN        =  1  )
                   IF  SYU-HKNCOMBINUM  =  RECE62-HKNCOMBI(IDX1)
                     IF  ( SYU-DENPJTIKBN         NOT =  "3" )
                     AND ((SYU-TOTAL-HKNTEN       NOT = ZERO) OR
                          (SYU-SYUSKJ-RYOYOHI     NOT = ZERO) OR
                          (SYU-KOH1SKJ-RYOYOHI    NOT = ZERO))
                     AND ( RECE62-DAISANFLG(IDX1) NOT =   1  )
                       IF   SYU-SKJ-FTNGAKU(3)  =  1
                          MOVE   SPACE    TO   RECE62-KOUREI
                          MOVE    1       TO   FLG-KOUREI-KBN
                       END-IF
                     END-IF
                     MOVE    10           TO   IDX1
                   END-IF
                 END-PERFORM
                 MOVE  "tbl_syunou"       TO   MCP-TABLE
                 MOVE  "key17"            TO   MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
               END-PERFORM
             END-IF
             MOVE      "tbl_syunou"       TO   MCP-TABLE
             MOVE      "key17"            TO   MCP-PATHNAME
             PERFORM    900-CLOSE-SEC
           END-IF
      *
           MOVE    ZERO                 TO      WRK-KOHCNT
           IF      RECE62-SRYYM   >=   "200804"
              PERFORM   VARYING  IDY2    FROM    1   BY   1
                         UNTIL   IDY2      >     4
                 IF    RECE62-KOHNUM(IDY2)  NOT =  SPACE
                     ADD       1        TO      WRK-KOHCNT
                 END-IF
              END-PERFORM
      *
              IF   (RECE62-HKNCOMBI(2)   NOT =   ZERO)
              AND  (WRK-KOHCNT               >    1  )
                     MOVE     "1"       TO      RECE62-JSKISAIFLG
              END-IF
      *
              IF   (RECE62-JSKISAIFLG   =   "1" )
              AND  (RECE62-HKNCOMBI(3)  =   ZERO)
                 IF  (RECE62-HKNNUMHC(1)   NOT =  SPACE)
                 AND (RECE62-HKNNUMHC(2)   NOT =  SPACE)
                   MOVE    ZERO    TO    FLG-NOTEQUAL
                   IF   RECE62-KOHNUMHC(1 1) = "972" OR "974" OR SPACE
                     IF RECE62-KOHNUMHC(2 1) = "972" OR "974" OR SPACE
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   ELSE
                     IF  (RECE62-KOHNUMHC(1 1) = RECE62-KOHNUMHC(2 1))
                     AND (RECE62-KOHIDHC (1 1) = RECE62-KOHIDHC (2 1))
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   END-IF
                   IF   RECE62-KOHNUMHC(1 2) = "972" OR "974" OR SPACE
                     IF RECE62-KOHNUMHC(2 2) = "972" OR "974" OR SPACE
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   ELSE
                     IF  (RECE62-KOHNUMHC(1 2) = RECE62-KOHNUMHC(2 2))
                     AND (RECE62-KOHIDHC (1 2) = RECE62-KOHIDHC (2 2))
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   END-IF
                   IF   RECE62-KOHNUMHC(1 3) = "972" OR "974" OR SPACE
                     IF RECE62-KOHNUMHC(2 3) = "972" OR "974" OR SPACE
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   ELSE
                     IF  (RECE62-KOHNUMHC(1 3) = RECE62-KOHNUMHC(2 3))
                     AND (RECE62-KOHIDHC (1 3) = RECE62-KOHIDHC (2 3))
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   END-IF
                   IF   RECE62-KOHNUMHC(1 4) = "972" OR "974" OR SPACE
                     IF RECE62-KOHNUMHC(2 4) = "972" OR "974" OR SPACE
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   ELSE
                     IF  (RECE62-KOHNUMHC(1 4) = RECE62-KOHNUMHC(2 4))
                     AND (RECE62-KOHIDHC (1 4) = RECE62-KOHIDHC (2 4))
                       CONTINUE
                     ELSE
                       MOVE    1   TO    FLG-NOTEQUAL
                     END-IF
                   END-IF
                   IF  FLG-NOTEQUAL = ZERO
                     MOVE    SPACE    TO    RECE62-JSKISAIFLG
                   END-IF
                 END-IF
                 IF ((RECE62-HKNNUMHC(1)   NOT =  SPACE         ) AND
                     (RECE62-HKNNUMHC(2)   NOT =  SPACE         ) AND
                     (RECE62-KOHNUMHC(1 1)     =  SPACE OR "972"
                                                        OR "974") AND
                     (RECE62-KOHNUMHC(1 2)     =  SPACE         ) AND
                     (RECE62-KOHNUMHC(1 3)     =  SPACE         ) AND
                     (RECE62-KOHNUMHC(1 4)     =  SPACE         ))
                 OR ((RECE62-HKNNUMHC(1)   NOT =  SPACE         ) AND
                     (RECE62-HKNNUMHC(2)   NOT =  SPACE         ) AND
                     (RECE62-KOHNUMHC(2 1)     =  SPACE OR "972"
                                                        OR "974") AND
                     (RECE62-KOHNUMHC(2 2)     =  SPACE         ) AND
                     (RECE62-KOHNUMHC(2 3)     =  SPACE         ) AND
                     (RECE62-KOHNUMHC(2 4)     =  SPACE         ))
                     MOVE     SPACE     TO      RECE62-JSKISAIFLG
                 END-IF
              END-IF
           END-IF
      *
           IF    RECE62-SRYYM    >=  "201808"
           AND   RECE62-KOUREI    =  "1"
                 PERFORM   2104M-KOUREI-GENBUTU-HENSYU-SEC
           END-IF
      *
           PERFORM         2104E-TOKUSITU-HANTEI-SEC
      *
           IF    RECE62-KOUREI    =  "1" OR "2"
              IF RECE62-KOUREI    =  "1"
                 PERFORM   21048-KOUREI-GENBUTU-HANTEI-SEC
              ELSE
                 PERFORM   21049-GENBUTU70-HANTEI-SEC
              END-IF
           END-IF
      *
           PERFORM         211B-DAISAN-CHECK-SEC
           IF   RECE62-DAISAN-GAITO          =   1
           AND  RECE62-DAISAN-GENBUTU-GAITO  =  ZERO
             IF   RECE62-KOUREI  =  "1"
               MOVE    1       TO   RECE62-DAISAN-KOUREI
             END-IF
             MOVE      SPACE   TO   RECE62-KOUREI
           END-IF
      *
           IF   RECE62-DAISAN-GAITO  =   1
             CONTINUE
           ELSE
             PERFORM       2110-GENGAKU-HANTEI-SEC
           END-IF
      *
           IF   (IDZ                       =     1   )
           AND  (RECE62-SRYYM             >= "201204")
              IF   (RECE62-HKNNUM       =   SPACE                  )
              OR   (RECE62-HKNNUM(1:2)  =   "98" OR "90" OR "91"   )
              OR   (RECE62-HKNNUM       =   "068" OR "069" OR "040")
              OR   ((RECE62-DAISAN-GAITO          =   1           ) AND
                    (RECE62-DAISAN-GENBUTU-GAITO  =  ZERO         ))
                 CONTINUE
              ELSE
                 PERFORM   2104J-ZEROKOGAITO-CHECK-SEC
              END-IF
           END-IF
      *
           IF    (RECE62-SRYYM   >=  "200804")
           AND   (RECE62-SRYYM   <=  "201903")
             IF  (RECE62-HKNNUM       =   SPACE                      )
             OR  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91"     )
             OR  (RECE62-HKNNUM  =   "068" OR "069" OR "040" OR "039")
             OR  (RECE62-AGE          <    70                        )
      ***    OR  (RECE62-AGE          >    74                        )
             OR  (RECE62-KOREIHIGAITO =     1                        )
               CONTINUE
             ELSE
               IF  (RECE62-HOJOKBN     =   "1"  OR  "9")
               AND (RECE62-BIRTHDAY    <    19440402   )
                  MOVE      1     TO    FLG-ZENKI-TOKUREI
               END-IF
             END-IF
           END-IF
      *
           IF   RECE62-DAISAN-GAITO          =   1
           AND  RECE62-DAISAN-GENBUTU-GAITO  =  ZERO
             CONTINUE
           ELSE
             PERFORM       2104D-TOKU75-HANTEI-SEC
           END-IF
      *
           PERFORM         21041-KOREISYA-KOHI-SEC
           PERFORM         2104C-ZENKOKUKOHI-NISYU-CHK-SEC
           IF  ( RECE62-KOUREI    =    "1"  OR  "2"    )
           OR  ( FLG-TOKU75       =     1  OR  2  OR 3 )
              PERFORM      21042-KOREISYA-CHECK-SEC
           END-IF
      *
           PERFORM         2104B-TOKUTEISIKKAN-CHECK-SEC
      *
           INITIALIZE                   TBL-HKNFTNDATA
           IF   RECE62-SRYYM    >=  "200804"
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  ( RECE62-KOHNUM(IDY2) =
                      "015" OR "016" OR "024" OR "079" OR
                      "038" OR "051" OR "052" OR "011" OR
                      "020" OR "012" OR "025" OR "028" OR
                      "029"                                     )
                OR  ((RECE62-KOHNUM(IDY2) = "054"              ) AND
                     (RECE62-SRYYM       >= "201501"           ))
                OR  ((RECE62-KOHNUM(IDY2) = "092"              ) AND
                     (RECE62-SRYYM       >= "201812"           ))
                OR  ( TBL-TOKATUKAIFLG(IDY2)  =  1              )
                OR  ( WRK-KOHJGNGET-TEKIYOFLG(IDY2) =  1        )
                     PERFORM  2104F-JGNCHK-HENSYU-SEC
                END-IF
                IF    RECE62-KOHNUM(IDY2) = "095"
                  IF    RECE62-SRYYM  >=  "202310"
                     PERFORM  2104FY-JGNCHK-HENSYU8-SEC
                  ELSE
                     PERFORM  2104FX-JGNCHK-HENSYU2-SEC
                  END-IF
                END-IF
                IF   (RECE62-KOHNUM(IDY2) = "096"   )
                AND  (RECE62-SRYYM       >= "202310")
                     PERFORM  2104FZ-JGNCHK-HENSYU9-SEC
                END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
                   IF  TBL-HKNFTNDATA-JGN(IDY2)   >
                               TBL-HKNFTNDATA-TAF(IDY2)
                       COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                TBL-HKNFTNDATA-JGN(IDY2) -
                                TBL-HKNFTNDATA-TAF(IDY2)
                   ELSE
                       MOVE  ZERO  TO  TBL-HKNFTNDATA-ZAN(IDY2)
                   END-IF
                   IF  TBL-HKNFTNDATA-ZAN(IDY2)   NOT =  ZERO
                     IF  TBL-HKNFTNDATA-ZAN(IDY2) >
                               TBL-HKNFTNDATA-GAIRAI(IDY2)
                       COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                TBL-HKNFTNDATA-ZAN(IDY2) -
                                TBL-HKNFTNDATA-GAIRAI(IDY2)
                     ELSE
                       MOVE  ZERO  TO  TBL-HKNFTNDATA-ZAN(IDY2)
                     END-IF
                     IF  TBL-HKNFTNDATA-ZAN(IDY2) NOT =  ZERO
                       IF  RECE62-KOHNUM(IDY2) NOT = "095" AND "096"
                         PERFORM  2104G-JGNCHK-HENSYU-OKIKAE-SEC
                       END-IF
                       IF  TBL-HKNFTNDATA-ZAN(IDY2)  >
                               TBL-HKNFTNDATA-NYUSKJ(IDY2)
                         COMPUTE  WRK-HKNFTNDATA-RUI          =
                                  TBL-HKNFTNDATA-TAF(IDY2)    +
                                  TBL-HKNFTNDATA-GAIRAI(IDY2) +
                                  TBL-HKNFTNDATA-NYUSKJ(IDY2)
                         IF   TBL-HKNFTNDATA-JGN(IDY2) =
                                              WRK-HKNFTNDATA-RUI
                           MOVE 1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                           MOVE ZERO TO  TBL-HKNFTNDATA-ZAN(IDY2)
                         ELSE
                           COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                    TBL-HKNFTNDATA-ZAN(IDY2) -
                                    TBL-HKNFTNDATA-NYUSKJ(IDY2)
                         END-IF
                       ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                         MOVE   ZERO TO  TBL-HKNFTNDATA-ZAN(IDY2)
                       END-IF
                     ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                     END-IF
                   ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                   END-IF
                   IF   TBL-HKNFTNDATA-FLG(IDY2) = 1
                     IF  ((RECE62-KOHNUM(IDY2)      =  "051"   ) AND
                          (TBL-DOTANDOKU-FLG(IDY2)  =   1      ))
                     OR  ((WRK-PREFNUM              =  "13"    ) AND
                          (RECE62-KOHNUM(IDY2)      =  "151"   ) AND
                          (RECE62-SRYYM             <  "200905"))
                         MOVE   2    TO  TBL-HKNFTNDATA-FLG(IDY2)
                     END-IF
                   END-IF
                END-IF
             END-PERFORM
      *
      *      複数の公費登録が有る場合
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
               IF  ( RECE62-KOHNUM(IDY2) =
                     "051" OR "038" OR "015" OR "016"     )
               OR  ((RECE62-KOHNUM(IDY2) = "052"         ) AND
                    (RECE62-SRYYM       <= "201412"      ))
               OR  ((RECE62-KOHNUM(IDY2) = "054" OR "052") AND
                    (RECE62-SRYYM       >= "201501"      ))
               OR  ((RECE62-KOHNUM(IDY2) = "092"         ) AND
                    (RECE62-SRYYM       >= "201812"      ))
                 IF   (TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO)
                 AND  (TBL-HKNFTNDATA-ZAN(IDY2)  NOT =  ZERO)
                 AND  (TBL-HKNFTNDATA-FLG(IDY2)      =  ZERO)
                 AND  (TBL-HKNFTNDATA-TEKFLG(IDY2)   =  ZERO)
                   MOVE   ZERO   TO  WRK-HKNFTNDATA-RUI
                   PERFORM   VARYING  IDY3    FROM    1   BY   1
                              UNTIL   IDY3      >     4
                     IF  (IDY2  NOT = IDY3                         )
                     AND (RECE62-KOHNUM(IDY2) = RECE62-KOHNUM(IDY3))
                     AND (TBL-HKNFTNDATA-TEKFLG(IDY3)  =  ZERO     )
                       IF   (RECE62-KOHNUM(IDY2) = "054" OR "052")
                       AND  (RECE62-SRYYM       >= "201501"      )
                         IF  RECE62-KOHFTNJANUM(IDY2)
                                         = RECE62-KOHFTNJANUM(IDY3)
                           ADD   TBL-HKNFTNDATA-GAIRAI(IDY3)  TO
                                               WRK-HKNFTNDATA-RUI
                           ADD   TBL-HKNFTNDATA-NYUSKJ(IDY3)  TO
                                               WRK-HKNFTNDATA-RUI
                         END-IF
                       ELSE
                           ADD   TBL-HKNFTNDATA-GAIRAI(IDY3)  TO
                                               WRK-HKNFTNDATA-RUI
                           ADD   TBL-HKNFTNDATA-NYUSKJ(IDY3)  TO
                                               WRK-HKNFTNDATA-RUI
                       END-IF
                     END-IF
                   END-PERFORM
      *
                   IF    TBL-HKNFTNDATA-ZAN(IDY2) <= WRK-HKNFTNDATA-RUI
                        MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                   ELSE
                    IF  ( RECE62-KOHNUM(IDY2) =
                                       "038" OR "015" OR "016" )
                    OR  ((RECE62-KOHNUM(IDY2) = "054" OR "052") AND
                         (RECE62-SRYYM       >= "201501"      ))
                      PERFORM  2104I-CYOFUKU-KOH-HENSYU-SEC
                      IF TBL-HKNFTNDATA-ZAN(IDY2) <= WRK-HKNFTNDATA-RUI
                        MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                      END-IF
                    END-IF
                   END-IF
                 END-IF
               END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
                   DISPLAY "IDX KOHNUM=" IDY2
                           " "    RECE62-KOHNUM(IDY2)
                   DISPLAY "JGN=" TBL-HKNFTNDATA-JGN(IDY2)
                   DISPLAY "FLG=" TBL-HKNFTNDATA-FLG(IDY2)
                END-IF
             END-PERFORM
      *
           END-IF
      *
           MOVE      ZERO       TO   FLG-KOHSKY-ARI
           INITIALIZE                WRK-KOHSKY-XXX-TABLE
           IF   (IDZ                       =     1   )
           AND  (RECE62-SRYYM             >= "201704")
             PERFORM  VARYING  IDX34  FROM  1  BY  1
                       UNTIL   IDX34    >   4
               IF   (RECE62-KOHSKY-KOHNUM(IDX34) NOT = SPACE)
               AND  (RECE62-KOHSKY-KOHNUM(IDX34)
                                      NOT = RECE62-KOHNUM(1))
               AND  (RECE62-KOHSKY-KOHNUM(IDX34)
                                      NOT = RECE62-KOHNUM(2))
               AND  (RECE62-KOHSKY-KOHNUM(IDX34)
                                      NOT = RECE62-KOHNUM(3))
               AND  (RECE62-KOHSKY-KOHNUM(IDX34)
                                      NOT = RECE62-KOHNUM(4))
                 MOVE     1     TO   FLG-KOHSKY-ARI
               END-IF
             END-PERFORM
           END-IF
      *
           MOVE      ZERO       TO   CNT-CYOKI-HENSYU1
           MOVE      ZERO       TO   CNT-CYOKI-HENSYU2
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU2
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU3
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU4
           INITIALIZE                WRK-SYUNOU-CYOKI-AREA
           IF  (RECE62-SRYYM     >=    "201204")
           AND (RECE62-KOUREI     =  "1" OR "2")
           AND (IDZ               =   1        )
               PERFORM    2104L-CYOKI-CHECK-SEC
           END-IF
           IF   FLG-CYOKI-HENSYU4 =  ZERO
               MOVE  SPACE  TO  RECE62-CYOKI-KSIKBN
           END-IF
      *
           MOVE    ZERO                 TO      FLG-NYUINRYO
           MOVE    ZERO                 TO      FLG-HOKENICHIBU
           MOVE    ZERO                 TO      FLG-HOKENICHIBU-SYU
           MOVE    ZERO                 TO      FLG-HOKENICHIBU2
           MOVE    ZERO                 TO      FLG-HOKENICHIBU3
           MOVE    ZERO                 TO      FLG-HOKENICHIBU7
      *
           MOVE    ZERO                 TO      FLG-JIRITU-CYUKANSOU1
           MOVE    ZERO                 TO      FLG-JIRITU-CYUKANSOU2
           MOVE    ZERO                 TO      WRK-JIRITU-SAIKEI
           MOVE    ZERO                 TO      WRK-JIRITU-SAIKEI2
           MOVE    ZERO                 TO      WRK-SAIKEI-TAIHI
           MOVE    ZERO                 TO      FLG-SKYIRYO-KOHFTN
      *
           INITIALIZE                           WRK-TOKUSYU-SKJFLG-T
      *
           INITIALIZE                           WRK-SKJ-FTN-T
      *
           INITIALIZE                           WRK-KOGAKU-TAISYOGAI-T
      *
           MOVE    ZERO                 TO      FLG-SKJ-CHECK
      *
           INITIALIZE                           SYUNOU-REC
           MOVE    RECE62-HOSPNUM       TO      SYU-HOSPNUM
           MOVE    RECE62-NYUGAIKBN     TO      SYU-NYUGAIKBN
           MOVE    RECE62-PTID          TO      SYU-PTID
      ***  MOVE    RECE62-SRYKA(IDX)    TO      SYU-SRYKA
           MOVE    RECE62-SRYYM         TO      SYU-SRYYMD(1:6)
           MOVE    "__"                 TO      SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO      MCPDATA-REC
           MOVE    "tbl_syunou"         TO      MCP-TABLE
           MOVE    "key17"              TO      MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_syunou"     TO      MCP-TABLE
               MOVE    "key17"          TO      MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
               PERFORM  UNTIL
                  (FLG-SYUNOU             =    1)
                   PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE62-HKNCOMBI (IDX1)   =   ZERO 
                     IF    SYU-HKNCOMBINUM  =  RECE62-HKNCOMBI(IDX1)
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                         MOVE    ZERO   TO   FLG-HANTEI
                         MOVE    ZERO   TO   FLG-HANTEI2
                         IF  SYU-TOTAL-HKNTEN    NOT = ZERO
                           MOVE    1    TO   FLG-HANTEI
      *                    入院補助公費＋長期の対応
                           IF     SYU-KOH-HKNNUM(1) = "095"
                             IF  (SYU-KOH-HKNNUM(2) = "972")
                             OR  (SYU-KOH-HKNNUM(3) = "972")
                             OR  (SYU-KOH-HKNNUM(4) = "972")
                               MOVE  1  TO   FLG-CYOKI-ARI
                             END-IF
                             IF  (SYU-KOH-HKNNUM(2) = "974")
                             OR  (SYU-KOH-HKNNUM(3) = "974")
                             OR  (SYU-KOH-HKNNUM(4) = "974")
                               MOVE  1  TO   FLG-CYOKI-ARI2
                             END-IF
                           END-IF
                         END-IF
                         IF (SYU-TOTAL-HKNTEN    NOT = ZERO)
                         OR (SYU-SYUSKJ-RYOYOHI  NOT = ZERO)
                         OR (SYU-KOH1SKJ-RYOYOHI NOT = ZERO)
                           MOVE    1    TO   FLG-HANTEI2
                         END-IF
      *
                         IF  RECE62-DAISANFLG(IDX1) =  1
                           IF   (RECE62-DAISAN-GAITO    =   1 OR 2)
                           AND  (RECE62-DAISAN-GENBUTU-GAITO  =  1)
                             PERFORM 21044-RECE62-FTN-HENSYU-SEC
                           ELSE
                             IF  FLG-HANTEI2  =  1
                               PERFORM 2104K-RECE62-FTN-HENSYU-XXX-SEC
                             ELSE
                               IF   RECE62-NYUINRYOFLG  =  "1"
                               AND  FLG-NYUINRYO        =  ZERO
                                 PERFORM 210441-NYUINRYOFLG-SET-SEC
                               END-IF
                             END-IF
                           END-IF
                         ELSE
                           PERFORM 21044-RECE62-FTN-HENSYU-SEC
                         END-IF
                         MOVE   1           TO  FLG-SYUNOU-ARI
                       END-IF
                       MOVE    10           TO  IDX1
                     END-IF
                   END-PERFORM          
                   MOVE    "tbl_syunou"     TO   MCP-TABLE
                   MOVE    "key17"          TO   MCP-PATHNAME
                   PERFORM   900-SYUNOU-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SYUNOU SELECT ERR" 
           END-IF
      *
           MOVE    "tbl_syunou"         TO      MCP-TABLE
           MOVE    "key17"              TO      MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           PERFORM         21043-GENMEN-TEK-CHECK-SEC
      *
      *    食事情報クリア
           IF   RECE62-SRYYM  >= "201604"
             IF   RECE62-SHOKUJISYUBETU-KHN     =  "９"
                MOVE   SPACE  TO   RECE62-SHOKUJISYUBETU-KHN
             END-IF
             IF   RECE62-SHOKUJISYUBETU-KHNSEI  =  "９"
                MOVE   SPACE  TO   RECE62-SHOKUJISYUBETU-KHNSEI
             END-IF
             IF   RECE62-SHOKUJIKHNRYO(1)       =  999999999
                MOVE   ZERO   TO   RECE62-SHOKUJIKHNRYO(1)
             END-IF
             IF   RECE62-SHOKUJIKHNRYO-SEI(1)   =  999999999
                MOVE   ZERO   TO   RECE62-SHOKUJIKHNRYO-SEI(1)
             END-IF
           END-IF
      *
      *    一部負担金再掲の計算処理
      *
           PERFORM         21046-SAIKEI-KEISAN-SEC
      *
      *    食事負担含む上限額のある公費の一部負担金額編集等
      *
           PERFORM         21045-KOH-FUTAN-SET-SEC
      *
      *    食事略称編集
      *
           IF   RECE62-SRYYM  >= "200604"
           AND  RECE62-SRYYM  <  "200610"
                PERFORM    21047-SKJ-RAYKU-HENSYU-SEC
           END-IF
      *
           IF   FLG-SYUNOU-ARI        =  ZERO
           OR   FLG-SYUNOUTENSU-NG    =   1
              IF   FLG-SYUNOU-ARI      =  ZERO
                DISPLAY "<SYUNOU NG STOP>"
                MOVE "仮収納データがありません"
                                        TO  ERR-ERRMSG
              ELSE
      ***       DISPLAY "<MIE SYUNOU NOT TOTALTEN>"
                MOVE "【三重県松阪市地方公費】当月退院又は定期"
                                        TO  ERR-ERRMSG(1:40)
                MOVE "請求の再計算が必要です。"
                                        TO  ERR-ERRMSG(41:24)
              END-IF
              PERFORM 600-ERRMSG-EDIT-SEC
              MOVE    ERR-HEN-ERRMSG    TO  WRK-RECEERR
              PERFORM 500-ERR-HENSYU-SEC
              MOVE    1                 TO  FLG-RECE62
      *
              MOVE    SPACE             TO  WRK-ERRMSG
              STRING  "ORCR0640 "           DELIMITED  BY  SIZE
                      WRK-RECEERR           DELIMITED  BY  SIZE
                      LOW-VALUE             DELIMITED  BY  SIZE
                                            INTO    WRK-ERRMSG
              END-STRING
              PERFORM 500-COBABORT-SEC
           END-IF
      *
           .
       2104-FTN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集
      *****************************************************************
       2104F-JGNCHK-HENSYU-SEC      SECTION.
      *
           INITIALIZE                      LNK-ORCSJGNGET-REC
           MOVE   RECE62-HOSPNUM       TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE62-NYUGAIKBN     TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE62-PTID          TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE62-KOHNUM(IDY2)  TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE62-KOHID(IDY2)   TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE62-SRYYM         TO  LNK-ORCSJGNGET-SRYYM
           MOVE   RECE62-SRYYM         TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
           MOVE   "31"                 TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
           IF     RECE62-KOHNUM(IDY2)(1:1) >=  "1" AND <=  "8"
              MOVE   WRK-KOHJGNGET-TAISYOKBN(IDY2)
                                       TO  LNK-ORCSJGNGET-SETKBN
              MOVE   WRK-KOHJGNGET-TEKIYOFLG(IDY2)
                                       TO  LNK-ORCSJGNGET-SETKBN2
           END-IF
           CALL    "ORCSJGNGET"        USING
                                       LNK-ORCSJGNGET-REC
                                       SPA-AREA
           IF     LNK-ORCSJGNGET-RC    =   ZERO
              IF    (RECE62-KOHNUM(IDY2) = "015" OR "016"        )
              AND   (LNK-ORCSJGNGET-NYUJGNGAK = 9999999 OR 999999)
                MOVE    ZERO           TO  TBL-HKNFTNDATA-JGN(IDY2)
              ELSE
                MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  TBL-HKNFTNDATA-JGN(IDY2)
                IF  ( RECE62-KOHNUM(IDY2) = "015" OR "016" OR "038" )
                OR  ((RECE62-KOHNUM(IDY2) = "052" OR "054"         ) AND
                     (RECE62-SRYYM       >= "201501"               ))
                OR  ((WRK-PREFNUM         = "23" OR "24"           ) AND
                     (RECE62-KOHNUM(IDY2) = "152"                  ) AND
                     (RECE62-SRYYM       >= "201104"               ) AND
                     (RECE62-SRYYM       <= "201412"               ))
                OR  ( WRK-KOHJGNGET-TEKIYOFLG(IDY2) =  1            )
                  MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO  TBL-HKNFTNDATA-TAF(IDY2)
                END-IF
              END-IF
              MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                       TO  TBL-HKNFTNDATA-JGNXXX(IDY2)
           END-IF
      *
           IF   TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
              INITIALIZE                      ORCSFTNJGNCHKAREA
              MOVE    RECE62-HOSPNUM      TO  LNK-FTNJGNCHK-HOSPNUM
              MOVE    RECE62-PTID         TO  LNK-FTNJGNCHK-PTID
              MOVE    "1"                 TO  LNK-FTNJGNCHK-NYUGAIKBN
              MOVE    RECE62-SRYYM        TO  LNK-FTNJGNCHK-SRYYM
              MOVE    RECE62-KOHNUM(IDY2) TO  LNK-FTNJGNCHK-KOHNUM
              MOVE    RECE62-KOHID(IDY2)  TO  LNK-FTNJGNCHK-KOHID
              MOVE    WRK-PREFNUM         TO  LNK-FTNJGNCHK-PREFNUM
              MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNCOMBINUM
              MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNID
              CALL    "ORCSFTNJGNCHK"     USING
                                          ORCSFTNJGNCHKAREA
                                          SPA-AREA
              MOVE    LNK-FTNJGNCHK-KOHFTN
                                   TO  TBL-HKNFTNDATA-NYUIN(IDY2)
              MOVE    LNK-FTNJGNCHK-KOHFTNSKJ
                                   TO  TBL-HKNFTNDATA-NYUSKJ(IDY2)
      *
              IF  ( RECE62-KOHNUM(IDY2) =
                    "015" OR "016" OR "024" OR "079" OR "038" )
              OR  ((RECE62-KOHNUM(IDY2) = "052" OR "054"     ) AND
                   (RECE62-SRYYM       >= "201501"           ))
              OR  ((WRK-PREFNUM         = "23" OR "24"       ) AND
                   (RECE62-KOHNUM(IDY2) = "152"              ) AND
                   (RECE62-SRYYM       >= "201104"           ) AND
                   (RECE62-SRYYM       <= "201412"           ))
              OR  ( WRK-KOHJGNGET-TEKIYOFLG(IDY2) =  1        )
                INITIALIZE                      ORCSFTNJGNCHKAREA
                MOVE  RECE62-HOSPNUM      TO  LNK-FTNJGNCHK-HOSPNUM
                MOVE  RECE62-PTID         TO  LNK-FTNJGNCHK-PTID
                MOVE  "2"                 TO  LNK-FTNJGNCHK-NYUGAIKBN
                MOVE  RECE62-SRYYM        TO  LNK-FTNJGNCHK-SRYYM
                MOVE  RECE62-KOHNUM(IDY2) TO  LNK-FTNJGNCHK-KOHNUM
                MOVE  RECE62-KOHID(IDY2)  TO  LNK-FTNJGNCHK-KOHID
                MOVE  WRK-PREFNUM         TO  LNK-FTNJGNCHK-PREFNUM
                MOVE  ZERO                TO  LNK-FTNJGNCHK-HKNCOMBINUM
                MOVE  ZERO                TO  LNK-FTNJGNCHK-HKNID
                CALL  "ORCSFTNJGNCHK"     USING
                                          ORCSFTNJGNCHKAREA
                                          SPA-AREA
                MOVE    LNK-FTNJGNCHK-KOHFTN
                                   TO  TBL-HKNFTNDATA-GAIRAI(IDY2)
              END-IF
      *
              IF   RECE62-KOHNUM(IDY2) = "015" OR "016"
                MOVE  RECE62-SRYYM    TO  WRK-CYOFUKU-KOH-YM
                MOVE  01              TO  WRK-CYOFUKU-KOH-DD
                IF   RECE62-KOHTEKSTYMD(IDY2) <=  WRK-CYOFUKU-KOH-YMD
                  CONTINUE
                ELSE
                  MOVE    1           TO  TBL-HKNFTNDATA-TEKFLG(IDY2)
                END-IF
              END-IF
           END-IF
      *
           .
       2104F-JGNCHK-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（入院補助公費）
      *    【２０２３年５月から２０２３年９月まで】
      *****************************************************************
       2104FX-JGNCHK-HENSYU2-SEC      SECTION.
      *
           MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
           IF    FLG-GENBUTU70  NOT =  ZERO
             EVALUATE   FLG-GENBUTU70
               WHEN        1
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      11
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   70050   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE  121300   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE  140100   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE  242600   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                   WHEN      12
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   46500   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   78700   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   93000   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE  157400   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN        2
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      21
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   22200   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   35050   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   44400   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   70100   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                   WHEN      22
      *              多数該当でない場合と多数該当の場合の上限は同じ
                     IF    FLG-TOKU75  =  3
                         MOVE   18800   TO   WRK-NYUINHOJO-MAX-KIN
                     ELSE
                         MOVE   37600   TO   WRK-NYUINHOJO-MAX-KIN
                     END-IF
                 END-EVALUATE
               WHEN        3
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      31
      *              多数該当でない場合と多数該当の場合の上限は同じ
                     IF    FLG-TOKU75  =  3
                         MOVE    7700   TO   WRK-NYUINHOJO-MAX-KIN
                     ELSE
                         MOVE   15400   TO   WRK-NYUINHOJO-MAX-KIN
                     END-IF
                 END-EVALUATE
             END-EVALUATE
      *
             MOVE     "095"   TO   WRK-NYUINHOJO-HKNNUM
             PERFORM  2104FX1-JGNCHK-HENSYU3-SEC
             IF      FLG-COVID-ETC   = 1
               CONTINUE
             ELSE
               IF    FLG-COVID-SEIHO = 1
      *          多数該当でない場合と多数該当の場合の上限は同じ
                 IF    FLG-TOKU75  =  3
                     MOVE    7700   TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                     MOVE   15400   TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
               ELSE
                 IF  FLG-COVID-CYOKI   = 1
                 OR  FLG-COVID-CYOKI2  = 1
                 OR  FLG-COVID-TANDOKU = 1
                     MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    FLG-KOUREI-GENEKIKBN  NOT =  ZERO
             EVALUATE   FLG-KOUREI-GENEKIKBN
               WHEN       1
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   70050   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE  121300   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE  140100   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE  242600   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       2
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   46500   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   78700   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   93000   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE  157400   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       3
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   22200   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   35050   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   44400   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   70100   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       4
      *          多数該当でない場合と多数該当の場合の上限は同じ
                 IF     FLG-TOKU75  =  1 OR 2
                     MOVE   18800   TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                     MOVE   37600   TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
               WHEN       5
      *          多数該当はない
                 IF     RECE62-TEISYOTOKU = "1" OR "4"
                     MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                   IF   FLG-TOKU75  =  1 OR 2
                     MOVE    2300   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE    4600   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
             END-EVALUATE
      *
             MOVE     "095"   TO   WRK-NYUINHOJO-HKNNUM
             PERFORM  2104FX1-JGNCHK-HENSYU3-SEC
             IF    FLG-COVID-ETC     = 1
               CONTINUE
             ELSE
               IF  FLG-COVID-SEIHO   = 1
               OR  FLG-COVID-CYOKI   = 1
               OR  FLG-COVID-TANDOKU = 1
                 MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
               END-IF
             END-IF
           END-IF
      *
           PERFORM    2104FX2-JGNCHK-HENSYU4-SEC
      *
           .
       2104FX-JGNCHK-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（入院補助公費・治療薬補助公費）
      *****************************************************************
       2104FX1-JGNCHK-HENSYU3-SEC      SECTION.
      *
           MOVE     ZERO   TO   FLG-COVID-CYOKI
           MOVE     ZERO   TO   FLG-COVID-CYOKI2
           MOVE     ZERO   TO   FLG-COVID-SEIHO
           MOVE     ZERO   TO   FLG-COVID-ETC
           MOVE     ZERO   TO   FLG-COVID-TANDOKU
      *
           PERFORM  VARYING  IDX47  FROM  1  BY  1
                     UNTIL  (IDX47                  >  10 )
                       OR   (RECE62-HKNCOMBI(IDX47) = ZERO)
             IF   RECE62-KOHNUMHC(IDX47 1) = WRK-NYUINHOJO-HKNNUM
               INITIALIZE                     HKNCOMBI-REC
               MOVE RECE62-HOSPNUM         TO COMB-HOSPNUM
               MOVE RECE62-PTID            TO COMB-PTID
               MOVE RECE62-HKNCOMBI(IDX47) TO COMB-HKNCOMBINUM
               MOVE HKNCOMBI-REC           TO MCPDATA-REC
               PERFORM 900-HKNCOMBI-INV-SEC
               IF   FLG-HKNCOMBI  =  ZERO
                 IF   COMB-HKNNUM  NOT =  SPACE
                   IF    (COMB-KOH2HKNNUM = "972" OR "974")
                   OR    (COMB-KOH3HKNNUM = "972" OR "974")
                   OR    (COMB-KOH4HKNNUM = "972" OR "974")
                     IF  (COMB-KOH2HKNNUM = "972")
                     OR  (COMB-KOH3HKNNUM = "972")
                     OR  (COMB-KOH4HKNNUM = "972")
                       MOVE   1     TO    FLG-COVID-CYOKI
                     ELSE
                       MOVE   1     TO    FLG-COVID-CYOKI2
                     END-IF
                   ELSE
                     IF  (COMB-KOH2HKNNUM = "012" OR "025")
                     OR  (COMB-KOH3HKNNUM = "012" OR "025")
                     OR  (COMB-KOH4HKNNUM = "012" OR "025")
                       MOVE   1     TO    FLG-COVID-SEIHO
                     ELSE
                       MOVE   1     TO    FLG-COVID-ETC
                     END-IF
                   END-IF
                 ELSE
                       MOVE   1     TO    FLG-COVID-TANDOKU
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
       2104FX1-JGNCHK-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（入院補助公費・治療薬補助公費）
      *****************************************************************
       2104FX2-JGNCHK-HENSYU4-SEC      SECTION.
      *
           MOVE   WRK-NYUINHOJO-MAX-KIN  TO  TBL-HKNFTNDATA-JGN(IDY2)
                                             TBL-HKNFTNDATA-JGNXXX(IDY2)
      *
           IF   TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
             INITIALIZE                      ORCSFTNJGNCHKAREA
             MOVE    RECE62-HOSPNUM      TO  LNK-FTNJGNCHK-HOSPNUM
             MOVE    RECE62-PTID         TO  LNK-FTNJGNCHK-PTID
             MOVE    "1"                 TO  LNK-FTNJGNCHK-NYUGAIKBN
             MOVE    RECE62-SRYYM        TO  LNK-FTNJGNCHK-SRYYM
             MOVE    RECE62-KOHNUM(IDY2) TO  LNK-FTNJGNCHK-KOHNUM
             MOVE    RECE62-KOHID(IDY2)  TO  LNK-FTNJGNCHK-KOHID
             MOVE    WRK-PREFNUM         TO  LNK-FTNJGNCHK-PREFNUM
             MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNCOMBINUM
             MOVE    RECE62-HKNID        TO  LNK-FTNJGNCHK-HKNID
             CALL    "ORCSFTNJGNCHK"     USING
                                         ORCSFTNJGNCHKAREA
                                         SPA-AREA
             MOVE    LNK-FTNJGNCHK-KOHFTN
                                  TO  TBL-HKNFTNDATA-NYUIN(IDY2)
             MOVE    LNK-FTNJGNCHK-KOHFTNSKJ
                                  TO  TBL-HKNFTNDATA-NYUSKJ(IDY2)
           END-IF
      *
           .
       2104FX2-JGNCHK-HENSYU4-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（入院補助公費）
      *    【２０２３年１０月から】
      *****************************************************************
       2104FY-JGNCHK-HENSYU8-SEC      SECTION.
      *
           MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
           IF    FLG-GENBUTU70  NOT =  ZERO
             EVALUATE   FLG-GENBUTU70
               WHEN        1
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      11
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   70050   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE  123800   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE  140100   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE  247600   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                   WHEN      12
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   46500   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   81200   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   93000   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE  162400   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN        2
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      21
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   22200   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   37550   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   44400   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   75100   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                   WHEN      22
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   22200   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   23800   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   44400   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   47600   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN        3
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      31
                     IF    FLG-TOKU75  =  3
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   12300   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   12700   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     ELSE
                       IF  FLG-KOHYONKAIME = 1
                         MOVE   24600   TO   WRK-NYUINHOJO-MAX-KIN
                       ELSE
                         MOVE   25400   TO   WRK-NYUINHOJO-MAX-KIN
                       END-IF
                     END-IF
                 END-EVALUATE
             END-EVALUATE
      *
             MOVE     "095"   TO   WRK-NYUINHOJO-HKNNUM
             PERFORM  2104FX1-JGNCHK-HENSYU3-SEC
             IF      FLG-COVID-ETC   = 1
               CONTINUE
             ELSE
               IF    FLG-COVID-SEIHO = 1
                   IF    FLG-TOKU75  =  3
                     IF  FLG-KOHYONKAIME = 1
                       MOVE   12300   TO   WRK-NYUINHOJO-MAX-KIN
                     ELSE
                       MOVE   12700   TO   WRK-NYUINHOJO-MAX-KIN
                     END-IF
                   ELSE
                     IF  FLG-KOHYONKAIME = 1
                       MOVE   24600   TO   WRK-NYUINHOJO-MAX-KIN
                     ELSE
                       MOVE   25400   TO   WRK-NYUINHOJO-MAX-KIN
                     END-IF
                   END-IF
               ELSE
                 IF      FLG-COVID-CYOKI2  = 1
      *            多数該当でない場合と多数該当の場合の上限は同じ
                   IF    FLG-TOKU75  =  3
                       MOVE    5000   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                       MOVE   10000   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF    FLG-COVID-CYOKI   = 1
                   OR    FLG-COVID-TANDOKU = 1
                       MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    FLG-KOUREI-GENEKIKBN  NOT =  ZERO
             EVALUATE   FLG-KOUREI-GENEKIKBN
               WHEN       1
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   70050   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE  123800   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE  140100   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE  247600   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       2
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   46500   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   81200   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   93000   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE  162400   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       3
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   22200   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   37550   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   44400   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   75100   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       4
                 IF     FLG-TOKU75  =  1 OR 2
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   22200   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   23800   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-KOHYONKAIME = 1
                     MOVE   44400   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   47600   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
               WHEN       5
      *          多数該当はない
                 IF     RECE62-TEISYOTOKU = "1" OR "4"
                   IF   FLG-TOKU75  =  1 OR 2
                     MOVE    2500   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE    5000   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 ELSE
                   IF   FLG-TOKU75  =  1 OR 2
                     MOVE    7300   TO   WRK-NYUINHOJO-MAX-KIN
                   ELSE
                     MOVE   14600   TO   WRK-NYUINHOJO-MAX-KIN
                   END-IF
                 END-IF
             END-EVALUATE
      *
             MOVE     "095"   TO   WRK-NYUINHOJO-HKNNUM
             PERFORM  2104FX1-JGNCHK-HENSYU3-SEC
             IF    FLG-COVID-ETC     = 1
               CONTINUE
             ELSE
               IF  FLG-COVID-SEIHO   = 1
                 IF   FLG-TOKU75  =  1 OR 2
                   MOVE    2500   TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                   MOVE    5000   TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
               ELSE
                 IF   FLG-COVID-CYOKI   = 1
                 OR   FLG-COVID-TANDOKU = 1
                   MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           PERFORM    2104FX2-JGNCHK-HENSYU4-SEC
      *
           .
       2104FY-JGNCHK-HENSYU8-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（治療薬補助公費）
      *    【２０２３年１０月から】
      *****************************************************************
       2104FZ-JGNCHK-HENSYU9-SEC      SECTION.
      *
           MOVE    ZERO   TO   WRK-NYUINHOJO-MAX-KIN
           EVALUATE   RECE62-KYURATE
             WHEN        10
                 IF     FLG-TOKU75  =  1 OR 2 OR 3
                     MOVE   1500    TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                     MOVE   3000    TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
             WHEN        20
                 IF     FLG-TOKU75  =  1 OR 2 OR 3
                     MOVE   3000    TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                     MOVE   6000    TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
             WHEN        30
                 IF     FLG-TOKU75  =  1 OR 2 OR 3
                     MOVE   4500    TO   WRK-NYUINHOJO-MAX-KIN
                 ELSE
                     MOVE   9000    TO   WRK-NYUINHOJO-MAX-KIN
                 END-IF
           END-EVALUATE
      *
           MOVE     "096"   TO   WRK-NYUINHOJO-HKNNUM
           PERFORM  2104FX1-JGNCHK-HENSYU3-SEC
           IF    FLG-COVID-ETC     = 1
           OR    FLG-COVID-SEIHO   = 1
           OR    FLG-COVID-CYOKI2  = 1
           OR    FLG-COVID-CYOKI   = 1
             CONTINUE
           ELSE
             IF  FLG-COVID-TANDOKU = 1
                     MOVE   ZERO    TO   WRK-NYUINHOJO-MAX-KIN
             END-IF
           END-IF
      *
           PERFORM  2104FX2-JGNCHK-HENSYU4-SEC
      *
           .
       2104FZ-JGNCHK-HENSYU9-EXT.
           EXIT.
      *
      *****************************************************************
      *    重複公費編集（外来レセプトのみに一部負担がある場合）
      *****************************************************************
       2104I-CYOFUKU-KOH-HENSYU-SEC      SECTION.
      *
           MOVE    ZERO                 TO  IDY4
           INITIALIZE                       TBL-CYOFUKU-KOH
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE62-PTID          TO  PTKOH-PTID
           MOVE    RECE62-KOHNUM(IDY2)  TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key4"             TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
               IF  (PTKOH-TEKSTYMD(1:6)  <=   RECE62-SRYYM       )
               AND (RECE62-SRYYM         <=   PTKOH-TEKEDYMD(1:6))
               AND (PTKOH-SAKJOKBN        =   SPACE              )
                 IF  ((PTKOH-KOHNUM = RECE62-KOHNUM(1)) AND
                      (PTKOH-KOHID  = RECE62-KOHID (1)))
                 OR  ((PTKOH-KOHNUM = RECE62-KOHNUM(2)) AND
                      (PTKOH-KOHID  = RECE62-KOHID (2)))
                 OR  ((PTKOH-KOHNUM = RECE62-KOHNUM(3)) AND
                      (PTKOH-KOHID  = RECE62-KOHID (3)))
                 OR  ((PTKOH-KOHNUM = RECE62-KOHNUM(4)) AND
                      (PTKOH-KOHID  = RECE62-KOHID (4)))
                   CONTINUE
                 ELSE
                   MOVE    ZERO           TO  FLG-CYOFUKU-KOH
                   IF   PTKOH-KOHNUM = "015" OR "016"
                     MOVE  RECE62-SRYYM   TO  WRK-CYOFUKU-KOH-YM
                     MOVE  01             TO  WRK-CYOFUKU-KOH-DD
                     IF   PTKOH-TEKSTYMD <=  WRK-CYOFUKU-KOH-YMD
                       CONTINUE
                     ELSE
                       MOVE    1          TO  FLG-CYOFUKU-KOH
                     END-IF
                   END-IF
                   IF  (PTKOH-KOHNUM   = "054" OR "052")
                   AND (RECE62-SRYYM  >= "201501"      )
                     IF  PTKOH-FTNJANUM = RECE62-KOHFTNJANUM(IDY2)
                       CONTINUE
                     ELSE
                       MOVE    1          TO  FLG-CYOFUKU-KOH
                     END-IF
                   END-IF
                   IF  (FLG-CYOFUKU-KOH  =  ZERO)
                   AND (IDY4             <   4  )
                     ADD      1           TO  IDY4
                     MOVE  PTKOH-KOHNUM   TO  TBL-CYOFUKU-KOHNUM(IDY4)
                     MOVE  PTKOH-KOHID    TO  TBL-CYOFUKU-KOHID (IDY4)
                   END-IF
                 END-IF
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
             END-PERFORM
           END-IF
           MOVE        "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE        "key4"             TO  MCP-PATHNAME
           PERFORM      900-CLOSE-SEC
      *
           PERFORM   VARYING  IDY4    FROM    1   BY   1
                      UNTIL  (IDY4                     >  4   )
                       OR    (TBL-CYOFUKU-KOHNUM(IDY4) = SPACE)
             INITIALIZE                 ORCSFTNJGNCHKAREA
             MOVE  RECE62-HOSPNUM   TO  LNK-FTNJGNCHK-HOSPNUM
             MOVE  RECE62-PTID      TO  LNK-FTNJGNCHK-PTID
             MOVE  "2"              TO  LNK-FTNJGNCHK-NYUGAIKBN
             MOVE  RECE62-SRYYM     TO  LNK-FTNJGNCHK-SRYYM
             MOVE  TBL-CYOFUKU-KOHNUM(IDY4)
                                    TO  LNK-FTNJGNCHK-KOHNUM
             MOVE  TBL-CYOFUKU-KOHID (IDY4)
                                    TO  LNK-FTNJGNCHK-KOHID
             MOVE  WRK-PREFNUM      TO  LNK-FTNJGNCHK-PREFNUM
             MOVE  ZERO             TO  LNK-FTNJGNCHK-HKNCOMBINUM
             MOVE  ZERO             TO  LNK-FTNJGNCHK-HKNID
             CALL  "ORCSFTNJGNCHK"  USING
                                    ORCSFTNJGNCHKAREA
                                    SPA-AREA
             ADD   LNK-FTNJGNCHK-KOHFTN
                                    TO  WRK-HKNFTNDATA-RUI
           END-PERFORM
      *
           .
       2104I-CYOFUKU-KOH-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（上限置き換え金額編集）
      *****************************************************************
       2104G1-JGNGAK-SET-SEC      SECTION.
      *
           IF      RECE62-SRYYM  >=  "201708"
             MOVE      57600   TO  WRK-KOH-GENDOGAKU
             IF    TBL-TOKUSITUFLG(IDX10) = 1
             OR    TBL-KANGANFLG(IDX10)   = 1
               IF  FLG-TOKUSITU-TASU      = 1
               OR  FLG-KANGAN-TASU        = 1
               OR  FLG-KOHYONKAIME        = 1
                 MOVE  44400   TO  WRK-KOH-GENDOGAKU
               END-IF
             ELSE
               IF  FLG-KOHYONKAIME        = 1
                 MOVE  44400   TO  WRK-KOH-GENDOGAKU
               END-IF
             END-IF
           ELSE
             IF    RECE62-SRYYM  >=  "200610"
               MOVE    44400   TO  WRK-KOH-GENDOGAKU
             ELSE
               MOVE    40200   TO  WRK-KOH-GENDOGAKU
             END-IF
           END-IF
           IF      RECE62-TEISYOTOKU  NOT =  SPACE
             EVALUATE  RECE62-TEISYOTOKU
               WHEN  "2"
               WHEN  "3"
                 MOVE  24600   TO  WRK-KOH-GENDOGAKU
               WHEN  "1"
               WHEN  "4"
                 MOVE  15000   TO  WRK-KOH-GENDOGAKU
             END-EVALUATE
           END-IF
      *
           IF   ( RECE62-ETC-KOHNUM(1)  =   "972" )
           OR   ( RECE62-ETC-KOHNUM(2)  =   "972" )
           OR   ( RECE62-ETC-KOHNUM(3)  =   "972" )
           OR   ( RECE62-ETC-KOHNUM(4)  =   "972" )
              IF   WRK-KOH-GENDOGAKU  >  10000
                  MOVE   10000    TO   WRK-KOH-GENDOGAKU
              END-IF
           END-IF
           IF   ( RECE62-ETC-KOHNUM(1)  =   "974" )
           OR   ( RECE62-ETC-KOHNUM(2)  =   "974" )
           OR   ( RECE62-ETC-KOHNUM(3)  =   "974" )
           OR   ( RECE62-ETC-KOHNUM(4)  =   "974" )
              IF   WRK-KOH-GENDOGAKU  >  20000
                  MOVE   20000    TO   WRK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           MOVE      ZERO           TO   WRK-GEN70-GENDOGAKU
           IF     FLG-GENBUTU70   NOT =  ZERO
              EVALUATE   FLG-GENBUTU70
                WHEN        1
                WHEN        2
                  MOVE       80100  TO   WRK-GEN70-GENDOGAKU
                  IF    RECE62-SRYYM      >= "201501"
                  AND   FLG-GENBUTU70-KBN  =  22
                    MOVE     57600  TO   WRK-GEN70-GENDOGAKU
                  END-IF
                  IF    TBL-TOKUSITUFLG(IDX10) = 1
                  OR    TBL-KANGANFLG(IDX10)   = 1
                    IF  FLG-TOKUSITU-TASU = 1
                    OR  FLG-KANGAN-TASU   = 1
                    OR  FLG-KOHYONKAIME   = 1
                       MOVE  44400  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME   = 1
                       MOVE  44400  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
                WHEN        3
                  MOVE       35400  TO   WRK-GEN70-GENDOGAKU
                  IF    TBL-TOKUSITUFLG(IDX10) = 1
                  OR    TBL-KANGANFLG(IDX10)   = 1
                    IF  FLG-TOKUSITU-TASU = 1
                    OR  FLG-KANGAN-TASU   = 1
                    OR  FLG-KOHYONKAIME   = 1
                       MOVE  24600  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME   = 1
                       MOVE  24600  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
              END-EVALUATE
              IF   ( RECE62-ETC-KOHNUM(1)  =   "972" )
              OR   ( RECE62-ETC-KOHNUM(2)  =   "972" )
              OR   ( RECE62-ETC-KOHNUM(3)  =   "972" )
              OR   ( RECE62-ETC-KOHNUM(4)  =   "972" )
                 IF   WRK-GEN70-GENDOGAKU  >  10000
                     MOVE  10000  TO   WRK-GEN70-GENDOGAKU
                 END-IF
              END-IF
              IF   ( RECE62-ETC-KOHNUM(1)  =   "974" )
              OR   ( RECE62-ETC-KOHNUM(2)  =   "974" )
              OR   ( RECE62-ETC-KOHNUM(3)  =   "974" )
              OR   ( RECE62-ETC-KOHNUM(4)  =   "974" )
                 IF   WRK-GEN70-GENDOGAKU  >  20000
                     MOVE  20000  TO   WRK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           END-IF
      *
           MOVE      15000        TO   WRK-SEIHO-GENDO
           IF  FLG-KOHYONKAIME = 1
              MOVE   24600        TO   WRK-SEIHO-GENDO70
           ELSE
              MOVE   35400        TO   WRK-SEIHO-GENDO70
           END-IF
           MOVE      10000        TO   WRK-CYOKI-GENDO
           MOVE      20000        TO   WRK-CYOKI-GENDO2
      *
           IF   FLG-GENGAKU-OKIKAE  =  1
             IF  FLG-TOKU75 = 1 OR 2 OR 3
               COMPUTE  WRK-KOH-GENDOGAKU   = WRK-KOH-GENDOGAKU
                                            / 2
               COMPUTE  WRK-GEN70-GENDOGAKU = WRK-GEN70-GENDOGAKU
                                            / 2
               COMPUTE  WRK-SEIHO-GENDO     = WRK-SEIHO-GENDO
                                            / 2
               COMPUTE  WRK-SEIHO-GENDO70   = WRK-SEIHO-GENDO70
                                            / 2
               COMPUTE  WRK-CYOKI-GENDO     = WRK-CYOKI-GENDO
                                            / 2
               COMPUTE  WRK-CYOKI-GENDO2    = WRK-CYOKI-GENDO2
                                            / 2
             END-IF
           END-IF
      *
           .
       2104G1-JGNGAK-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（上限置き換え金額編集）
      *****************************************************************
       2104G-JGNCHK-HENSYU-OKIKAE-SEC      SECTION.
      *
           MOVE      ZERO    TO     FLG-GENGAKU-OKIKAE
           MOVE      IDY2    TO     IDX10
           PERFORM   2104G1-JGNGAK-SET-SEC
      *
           IF  (RECE62-KOUREI    =   "1")
           OR  (FLG-KOUREI-KBN   =    1 )
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-KOH-GENDOGAKU
                 MOVE WRK-KOH-GENDOGAKU   TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF  FLG-GENBUTU70   NOT =   ZERO
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-GEN70-GENDOGAKU
                 MOVE WRK-GEN70-GENDOGAKU TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF   (RECE62-ETC-KOHNUM(1) = "972")
           OR   (RECE62-ETC-KOHNUM(2) = "972")
           OR   (RECE62-ETC-KOHNUM(3) = "972")
           OR   (RECE62-ETC-KOHNUM(4) = "972")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-CYOKI-GENDO
                 MOVE WRK-CYOKI-GENDO     TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF   (RECE62-ETC-KOHNUM(1) = "974")
           OR   (RECE62-ETC-KOHNUM(2) = "974")
           OR   (RECE62-ETC-KOHNUM(3) = "974")
           OR   (RECE62-ETC-KOHNUM(4) = "974")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-CYOKI-GENDO2
                 MOVE WRK-CYOKI-GENDO2    TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
      *
           .
       2104G-JGNCHK-HENSYU-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者の保険組合せに全国公費を含むかチェック
      *****************************************************************
       21041-KOREISYA-KOHI-SEC               SECTION.
      *
           INITIALIZE                   TBL-HKNCOMBI
      *
           MOVE      ZERO        TO     CNT-HKNCOMBI-KOHARI
      *
           MOVE      ZERO        TO     FLG-ZENKOH-ARI
           PERFORM   VARYING  IDX1    FROM    1   BY  1
                      UNTIL   IDX1    >       10
                       OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
                    IF      RECE62-HKNCOMBIFLG (IDX1)  =  1 OR 2
                       MOVE     1        TO     FLG-ZENKOH-ARI
                       MOVE    10        TO     IDX1
                    END-IF
           END-PERFORM
      *
           IF   FLG-ZENKOH-ARI  =  1
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1    >       10
                         OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
      ****    IF   RECE62-HKNCOMBIFLG(IDX1) =  1 OR 2
               INITIALIZE                      SYUNOU-REC
               MOVE  RECE62-HOSPNUM        TO  SYU-HOSPNUM
               MOVE  RECE62-NYUGAIKBN      TO  SYU-NYUGAIKBN
               MOVE  RECE62-PTID           TO  SYU-PTID
               MOVE  RECE62-SRYYM          TO  SYU-SRYYMD(1:6)
               MOVE  "__"                  TO  SYU-SRYYMD(7:2)
               MOVE  RECE62-HKNCOMBI(IDX1) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC            TO  MCPDATA-REC
               MOVE  "tbl_syunou"          TO  MCP-TABLE
               MOVE  "key19"               TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"      TO  MCP-TABLE
                 MOVE    "key19"           TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                   IF   SYU-DENPJTIKBN           NOT =  "3"
                     IF   RECE62-DAISANFLG(IDX1) NOT =   1
                       ADD   SYU-TOTAL-HKNTEN
                                TO  TBL-HKNCOMBI-TOTALTEN(IDX1)
                     END-IF
                     IF  (SYU-KOH-HKNNUM(1)  =
                          "012" OR "025" OR "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(2)  =
                          "012" OR "025" OR "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(3)  =
                          "012" OR "025" OR "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(4)  =
                          "012" OR "025" OR "972" OR "974")
                       MOVE  1  TO  TBL-HKNCOMBI-CHKFLG(IDX1)
                     END-IF
                     IF  (SYU-KOH-HKNNUM(1)  =  "092")
                     AND (SYU-NYNSHOKAISU    =    7  )
                       MOVE  1  TO  TBL-HKNCOMBI-CHKFLG2(IDX1)
                     END-IF
      *
                     IF ((SYU-KOH-HKNNUM(1)  =
                              SPACE OR "027" OR "972" OR "974") AND
                         (SYU-KOH-HKNNUM(2)  =  SPACE         ) AND
                         (SYU-KOH-HKNNUM(3)  =  SPACE         ) AND
                         (SYU-KOH-HKNNUM(4)  =  SPACE         ))
                     OR ( SYU-KOH-HKNNUM(1)  =  "970"          )
                     OR ((SYU-KOH-HKNNUM(1)  =  "092"         ) AND
                         (SYU-NYNSHOKAISU    =    7           ) AND
                         (SYU-KOH-HKNNUM(2)  =  SPACE         ) AND
                         (SYU-KOH-HKNNUM(3)  =  SPACE         ) AND
                         (SYU-KOH-HKNNUM(4)  =  SPACE         ))
                       CONTINUE
                     ELSE
                       MOVE  1  TO  TBL-HKNCOMBI-KOHARI(IDX1)
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"    TO  MCP-TABLE
                   MOVE    "key19"         TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"      TO  MCP-TABLE
               MOVE      "key19"           TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
               IF  (TBL-HKNCOMBI-TOTALTEN(IDX1) =  ZERO)
               AND (TBL-HKNCOMBI-CHKFLG(IDX1)   =  ZERO)
                 IF ((RECE62-KOHNUMHC(IDX1 1)      NOT = "027") AND
                     (RECE62-KOHNUMHC(IDX1 1)(1:1)     = "0"  ))
                 OR ((RECE62-KOHNUMHC(IDX1 2)      NOT = "027") AND
                     (RECE62-KOHNUMHC(IDX1 2)(1:1)     = "0"  ))
                 OR ((RECE62-KOHNUMHC(IDX1 3)      NOT = "027") AND
                     (RECE62-KOHNUMHC(IDX1 3)(1:1)     = "0"  ))
                 OR ((RECE62-KOHNUMHC(IDX1 4)      NOT = "027") AND
                     (RECE62-KOHNUMHC(IDX1 4)(1:1)     = "0"  ))
                     MOVE  1  TO  TBL-HKNCOMBI-CHKFLG(IDX1)
                 END-IF
               END-IF
      ****    END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1    >       10
                         OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
               IF    (RECE62-HKNCOMBIFLG(IDX1)    =  1 OR 2)
               AND   (TBL-HKNCOMBI-TOTALTEN(IDX1) =  ZERO  )
               AND   (TBL-HKNCOMBI-CHKFLG(IDX1)   =  ZERO  )
                 MOVE   ZERO    TO  RECE62-HKNCOMBIFLG(IDX1)
               END-IF
               IF    (RECE62-HKNCOMBIFLG(IDX1)    =  1 OR 2)
               AND   (TBL-HKNCOMBI-CHKFLG(IDX1)   =  ZERO  )
               AND   (TBL-HKNCOMBI-CHKFLG2(IDX1)  =  1     )
                 MOVE   ZERO    TO  RECE62-HKNCOMBIFLG(IDX1)
               END-IF
             END-PERFORM
      *
             MOVE       ZERO    TO  FLG-ZENKOH-ARI
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1    >       10
                         OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
               IF     RECE62-HKNCOMBIFLG(IDX1)    =  1 OR 2
                 MOVE     1     TO  FLG-ZENKOH-ARI
                 MOVE    10     TO  IDX1
               END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1    >       10
                         OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
               IF     TBL-HKNCOMBI-KOHARI(IDX1)   =  1
                 ADD      1     TO  CNT-HKNCOMBI-KOHARI
               END-IF
             END-PERFORM
           END-IF
      *
           MOVE      ZERO        TO     FLG-DOTANDOKU-IGAI
                                        FLG-DOTANDOKU
           IF   ( WRK-PREFNUM         =  "01"     )
           AND  ( RECE62-SRYYM       >=  "200510" )
           AND  ( RECE62-SRYYM       <   "200810" )
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1      >     4
               IF RECE62-KOHNUM(IDX1)(1:1) =  "0" OR "9"
                  IF  ( RECE62-KOHNUM(IDX1) =  "051"         )
                  AND ((RECE62-KOHJKYSNUM(IDX1)(1:2) >= "91"
                                                 AND <= "95") OR
                       (RECE62-KOHJKYSNUM(IDX1)(1:2) >= "71"
                                                 AND <= "88"))
                     MOVE    1     TO    FLG-DOTANDOKU
                  ELSE
                     MOVE    1     TO    FLG-DOTANDOKU-IGAI
                  END-IF
               END-IF
             END-PERFORM
             IF   (FLG-DOTANDOKU-IGAI   =   ZERO)
             AND  (FLG-DOTANDOKU        =    1  )
             AND  (FLG-ZENKOH-ARI       =    1  )
                     MOVE   ZERO   TO    FLG-ZENKOH-ARI
             END-IF
           END-IF
      *
           IF   FLG-ZENKOH-ARI  =  ZERO
             IF (TBL-TOKATUKAIFLG(1)  =  1)
             OR (TBL-TOKATUKAIFLG(2)  =  1)
             OR (TBL-TOKATUKAIFLG(3)  =  1)
             OR (TBL-TOKATUKAIFLG(4)  =  1)
                     MOVE     1    TO    FLG-ZENKOH-ARI
             END-IF
           END-IF
      *
           MOVE      ZERO        TO     FLG-TAISYO
           PERFORM   VARYING  IDX1    FROM    1   BY  1
                      UNTIL   IDX1    >       10
                       OR     RECE62-HKNCOMBI (IDX1)  =   ZERO
                 IF      RECE62-HKNCOMBIFLG (IDX1)  =  2
                     IF   FLG-TAISYO  =  ZERO
                        MOVE   1     TO   FLG-TAISYO
                     END-IF
                 ELSE
                     MOVE      9     TO   FLG-TAISYO
                 END-IF
           END-PERFORM
      *
           .
       21041-KOREISYA-KOHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者の一部負担金額記載に関するチェック
      *****************************************************************
       21042-KOREISYA-CHECK-SEC               SECTION.
      *
           MOVE    SPACE               TO  WRK-CHK-HKNJANUM
                                           WRK-CHK-HKNNUM
                                           WRK-CHK-HONKZKKBN
           MOVE    ZERO                TO  WRK-CHK-IDOU
                                           WRK-CHK-TAISYO
                                           WRK-CHK-HKNID
                                           WRK-CHK-CNT
                                           WRK-CHK-TAISYO2
                                           WRK-CHK-TOKU75-MAE
                                           FLG-TOKU75-XXX
                                           WRK-CHK-TAISYO3
      *
           INITIALIZE                      RECE69-REC
           MOVE    RECE62-HOSPNUM      TO  RECE69-HOSPNUM
           MOVE    RECE62-SRYYM        TO  RECE69-SRYYM
           MOVE    RECE62-NYUGAIKBN    TO  RECE69-NYUGAIKBN
           MOVE    RECE62-PTID         TO  RECE69-PTID
           MOVE    RECE62-RECEKA       TO  RECE69-RECEKA
      *
           START   RECE69-FILE
               KEY IS    >=   RECE69-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE69
               NOT INVALID
                   PERFORM 900-RECE69-NEXT-SEC
           END-START
           PERFORM UNTIL ( FLG-RECE69           =   1                )
                   OR    ( RECE62-HOSPNUM   NOT =   RECE69-HOSPNUM   )
                   OR    ( RECE62-SRYYM     NOT =   RECE69-SRYYM     )
                   OR    ( RECE62-NYUGAIKBN NOT =   RECE69-NYUGAIKBN )
                   OR    ( RECE62-PTID      NOT =   RECE69-PTID      )
                   OR    ( RECE62-RECEKA    NOT =   RECE69-RECEKA    )
      *
               EVALUATE    RECE69-TEISYUTUSAKI
                   WHEN    "1"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE69-HKNJANUM  NOT =  SPACE
                            MOVE    1             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                            IF  (FLG-TOKU75  =  2 OR 3                 )
                            AND (RECE69-TEKSTYMDX < WRK-TOKU75-BIRTHDAY)
                                 MOVE     1    TO    WRK-CHK-TOKU75-MAE
                            END-IF
                         END-IF
                       WHEN     1
                         ADD     1                TO  WRK-CHK-CNT
                         IF   (RECE62-KOUREI    =   "1")
                         OR   (FLG-TOKU75    =  1 OR 2 )
                          IF  (RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                              IF  (FLG-TOKU75   = 2                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    1      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         ELSE
                          IF ((RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM ))
                          OR ( RECE69-HONKZKKBN NOT =
                                                  WRK-CHK-HONKZKKBN )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                          AND (RECE69-HONKZKKBN =  WRK-CHK-HONKZKKBN)
                              IF  (FLG-TOKU75   = 3                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    2      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         END-IF
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                     END-EVALUATE
                   WHEN    "2"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE69-HKNJANUM  NOT =  SPACE
                            MOVE    2             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                            IF  (FLG-TOKU75  =  2 OR 3                 )
                            AND (RECE69-TEKSTYMDX < WRK-TOKU75-BIRTHDAY)
                                 MOVE     1    TO    WRK-CHK-TOKU75-MAE
                            END-IF
                         END-IF
                       WHEN     1
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         IF   (RECE62-HKNNUM  = "060"  )
                         OR   (RECE62-KOUREI  = "1"    )
                         OR   (FLG-TOKU75     =  1 OR 2)
                          IF  (RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                              IF  (FLG-TOKU75   = 2                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    1      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         ELSE
                          IF ((RECE69-HKNJANUM  NOT = SPACE        ) AND
                              (RECE69-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM ))
                          OR ( RECE69-HONKZKKBN NOT =
                                                  WRK-CHK-HONKZKKBN )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE69-HKNJANUM  NOT = SPACE         )
                          AND (RECE69-HKNJANUM  =  WRK-CHK-HKNJANUM )
                          AND (RECE69-HONKZKKBN =  WRK-CHK-HONKZKKBN)
                              IF  (FLG-TOKU75   = 3                  )
                              AND (RECE69-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    2      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         END-IF
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                     END-EVALUATE
                   WHEN    "6"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE69-HKNJANUM  NOT =  SPACE
                            MOVE    6             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                         END-IF
                       WHEN     1
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE62-HKNNUM  =  "039"
                          IF  FLG-TOKU75     =   ZERO
                            IF    FLG-TAISYO   =    1
                                MOVE    1         TO  WRK-CHK-TAISYO
                            END-IF
                          ELSE
                            MOVE    1             TO  WRK-CHK-CNT
                            MOVE    6             TO  WRK-CHK-IDOU
                            MOVE  RECE69-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE69-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE69-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE69-HKNNUM   TO  WRK-CHK-HKNNUM
                            MOVE   ZERO           TO  WRK-CHK-TAISYO
                          END-IF
                         END-IF
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         IF  (RECE69-HKNJANUM  NOT = SPACE        ) AND
                             (RECE69-HKNJANUM  NOT =
                                                 WRK-CHK-HKNJANUM )
                             MOVE    1            TO  WRK-CHK-TAISYO
                             MOVE    1            TO  WRK-CHK-TAISYO3
                         END-IF
                     END-EVALUATE
               END-EVALUATE
      *
               PERFORM 900-RECE69-NEXT-SEC
           END-PERFORM
      *
           IF   (RECE62-SRYYM       >=  "201204")
           AND  (WRK-CHK-TAISYO3     =   1      )
           AND  (WRK-CHK-CNT         =   2      )
             IF  (RECE62-HKNJANUM  NOT = SPACE           )
             AND (RECE62-HKNJANUM  NOT = WRK-CHK-HKNJANUM)
                  MOVE    1      TO  FLG-GENBUTU-HANTEI2
             END-IF
           END-IF
      *
           IF   (RECE62-HKNNUM    NOT = "039")
           AND  (FLG-TOKU75       =  2 OR 3  )
           AND  (WRK-CHK-TAISYO2  NOT =  ZERO)
           AND  (WRK-CHK-CNT      =  2       )
              EVALUATE  WRK-CHK-TAISYO2
                WHEN      1
                  IF  (RECE62-HKNJANUM  NOT = SPACE        )
                  AND (RECE62-HKNJANUM  = WRK-CHK-HKNJANUM )
                    MOVE      1     TO    FLG-TOKU75-XXX
                  END-IF
                WHEN      2
                  IF  (RECE62-HKNJANUM  NOT = SPACE        )
                  AND (RECE62-HKNJANUM  = WRK-CHK-HKNJANUM )
                  AND (RECE62-HONKZKKBN = WRK-CHK-HONKZKKBN)
                    MOVE      1     TO    FLG-TOKU75-XXX
                  END-IF
              END-EVALUATE
           END-IF
      *
           IF    RECE62-SRYYM       >=  "200804"
             IF  ((RECE62-KOUREI       =   "1"         ) AND
                  (RECE62-HKNNUM       =   "039"       ) AND
                  (FLG-TAISYO          =    1          ))
             OR  ((RECE62-KOUREI       =   "1"  OR  "2") AND
                  (RECE62-HKNNUM   NOT =   "039"       ) AND
                  (FLG-TAISYO          =    1          ) AND
                  (FLG-TOKU75          =   ZERO        ))
                CONTINUE
             ELSE
                MOVE   ZERO    TO  WRK-CHK-TAISYO
             END-IF
           ELSE
             IF  ( RECE62-KOUREI       =   "1"          )
             OR  ((RECE62-KOUREI       =   "2"         ) AND
                  (FLG-TAISYO          =    1          ))
                CONTINUE
             ELSE
                MOVE   ZERO    TO  WRK-CHK-TAISYO
             END-IF
           END-IF
      *
           IF  ((  WRK-CHK-TAISYO       =  1                 )  AND
                (  WRK-CHK-CNT          =  2                 )  AND
                (((RECE62-HKNJANUM  NOT = SPACE            ) AND
                  (RECE62-HKNJANUM  NOT = WRK-CHK-HKNJANUM ))  OR
                 ( RECE62-HONKZKKBN NOT = WRK-CHK-HONKZKKBN )))
           OR  ((  WRK-CHK-TAISYO       =  ZERO              )  AND
                (  WRK-CHK-CNT          =  2                 )  AND
                (  RECE62-RECEIPT-KBN(2:3)  NOT = SPACE      )  AND
                (  RECE62-RECEIPT-KBN(4:1)      = "2"        ))
      *
                INITIALIZE                 ORCSKOREIFTNCHKAREA
                MOVE    RECE62-HOSPNUM TO  LNK-KOREIFTNCHK-HOSPNUM
                MOVE    RECE62-PTID    TO  LNK-KOREIFTNCHK-PTID
                MOVE    "1"            TO  LNK-KOREIFTNCHK-NYUGAIKBN
                MOVE    RECE62-SRYYM   TO  LNK-KOREIFTNCHK-SRYYM
                MOVE    WRK-CHK-HKNNUM TO  LNK-KOREIFTNCHK-HKNNUM
                MOVE    WRK-CHK-HKNID  TO  LNK-KOREIFTNCHK-HKNID
                MOVE    RECE62-TEISYOTOKU
                                       TO  LNK-KOREIFTNCHK-TEISYOTOKU
                MOVE    SPACE          TO  LNK-KOREIFTNCHK-RECEKA
                MOVE    RECE62-RJNGENMENKBN
                                       TO  LNK-KOREIFTNCHK-KEIKASOCHI
                MOVE    WK-GENGAKUKBN  TO  LNK-KOREIFTNCHK-GENGAKUKBN
                MOVE    WK-GENGAKU-RITU
                                       TO  LNK-KOREIFTNCHK-GENGAKU-RITU
                MOVE    WK-GENGAKU-KIN TO  LNK-KOREIFTNCHK-GENGAKU-KIN
                MOVE    WK-GENGAKUKBN-KEISAN
                                       TO  LNK-KOREIFTNCHK-GENGAKUFLG
                MOVE    FLG-KOHYONKAIME
                                       TO  LNK-KOREIFTNCHK-KOHYONKAIME
                MOVE    RECE62-KOUREI  TO  LNK-KOREIFTNCHK-NENREIKBN
                MOVE    RECE62-AGE     TO  LNK-KOREIFTNCHK-AGE
                MOVE    WRK-PREFNUM    TO  LNK-KOREIFTNCHK-PREFNUM
                MOVE    RECE62-SYUGAKUKBN
                                       TO  LNK-KOREIFTNCHK-SYUGAKUKBN
                MOVE    RECE62-KOHID(1)
                                       TO  LNK-KOREIFTNCHK-KOHID-CYOKI
                MOVE    FLG-TOKU75     TO  LNK-KOREIFTNCHK-TOKU75
                IF      RECE62-SRYYM   >=  "200804"
                     MOVE      1       TO  LNK-KOREIFTNCHK-CYOKINOMI
                ELSE
                  IF   (RECE62-KOUREI   =   "2")
                  AND  (FLG-TAISYO      =    1 )
                     MOVE      1       TO  LNK-KOREIFTNCHK-CYOKINOMI
                  END-IF
                END-IF
      *
                CALL    "ORCSKOREIFTNCHK"   USING
                                            ORCSKOREIFTNCHKAREA
                                            SPA-AREA
                IF      LNK-KOREIFTNCHK-RC   =   ZERO
      ***           MOVE   LNK-KOREIFTNCHK-FTNGAKU
      ***                              TO  WRK-CHK-FTNGAKU
                    MOVE   LNK-KOREIFTNCHK-KOHFTNGAKU
                                       TO  WRK-CHK-KOHFTNGAKU
                    IF  FLG-ZENKOKUKOHI-NISYU = ZERO
                      MOVE   LNK-KOREIFTNCHK-ICHIBUGAKU
                                       TO  FTN-KOH-XXX
                                           WRK-CHK-ICHIBUGAKU
                      MOVE   LNK-KOREIFTNCHK-ICHIBUGAKU2
                                       TO  WRK-CHK-ICHIBUGAKU2
                    END-IF
      ***           MOVE   LNK-KOREIFTNCHK-CHIHOUGAKU
      ***                              TO  WRK-CHIHOU-KIN
                END-IF
      *
           END-IF
      *
           IF   FLG-TOKU75-XXX  =  1
              MOVE    ZERO    TO    FLG-TOKU75
           END-IF
      *
           .
       21042-KOREISYA-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック
      *****************************************************************
       2104L-CYOKI-CHECK-SEC                SECTION.
      *
           INITIALIZE                        SYUNOU-REC
           MOVE    RECE62-HOSPNUM       TO   SYU-HOSPNUM
           MOVE    RECE62-NYUGAIKBN     TO   SYU-NYUGAIKBN
           MOVE    RECE62-PTID          TO   SYU-PTID
           MOVE    RECE62-SRYYM         TO   SYU-SRYYMD(1:6)
           MOVE    "__"                 TO   SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO   MCPDATA-REC
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key17"              TO   MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =    ZERO
             MOVE  "tbl_syunou"         TO   MCP-TABLE
             MOVE  "key17"              TO   MCP-PATHNAME
             PERFORM  900-SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU     = 1)
               PERFORM  VARYING  IDX1  FROM  1  BY  1
                         UNTIL  (IDX1    >  10               )
                          OR    (RECE62-HKNCOMBI(IDX1) = ZERO)
                 IF  SYU-HKNCOMBINUM  =  RECE62-HKNCOMBI(IDX1)
                   IF  (SYU-DENPJTIKBN         NOT =  "3")
                   AND (SYU-TOTAL-HKNTEN       NOT = ZERO)
                   AND (RECE62-DAISANFLG(IDX1) NOT =   1 )
                     IF  (SYU-KOH-HKNNUM(1) =  "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(2) =  "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(3) =  "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(4) =  "972" OR "974")
                         PERFORM 2104L1-CYOKI-HENSYU1-SEC
                     END-IF
                   END-IF
                   MOVE    10           TO   IDX1
                 END-IF
               END-PERFORM
               MOVE  "tbl_syunou"       TO   MCP-TABLE
               MOVE  "key17"            TO   MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE      "tbl_syunou"       TO   MCP-TABLE
           MOVE      "key17"            TO   MCP-PATHNAME
           PERFORM    900-CLOSE-SEC
      *
           PERFORM  VARYING  IDX1   FROM  1   BY  1
                     UNTIL   IDX1    >   10
             EVALUATE  WRK-SYUNOU-CYOKI-KOHFLG(IDX1)
               WHEN       1
                 ADD    1      TO    CNT-CYOKI-HENSYU1
               WHEN       2
                 ADD    1      TO    CNT-CYOKI-HENSYU2
             END-EVALUATE
           END-PERFORM
      *
           IF  (CNT-CYOKI-HENSYU1      =  1             )
           AND (CNT-CYOKI-HENSYU2      =  1             )
      *****AND (FLG-ZENKOKUKOHI-NISYU  =  ZERO OR 2 OR 4)
             PERFORM 2104L2-CYOKI-HENSYU2-SEC
           END-IF
      *
      *    マル長レセプト記載処理区分の編集
      *
           IF   (RECE62-SRYYM                >=  "202001")
      **>  AND  (CNT-CYOKI-HENSYU1            =   1      )
      **>  AND  (CNT-CYOKI-HENSYU2            =   1      )
           AND  (CNT-CYOKI-HENSYU1        NOT =  ZERO    )
           AND  (CNT-CYOKI-HENSYU2        NOT =  ZERO    )
           AND  (WRK-SYUNOU-CYOKI-KEISANFLG   =   1      )
           AND  (WRK-SYUNOU-CYOKI-KEISANFLG2  =  ZERO    )
             IF   (FLG-CYOKI-HENSYU   =   1  )
             AND  (FLG-CYOKI-HENSYU3  =  ZERO)
               CONTINUE
             ELSE
               MOVE    1    TO  FLG-CYOKI-HENSYU4
             END-IF
           END-IF
      *
           .
       2104L-CYOKI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック編集
      *****************************************************************
       2104L1-CYOKI-HENSYU1-SEC              SECTION.
      *
           IF    FLG-CYOKI-HENSYU2  =  ZERO
             MOVE   1   TO   FLG-CYOKI-HENSYU2
             IF  (SYU-KOH-HKNNUM(1) =  "972")
             OR  (SYU-KOH-HKNNUM(2) =  "972")
             OR  (SYU-KOH-HKNNUM(3) =  "972")
             OR  (SYU-KOH-HKNNUM(4) =  "972")
               EVALUATE   RECE62-KOUREI
                 WHEN      "1"
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE      5000   TO   WRK-KINGAKU
                     ELSE
                       MOVE     10000   TO   WRK-KINGAKU
                     END-IF
                 WHEN      "2"
                     IF  FLG-TOKU75 = 3
                       MOVE      5000   TO   WRK-KINGAKU
                     ELSE
                       MOVE     10000   TO   WRK-KINGAKU
                     END-IF
               END-EVALUATE
             ELSE
               EVALUATE   RECE62-KOUREI
                 WHEN      "1"
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE     10000   TO   WRK-KINGAKU
                     ELSE
                       MOVE     20000   TO   WRK-KINGAKU
                     END-IF
                 WHEN      "2"
                     IF  FLG-TOKU75 = 3
                       MOVE     10000   TO   WRK-KINGAKU
                     ELSE
                       MOVE     20000   TO   WRK-KINGAKU
                     END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           MOVE  SYU-HKNCOMBINUM
                      TO   WRK-SYUNOU-CYOKI-HKNCOMBINUM(IDX1)
      *
           IF   (SYU-KOH-HKNNUM(1) =  "972" OR "974")
           AND  (SYU-KOH-HKNNUM(2) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(3) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(4) =  SPACE         )
             MOVE  1  TO   WRK-SYUNOU-CYOKI-KOHFLG(IDX1)
      *
             COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                                 * 10
                                 * RECE62-KYURATE
                                 / 100
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
             IF   FTN-CYOKI-XX2  >=  WRK-KINGAKU
               IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                 MOVE      1         TO  FLG-CYOKI-HENSYU3
               END-IF
             ELSE
               IF  FTN-CYOKI-XXX  >  WRK-KINGAKU
                 MOVE  WRK-KINGAKU   TO  FTN-CYOKI-XXX
               END-IF
               COMPUTE FTN-CYOKI-YYY = WRK-KINGAKU - FTN-CYOKI-XXX
               IF  WRK-FTNKEI     >  FTN-CYOKI-YYY
                 ADD  FTN-CYOKI-YYY  TO  FTN-CYOKI-XXX
               ELSE
                 ADD  WRK-FTNKEI     TO  FTN-CYOKI-XXX
               END-IF
             END-IF
           ELSE
             MOVE  2  TO   WRK-SYUNOU-CYOKI-KOHFLG(IDX1)
             MOVE  9999999           TO  FTN-CYOKI-XX2
           END-IF
      *
      ***  IF  FTN-CYOKI-XX2  >  WRK-KINGAKU
      ***    MOVE  WRK-KINGAKU   TO  FTN-CYOKI-XX2
      ***  END-IF
      ***  COMPUTE FTN-CYOKI-YY2 = WRK-KINGAKU - FTN-CYOKI-XX2
      ***  IF  WRK-FTNKEI     >  FTN-CYOKI-YY2
      ***    ADD  FTN-CYOKI-YY2  TO  FTN-CYOKI-XX2
      ***  ELSE
      ***    ADD  WRK-FTNKEI     TO  FTN-CYOKI-XX2
      ***  END-IF
      *
           IF   (RECE62-SRYYM     >=  "202001"      )
           AND  (SYU-KOH-HKNNUM(1) =  "972" OR "974")
           AND  (SYU-KOH-HKNNUM(2) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(3) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(4) =  SPACE         )
             IF  SYU-SECMONEY      =   2
               MOVE    1    TO    WRK-SYUNOU-CYOKI-KEISANFLG2
             ELSE
               MOVE    1    TO    WRK-SYUNOU-CYOKI-KEISANFLG
             END-IF
           END-IF
      *
           .
       2104L1-CYOKI-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック編集２
      *    ＜月途中の公費適用前に「主保険＋長期」での診療があるか＞
      *****************************************************************
       2104L2-CYOKI-HENSYU2-SEC              SECTION.
      *
           PERFORM  VARYING  IDX1   FROM  1   BY  1
                     UNTIL   IDX1    >   10
             IF   WRK-SYUNOU-CYOKI-KOHFLG(IDX1)  NOT =  ZERO
               INITIALIZE                  HKNCOMBI-REC
               MOVE    RECE62-HOSPNUM  TO  COMB-HOSPNUM
               MOVE    RECE62-PTID     TO  COMB-PTID
               MOVE    WRK-SYUNOU-CYOKI-HKNCOMBINUM(IDX1)
                                       TO  COMB-HKNCOMBINUM
               MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
               PERFORM 900-HKNCOMBI-INV-SEC
               IF      FLG-HKNCOMBI    =   ZERO
                 MOVE  RECE62-SRYYM
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(1:6)
                 IF   COMB-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                    MOVE   COMB-TEKSTYMD(7:2)
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(7:2)
                    IF  (COMB-KOH1HKNNUM = "095" OR "096")
                    AND (COMB-TEKSTYMD   = "20230508"    )
                      MOVE   "01"
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(7:2)
                    END-IF
                 ELSE
                    MOVE   "01"
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(7:2)
                 END-IF
      *
                 IF   WRK-SYUNOU-CYOKI-KOHFLG(IDX1) = 1
                    MOVE   WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD-XXX
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           IF   WRK-SYUNOU-CYOKI-TEKSTYMD-XXX   NOT =  SPACE
             PERFORM  VARYING  IDX1   FROM  1   BY  1
                       UNTIL   IDX1    >   10
               IF   WRK-SYUNOU-CYOKI-KOHFLG(IDX1) = 2
                 IF   WRK-SYUNOU-CYOKI-TEKSTYMD-XXX
                                 < WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)
                   MOVE  1  TO  WRK-SYUNOU-CYOKI-HANTEIFLG
                 ELSE
                   MOVE  1  TO  WRK-SYUNOU-CYOKI-HANTEIFLG2
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
           IF  (WRK-SYUNOU-CYOKI-HANTEIFLG  =  1  )
           AND (WRK-SYUNOU-CYOKI-HANTEIFLG2 = ZERO)
             IF    FTN-KOH-XXX   <   WRK-KINGAKU
               COMPUTE  WRK-SYUNOU-CYOKI-FTNMONEY2 = WRK-KINGAKU
                                                   - FTN-KOH-XXX
               IF  WRK-SYUNOU-CYOKI-FTNMONEY2 < FTN-CYOKI-XXX
                 MOVE   WRK-SYUNOU-CYOKI-FTNMONEY2
                               TO  WRK-SYUNOU-CYOKI-FTNMONEY
               ELSE
                 MOVE   FTN-CYOKI-XXX
                               TO  WRK-SYUNOU-CYOKI-FTNMONEY
               END-IF
               IF  WRK-SYUNOU-CYOKI-FTNMONEY  NOT = ZERO
                 ADD    WRK-SYUNOU-CYOKI-FTNMONEY
                               TO  FTN-KOH-XXX
                                   WRK-CHK-ICHIBUGAKU
                                   RECE62-FTNMONEY(1)
                 MOVE     1    TO  FLG-CYOKI-HENSYU
               END-IF
             END-IF
           END-IF
      *
           .
       2104L2-CYOKI-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送−負担金（Ｆ００２）
      *****************************************************************
       21044-RECE62-FTN-HENSYU-SEC               SECTION.
      *
           IF  FLG-HANTEI2  =  1
             IF    SYU-YKZKENNUM   =   1  OR  2  OR  5
                COMPUTE  WK-GENGAKU-KEISAN1 = SYU-TOTAL-HKNTEN
                                            * 10
                                            * RECE62-KYURATE
                                            / 100
                ADD   WK-GENGAKU-KEISAN1  TO  WK-GENGAKU-KEISAN2
      *
                COMPUTE  WK-GENGAKU-KEISAN1 = SYU-TOTAL-HKNTEN
                                            * 10
                                            * RECE62-KYURATE
                                            / 100
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1 +  5
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1 / 10
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1 * 10
                ADD   WK-GENGAKU-KEISAN1  TO  WK-GENGAKU-KEISAN3
      *
                IF   (SYU-SYUHKNNUM   NOT =  SPACE)
                AND  (SYU-KOH1HKNNUM      =  SPACE)
                AND  (SYU-KOH2HKNNUM      =  SPACE)
                AND  (SYU-KOH3HKNNUM      =  SPACE)
                AND  (SYU-KOH4HKNNUM      =  SPACE)
                  CONTINUE
                ELSE
                  MOVE  1     TO   FLG-GENGAKU5
                END-IF
             END-IF
      *
             IF    SYU-YKZKENNUM  NOT = ZERO
                MOVE    1     TO   FLG-GENMEN-ARI
             ELSE
                MOVE    1     TO   FLG-GENMEN-NASI
                IF     SYU-KOH-HKNNUM(1) = "970"
                  ADD   SYU-SYUCOMPFTN     TO   WRK-GENMEN-NASI-KIN
                  ADD   SYU-KOH1SKJ-FTN-RECE
                                           TO   WRK-GENMEN-NASI-SKJ
                ELSE
                  ADD   SYU-HKNTEKMONEY    TO   WRK-GENMEN-NASI-KIN
                  ADD   SYU-KOH-FTN        TO   WRK-GENMEN-NASI-KIN
                  ADD   SYU-SKYMONEY-SKJ   TO   WRK-GENMEN-NASI-SKJ
                  ADD   SYU-SKYMONEY-LIFE  TO   WRK-GENMEN-NASI-SKJ
                END-IF
             END-IF
             IF   (FLG-SAIGAI-TAISYO  =  1    )
             AND  (RECE62-HKNNUM      =  SPACE)
                PERFORM    VARYING   IDX-SAI    FROM   1   BY   1
                            UNTIL    IDX-SAI      >   31
                  IF   SYU-DAY(IDX-SAI)   =   "1"  OR  "2"  OR  "9"
                      IF   IDX-SAI  <  WRK-SAIGAI-DD
                         MOVE    1     TO   FLG-GENMEN-NASI2
                      ELSE
                         MOVE    1     TO   FLG-GENMEN-ARI2
                      END-IF
                  END-IF
                END-PERFORM
                ADD   SYU-HKNTEKMONEY
                              TO   WRK-GENMEN-NASI-KIN2
                ADD   SYU-KOH-FTN
                              TO   WRK-GENMEN-NASI-KIN2
                ADD   SYU-SKYMONEY-SKJ
                              TO   WRK-GENMEN-NASI-SKJ2
                ADD   SYU-SKYMONEY-LIFE
                              TO   WRK-GENMEN-NASI-SKJ2
             END-IF
      *
      *      請求額収納編集
             PERFORM   210448-SKY-SYUNOU-HENSYU-SEC
           END-IF
      *
      *    収納より総点数を集計
           ADD       SYU-TOTAL-HKNTEN   TO   RECE62-RJNGAIFTN
      *
           IF   RECE62-NYUINRYOFLG       =   "1"
           AND  FLG-NYUINRYO             =   ZERO
               PERFORM         210441-NYUINRYOFLG-SET-SEC
           END-IF
      *
           IF   RECE62-SRYYM   >=  "201604"
               PERFORM         210445-SKJ-KINGAKU-HENSYU2-SEC
           ELSE
               PERFORM         210445-SKJ-KINGAKU-HENSYU-SEC
           END-IF
      *
           IF      SYU-SYUSKJ-RYOYOHI  NOT =  ZERO
                   ADD   SYU-SYUSKJ-NISSU     TO  
                                       RECE62-SHOKUJINISSU(1)
                   ADD   SYU-SYUSKJ-RYOYOHI   TO
                                       RECE62-SHOKUJIRYOYOHI(1)
                   ADD   SYU-SYUSKJ-FTN-RECE  TO
                                       RECE62-SHOKUJIFTN(1)
                   IF    RECE62-SRYYM      >=  "200604"
                     ADD SYU-SYUSKJ-RYOYOHI   TO
                                       RECE62-HENSHOKUJIRYOYOHI(1)
                   END-IF
           END-IF
           IF      RECE62-RJNHKNNUM    NOT =  SPACE
             IF      SYU-SKJ-RYOYOHI(1)  NOT =  ZERO
                   ADD   SYU-SKJ-NISSU(1)     TO  
                                       RECE62-SHOKUJINISSU(1)
                   ADD   SYU-SKJ-RYOYOHI(1)   TO
                                       RECE62-SHOKUJIRYOYOHI(1)
                   ADD   SYU-SKJ-FTN-RECE(1)  TO
                                       RECE62-SHOKUJIFTN(1)
                   IF    RECE62-SRYYM      >=  "200604"
                     ADD SYU-SKJ-RYOYOHI(1)   TO
                                       RECE62-HENSHOKUJIRYOYOHI(1)
                   END-IF
             END-IF
           END-IF
      *
           IF      RECE62-SRYYM      >=  "200210"
             IF    RECE62-KOUREI   =   "1" OR "2"
               IF  SYU-SYUHKNNUM  NOT = SPACE
                EVALUATE  RECE62-KOUREI
                  WHEN      "1"
                    PERFORM     210442-HOKEN-FUTAN-HENSYU-SEC
                  WHEN      "2"
                    PERFORM     210447-HOKEN-FUTAN-HENSYU2-SEC
                END-EVALUATE
               END-IF
             ELSE                                                       
      *         船員保険（被保険者）＋通勤災害
                IF    RECE62-SENIN-TUUSAI     =    "1"
                   ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)
                END-IF
                IF  (IDZ                 =     1    )
                AND (RECE62-SRYYM       >=  "201004")
                AND (SYU-SYUHKNNUM   NOT =   SPACE  )
                  IF    RECE62-SENIN-TUUSAI     =    "1"
                    CONTINUE
                  ELSE
                    MOVE    1    TO   FLG-WRKFILE-CLEAR
                    IF   RECE62-KOUREI-HANTEIFLG   =   "1"
                      PERFORM   210442-HOKEN-FUTAN-HENSYU-SEC
                    ELSE
                      PERFORM   210447-HOKEN-FUTAN-HENSYU2-SEC
                    END-IF
                  END-IF
                END-IF
             END-IF
           ELSE
             IF    RECE62-RJNHKNNUM    NOT =    SPACE
                ADD    SYU-KOH1COMPFTN  TO   RECE62-FTNMONEY(1)
             END-IF
      *      船員保険（被保険者）＋通勤災害
             IF    RECE62-SENIN-TUUSAI     =    "1"
                ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)
             END-IF
           END-IF
      *
           MOVE    IDX1            TO  HC-IDX
      *
           MOVE    ZERO            TO  KH-IDX
      *
           IF  FLG-HANTEI2  =  1
            PERFORM    VARYING   IDX2    FROM   1   BY   1
              UNTIL    IDX2      >       4
              IF      RECE62-KOHNUMHC(HC-IDX IDX2)  NOT =  SPACE
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(1)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(1)
                      MOVE    2          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(1)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
                 END-IF
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(2)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(2)
                      MOVE    3          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(2)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
                 END-IF
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(3)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(3)
                      MOVE    4          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(3)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
                 END-IF
                 IF   RECE62-KOHNUMHC(HC-IDX IDX2) =  RECE62-KOHNUM(4)
                 AND  RECE62-KOHIDHC(HC-IDX IDX2)  =  RECE62-KOHID(4)
                      MOVE    5          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE62-KOHNUM(4)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210446-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210444-FTNMONEY-FTN-HENSYU-SEC
      *
                      PERFORM   210443-KOHJNISSUTBL-SET-SEC
                 END-IF
              END-IF
            END-PERFORM
      *
      *     ３歳児視覚聴覚精密健康診査（地域公費）の点数集計
            EVALUATE   WRK-PREFNUM
             WHEN    "38"
               IF   (SYU-KOH-HKNNUM(1) = "394")
               OR   (SYU-KOH-HKNNUM(2) = "394")
               OR   (SYU-KOH-HKNNUM(3) = "394")
               OR   (SYU-KOH-HKNNUM(4) = "394")
                 IF  RECE62-TEISYUTUSAKI  =  2
                    MOVE   1                TO  RECE62-SEIKENFLG
                    ADD   SYU-TOTAL-HKNTEN  TO  RECE62-SEIKENTEN
                 END-IF
               END-IF
            END-EVALUATE
           END-IF
      *
      *    レセプト記載外公費用一部負担金編集
           MOVE       IDX1       TO     HC-IDX
           IF  FLG-HANTEI2  =  1
             PERFORM    VARYING   IDX2    FROM   1   BY   1
                         UNTIL    IDX2      >    4
               PERFORM  VARYING   IDX45   FROM   1   BY   1
                         UNTIL   (IDX45                    >  4   )
                           OR    (RECE62-ETC-KOHNUM(IDX45) = SPACE)
                 IF    RECE62-KOHNUMHC(HC-IDX IDX2)  NOT =  SPACE
                   IF   (RECE62-KOHNUMHC(HC-IDX IDX2) =
                                             RECE62-ETC-KOHNUM(IDX45))
                   AND  (RECE62-KOHIDHC (HC-IDX IDX2) =
                                             RECE62-ETC-KOHID (IDX45))
                     EVALUATE  TRUE
                       WHEN RECE62-ETC-KOHNUM(IDX45) = SYU-KOH-HKNNUM(1)
                              MOVE     1    TO   IDX3
                       WHEN RECE62-ETC-KOHNUM(IDX45) = SYU-KOH-HKNNUM(2)
                              MOVE     2    TO   IDX3
                       WHEN RECE62-ETC-KOHNUM(IDX45) = SYU-KOH-HKNNUM(3)
                              MOVE     3    TO   IDX3
                       WHEN RECE62-ETC-KOHNUM(IDX45) = SYU-KOH-HKNNUM(4)
                              MOVE     4    TO   IDX3
                     END-EVALUATE
      *
                     PERFORM   21044A-FTNMONEY-HENSYU-ETC-SEC
                   END-IF
                 END-IF
               END-PERFORM
             END-PERFORM
           END-IF
      *
      *    生活保護交付番号記載情報編集
           MOVE       IDX1       TO     HC-IDX
           IF   SYS-200501-KOFUNUM-KSIKBN  =  "1"
             PERFORM    VARYING   IDX2    FROM   1   BY   1
                         UNTIL    IDX2      >    4
               PERFORM  VARYING   IDX45   FROM   1   BY   1
                         UNTIL   (IDX45                >  4   )
                           OR    (RECE62-KOHNUM(IDX45) = SPACE)
                 IF   (RECE62-KOHNUMHC(HC-IDX IDX2) = "012"      )
                 AND  (RECE62-KOHNUMHC(HC-IDX IDX2) =
                                             RECE62-KOHNUM(IDX45))
                 AND  (RECE62-KOHIDHC (HC-IDX IDX2) =
                                             RECE62-KOHID (IDX45))
                 AND  (RECE62-KOFUNUM(IDX45) NOT = SPACE         )
                   MOVE    1     TO  RECE62-SEIHOKOFU-FLG
                   MOVE   RECE62-KOFUNUM(IDX45)
                                 TO  RECE62-SEIHOKOFU-NUM(IDX1)
                 END-IF
               END-PERFORM
             END-PERFORM
           END-IF
      *
           .
       21044-RECE62-FTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送−負担金（Ｆ００２）
      *    （第三者行為）
      *****************************************************************
       2104K-RECE62-FTN-HENSYU-XXX-SEC               SECTION.
      *
           MOVE  1                  TO   FLG-GENMEN-NASI
           ADD   SYU-SYUCOMPFTN     TO   WRK-GENMEN-NASI-KIN
           ADD   SYU-KOH1SKJ-FTN-RECE
                                    TO   WRK-GENMEN-NASI-SKJ
      *
      *  （１）（１００％−負担割合）計算分は、医保分の保険者負担に集計
      *  （２）残りは、自賠責の保険者負担に集計
      *
           ADD   SYU-TOTAL-HKNTEN   TO   RECE62-SKYIRYO-TOTALTEN
      *
      ***  IF   WRK-DAISAN-DAISANKBN  =  "1"
      ***    COMPUTE  WRK-SKY-KEISAN6 =  SYU-TOTAL-HKNTEN
      ***                             *  10
      ***                             *  RECE62-KYURATE
      ***                             /  100
      ***    COMPUTE  WRK-SKY-KEISAN6 =
      ***             WRK-SKY-KEISAN6 +  5
      ***    COMPUTE  WRK-SKY-KEISAN6 =
      ***             WRK-SKY-KEISAN6 /  10
      ***    COMPUTE  WRK-SKY-KEISAN6 =
      ***             WRK-SKY-KEISAN6 *  10
      ***    COMPUTE  WRK-SKY-KEISAN  = (SYU-TOTAL-HKNTEN * 10)
      ***                             -  WRK-SKY-KEISAN6
      ***  ELSE
             COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                      *  10
                                      * (100 - RECE62-KYURATE)
                                      /  100
      ***  END-IF
           ADD   WRK-SKY-KEISAN     TO   RECE62-SKYIRYO-HOKENJA
      *
      *  （１）（請求円−標準負担金額）計算分は、医保分の保険者負担に集計
      *  （２）残りは、自賠責の保険者負担に集計
      *
           ADD   SYU-SYUSKJ-NISSU   TO   RECE62-SKYSKJ-KAISU
      *
      **>  ADD   SYU-SYUSKJ-RYOYOHI TO   RECE62-SKYSKJ-RYOYOHI
      *
           COMPUTE  WRK-SKY-KEISAN  =  SYU-SYUSKJ-RYOYOHI
                                    -  SYU-SYUSKJ-FTN
           ADD   WRK-SKY-KEISAN     TO   RECE62-SKYSKJ-HOKENJA
           ADD   WRK-SKY-KEISAN     TO   RECE62-SKYSKJ-RYOYOHI
      *
      *****
      *
           IF   RECE62-NYUINRYOFLG       =   "1"
           AND  FLG-NYUINRYO             =   ZERO
             PERFORM  210441-NYUINRYOFLG-SET-SEC
           END-IF
      *
           IF   RECE62-SRYYM   >=  "201604"
               PERFORM         210445-SKJ-KINGAKU-HENSYU2-SEC
           ELSE
               PERFORM         210445-SKJ-KINGAKU-HENSYU-SEC
           END-IF
      *
           IF      SYU-SYUSKJ-RYOYOHI  NOT =  ZERO
             ADD   SYU-SYUSKJ-NISSU    TO  RECE62-SHOKUJINISSU(1)
             ADD   SYU-SYUSKJ-RYOYOHI  TO  RECE62-SHOKUJIRYOYOHI(1)
             ADD   SYU-SYUSKJ-FTN-RECE TO  RECE62-SHOKUJIFTN(1)
             IF    RECE62-SRYYM  >=  "200604"
               ADD SYU-SYUSKJ-RYOYOHI  TO  RECE62-HENSHOKUJIRYOYOHI(1)
             END-IF
           END-IF
      *
           .
       2104K-RECE62-FTN-HENSYU-XXX-EXT.
           EXIT.
      *
      *****************************************************************
      *    他保険にて入院料を算定している場合の保険決定
      *****************************************************************
       210441-NYUINRYOFLG-SET-SEC               SECTION.
      *
           MOVE     SPACE    TO    RECE62-NYUINRYOFLG
      *
           PERFORM  VARYING  IDY    FROM    1   BY  1
                            UNTIL   IDY     >       31
      *
             IF      SYU-DAY(IDY)    =    "2"
      *
                IF         WRK-DAY5(IDY)      NOT =  ZERO
                AND        WRK-DAY1(IDY)      NOT =  ZERO
                     EVALUATE  SYS-200501-COMMENT-NYUINRYO1-KSIKBN
                       WHEN     "0"
                          MOVE   SPACE    TO   RECE62-NYUINRYOFLG
                       WHEN     "1"
                          MOVE    "6"     TO   RECE62-NYUINRYOFLG
                       WHEN     "2"
                          PERFORM  2104411-NYUINRYOFLG-HENSYU-SEC
                     END-EVALUATE
                ELSE
                   IF      WRK-DAY5(IDY)              NOT =  ZERO
                   AND     RECE62-NYUINDAY-KBN(IDY)   NOT =  "1"
                     EVALUATE  SYS-200501-COMMENT-NYUINRYO-KSIKBN
                       WHEN     "0"
                          MOVE   SPACE    TO   RECE62-NYUINRYOFLG
                       WHEN     "1"
                          MOVE    "1"     TO   RECE62-NYUINRYOFLG
                       WHEN     "2"
                          MOVE    "6"     TO   RECE62-NYUINRYOFLG
                          IF  (RECE62-SRYYM      >= "200904")
                          AND (RECE62-SRYYM      <= "201203")
                          AND (RECE62-KOUREI      = "1"     )
                            MOVE  "1"     TO   RECE62-NYUINRYOFLG
                          END-IF
                       WHEN     "3"
                          PERFORM  2104411-NYUINRYOFLG-HENSYU-SEC
                          IF  (RECE62-SRYYM      >= "200904"         )
                          AND (RECE62-SRYYM      <= "201203"         )
                          AND (RECE62-KOUREI      = "1"              )
                          AND (RECE62-NYUINRYOFLG = "2" OR "3" OR "7")
                            MOVE  "1"     TO   RECE62-NYUINRYOFLG
                          END-IF
                     END-EVALUATE
                   END-IF
                   IF      WRK-DAY5(IDY)              NOT =  ZERO
                   AND     RECE62-NYUINDAY-KBN(IDY)       =  "1"
                   AND     RECE62-SRYYM                  >=  "200904"
                     EVALUATE  SYS-200501-COMMENT-NYUINRYO1-KSIKBN
                       WHEN     "0"
                          MOVE   SPACE    TO   RECE62-NYUINRYOFLG
                       WHEN     "1"
                          MOVE    "6"     TO   RECE62-NYUINRYOFLG
                       WHEN     "2"
                          PERFORM  2104411-NYUINRYOFLG-HENSYU-SEC
                     END-EVALUATE
                   END-IF
                END-IF
                IF  RECE62-HKNNUM(1:2)  =  "98"  OR  "90"  OR "91"
                   MOVE   SPACE   TO     RECE62-NYUINRYOFLG
                END-IF
      *
                MOVE      1       TO     FLG-NYUINRYO
                MOVE     31       TO     IDY
      *
             END-IF
      *
           END-PERFORM
      *
           .
       210441-NYUINRYOFLG-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険編集
      *****************************************************************
       2104411-NYUINRYOFLG-HENSYU-SEC               SECTION.
      *
           INITIALIZE                  HKNCOMBI-REC
           MOVE    RECE62-HOSPNUM  TO  COMB-HOSPNUM
           MOVE    RECE62-PTID     TO  COMB-PTID
           MOVE    WRK-DAY5(IDY)   TO  COMB-HKNCOMBINUM
           MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
           PERFORM 900-HKNCOMBI-INV-SEC
           IF      FLG-HKNCOMBI    =   ZERO
              IF   COMB-HKNNUM(1:2)  =  "98"
              OR   COMB-HKNNUM       =  "971"
              OR   COMB-HKNNUM       =  "973"
              OR   COMB-HKNNUM       =  "975"
                IF   COMB-HKNNUM(1:2)  =  "98"
                   MOVE    "1"   TO   RECE62-NYUINRYOFLG
                END-IF
                IF   COMB-HKNNUM       =  "971"
                   MOVE    "2"   TO   RECE62-NYUINRYOFLG
                END-IF
                IF   COMB-HKNNUM       =  "973"
                   MOVE    "3"   TO   RECE62-NYUINRYOFLG
                END-IF
                IF   COMB-HKNNUM       =  "975"
                   MOVE    "7"   TO   RECE62-NYUINRYOFLG
                END-IF
              ELSE
                   CONTINUE
      ***          MOVE    "6"   TO   RECE62-NYUINRYOFLG
              END-IF
           END-IF
      *
           .
       2104411-NYUINRYOFLG-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険分負担金額編集
      *****************************************************************
       210442-HOKEN-FUTAN-HENSYU-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-KEISAN
           MOVE     ZERO    TO   FLG-KEISAN2
           MOVE     ZERO    TO   FLG-KEISAN3
      *
           MOVE     ZERO    TO   FLG-KGKIPNTAI
           MOVE     ZERO    TO   FLG-WRKFILE-KGKTAI
           IF    SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <= "8"
             IF  ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1) ))
             OR  ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1) ))
             OR  ((RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1) ))
             OR  ((RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 1) ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
           IF   (SYU-KOH-HKNNUM(1)    = "092"             )
           AND  (SYU-NYNSHOKAISU      =  7                )
           AND  (SYU-KOH-HKNNUM(2)(1:1)  >= "1" AND <= "8")
             IF  ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 2) ))
             OR  ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 2) ))
             OR  ((RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 2) ))
             OR  ((RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 2) ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                               * 10
                               * RECE62-KYURATE
                               / 100
           IF   FLG-WRKFILE-CLEAR   =   ZERO
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
           END-IF
      *
           COMPUTE  WRK-FTNKEI-Z = SYU-TOTAL-HKNTEN
                                 * 10
                                 * 20
                                 / 100
      *
           IF  (( SYU-KOH-FTN         =   ZERO          ) AND
                ( SYU-KOH-HKNNUM(1)   =   SPACE OR "027") AND
                ( SYU-KOH-HKNNUM(2)   =   SPACE         ) AND
                ( SYU-KOH-HKNNUM(3)   =   SPACE         ) AND
                ( SYU-KOH-HKNNUM(4)   =   SPACE         ))
           OR  (  SYU-KOH-HKNNUM(1)   =   "970"          )
           OR  (( SYU-KOH-HKNNUM(1)   =   "092"         ) AND
                ( SYU-NYNSHOKAISU     =    7            ) AND
                ( SYU-KOH-HKNNUM(2)   =   SPACE         ) AND
                ( SYU-KOH-HKNNUM(3)   =   SPACE         ) AND
                ( SYU-KOH-HKNNUM(4)   =   SPACE         ))
             IF    (FLG-WRKFILE-CLEAR   =  ZERO)
             AND   (FLG-HANTEI          =  1   )
               MOVE    1      TO    FLG-HOKENICHIBU-SYU
               IF    RECE62-RJNHKNNUM    NOT =    SPACE            
                 ADD    SYU-KOH1COMPFTN  TO   RECE62-FTNMONEY(1)   
                                              WRK-KOH-GAI          
                                              WRK-KOH-GAI2
               ELSE                                                
                 ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)   
                                              WRK-KOH-GAI          
                                              WRK-KOH-GAI2
               END-IF                                              
               MOVE     1                TO   FLG-JYOGENKBN
               ADD      SYU-SYUCOMPFTN   TO   WRK-KOH-GAI-GEN70
               ADD      SYU-TOTAL-HKNTEN TO   WRK-KOH-GAI-GEN70-TEN
               ADD      SYU-TOTAL-HKNTEN TO   WRK-JYOGENKBN-TEN
                                              WRK-JYOGENKBN-TEN4
             END-IF
           ELSE
             IF  FLG-HANTEI2  =  1
               MOVE    1      TO    FLG-HOKENICHIBU
             END-IF
             ADD    SYU-KOH-FTN          TO   WRK-KOH-FTN-GEN70
             IF  ((SYU-KOH-HKNNUM(1) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(2) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(3) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(4) = "012" OR "025"))
             AND ( FLG-ZENKOKUKOHI-NISYU    NOT =   5 )
               IF   SYU-SYUHKNNUM  NOT = SPACE
                 MOVE      1         TO   FLG-JYOGENKBN2
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    7500      TO   WRK-KINGAKU
                 ELSE
                   MOVE    15000     TO   WRK-KINGAKU
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      ****       PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
               END-IF
             ELSE
               IF   ( SYU-KOH-HKNNUM(1) =   "972" )
               OR   ( SYU-KOH-HKNNUM(2) =   "972" )
               OR   ( SYU-KOH-HKNNUM(3) =   "972" )
               OR   ( SYU-KOH-HKNNUM(4) =   "972" )
                 IF  ((SYU-KOH-HKNNUM(1)(1:1)  = "0"  ) AND
                      (SYU-KOH-HKNNUM(1)
                              NOT = "027" AND "092"   ))
                 OR  ((SYU-KOH-HKNNUM(1)       = "092") AND
                      (SYU-NYNSHOKAISU    NOT  =  7   ) AND
                      (RECE62-SRYYM       >= "201812" ))
                 OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0"   )
                 OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0"   )
                 OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0"   )
                 OR  ( TBL-TOKATUKAIFLG2       =  1    )
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                      (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                      (RECE62-KOHID(1)  = RECE62-KOHIDHC (IDX1 1)))
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (SYU-KOH-HKNNUM(1)    = "092"              ) AND
                      (SYU-NYNSHOKAISU      =  7                 ) AND
                      (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)      ) AND
                      (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 2)) AND
                      (RECE62-KOHID(1)  = RECE62-KOHIDHC (IDX1 2)))
                   MOVE     1        TO   FLG-KEISAN-TOK1
                   MOVE     3        TO   FLG-KEISAN
                 ELSE
                   MOVE     1        TO   FLG-KEISAN-TOK2
                   MOVE     4        TO   FLG-KEISAN
                 END-IF
                 IF  (SYU-KOH-HKNNUM(1) =  "972")
                 AND (SYU-KOH-HKNNUM(2) =  SPACE)
                 AND (SYU-KOH-HKNNUM(3) =  SPACE)
                 AND (SYU-KOH-HKNNUM(4) =  SPACE)
                   ADD  SYU-KOH-FTN  TO   WRK-CYOKI-KOH-FTN
                 ELSE
                   IF  (SYU-KOH-HKNNUM(2)    =  "972"      )
                   AND (SYU-KOH1HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH1HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(3)    =  "972"      )
                   AND (SYU-KOH2HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH2HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(4)    =  "972"      )
                   AND (SYU-KOH3HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH3HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   COMPUTE   WRK-CYOKI-KOH-FTN4 = WRK-CYOKI-KOH-FTN4
                                                + WRK-FTNKEI
                 END-IF
                 MOVE      1         TO   FLG-CYOKI
                 MOVE      3         TO   FLG-JYOGENKBN2
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    5000      TO   WRK-KINGAKU
                 ELSE
                   MOVE    10000     TO   WRK-KINGAKU
                 END-IF
                 MOVE  WRK-KINGAKU   TO   WRK-CYOKI-JGNGAK
                 IF    FLG-KEISAN   =    4
                   PERFORM 2104426-ICHIBUFTN-GEN-SEC
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                 PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
               ELSE
                 IF   FLG-ZENKOH-ARI  =   ZERO
                   IF  FLG-WRKFILE-CLEAR  =  ZERO
                   OR  FLG-WRKFILE-KGKTAI =   1
                     IF  FLG-ZENKOKUKOHI-NISYU  =  4
                        IF ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)) AND
                            (RECE62-KOHNUM(1) =
                                          RECE62-KOHNUMHC(IDX1 1)) AND
                            (RECE62-KOHID(1)  =
                                          RECE62-KOHIDHC(IDX1 1) ))
                        OR ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                            (SYU-NYNSHOKAISU      =  7           ) AND
                            (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)) AND
                            (RECE62-KOHNUM(1) =
                                          RECE62-KOHNUMHC(IDX1 2)) AND
                            (RECE62-KOHID(1)  =
                                          RECE62-KOHIDHC(IDX1 2) ))
                           MOVE    1    TO   FLG-KEISAN2
                        END-IF
                        IF ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)) AND
                            (RECE62-KOHNUM(2) =
                                          RECE62-KOHNUMHC(IDX1 1)) AND
                            (RECE62-KOHID(2)  =
                                          RECE62-KOHIDHC(IDX1 1) ))
                        OR ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                            (SYU-NYNSHOKAISU      =  7           ) AND
                            (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)) AND
                            (RECE62-KOHNUM(2) =
                                          RECE62-KOHNUMHC(IDX1 2)) AND
                            (RECE62-KOHID(2)  =
                                          RECE62-KOHIDHC(IDX1 2) ))
                           MOVE    2    TO   FLG-KEISAN2
                        END-IF
                     END-IF
                     MOVE          4    TO   FLG-JYOGENKBN2
                     PERFORM   2104422-ICHIBUFTN-KOH-HEN1-SEC
                   ELSE
                     ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                   END-IF
                   IF  ( RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1) )
                   OR  ( RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1) )
                   OR  ( RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1) )
                   OR  ( RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1) )
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)))
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)))
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2)))
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2)))
                    IF  IDZ  =  2
                       ADD  SYU-TOTAL-HKNTEN
                                           TO   WRK-JYOGENKBN-TEN5
                    END-IF
                   ELSE
                    IF  IDZ  =  1
                      IF ( RECE62-KOHSKY-KOHNUM(1)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ( RECE62-KOHSKY-KOHNUM(2)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ( RECE62-KOHSKY-KOHNUM(3)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ( RECE62-KOHSKY-KOHNUM(4)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(1)
                                              = SYU-KOH-HKNNUM(2)))
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(2)
                                              = SYU-KOH-HKNNUM(2)))
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(3)
                                              = SYU-KOH-HKNNUM(2)))
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(4)
                                              = SYU-KOH-HKNNUM(2)))
                       ADD  SYU-TOTAL-HKNTEN
                                           TO   WRK-JYOGENKBN-TEN5
                      END-IF
                    END-IF
                   END-IF
                 ELSE
                   IF  ((SYU-KOH-HKNNUM(1)(1:1)    = "0"  ) AND
                        (SYU-KOH-HKNNUM(1)
                                  NOT = "027" AND "092"   ))
                   OR  ((SYU-KOH-HKNNUM(1)         = "092") AND
                        (SYU-NYNSHOKAISU      NOT  =  7   ) AND
                        (RECE62-SRYYM         >= "201812" ))
                   OR  ( SYU-KOH-HKNNUM(2)(1:1)    = "0"   )
                   OR  ( SYU-KOH-HKNNUM(3)(1:1)    = "0"   )
                   OR  ( SYU-KOH-HKNNUM(4)(1:1)    = "0"   )
                   OR  ( TBL-TOKATUKAIFLG2         =  1    )
      *
                      IF  FLG-HANTEI  =  1
                        MOVE       1    TO   FLG-HOKENICHIBU7
                        IF   SYU-KOH-HKNNUM(1)(1:1) >= "1" AND <= "8"
                          IF  TBL-TOKATUKAIFLG2  =  1
                            CONTINUE
                          ELSE
                            MOVE   1    TO   FLG-HOKENICHIBU2
                          END-IF
                        END-IF
                        IF  (SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                        OR  (SYU-KOH-HKNNUM(3)(1:1) >= "1" AND <= "8")
                        OR  (SYU-KOH-HKNNUM(4)(1:1) >= "1" AND <= "8")
                          MOVE     1    TO   FLG-HOKENICHIBU2
                        END-IF
                      END-IF
      *
                      IF   SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8"
                        IF  (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2))
                        OR  (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2))
                        OR  (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2))
                        OR  (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2))
                         CONTINUE
                        ELSE
                         IF  IDZ  =  1
                           IF  RECE62-KOHSKY-KOHNUM(1)
                                              = SYU-KOH-HKNNUM(2)
                            ADD    SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN8
                           END-IF
                         END-IF
                        END-IF
                      END-IF
      *
                      IF  FLG-ZENKOKUKOHI-NISYU  =  1 OR 2 OR 5
                        IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    1    TO   FLG-KEISAN2
                        END-IF
                        IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    2    TO   FLG-KEISAN2
                        END-IF
                        IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                        AND RECE62-SRYYM    >= "202301"
                           MOVE    3    TO   FLG-KEISAN2
                        END-IF
                      END-IF
                      PERFORM 2104427-TOKUSITU-HENSYU-SEC
                      ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN2
                      IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN21
                      END-IF
                      IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN22
                      END-IF
                      IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN23
                      END-IF
                   ELSE
                      IF   FLG-HANTEI  =  1
                        MOVE     1    TO   FLG-HOKENICHIBU3
                      END-IF
                      IF   RECE62-RJNGENMENKBN  =   "1"
                        MOVE     1    TO   FLG-RJNGENMEN-CHIARI
                      END-IF
                      IF   FLG-ZENKOKUKOHI-NISYU  =  2 OR 4
                        MOVE     2    TO   FLG-KEISAN
                      ELSE
                        MOVE     1    TO   FLG-KEISAN
                      END-IF
                      IF  FLG-WRKFILE-CLEAR  =  ZERO
                      OR  FLG-WRKFILE-KGKTAI =   1
                        IF  FLG-JYOGENKBN = ZERO
                          MOVE      2       TO   FLG-JYOGENKBN
                        END-IF
                        MOVE        1       TO   FLG-JYOGENKBN3
                        PERFORM   2104422-ICHIBUFTN-KOH-HEN1-SEC
                      ELSE
                        ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                      END-IF
                      IF  ( RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1) )
                      OR  ( RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1) )
                      OR  ( RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1) )
                      OR  ( RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1) )
                      OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                           (SYU-NYNSHOKAISU      =  7           ) AND
                           (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)))
                      OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                           (SYU-NYNSHOKAISU      =  7           ) AND
                           (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)))
                      OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                           (SYU-NYNSHOKAISU      =  7           ) AND
                           (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2)))
                      OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                           (SYU-NYNSHOKAISU      =  7           ) AND
                           (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2)))
                       IF  IDZ  =  2
                           ADD    SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN5
                       END-IF
                      ELSE
                       IF  IDZ  =  1
                        IF ( RECE62-KOHSKY-KOHNUM(1)
                                                = SYU-KOH-HKNNUM(1) )
                        OR ( RECE62-KOHSKY-KOHNUM(2)
                                                = SYU-KOH-HKNNUM(1) )
                        OR ( RECE62-KOHSKY-KOHNUM(3)
                                                = SYU-KOH-HKNNUM(1) )
                        OR ( RECE62-KOHSKY-KOHNUM(4)
                                                = SYU-KOH-HKNNUM(1) )
                        OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                            (SYU-NYNSHOKAISU    =  7               ) AND
                            (RECE62-KOHSKY-KOHNUM(1)
                                                = SYU-KOH-HKNNUM(2)))
                        OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                            (SYU-NYNSHOKAISU    =  7               ) AND
                            (RECE62-KOHSKY-KOHNUM(2)
                                                = SYU-KOH-HKNNUM(2)))
                        OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                            (SYU-NYNSHOKAISU    =  7               ) AND
                            (RECE62-KOHSKY-KOHNUM(3)
                                                = SYU-KOH-HKNNUM(2)))
                        OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                            (SYU-NYNSHOKAISU    =  7               ) AND
                            (RECE62-KOHSKY-KOHNUM(4)
                                                = SYU-KOH-HKNNUM(2)))
                           ADD    SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN5
                        END-IF
                        IF   RECE62-KOHSKY-KOHNUM(1)
                                                = SYU-KOH-HKNNUM(1)
                           ADD    SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN8
                        END-IF
                       END-IF
                      END-IF
                      ADD    SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN7
                      IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN72
                      END-IF
                      IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN73
                      END-IF
                      IF  RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN74
                      END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF                                              
           END-IF                                                  
      *
           IF   SYU-SYUHKNNUM  NOT = SPACE
              ADD   SYU-KOH-FTN         TO   WRK-KOH-FTN
              IF  (SYU-SKJ-FTNGAKU(1)  =     1   )
              AND (RECE62-SRYYM       >= "201204")
                 MOVE    1   TO   FLG-GENBUTU-HANTEI
              END-IF
           END-IF
      *
           .
       210442-HOKEN-FUTAN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険分負担金額編集
      *****************************************************************
       210447-HOKEN-FUTAN-HENSYU2-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-KEISAN
           MOVE     ZERO    TO   FLG-KEISAN2
           MOVE     ZERO    TO   FLG-KEISAN3
      *
           MOVE     ZERO    TO   FLG-KGKIPNTAI
           MOVE     ZERO    TO   FLG-WRKFILE-KGKTAI
           IF    SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <= "8"
             IF  ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1) ))
             OR  ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1) ))
             OR  ((RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1) ))
             OR  ((RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 1) ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
           IF   (SYU-KOH-HKNNUM(1)    = "092"             )
           AND  (SYU-NYNSHOKAISU      =  7                )
           AND  (SYU-KOH-HKNNUM(2)(1:1)  >= "1" AND <= "8")
             IF  ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 2) ))
             OR  ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 2) ))
             OR  ((RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 2) ))
             OR  ((RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2)      ) AND
                  (RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 2)) AND
                  (RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 2) ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                               * 10
                               * RECE62-KYURATE
                               / 100
           IF   FLG-WRKFILE-CLEAR   =   ZERO
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
           END-IF
      *
           IF  (( SYU-KOH-FTN         =   ZERO  ) AND
                ( SYU-KOH-HKNNUM(1)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(2)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(3)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(4)   =   SPACE ))
           OR  (  SYU-KOH-HKNNUM(1)   =   "970"  )
           OR  (( SYU-KOH-HKNNUM(1)   =   "092" ) AND
                ( SYU-NYNSHOKAISU     =    7    ) AND
                ( SYU-KOH-HKNNUM(2)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(3)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(4)   =   SPACE ))
             IF    (FLG-WRKFILE-CLEAR   =  ZERO)
             AND   (FLG-HANTEI          =  1   )
                 MOVE      1             TO   FLG-HOKENICHIBU-SYU
                 ADD    SYU-SYUCOMPFTN   TO   RECE62-FTNMONEY(1)
                                              WRK-KOH-GAI
                                              WRK-KOH-GAI2
                 MOVE   1                TO   FLG-JYOGENKBN
                 IF     SYU-KOHTAIYKZKBN  =   "9"
                     MOVE      1            TO  FLG-GENBUTU-TAISYOOK
                     ADD  SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN
                     ADD  SYU-TOTAL-HKNTEN  TO  WRK-JYOGENKBN-TEN
                 END-IF
                 ADD    SYU-SYUCOMPFTN      TO  WRK-KOH-GAI-GEN70
                 ADD    SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN4
             END-IF
             ADD        SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN6
           ELSE
             IF  FLG-HANTEI2  =  1
               MOVE    1      TO    FLG-HOKENICHIBU
             END-IF
             IF   ( SYU-KOHTAIYKZKBN  = "9"            )
             OR   ((SYU-KOH-HKNNUM(1) = "972" OR "974") AND
                   (SYU-KOH-HKNNUM(2) = SPACE         ) AND
                   (SYU-KOH-HKNNUM(3) = SPACE         ) AND
                   (SYU-KOH-HKNNUM(4) = SPACE         ))
             OR   ((SYU-KOH-HKNNUM(1) = "092"         ) AND
                   (SYU-NYNSHOKAISU   =  7            ) AND
                   (SYU-KOH-HKNNUM(2) = "972" OR "974") AND
                   (SYU-KOH-HKNNUM(3) = SPACE         ) AND
                   (SYU-KOH-HKNNUM(4) = SPACE         ))
             OR   ((SYU-SKJ-FTNGAKU(3)  =  9          ) AND
                   (RECE62-SRYYM     >= "201204"      ))
      ****       ADD    SYU-TOTAL-HKNTEN    TO  WRK-KOH-GAI-GEN70-TEN
                 ADD    SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN
                 ADD    SYU-KOH-FTN         TO  WRK-KOH-FTN-GEN70
             END-IF
             IF  ((SYU-KOH-HKNNUM(1) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(2) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(3) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(4) = "012" OR "025"))
             AND ( FLG-ZENKOKUKOHI-NISYU    NOT =   5 )
               IF   SYU-SYUHKNNUM  NOT = SPACE
                 MOVE    1         TO   FLG-JYOGENKBN2
      ****       IF  FLG-KOHYONKAIME = 1
      ****        IF  FLG-TOKU75 = 3
      ****          MOVE   12300      TO   WRK-KINGAKU
      ****        ELSE
      ****          MOVE   24600      TO   WRK-KINGAKU
      ****        END-IF
      ****       ELSE
                  IF  FLG-TOKU75 = 3
                    MOVE   17700      TO   WRK-KINGAKU
                  ELSE
                    MOVE   35400      TO   WRK-KINGAKU
                  END-IF
      ****       END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      ****       PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
               END-IF
             ELSE
               IF   ( SYU-KOH-HKNNUM(1) =   "972" )
               OR   ( SYU-KOH-HKNNUM(2) =   "972" )
               OR   ( SYU-KOH-HKNNUM(3) =   "972" )
               OR   ( SYU-KOH-HKNNUM(4) =   "972" )
                 IF  ((SYU-KOH-HKNNUM(1)(1:1)  = "0"  ) AND
                      (SYU-KOH-HKNNUM(1)  NOT  = "092"))
                 OR  ((SYU-KOH-HKNNUM(1)       = "092") AND
                      (SYU-NYNSHOKAISU    NOT  =  7   ) AND
                      (RECE62-SRYYM       >= "201812" ))
                 OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0"   )
                 OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0"   )
                 OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0"   )
                 OR  ( TBL-TOKATUKAIFLG2       =  1    )
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                      (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                      (RECE62-KOHID(1)  = RECE62-KOHIDHC (IDX1 1)))
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (SYU-KOH-HKNNUM(1)    = "092"              ) AND
                      (SYU-NYNSHOKAISU      =  7                 ) AND
                      (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)      ) AND
                      (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 2)) AND
                      (RECE62-KOHID(1)  = RECE62-KOHIDHC (IDX1 2)))
                   MOVE     1         TO   FLG-KEISAN-TOK1
                   MOVE     3         TO   FLG-KEISAN
                 ELSE
                   MOVE     1         TO   FLG-KEISAN-TOK2
                   MOVE     4         TO   FLG-KEISAN
                 END-IF
                 IF  (SYU-KOH-HKNNUM(1) =  "972")
                 AND (SYU-KOH-HKNNUM(2) =  SPACE)
                 AND (SYU-KOH-HKNNUM(3) =  SPACE)
                 AND (SYU-KOH-HKNNUM(4) =  SPACE)
                   ADD  SYU-KOH-FTN   TO   WRK-CYOKI-KOH-FTN
                 ELSE
                   IF  (SYU-KOH-HKNNUM(2)    =  "972"      )
                   AND (SYU-KOH1HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH1HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(3)    =  "972"      )
                   AND (SYU-KOH2HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH2HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(4)    =  "972"      )
                   AND (SYU-KOH3HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH3HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   COMPUTE   WRK-CYOKI-KOH-FTN4 = WRK-CYOKI-KOH-FTN4
                                                + WRK-FTNKEI
                 END-IF
                 MOVE      2          TO   FLG-JYOGENKBN2
                 IF  FLG-TOKU75 = 3
                    MOVE   5000       TO   WRK-KINGAKU
                 ELSE
                    MOVE   10000      TO   WRK-KINGAKU
                 END-IF
                 MOVE  WRK-KINGAKU    TO   WRK-CYOKI-JGNGAK
                 IF    FLG-KEISAN   =    4
                   PERFORM 2104426-ICHIBUFTN-GEN-SEC
                 END-IF
                 PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                 PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
               ELSE
                IF  ( SYU-KOH-HKNNUM(1) =   "974")
                OR  ( SYU-KOH-HKNNUM(2) =   "974")
                OR  ( SYU-KOH-HKNNUM(3) =   "974")
                OR  ( SYU-KOH-HKNNUM(4) =   "974")
                    IF ((SYU-KOH-HKNNUM(1)(1:1)  = "0"  ) AND
                        (SYU-KOH-HKNNUM(1)  NOT  = "092"))
                    OR ((SYU-KOH-HKNNUM(1)       = "092") AND
                        (SYU-NYNSHOKAISU    NOT  =  7   ) AND
                        (RECE62-SRYYM       >= "201812" ))
                    OR ( SYU-KOH-HKNNUM(2)(1:1)  = "0"   )
                    OR ( SYU-KOH-HKNNUM(3)(1:1)  = "0"   )
                    OR ( SYU-KOH-HKNNUM(4)(1:1)  = "0"   )
                    OR ( TBL-TOKATUKAIFLG2       =  1    )
                    OR ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                        (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)) AND
                        (RECE62-KOHID(1)  = RECE62-KOHIDHC (IDX1 1)))
                    OR ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                        (SYU-KOH-HKNNUM(1)    = "092"              ) AND
                        (SYU-NYNSHOKAISU      =  7                 ) AND
                        (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)      ) AND
                        (RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 2)) AND
                        (RECE62-KOHID(1)  = RECE62-KOHIDHC (IDX1 2)))
                      MOVE     1      TO   FLG-KEISAN-TOK1
                      MOVE     3      TO   FLG-KEISAN
                    ELSE
                      MOVE     1      TO   FLG-KEISAN-TOK2
                      MOVE     4      TO   FLG-KEISAN
                    END-IF
                    IF  (SYU-KOH-HKNNUM(1) =  "974")
                    AND (SYU-KOH-HKNNUM(2) =  SPACE)
                    AND (SYU-KOH-HKNNUM(3) =  SPACE)
                    AND (SYU-KOH-HKNNUM(4) =  SPACE)
                      ADD  SYU-KOH-FTN
                                      TO   WRK-CYOKI-KOH-FTN
                    ELSE
                      IF  (SYU-KOH-HKNNUM(2)    =  "974"      )
                      AND (SYU-KOH1HKNFTNMONEY  >  SYU-KOH-FTN)
                        COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH1HKNFTNMONEY
                                                   - SYU-KOH-FTN
                        COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                   + WRK-CYOKI-KOH-FTN3
                      END-IF
                      IF  (SYU-KOH-HKNNUM(3)    =  "974"      )
                      AND (SYU-KOH2HKNFTNMONEY  >  SYU-KOH-FTN)
                        COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH2HKNFTNMONEY
                                                   - SYU-KOH-FTN
                        COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                   + WRK-CYOKI-KOH-FTN3
                      END-IF
                      IF  (SYU-KOH-HKNNUM(4)    =  "974"      )
                      AND (SYU-KOH3HKNFTNMONEY  >  SYU-KOH-FTN)
                        COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH3HKNFTNMONEY
                                                   - SYU-KOH-FTN
                        COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                   + WRK-CYOKI-KOH-FTN3
                      END-IF
                      COMPUTE   WRK-CYOKI-KOH-FTN4 = WRK-CYOKI-KOH-FTN4
                                                   + WRK-FTNKEI
                    END-IF
                    MOVE      3       TO   FLG-JYOGENKBN2
                    IF  FLG-TOKU75 = 3
                       MOVE   10000   TO   WRK-KINGAKU
                    ELSE
                       MOVE   20000   TO   WRK-KINGAKU
                    END-IF
                    MOVE  WRK-KINGAKU TO   WRK-CYOKI-JGNGAK
                    IF    FLG-KEISAN   =    4
                      PERFORM 2104426-ICHIBUFTN-GEN-SEC
                    END-IF
                    PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
                    PERFORM   210442B-ICHIBUFTN-NISYU-HEN-SEC
                ELSE
                 IF   FLG-ZENKOH-ARI    =   ZERO
                   IF  FLG-WRKFILE-CLEAR  =  ZERO
                   OR  FLG-WRKFILE-KGKTAI =   1
                     IF  FLG-ZENKOKUKOHI-NISYU  =  4
                        IF ((RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)) AND
                            (RECE62-KOHNUM(1) =
                                          RECE62-KOHNUMHC(IDX1 1)) AND
                            (RECE62-KOHID(1)  =
                                          RECE62-KOHIDHC(IDX1 1) ))
                        OR ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                            (SYU-NYNSHOKAISU      =  7           ) AND
                            (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)) AND
                            (RECE62-KOHNUM(1) =
                                          RECE62-KOHNUMHC(IDX1 2)) AND
                            (RECE62-KOHID(1)  =
                                          RECE62-KOHIDHC(IDX1 2) ))
                           MOVE    1    TO   FLG-KEISAN2
                        END-IF
                        IF ((RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)) AND
                            (RECE62-KOHNUM(2) =
                                          RECE62-KOHNUMHC(IDX1 1)) AND
                            (RECE62-KOHID(2)  =
                                          RECE62-KOHIDHC(IDX1 1) ))
                        OR ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                            (SYU-NYNSHOKAISU      =  7           ) AND
                            (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)) AND
                            (RECE62-KOHNUM(2) =
                                          RECE62-KOHNUMHC(IDX1 2)) AND
                            (RECE62-KOHID(2)  =
                                          RECE62-KOHIDHC(IDX1 2) ))
                           MOVE    2    TO   FLG-KEISAN2
                        END-IF
                     END-IF
                     MOVE        4       TO   FLG-JYOGENKBN2
                     PERFORM   2104424-ICHIBUFTN-KOH-HEN3-SEC
                   ELSE
                     ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                   END-IF
                   IF  ( RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1) )
                   OR  ( RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1) )
                   OR  ( RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1) )
                   OR  ( RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1) )
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)))
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)))
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2)))
                   OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                        (SYU-NYNSHOKAISU      =  7           ) AND
                        (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2)))
                    IF  IDZ  =  2
                       ADD  SYU-TOTAL-HKNTEN
                                           TO   WRK-JYOGENKBN-TEN5
                    END-IF
                   ELSE
                    IF  IDZ  =  1
                      IF ( RECE62-KOHSKY-KOHNUM(1)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ( RECE62-KOHSKY-KOHNUM(2)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ( RECE62-KOHSKY-KOHNUM(3)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ( RECE62-KOHSKY-KOHNUM(4)
                                              = SYU-KOH-HKNNUM(1) )
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(1)
                                              = SYU-KOH-HKNNUM(2)))
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(2)
                                              = SYU-KOH-HKNNUM(2)))
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(3)
                                              = SYU-KOH-HKNNUM(2)))
                      OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                          (SYU-NYNSHOKAISU    =  7               ) AND
                          (RECE62-KOHSKY-KOHNUM(4)
                                              = SYU-KOH-HKNNUM(2)))
                       ADD  SYU-TOTAL-HKNTEN
                                           TO   WRK-JYOGENKBN-TEN5
                      END-IF
                    END-IF
                   END-IF
                 ELSE
                   IF  ((SYU-KOH-HKNNUM(1)(1:1)  = "0"  ) AND
                        (SYU-KOH-HKNNUM(1)  NOT  = "092"))
                   OR  ((SYU-KOH-HKNNUM(1)       = "092") AND
                        (SYU-NYNSHOKAISU    NOT  =  7   ) AND
                        (RECE62-SRYYM       >= "201812" ))
                   OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0"   )
                   OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0"   )
                   OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0"   )
                   OR  ( TBL-TOKATUKAIFLG2       =  1    )
      *
                     IF  FLG-HANTEI  =  1
                       MOVE        1    TO   FLG-HOKENICHIBU7
                       IF   SYU-KOH-HKNNUM(1)(1:1) >= "1" AND <= "8"
                         IF  TBL-TOKATUKAIFLG2  =  1
                           CONTINUE
                         ELSE
                           MOVE    1    TO   FLG-HOKENICHIBU2
                         END-IF
                       END-IF
                       IF  (SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                       OR  (SYU-KOH-HKNNUM(3)(1:1) >= "1" AND <= "8")
                       OR  (SYU-KOH-HKNNUM(4)(1:1) >= "1" AND <= "8")
                         MOVE      1    TO   FLG-HOKENICHIBU2
                       END-IF
                     END-IF
      *
                     IF   SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8"
                       IF  (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2))
                       OR  (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2))
                       OR  (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2))
                       OR  (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2))
                        CONTINUE
                       ELSE
                        IF  IDZ  =  1
                          IF  RECE62-KOHSKY-KOHNUM(1)
                                             = SYU-KOH-HKNNUM(2)
                           ADD    SYU-TOTAL-HKNTEN
                                        TO   WRK-JYOGENKBN-TEN8
                          END-IF
                        END-IF
                       END-IF
                     END-IF
      *
                     IF  FLG-ZENKOKUKOHI-NISYU  =  1 OR 2 OR 5
                        IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    1    TO   FLG-KEISAN2
                           IF   SYU-NYNSHOKAISU  =  1
                             MOVE  1    TO   FLG-JIRITU-CYUKANSOU1
                           END-IF
                        END-IF
                        IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                           MOVE    2    TO   FLG-KEISAN2
                           IF   SYU-NYNSHOKAISU  =  1
                             MOVE  1    TO   FLG-JIRITU-CYUKANSOU2
                           END-IF
                        END-IF
                        IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
                        AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
                        AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                        AND RECE62-SRYYM    >= "202301"
                           MOVE    3    TO   FLG-KEISAN2
                        END-IF
                     END-IF
                     PERFORM  2104429-TOKUSITU-HENSYU2-SEC
                     IF  SYU-KOHTAIYKZKBN   = "9"
                      ADD  SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN2
                      IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN21
                      END-IF
                      IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN22
                      END-IF
                      IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
                      AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
                      AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                        ADD  SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN23
                      END-IF
                     END-IF
                   ELSE
                     IF   FLG-HANTEI  =  1
                        MOVE     1    TO   FLG-HOKENICHIBU3
                     END-IF
                     IF   FLG-ZENKOKUKOHI-NISYU  =  2 OR 4
                        MOVE     2    TO   FLG-KEISAN
                     ELSE
                        MOVE     1    TO   FLG-KEISAN
                     END-IF
                     IF  FLG-WRKFILE-CLEAR  =  ZERO
                     OR  FLG-WRKFILE-KGKTAI =   1
                       IF  FLG-JYOGENKBN = ZERO
                         MOVE      2       TO   FLG-JYOGENKBN
                       END-IF
                       MOVE        1       TO   FLG-JYOGENKBN3
                       PERFORM   2104424-ICHIBUFTN-KOH-HEN3-SEC
                     ELSE
                       ADD    WRK-FTNKEI   TO   RECE62-FTNMONEY(1)
                     END-IF
                     IF  ( RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1) )
                     OR  ( RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1) )
                     OR  ( RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1) )
                     OR  ( RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1) )
                     OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                          (SYU-NYNSHOKAISU      =  7           ) AND
                          (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(2)))
                     OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                          (SYU-NYNSHOKAISU      =  7           ) AND
                          (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(2)))
                     OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                          (SYU-NYNSHOKAISU      =  7           ) AND
                          (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(2)))
                     OR  ((SYU-KOH-HKNNUM(1)    = "092"        ) AND
                          (SYU-NYNSHOKAISU      =  7           ) AND
                          (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(2)))
                      IF  IDZ  =  2
                          ADD    SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN5
                      END-IF
                     ELSE
                      IF  IDZ  =  1
                       IF ( RECE62-KOHSKY-KOHNUM(1)
                                               = SYU-KOH-HKNNUM(1) )
                       OR ( RECE62-KOHSKY-KOHNUM(2)
                                               = SYU-KOH-HKNNUM(1) )
                       OR ( RECE62-KOHSKY-KOHNUM(3)
                                               = SYU-KOH-HKNNUM(1) )
                       OR ( RECE62-KOHSKY-KOHNUM(4)
                                               = SYU-KOH-HKNNUM(1) )
                       OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                           (SYU-NYNSHOKAISU    =  7               ) AND
                           (RECE62-KOHSKY-KOHNUM(1)
                                               = SYU-KOH-HKNNUM(2)))
                       OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                           (SYU-NYNSHOKAISU    =  7               ) AND
                           (RECE62-KOHSKY-KOHNUM(2)
                                               = SYU-KOH-HKNNUM(2)))
                       OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                           (SYU-NYNSHOKAISU    =  7               ) AND
                           (RECE62-KOHSKY-KOHNUM(3)
                                               = SYU-KOH-HKNNUM(2)))
                       OR ((SYU-KOH-HKNNUM(1)  = "092"            ) AND
                           (SYU-NYNSHOKAISU    =  7               ) AND
                           (RECE62-KOHSKY-KOHNUM(4)
                                               = SYU-KOH-HKNNUM(2)))
                          ADD    SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN5
                       END-IF
                       IF   RECE62-KOHSKY-KOHNUM(1)
                                               = SYU-KOH-HKNNUM(1)
                          ADD    SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN8
                       END-IF
                      END-IF
                     END-IF
                     ADD    SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN6
                     ADD    SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN7
                     IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                     AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                     AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                       ADD  SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN72
                     END-IF
                     IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
                     AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
                     AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
                       ADD  SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN73
                     END-IF
                     IF  RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1)
                     AND RECE62-KOHNUM(4) = RECE62-KOHNUMHC(IDX1 1)
                     AND RECE62-KOHID(4)  = RECE62-KOHIDHC(IDX1 1)
                       ADD  SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN74
                     END-IF
                   END-IF
                 END-IF
                END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   SYU-SYUHKNNUM  NOT = SPACE
              ADD   SYU-KOH-FTN         TO   WRK-KOH-FTN
              IF  (SYU-SKJ-FTNGAKU(1)  =     1   )
              AND (RECE62-SRYYM       >= "201204")
                 MOVE    1   TO   FLG-GENBUTU-HANTEI
              END-IF
           END-IF
      *
           .
       210447-HOKEN-FUTAN-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額セット（公費含む場合）
      *****************************************************************
       2104421-ICHIBUFTN-KOH-SET-SEC               SECTION.
      *
           IF  FLG-KEISAN   NOT =  ZERO
             EVALUATE   FLG-KEISAN
               WHEN         1
                 IF  FTN-KOH-XX2  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX2
                 END-IF
                 COMPUTE  FTN-KOH-YY2  =   WRK-KINGAKU -  FTN-KOH-XX2
                 IF  WRK-FTNKEI   >   FTN-KOH-YY2
                      ADD    FTN-KOH-YY2    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX2
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX2
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN2
                 MOVE     1                 TO  FLG-XX2-TUUKA
               WHEN         2
                 IF  FTN-KOH-XX4  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX4
                 END-IF
                 COMPUTE  FTN-KOH-YY4  =   WRK-KINGAKU -  FTN-KOH-XX4
                 IF  WRK-FTNKEI   >   FTN-KOH-YY4
                      ADD    FTN-KOH-YY4    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX4
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX4
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN4
                 MOVE     1                 TO  FLG-XX4-TUUKA
               WHEN         3
                 MOVE        WRK-KINGAKU    TO  WRK-KINGAKU-TOK7
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =   WRK-KINGAKU -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
                 IF  WRK-KINGAKU-TOK1  >  WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  WRK-KINGAKU-TOK1
                 END-IF
                 COMPUTE  WRK-KINGAKU-TOK3
                             =   WRK-KINGAKU -  WRK-KINGAKU-TOK1
                 IF  WRK-FTNKEI   >   WRK-KINGAKU-TOK3
                      ADD  WRK-KINGAKU-TOK3 TO  WRK-KINGAKU-TOK1
                 ELSE
                      ADD  WRK-FTNKEI       TO  WRK-KINGAKU-TOK1
                 END-IF
      *
                 IF  WRK-KINGAKU-TOK1X >  WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  WRK-KINGAKU-TOK1X
                 END-IF
                 COMPUTE  WRK-KINGAKU-TOK3
                             =   WRK-KINGAKU -  WRK-KINGAKU-TOK1X
                 IF  WRK-FTNKEI-Z >   WRK-KINGAKU-TOK3
                      ADD  WRK-KINGAKU-TOK3 TO  WRK-KINGAKU-TOK1X
                 ELSE
                      ADD  WRK-FTNKEI-Z     TO  WRK-KINGAKU-TOK1X
                 END-IF
      *
                 IF  FTN-KOH-XX12      >  WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX12
                 END-IF
                 COMPUTE  FTN-KOH-YY12 =   WRK-KINGAKU -  FTN-KOH-XX12
                 IF  WRK-FTNKEI   >   FTN-KOH-YY12
                      ADD    FTN-KOH-YY12   TO  FTN-KOH-XX12
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX12
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN1
               WHEN         4
                 MOVE        WRK-KINGAKU    TO  WRK-KINGAKU-TOK8
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =   WRK-KINGAKU -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
                 IF  ((SYU-KOH-HKNNUM(1) =  "972" OR "974") AND
                      (SYU-KOH-HKNNUM(2) =  SPACE         ) AND
                      (SYU-KOH-HKNNUM(3) =  SPACE         ) AND
                      (SYU-KOH-HKNNUM(4) =  SPACE         ))
                 OR  ((SYU-KOH-HKNNUM(1) =  "092"         ) AND
                      (SYU-NYNSHOKAISU   =   7            ) AND
                      (SYU-KOH-HKNNUM(2) =  "972" OR "974") AND
                      (SYU-KOH-HKNNUM(3) =  SPACE         ) AND
                      (SYU-KOH-HKNNUM(4) =  SPACE         ))
                   MOVE        1              TO  FLG-XX7A-TUUKA
                 ELSE
                   IF  FTN-KOH-XX7  >   WRK-KINGAKU
                        MOVE   WRK-KINGAKU    TO  FTN-KOH-XX7
                   END-IF
                   COMPUTE  FTN-KOH-YY7  =   WRK-KINGAKU -  FTN-KOH-XX7
                   IF  WRK-FTNKEI   >   FTN-KOH-YY7
                        ADD    FTN-KOH-YY7    TO  FTN-KOH-XX7
                   ELSE
                        ADD    WRK-FTNKEI     TO  FTN-KOH-XX7
                   END-IF
                   MOVE        1              TO  FLG-XX7-TUUKA
                 END-IF
      *
                 IF  FTN-KOH-XX7X >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX7X
                 END-IF
                 COMPUTE  FTN-KOH-YY7  =   WRK-KINGAKU -  FTN-KOH-XX7X
                 IF  WRK-FTNKEI   >   FTN-KOH-YY7
                      ADD    FTN-KOH-YY7    TO  FTN-KOH-XX7X
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX7X
                 END-IF
      *
                 IF  FTN-KOH-XX12 >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX12
                 END-IF
                 COMPUTE  FTN-KOH-YY12 =   WRK-KINGAKU -  FTN-KOH-XX12
                 IF  WRK-FTNKEI   >   FTN-KOH-YY12
                      ADD    FTN-KOH-YY12   TO  FTN-KOH-XX12
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX12
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN1
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN9
             END-EVALUATE
           ELSE
             EVALUATE   FLG-KEISAN2
               WHEN        ZERO
               WHEN         1
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE     WRK-KINGAKU  TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =  WRK-KINGAKU  -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD      FTN-KOH-YYY  TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD      WRK-FTNKEI   TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
      *
                 IF  FTN-KOH-XX8  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX8
                 END-IF
                 COMPUTE  FTN-KOH-YY8  =   WRK-KINGAKU -  FTN-KOH-XX8
                 IF  WRK-FTNKEI   >   FTN-KOH-YY8
                      ADD    FTN-KOH-YY8    TO  FTN-KOH-XX8
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX8
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN1
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN8
                 MOVE     1                 TO  FLG-XX8-TUUKA
               WHEN         2
                 IF  FTN-KOH-XX3  >   WRK-KINGAKU
                      MOVE     WRK-KINGAKU  TO  FTN-KOH-XX3
                 END-IF
                 COMPUTE  FTN-KOH-YY3  =  WRK-KINGAKU  -  FTN-KOH-XX3
                 IF  WRK-FTNKEI   >   FTN-KOH-YY3
                      ADD      FTN-KOH-YY3  TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX3
                                                WRK-KOH-GAI
                 ELSE
                      ADD      WRK-FTNKEI   TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX3
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN3
                 MOVE     1                 TO  FLG-XX3-TUUKA
               WHEN         3
                 IF  FTN-KOH-XX10 >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX10
                 END-IF
                 COMPUTE  FTN-KOH-YY10 =   WRK-KINGAKU -  FTN-KOH-XX10
                 IF  WRK-FTNKEI   >   FTN-KOH-YY10
                      ADD    FTN-KOH-YY10   TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX10
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE62-FTNMONEY(1)
                                                FTN-KOH-XX10
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN10
                 MOVE     1                 TO  FLG-XX10-TUUKA
             END-EVALUATE
           END-IF
      *
           .
       2104421-ICHIBUFTN-KOH-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１
      *****************************************************************
       2104422-ICHIBUFTN-KOH-HEN1-SEC               SECTION.
      *
           IF  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(1)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(1)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(1) ) AND
                (RECE62-EKF-HKNFTNFLG-K(2) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(2)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(2)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(2) ) AND
                (RECE62-EKF-HKNFTNFLG-K(3) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(3)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(3)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(3) ) AND
                (RECE62-EKF-HKNFTNFLG-K(4) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(4)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(4)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(4) ) AND
                (RECE62-EKF-HKNFTNFLG-K(5) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(1)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(1)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(1) ) AND
                (RECE62-EKF-HKNFTNFLG-K(2) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(2)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(2)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(2) ) AND
                (RECE62-EKF-HKNFTNFLG-K(3) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(3)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(3)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(3) ) AND
                (RECE62-EKF-HKNFTNFLG-K(4) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(4)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(4)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(4) ) AND
                (RECE62-EKF-HKNFTNFLG-K(5) = "1"           ))
              CONTINUE
           ELSE
              MOVE    ZERO    TO    FLG-KGKIPNTAI
           END-IF
      *
           IF  ( FLG-KGKIPNTAI      =  1 )
           OR  ( FLG-WRKFILE-KGKTAI =  1 )
           OR  ( FLG-ZEROKOGAITO    =  1 )
              IF     RECE62-SRYYM   >=  "201708"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    28800   TO   WRK-KINGAKU
                   ELSE
                     MOVE    57600   TO   WRK-KINGAKU
                   END-IF
              ELSE
               IF    RECE62-SRYYM   >=  "200610"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200   TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400   TO   WRK-KINGAKU
                   END-IF
               ELSE
                   MOVE      40200   TO   WRK-KINGAKU
               END-IF
              END-IF
              IF    FLG-KEISAN2 = 2
                MOVE    WRK-KINGAKU  TO   WRK-KINGAKU-GENBUTU5
              ELSE
                MOVE    WRK-KINGAKU  TO   WRK-KINGAKU-GENBUTU
              END-IF
              PERFORM   2104426-ICHIBUFTN-GEN-SEC
              PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
              MOVE      1            TO   FLG-CHIIKI2
           ELSE
              IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                   (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(1) =  1                     ) AND
                   (RECE62-EKF-HKNFTNFLG-K2(2) = "0"            ))
              OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                   (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(2) =  1                     ) AND
                   (RECE62-EKF-HKNFTNFLG-K2(3) = "0"            ))
              OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                   (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(3) =  1                     ) AND
                   (RECE62-EKF-HKNFTNFLG-K2(4) = "0"            ))
              OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                   (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(4) =  1                     ) AND
                   (RECE62-EKF-HKNFTNFLG-K2(5) = "0"            ))
              OR  ((IDZ                =  2                     ) AND
                   (SYU-SKJ-FTNDAY(3)  =  1                     ))
                 PERFORM     2104422-ICHIBUFTN-KOH-HEN11-SEC
              ELSE
                 PERFORM     2104422-ICHIBUFTN-KOH-HEN12-SEC
              END-IF
           END-IF
      *
           .
       2104422-ICHIBUFTN-KOH-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１（１）
      *****************************************************************
       2104422-ICHIBUFTN-KOH-HEN11-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE   FLG-TOKUSITU
             WHEN       1
               IF     RECE62-SRYYM   >=  "201808"
                EVALUATE   FLG-KOUREI-GENEKIKBN
                  WHEN        1
                    IF    FLG-TOKUSITU-TASU  =  1
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    70050     TO   WRK-KINGAKU
                     ELSE
                       MOVE   140100     TO   WRK-KINGAKU
                     END-IF
                     MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                    ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN   >  421000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 421000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE    126300  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN   >  842000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 842000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE    252600  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                    END-IF
                  WHEN        2
                    IF    FLG-TOKUSITU-TASU  =  1
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    46500     TO   WRK-KINGAKU
                     ELSE
                       MOVE    93000     TO   WRK-KINGAKU
                     END-IF
                     MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                    ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN   >  279000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 279000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE     83700  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN   >  558000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 558000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE    167400  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                    END-IF
                  WHEN        3
                    IF    FLG-TOKUSITU-TASU  =  1
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    22200     TO   WRK-KINGAKU
                     ELSE
                       MOVE    44400     TO   WRK-KINGAKU
                     END-IF
                     MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                    ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN   >  133500
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 133500 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE     40050  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN   >  267000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 267000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE     80100  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                    END-IF
                END-EVALUATE
               ELSE
                IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    22200     TO   WRK-KINGAKU
                 ELSE
                   MOVE    44400     TO   WRK-KINGAKU
                 END-IF
                ELSE
                 IF  FLG-TOKU75 = 1 OR 2
                   IF   WRK-CHIHOU-KIN   >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN  -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                   ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                   END-IF
                 ELSE
                   IF   WRK-CHIHOU-KIN   >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN  -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                   ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                   END-IF
                 END-IF
                END-IF
               END-IF
             WHEN       2
               IF      RECE62-SRYYM   >=  "201708"
                 IF    FLG-TOKUSITU-TASU  =  1
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200   TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400   TO   WRK-KINGAKU
                   END-IF
                   MOVE       1      TO   FLG-KINGAKU-GENBUTUX
                 ELSE
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    28800   TO   WRK-KINGAKU
                   ELSE
                     MOVE    57600   TO   WRK-KINGAKU
                   END-IF
                 END-IF
               ELSE
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE      22200   TO   WRK-KINGAKU
                 ELSE
                   MOVE      44400   TO   WRK-KINGAKU
                 END-IF
               END-IF
             WHEN       3
               EVALUATE   RECE62-TEISYOTOKU
                 WHEN  "1"
                 WHEN  "4"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    7500    TO   WRK-KINGAKU
                   ELSE
                     MOVE    15000   TO   WRK-KINGAKU
                   END-IF
                 WHEN  "2"
                 WHEN  "3"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    12300   TO   WRK-KINGAKU
                   ELSE
                     MOVE    24600   TO   WRK-KINGAKU
                   END-IF
               END-EVALUATE
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1           TO   FLG-KINGAKU-GENBUTU5
             END-IF
           ELSE
             MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1           TO   FLG-KINGAKU-GENBUTU
             END-IF
           END-IF
      ***  PERFORM   2104426-ICHIBUFTN-GEN-SEC
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104422-ICHIBUFTN-KOH-HEN11-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１（２）
      *****************************************************************
       2104422-ICHIBUFTN-KOH-HEN12-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
      *
           IF   RECE62-TEISYOTOKU  NOT =  SPACE
              EVALUATE   RECE62-TEISYOTOKU
                WHEN  "1"
                WHEN  "4"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    7500    TO   WRK-KINGAKU
                   ELSE
                     MOVE    15000   TO   WRK-KINGAKU
                   END-IF
                WHEN  "2"
                WHEN  "3"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    12300   TO   WRK-KINGAKU
                   ELSE
                     MOVE    24600   TO   WRK-KINGAKU
                   END-IF
              END-EVALUATE
           ELSE
              IF   ((RECE62-KYURATE       =   30     ) AND
                    (RECE62-SRYYM        >=  "201808"))
              OR   ((RECE62-KYURATE       =   30     ) AND
                    (RECE62-SRYYM         <  "201808") AND
                    (RECE62-RJNGENMENKBN  =   SPACE  ) AND
                    (FLG-KOHYONKAIME      =   ZERO   ))
              OR   ((RECE62-KYURATE       =   20     ) AND
                    (RECE62-SRYYM         <  "200804") AND
                    (RECE62-RJNGENMENKBN  =   SPACE  ) AND
                    (FLG-KOHYONKAIME      =   ZERO   ))
                IF    FLG-KEISAN2 = 2
                  COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                          + (SYU-TOTAL-HKNTEN * 10)
                  MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
                ELSE
                  COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                          + (SYU-TOTAL-HKNTEN * 10)
                  MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
                END-IF
                IF     RECE62-SRYYM   >=  "201808"
                 EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN        1
                     IF    FLG-KOHYONKAIME    =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE    70050     TO   WRK-KINGAKU
                       ELSE
                         MOVE   140100     TO   WRK-KINGAKU
                       END-IF
                       MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN  >  421000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 421000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 126300
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE    126300  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN  >  842000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 842000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 252600
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE    252600  TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     END-IF
                   WHEN        2
                     IF    FLG-KOHYONKAIME    =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE    46500     TO   WRK-KINGAKU
                       ELSE
                         MOVE    93000     TO   WRK-KINGAKU
                       END-IF
                       MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN  >  279000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 279000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 83700
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE     83700  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN  >  558000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 558000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 167400
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE    167400  TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     END-IF
                   WHEN        3
                     IF    FLG-KOHYONKAIME    =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE    22200     TO   WRK-KINGAKU
                       ELSE
                         MOVE    44400     TO   WRK-KINGAKU
                       END-IF
                       MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN  >  133500
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 133500 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 40050
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE     40050  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN  >  267000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 267000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 80100
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE     80100  TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     END-IF
                 END-EVALUATE
                ELSE
                 IF    RECE62-SRYYM   >=  "200610"
                  IF  FLG-TOKU75 = 1 OR 2
                   IF   WRK-CHIHOU-KIN  >  133500
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                      MOVE     1      TO   FLG-KOUGAKU
                   ELSE
                      MOVE     40050  TO   WRK-KINGAKU
                   END-IF
                  ELSE
                   IF   WRK-CHIHOU-KIN  >  267000
                      COMPUTE  WRK-KINGAKU2 =
                            (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                          + 0.5
                      COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                      MOVE     1      TO   FLG-KOUGAKU
                   ELSE
                      MOVE     80100  TO   WRK-KINGAKU
                   END-IF
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  361500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  361500 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  72300  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     72300  TO   WRK-KINGAKU
                  END-IF
                 END-IF
                END-IF
              ELSE
                IF      RECE62-SRYYM   >=  "201708"
                  IF    FLG-KOHYONKAIME  =  1
                    IF  FLG-TOKU75 = 1 OR 2
                     MOVE     22200  TO   WRK-KINGAKU
                    ELSE
                     MOVE     44400  TO   WRK-KINGAKU
                    END-IF
                    MOVE       1     TO   FLG-KINGAKU-GENBUTUX
                  ELSE
                    IF  FLG-TOKU75 = 1 OR 2
                     MOVE     28800  TO   WRK-KINGAKU
                    ELSE
                     MOVE     57600  TO   WRK-KINGAKU
                    END-IF
                  END-IF
                ELSE
                  IF    RECE62-SRYYM   >=  "200610"
                    IF  FLG-TOKU75 = 1 OR 2
                     MOVE     22200  TO   WRK-KINGAKU
                    ELSE
                     MOVE     44400  TO   WRK-KINGAKU
                    END-IF
                  ELSE
                    MOVE      40200  TO   WRK-KINGAKU
                  END-IF
                END-IF
              END-IF
           END-IF
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1             TO   FLG-KINGAKU-GENBUTU5
             END-IF
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1             TO   FLG-KINGAKU-GENBUTU
             END-IF
           END-IF
           PERFORM     2104426-ICHIBUFTN-GEN-SEC
           PERFORM     2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104422-ICHIBUFTN-KOH-HEN12-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集２
      *****************************************************************
       2104423-ICHIBUFTN-KOH-HEN2-SEC               SECTION.
      *
           IF      RECE62-SRYYM   >=  "201708"
             IF    FLG-TOKU75 = 1 OR 2
               MOVE     28800   TO   WRK-KINGAKU
             ELSE
               MOVE     57600   TO   WRK-KINGAKU
             END-IF
           ELSE
             IF    RECE62-SRYYM   >=  "200610"
               IF  FLG-TOKU75 = 1 OR 2
                 MOVE   22200   TO   WRK-KINGAKU
               ELSE
                 MOVE   44400   TO   WRK-KINGAKU
               END-IF
             ELSE
               MOVE     40200   TO   WRK-KINGAKU
             END-IF
           END-IF
      *
           PERFORM   210442D-KOH-SEIHEI-K-SEC
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               PERFORM   210449-KOHARI-CHECK-SEC
               IF  FLG-KOHARI-CHECK = 1
                 MOVE WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
               END-IF
             WHEN       2
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
             WHEN       3
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU10
           END-EVALUATE
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104423-ICHIBUFTN-KOH-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    生保併用（高齢者）
      *****************************************************************
       210442D-KOH-SEIHEI-K-SEC               SECTION.
      *
           IF  (SYU-KOH-HKNNUM(1) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(2) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(3) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(4) = "012" OR "025")
             IF  SYU-SYUHKNNUM  NOT = SPACE
                IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
                AND  (RECE62-KOHNUM(1)(1:1)    = "0"                )
                AND  (RECE62-KOHNUM(1)     NOT = "012" AND "025"    )
                AND  (RECE62-TOTALTEN(1)       =  RECE62-TOTALTEN(2))
                AND  (FLG-ZENKOKUKOHI-NISYU9   =  ZERO              )
                  IF  FLG-ZENKOKUKOHI-NISYU-SC =  1
                    IF   FLG-TOKU75 = 1 OR 2
                      MOVE    5000     TO   WRK-KINGAKU
                    ELSE
                      MOVE    10000    TO   WRK-KINGAKU
                    END-IF
                  END-IF
                ELSE
                    IF   FLG-TOKU75 = 1 OR 2
                      MOVE    7500     TO   WRK-KINGAKU
                    ELSE
                      MOVE    15000    TO   WRK-KINGAKU
                    END-IF
                END-IF
             END-IF
           END-IF
      *
           .
       210442D-KOH-SEIHEI-K-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集３
      *****************************************************************
       2104424-ICHIBUFTN-KOH-HEN3-SEC               SECTION.
      *
           IF  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(1)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(1)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(1) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(2) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(2)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(2)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(2) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(3) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(3)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(3)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(3) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(4) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE62-KOHNUM(4)) AND
                (RECE62-KOHNUMHC(IDX1 1) = RECE62-KOHNUM(4)) AND
                (RECE62-KOHIDHC(IDX1 1)  = RECE62-KOHID(4) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(5) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(1)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(1)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(1) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(2) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(2)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(2)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(2) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(3) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(3)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(3)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(3) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(4) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = "092"           ) AND
                (SYU-NYNSHOKAISU         =  7              ) AND
                (SYU-KOH-HKNNUM(2)       = RECE62-KOHNUM(4)) AND
                (RECE62-KOHNUMHC(IDX1 2) = RECE62-KOHNUM(4)) AND
                (RECE62-KOHIDHC(IDX1 2)  = RECE62-KOHID(4) ) AND
                (RECE62-EKF-HKNFTNFLG-Y(5) = "1"           ))
              CONTINUE
           ELSE
              MOVE    ZERO    TO    FLG-KGKIPNTAI
           END-IF
      *
           IF  ( FLG-KGKIPNTAI      =  1 )
           OR  ( FLG-WRKFILE-KGKTAI =  1 )
           OR  ( FLG-ZEROKOGAITO    =  1 )
      *
            MOVE     ZERO    TO   FLG-KOHYONKAIME-NO
            IF  (WRK-PREFNUM        = "01"           )
            AND (SYU-SYUHKNNUM  NOT = "060" AND "067")
            AND (SYU-KOH-HKNNUM(1)  = "141" OR "241" )
            AND (IDZ                =  1             )
            AND (RECE62-SRYYM      <= "200803"       )
               CONTINUE
            ELSE
               MOVE   1      TO   FLG-KOHYONKAIME-NO
            END-IF
            IF    FLG-KEISAN2 = 2
              COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                      + (SYU-TOTAL-HKNTEN * 10)
              MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
            ELSE
              COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                      + (SYU-TOTAL-HKNTEN * 10)
              MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
            END-IF
            IF  (FLG-KOHYONKAIME-NO  =  ZERO)
            AND (FLG-KOHYONKAIME     =   1  )
              IF  FLG-TOKU75 = 3
                 MOVE  22200  TO   WRK-KINGAKU
              ELSE
                 MOVE  44400  TO   WRK-KINGAKU
              END-IF
            ELSE
              IF  FLG-TOKU75 = 3
               IF   WRK-CHIHOU-KIN  >  133500
                  COMPUTE  WRK-KINGAKU2 =
                        (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                      + 0.5
                  COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  MOVE     1      TO   FLG-KOUGAKU
               ELSE
                  MOVE     40050  TO   WRK-KINGAKU
               END-IF
              ELSE
               IF   WRK-CHIHOU-KIN  >  267000
                  COMPUTE  WRK-KINGAKU2 =
                        (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                      + 0.5
                  COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  MOVE     1      TO   FLG-KOUGAKU
               ELSE
                  MOVE     80100  TO   WRK-KINGAKU
               END-IF
              END-IF
            END-IF
            IF    FLG-KEISAN2 = 2
              MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
            ELSE
              MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
            END-IF
            PERFORM   2104426-ICHIBUFTN-GEN-SEC
            PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
            MOVE      1               TO   FLG-CHIIKI2
           ELSE
             IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(1) =  1                     ) AND
                  (RECE62-EKF-HKNFTNFLG-Y2(2) = "0"            ))
             OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(2) =  1                     ) AND
                  (RECE62-EKF-HKNFTNFLG-Y2(3) = "0"            ))
             OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(3) =  1                     ) AND
                  (RECE62-EKF-HKNFTNFLG-Y2(4) = "0"            ))
             OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                  (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(4) =  1                     ) AND
                  (RECE62-EKF-HKNFTNFLG-Y2(5) = "0"            ))
             OR  ((IDZ                =  2                     ) AND
                  (SYU-SKJ-FTNDAY(3)  =  1                     ))
                PERFORM   2104424-ICHIBUFTN-KOH-HEN33-SEC
             ELSE
                IF  RECE62-SRYYM  >= "201501"
                  PERFORM 2104424-ICHIBUFTN-KOH-HEN32-SEC
                ELSE
                  PERFORM 2104424-ICHIBUFTN-KOH-HEN31-SEC
                END-IF
             END-IF
           END-IF
      *
           .
       2104424-ICHIBUFTN-KOH-HEN3-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集３１（平成２６年１２月まで）
      *****************************************************************
       2104424-ICHIBUFTN-KOH-HEN31-SEC               SECTION.
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE     FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  250000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  = 75000   +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE    75000   TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  500000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  = 150000  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE    150000  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
           END-IF
           PERFORM   2104426-ICHIBUFTN-GEN-SEC
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104424-ICHIBUFTN-KOH-HEN31-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集３２（平成２７年１月から）
      *****************************************************************
       2104424-ICHIBUFTN-KOH-HEN32-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE     FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 MOVE          1       TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  421000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  279000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  842000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  558000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 MOVE          1       TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
                 MOVE          1       TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1             TO   FLG-KINGAKU-GENBUTU5
             END-IF
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1             TO   FLG-KINGAKU-GENBUTU
             END-IF
           END-IF
           PERFORM   2104426-ICHIBUFTN-GEN-SEC
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104424-ICHIBUFTN-KOH-HEN32-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集３３
      *****************************************************************
       2104424-ICHIBUFTN-KOH-HEN33-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE   FLG-TOKUSITU
             WHEN       1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050     TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500     TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100     TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000     TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 MOVE           1        TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
             WHEN       2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200     TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200     TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400     TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400     TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 MOVE           1        TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
             WHEN       3
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300     TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600     TO   WRK-KINGAKU
                 END-IF
                 MOVE           1        TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700     TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400     TO   WRK-KINGAKU
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1             TO   FLG-KINGAKU-GENBUTU5
             END-IF
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
             IF  FLG-KINGAKU-GENBUTUX  =  1
               MOVE    1             TO   FLG-KINGAKU-GENBUTU
             END-IF
           END-IF
      ***  PERFORM   2104426-ICHIBUFTN-GEN-SEC
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104424-ICHIBUFTN-KOH-HEN33-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集４
      *****************************************************************
       2104425-ICHIBUFTN-KOH-HEN4-SEC               SECTION.
      *
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               COMPUTE WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN2  TO  WRK-CHIHOU-KIN5
             WHEN       2
               COMPUTE WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN4  TO  WRK-CHIHOU-KIN5
             WHEN       3
               COMPUTE WRK-CHIHOU-KIN10 =  WRK-CHIHOU-KIN10
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN10 TO  WRK-CHIHOU-KIN5
           END-EVALUATE
      *
      ***> IF  FLG-KOHYONKAIME = 1
      ***>     MOVE   44400   TO   WRK-KINGAKU
      ***> ELSE
               IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN5  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN5 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
               ELSE
                  IF   WRK-CHIHOU-KIN5  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN5 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
               END-IF
      ***> END-IF
      *
           PERFORM   210442E-KOH-SEIHEI-Y-SEC
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               PERFORM   210449-KOHARI-CHECK-SEC
               IF  FLG-KOHARI-CHECK = 1
                 MOVE WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
               END-IF
             WHEN       2
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
             WHEN       3
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU10
           END-EVALUATE
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104425-ICHIBUFTN-KOH-HEN4-EXT.
           EXIT.
      *
      *****************************************************************
      *    生保併用（７０歳未満）
      *****************************************************************
       210442E-KOH-SEIHEI-Y-SEC               SECTION.
      *
           MOVE     ZERO    TO    FLG-SEIHEI-Y
           IF  (SYU-KOH-HKNNUM(1) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(2) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(3) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(4) = "012" OR "025")
             IF   SYU-SYUHKNNUM  NOT = SPACE
               IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
               AND  (RECE62-KOHNUM(1)(1:1)    = "0"                )
               AND  (RECE62-KOHNUM(1)     NOT = "012" AND "025"    )
               AND  (RECE62-TOTALTEN(1)       =  RECE62-TOTALTEN(2))
               AND  (FLG-ZENKOKUKOHI-NISYU9   =  ZERO              )
                 IF   FLG-ZENKOKUKOHI-NISYU-SC =  1
                   IF  FLG-TOKU75 = 3
                     MOVE  5000       TO   WRK-KINGAKU
                   ELSE
                     MOVE  10000      TO   WRK-KINGAKU
                   END-IF
                 END-IF
               ELSE
      ****       IF  FLG-KOHYONKAIME = 1
      ****         IF  FLG-TOKU75 = 3
      ****           MOVE  12300      TO   WRK-KINGAKU
      ****         ELSE
      ****           MOVE  24600      TO   WRK-KINGAKU
      ****         END-IF
      ****       ELSE
                   IF  FLG-TOKU75 = 3
                     MOVE  17700      TO   WRK-KINGAKU
                   ELSE
                     MOVE  35400      TO   WRK-KINGAKU
                   END-IF
      ****       END-IF
               END-IF
               MOVE     1       TO    FLG-SEIHEI-Y
             END-IF
           END-IF
      *
           .
       210442E-KOH-SEIHEI-Y-EXT.
           EXIT.
      *
      *****************************************************************
      *    金額の減額
      *****************************************************************
       2104426-ICHIBUFTN-GEN-SEC               SECTION.
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
      *
              COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                                  * 10
                                  * RECE62-KYURATE
                                  / 100
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKUKBN-KEISAN  =  2
                    IF  RECE62-KYURATE  <= WK-GENGAKU-RITU
                        MOVE   ZERO     TO   WRK-FTNKEI
                    ELSE
                        COMPUTE  WRK-FTNKEI-XXX = SYU-TOTAL-HKNTEN
                                                * 10
                                                * WK-GENGAKU-RITU
                                                / 100
                        IF  WRK-FTNKEI > WRK-FTNKEI-XXX
                          COMPUTE  WRK-FTNKEI         =
                                   WRK-FTNKEI         -
                                   WRK-FTNKEI-XXX
                        ELSE
                          MOVE ZERO     TO   WRK-FTNKEI
                        END-IF
                    END-IF
                  ELSE
                    IF  WK-GENGAKU-RITU = 100
                        MOVE   ZERO     TO   WRK-FTNKEI
                    ELSE
                        COMPUTE  WK-GENGAKU-RITUX =
                                 100 - WK-GENGAKU-RITU
                        IF    WRK-FTNKEI  NOT = ZERO
                          COMPUTE  WRK-FTNKEI         =
                                   WRK-FTNKEI         *
                                   WK-GENGAKU-RITUX   /
                                   100
                        END-IF
                    END-IF
                  END-IF
                WHEN        2
                  MOVE     WRK-FTNKEI   TO   WRK-FTNKEI-GENGAKU
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU *  10
      *
                  IF  WRK-FTNKEI < WK-GENGAKU-KIN2
                    MOVE   ZERO   TO   WRK-FTNKEI
                  ELSE
                    COMPUTE  WRK-FTNKEI     =
                             WRK-FTNKEI     -
                             WK-GENGAKU-KIN2
                  END-IF
      *
                  IF  WK-GENGAKU-KIN2  <=  WRK-FTNKEI-GENGAKU
                    MOVE   ZERO   TO   WK-GENGAKU-KIN2
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN2   =
                             WK-GENGAKU-KIN2   -
                             WRK-FTNKEI-GENGAKU
                  END-IF
                WHEN        3
                WHEN        4
      ***          災２の対応
                   IF    SYU-YKZKENNUM   =  3  OR  4  OR  7  OR  8
                      MOVE   ZERO     TO   WRK-FTNKEI
                   END-IF
                WHEN        5
                  MOVE     WRK-FTNKEI   TO   WRK-FTNKEI-GENGAKU
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU *  10
      *
                  IF  WRK-FTNKEI > WK-GENGAKU-KIN2
                    COMPUTE  WRK-FTNKEI     =
                             WK-GENGAKU-KIN2
                  END-IF
      *
                  IF  WK-GENGAKU-KIN2  <=  WRK-FTNKEI-GENGAKU
                    MOVE   ZERO   TO   WK-GENGAKU-KIN2
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN2   =
                             WK-GENGAKU-KIN2   -
                             WRK-FTNKEI-GENGAKU
                  END-IF
              END-EVALUATE
              IF   FLG-WRKFILE-CLEAR   =   ZERO
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
              END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
           AND  WK-GENGAKUKBN-KEISAN =   ZERO
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKU-RITU = 100
                      MOVE   ZERO     TO   WRK-KINGAKU
                  ELSE
                      COMPUTE  WK-GENGAKU-RITUX =
                               100 - WK-GENGAKU-RITU
                      IF    WRK-KINGAKU  NOT = ZERO
                        IF  FLG-KOUGAKU = ZERO
                          COMPUTE  WRK-KINGAKU         =
                                   WRK-KINGAKU         *
                                   WK-GENGAKU-RITUX    /
                                   100
                          COMPUTE  WRK-KINGAKU  = WRK-KINGAKU  +  5
                          COMPUTE  WRK-KINGAKU  = WRK-KINGAKU  / 10
                          COMPUTE  WRK-KINGAKU  = WRK-KINGAKU  * 10
                        ELSE
                          COMPUTE  WRK-KINGAKU         =
                                  (WRK-KINGAKU         *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                      END-IF
                  END-IF
                WHEN        2
                  IF  WRK-KINGAKU < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   WRK-KINGAKU
                  ELSE
                    COMPUTE  WRK-KINGAKU    =
                             WRK-KINGAKU    -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN        3
                WHEN        4
      ***          災２の対応
      **>             MOVE   ZERO     TO   WRK-KINGAKU
                      CONTINUE
                WHEN        5
                  IF  WRK-KINGAKU > WK-GENGAKU-KIN
                    COMPUTE  WRK-KINGAKU    =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
      *
           END-IF
      *
           .
       2104426-ICHIBUFTN-GEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集（高齢者）
      *****************************************************************
       2104427-TOKUSITU-HENSYU-SEC               SECTION.
      *
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(1) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(2) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(3) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
           OR  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(1)   =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(2)   =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(3)   =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(4)   =  1                     ))
           OR  ( SYU-KOH-HKNNUM(1)  = "095" OR "096"          )
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  41 OR 42 OR 43        ))
              MOVE           5         TO   FLG-JYOGENKBN2
              PERFORM 2104428-ICHIBUFTN-KOH-HEN5-SEC
           ELSE
            IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(1)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
            OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(2)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
            OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(3)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
            OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(4)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
              MOVE           5         TO   FLG-JYOGENKBN2
              PERFORM 2104428-ICHIBUFTN-KOH-HEN5X-SEC
            ELSE
              MOVE           5         TO   FLG-JYOGENKBN2
              PERFORM 2104423-ICHIBUFTN-KOH-HEN2-SEC
            END-IF
           END-IF
      *
           .
       2104427-TOKUSITU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集５
      *****************************************************************
       2104428-ICHIBUFTN-KOH-HEN5-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
      *
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
              MOVE   FLG-TOKUSITU        TO   FLG-CHECKKBN
              MOVE   FLG-TOKUSITU-TASU   TO   FLG-CHECKKBN-TASU
           ELSE
              MOVE   FLG-KANGAN          TO   FLG-CHECKKBN
              MOVE   FLG-KANGAN-TASU     TO   FLG-CHECKKBN-TASU
           END-IF
      *
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               COMPUTE WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN2  TO  WRK-CHIHOU-KIN5
             WHEN       2
               COMPUTE WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN4  TO  WRK-CHIHOU-KIN5
             WHEN       3
               COMPUTE WRK-CHIHOU-KIN10 =  WRK-CHIHOU-KIN10
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN10 TO  WRK-CHIHOU-KIN5
           END-EVALUATE
      *
           IF  SYU-KOH-HKNNUM(1)  = "095" OR "096"
             EVALUATE  FLG-KOUREI-GENEKIKBN
               WHEN     1
               WHEN     2
               WHEN     3
                   MOVE     1         TO  FLG-SYOTOKU-KBN
                   IF   FLG-KOHYONKAIME  =  1
                     MOVE   FLG-KOUREI-GENEKIKBN
                                      TO  FLG-COVID-TASU
                   END-IF
               WHEN     4
                   MOVE     2         TO  FLG-SYOTOKU-KBN
                   IF   FLG-KOHYONKAIME  =  1
                     MOVE   FLG-KOUREI-GENEKIKBN
                                      TO  FLG-COVID-TASU
                   END-IF
               WHEN     5
                   MOVE     3         TO  FLG-SYOTOKU-KBN
             END-EVALUATE
             MOVE  FLG-KOHYONKAIME    TO  FLG-SYOTOKU-TASU
           ELSE
             MOVE  FLG-CHECKKBN       TO  FLG-SYOTOKU-KBN
             MOVE  FLG-CHECKKBN-TASU  TO  FLG-SYOTOKU-TASU
           END-IF
      *
      ***  EVALUATE   FLG-TOKUSITU
      ***  EVALUATE   FLG-CHECKKBN
           EVALUATE   FLG-SYOTOKU-KBN
             WHEN       1
               IF     RECE62-SRYYM   >=  "201808"
                EVALUATE   FLG-KOUREI-GENEKIKBN
                  WHEN        1
      ***           IF    FLG-TOKUSITU-TASU  =  1
      ***           IF    FLG-CHECKKBN-TASU  =  1
                    IF    FLG-SYOTOKU-TASU   =  1
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    70050     TO   WRK-KINGAKU
                     ELSE
                       MOVE   140100     TO   WRK-KINGAKU
                     END-IF
                     MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                    ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN5  >  421000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 421000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE    126300  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN5  >  842000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 842000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE    252600  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                    END-IF
                  WHEN        2
      ***           IF    FLG-TOKUSITU-TASU  =  1
      ***           IF    FLG-CHECKKBN-TASU  =  1
                    IF    FLG-SYOTOKU-TASU   =  1
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    46500     TO   WRK-KINGAKU
                     ELSE
                       MOVE    93000     TO   WRK-KINGAKU
                     END-IF
                     MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                    ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN5  >  279000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 279000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE     83700  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN5  >  558000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 558000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE    167400  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                    END-IF
                  WHEN        3
      ***           IF    FLG-TOKUSITU-TASU  =  1
      ***           IF    FLG-CHECKKBN-TASU  =  1
                    IF    FLG-SYOTOKU-TASU   =  1
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    22200     TO   WRK-KINGAKU
                     ELSE
                       MOVE    44400     TO   WRK-KINGAKU
                     END-IF
                     MOVE       1        TO   FLG-KINGAKU-GENBUTUX
                    ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN5  >  133500
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 133500 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE     40050  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN5  >  267000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 267000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE     80100  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                    END-IF
                END-EVALUATE
               ELSE
      ***       IF    FLG-TOKUSITU-TASU  =  1
      ***       IF    FLG-CHECKKBN-TASU  =  1
                IF    FLG-SYOTOKU-TASU   =  1
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    22200     TO   WRK-KINGAKU
                 ELSE
                   MOVE    44400     TO   WRK-KINGAKU
                 END-IF
                ELSE
                 IF  FLG-TOKU75 = 1 OR 2
                   IF   WRK-CHIHOU-KIN5  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN5 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                   ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                   END-IF
                 ELSE
                   IF   WRK-CHIHOU-KIN5  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN5 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                   ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                   END-IF
                 END-IF
                END-IF
               END-IF
             WHEN       2
               IF      RECE62-SRYYM   >=  "201708"
      ***        IF    FLG-TOKUSITU-TASU  =  1
      ***        IF    FLG-CHECKKBN-TASU  =  1
                 IF    FLG-SYOTOKU-TASU   =  1
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200   TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400   TO   WRK-KINGAKU
                   END-IF
                   MOVE       1      TO   FLG-KINGAKU-GENBUTUX
                 ELSE
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    28800   TO   WRK-KINGAKU
                   ELSE
                     MOVE    57600   TO   WRK-KINGAKU
                   END-IF
                 END-IF
               ELSE
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE      22200   TO   WRK-KINGAKU
                 ELSE
                   MOVE      44400   TO   WRK-KINGAKU
                 END-IF
               END-IF
             WHEN       3
               EVALUATE   RECE62-TEISYOTOKU
                 WHEN  "1"
                 WHEN  "4"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    7500    TO   WRK-KINGAKU
                   ELSE
                     MOVE    15000   TO   WRK-KINGAKU
                   END-IF
                 WHEN  "2"
                 WHEN  "3"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    12300   TO   WRK-KINGAKU
                   ELSE
                     MOVE    24600   TO   WRK-KINGAKU
                   END-IF
               END-EVALUATE
           END-EVALUATE
      *
           PERFORM   210442D-KOH-SEIHEI-K-SEC
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
               IF  FLG-KINGAKU-GENBUTUX  =  1
                 MOVE   1           TO   FLG-KINGAKU-GENBUTU2
               END-IF
             WHEN       2
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
               IF  FLG-KINGAKU-GENBUTUX  =  1
                 MOVE   1           TO   FLG-KINGAKU-GENBUTU4
               END-IF
             WHEN       3
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU10
               IF  FLG-KINGAKU-GENBUTUX  =  1
                 MOVE   1           TO   FLG-KINGAKU-GENBUTU10
               END-IF
           END-EVALUATE
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104428-ICHIBUFTN-KOH-HEN5-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集５（特例）
      *****************************************************************
       2104428-ICHIBUFTN-KOH-HEN5X-SEC               SECTION.
      *
           IF   RECE62-TEISYOTOKU  NOT =  SPACE
             EVALUATE   RECE62-TEISYOTOKU
               WHEN  "1"
               WHEN  "4"
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    7500    TO   WRK-KINGAKU
                 ELSE
                   MOVE    15000   TO   WRK-KINGAKU
                 END-IF
               WHEN  "2"
               WHEN  "3"
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                   MOVE    24600   TO   WRK-KINGAKU
                 END-IF
             END-EVALUATE
           ELSE
             IF   ((RECE62-KYURATE       =   30     ) AND
                   (RECE62-RJNGENMENKBN  =   SPACE  ) AND
                   (FLG-KOHYONKAIME      =   ZERO   ))
             OR   ((RECE62-KYURATE       =   20     ) AND
                   (RECE62-SRYYM         <  "200804") AND
                   (RECE62-RJNGENMENKBN  =   SPACE  ) AND
                   (FLG-KOHYONKAIME      =   ZERO   ))
               IF    FLG-KEISAN2 = 2
                 COMPUTE WRK-CHIHOU-KIN4 =  WRK-CHIHOU-KIN4
                                         + (SYU-TOTAL-HKNTEN * 10)
                 MOVE    WRK-CHIHOU-KIN4  TO  WRK-CHIHOU-KIN5
               ELSE
                 COMPUTE WRK-CHIHOU-KIN2 =  WRK-CHIHOU-KIN2
                                         + (SYU-TOTAL-HKNTEN * 10)
                 MOVE    WRK-CHIHOU-KIN2  TO  WRK-CHIHOU-KIN5
               END-IF
               IF  FLG-TOKU75 = 1 OR 2
                 IF   WRK-CHIHOU-KIN5  >  133500
                   COMPUTE  WRK-KINGAKU2 =
                         (( WRK-CHIHOU-KIN5 -  133500 ) * 0.01 )
                                                        + 0.5
                   COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                 ELSE
                   MOVE     40050  TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF   WRK-CHIHOU-KIN5  >  267000
                   COMPUTE  WRK-KINGAKU2 =
                         (( WRK-CHIHOU-KIN5 -  267000 ) * 0.01 )
                                                        + 0.5
                   COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                 ELSE
                   MOVE     80100  TO   WRK-KINGAKU
                 END-IF
               END-IF
             ELSE
               IF    FLG-TOKU75 = 1 OR 2
                   MOVE     22200  TO   WRK-KINGAKU
               ELSE
                   MOVE     44400  TO   WRK-KINGAKU
               END-IF
             END-IF
           END-IF
           PERFORM   210442D-KOH-SEIHEI-K-SEC
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
           END-IF
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2104428-ICHIBUFTN-KOH-HEN5X-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集（７０歳未満）
      *****************************************************************
       2104429-TOKUSITU-HENSYU2-SEC               SECTION.
      *
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(1) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(2) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(3) =  1                     ))
      ***  OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 2)) AND
      ***       (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
           OR  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(1)   =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(2)   =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(3)   =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-KANGANFLG(4)   =  1                     ))
           OR  ((SYU-KOH-HKNNUM(1)  = "095" OR "096"         ) AND
                (FLG-GENBUTU70-KBN  NOT = ZERO               ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  11 OR 12 OR 21 OR 22
                                                      OR 31  ))
              MOVE      5      TO   FLG-JYOGENKBN2
              IF  RECE62-SRYYM  >= "201501"
                PERFORM 210442A-ICHIBUFTN-KOH-HEN7-SEC
              ELSE
                PERFORM 210442A-ICHIBUFTN-KOH-HEN6-SEC
              END-IF
           ELSE
            IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(1)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
            OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(2)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
            OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(3)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
            OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                 (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                 (WRK-PREFNUM        = "23"                   ) AND
                 (RECE62-KOHNUM(4)   = "191"                  ) AND
                 (RECE62-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE62-SRYYM      >=  "201204"              ) AND
                 (RECE62-SRYYM      <=  "201509"              ))
              MOVE      5      TO   FLG-JYOGENKBN2
              IF  RECE62-SRYYM  >= "201501"
                PERFORM 210442A-ICHIBUFTN-KOH-HEN7X-SEC
              ELSE
                PERFORM 210442A-ICHIBUFTN-KOH-HEN6X-SEC
              END-IF
            ELSE
              MOVE      5      TO   FLG-JYOGENKBN2
              PERFORM   2104425-ICHIBUFTN-KOH-HEN4-SEC
            END-IF
           END-IF
      *
           .
       2104429-TOKUSITU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集６（平成２６年１２月まで）
      *****************************************************************
       210442A-ICHIBUFTN-KOH-HEN6-SEC               SECTION.
      *
           EVALUATE   FLG-TOKUSITU
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF    FLG-TOKUSITU-TASU  =  1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           END-EVALUATE
      *
           .
       210442A-ICHIBUFTN-KOH-HEN6-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集６（特例）（平成２６年１２月まで）
      *****************************************************************
       210442A-ICHIBUFTN-KOH-HEN6X-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       0
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           END-EVALUATE
      *
           .
       210442A-ICHIBUFTN-KOH-HEN6X-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集７（平成２７年１月から）
      *****************************************************************
       210442A-ICHIBUFTN-KOH-HEN7-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
      *
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
              MOVE   FLG-TOKUSITU        TO   FLG-CHECKKBN
              MOVE   FLG-TOKUSITU-TASU   TO   FLG-CHECKKBN-TASU
           ELSE
              MOVE   FLG-KANGAN          TO   FLG-CHECKKBN
              MOVE   FLG-KANGAN-TASU     TO   FLG-CHECKKBN-TASU
           END-IF
      *
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               COMPUTE WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN2  TO  WRK-CHIHOU-KIN5
             WHEN       2
               COMPUTE WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN4  TO  WRK-CHIHOU-KIN5
             WHEN       3
               COMPUTE WRK-CHIHOU-KIN10 =  WRK-CHIHOU-KIN10
                                        + (SYU-TOTAL-HKNTEN * 10)
               MOVE    WRK-CHIHOU-KIN10 TO  WRK-CHIHOU-KIN5
           END-EVALUATE
      *
           IF  SYU-KOH-HKNNUM(1)  = "095" OR "096"
             EVALUATE  FLG-GENBUTU70-KBN
               WHEN     11
               WHEN     12
                   MOVE     1         TO  FLG-SYOTOKU-KBN
                   IF   FLG-KOHYONKAIME  =  1
                     MOVE   FLG-GENBUTU70-KBN
                                      TO  FLG-COVID-TASU2
                   END-IF
               WHEN     21
               WHEN     22
                   MOVE     2         TO  FLG-SYOTOKU-KBN
                   IF   FLG-KOHYONKAIME  =  1
                     MOVE   FLG-GENBUTU70-KBN
                                      TO  FLG-COVID-TASU2
                   END-IF
               WHEN     31
                   MOVE     3         TO  FLG-SYOTOKU-KBN
                   IF   FLG-KOHYONKAIME  =  1
                     MOVE   FLG-GENBUTU70-KBN
                                      TO  FLG-COVID-TASU2
                   END-IF
             END-EVALUATE
             MOVE  FLG-KOHYONKAIME    TO  FLG-SYOTOKU-TASU
           ELSE
             MOVE  FLG-CHECKKBN       TO  FLG-SYOTOKU-KBN
             MOVE  FLG-CHECKKBN-TASU  TO  FLG-SYOTOKU-TASU
           END-IF
      *
      ***  EVALUATE   FLG-TOKUSITU
      ***  EVALUATE   FLG-CHECKKBN
           EVALUATE   FLG-SYOTOKU-KBN
            WHEN       1
      ***      IF  FLG-TOKUSITU-TASU  =  1
      ***      IF  FLG-CHECKKBN-TASU  =  1
               IF  FLG-SYOTOKU-TASU   =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 MOVE           1      TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN5 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN5 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN5 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN5 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN5 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN5 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN5 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN5 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
      *
            WHEN       2
      ***      IF  FLG-TOKUSITU-TASU  =  1
      ***      IF  FLG-CHECKKBN-TASU  =  1
               IF  FLG-SYOTOKU-TASU   =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 MOVE           1      TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN5 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN5 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN5 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN5 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
      *
            WHEN       3
      ***      IF  FLG-TOKUSITU-TASU  =  1
      ***      IF  FLG-CHECKKBN-TASU  =  1
               IF  FLG-SYOTOKU-TASU   =  1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
                 MOVE           1      TO   FLG-KINGAKU-GENBUTUX
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
           END-EVALUATE
      *
           PERFORM   210442E-KOH-SEIHEI-Y-SEC
           IF   FLG-SEIHEI-Y  =  1
             MOVE    ZERO    TO    FLG-KINGAKU-GENBUTUX
           END-IF
           EVALUATE  FLG-KEISAN2
             WHEN      ZERO
             WHEN       1
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
               IF  FLG-KINGAKU-GENBUTUX  =  1
                 MOVE   1           TO   FLG-KINGAKU-GENBUTU2
               END-IF
             WHEN       2
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
               IF  FLG-KINGAKU-GENBUTUX  =  1
                 MOVE   1           TO   FLG-KINGAKU-GENBUTU4
               END-IF
             WHEN       3
               MOVE   WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU10
               IF  FLG-KINGAKU-GENBUTUX  =  1
                 MOVE   1           TO   FLG-KINGAKU-GENBUTU10
               END-IF
           END-EVALUATE
           PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           .
       210442A-ICHIBUFTN-KOH-HEN7-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集７（特例）（平成２７年１月から）
      *****************************************************************
       210442A-ICHIBUFTN-KOH-HEN7X-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-KOHYONKAIME  =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN2 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN2 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN2 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN2 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF    FLG-KOHYONKAIME  =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN4 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN4 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN4 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN4 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       0
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-KOHYONKAIME  =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN2 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN2 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF    FLG-KOHYONKAIME  =  1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN4 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN4 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF    FLG-KOHYONKAIME  =  1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
              WHEN         2
               IF    FLG-KOHYONKAIME  =  1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM   210442E-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
             END-EVALUATE
             PERFORM   2104421-ICHIBUFTN-KOH-SET-SEC
      *
           END-EVALUATE
      *
           .
       210442A-ICHIBUFTN-KOH-HEN7X-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期＋２種の編集
      *****************************************************************
       210442B-ICHIBUFTN-NISYU-HEN-SEC               SECTION.
      *
           EVALUATE  FLG-ZENKOKUKOHI-NISYU
              WHEN       1
              WHEN       2
              WHEN       5
               IF  RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               IF  RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1)
               AND RECE62-KOHNUM(3) = RECE62-KOHNUMHC(IDX1 1)
               AND RECE62-KOHID(3)  = RECE62-KOHIDHC(IDX1 1)
               AND RECE62-SRYYM    >= "202301"
                  MOVE    3    TO   FLG-KEISAN3
               END-IF
               PERFORM   210442C-ICHIBUFTN-KOH-SET2-SEC
           END-EVALUATE
      *
           .
       210442B-ICHIBUFTN-NISYU-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額セット（長期＋２種）
      *****************************************************************
       210442C-ICHIBUFTN-KOH-SET2-SEC               SECTION.
      *
           EVALUATE   FLG-KEISAN3
             WHEN         1
                 IF  FTN-KOH-XX5  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX5
                 END-IF
                 COMPUTE  FTN-KOH-YY5  =   WRK-KINGAKU -  FTN-KOH-XX5
                 IF  WRK-FTNKEI   >   FTN-KOH-YY5
                      ADD    FTN-KOH-YY5    TO  FTN-KOH-XX5
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX5
                 END-IF
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN5
                 MOVE     1                 TO  FLG-XX5-TUUKA
             WHEN         2
                 IF  FTN-KOH-XX6  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX6
                 END-IF
                 COMPUTE  FTN-KOH-YY6  =   WRK-KINGAKU -  FTN-KOH-XX6
                 IF  WRK-FTNKEI   >   FTN-KOH-YY6
                      ADD    FTN-KOH-YY6    TO  FTN-KOH-XX6
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX6
                 END-IF
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN6
                 MOVE     1                 TO  FLG-XX6-TUUKA
             WHEN         3
                 IF  FTN-KOH-XX11 >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX11
                 END-IF
                 COMPUTE  FTN-KOH-YY11 =   WRK-KINGAKU -  FTN-KOH-XX11
                 IF  WRK-FTNKEI   >   FTN-KOH-YY11
                      ADD    FTN-KOH-YY11   TO  FTN-KOH-XX11
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX11
                 END-IF
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN11
                 MOVE     1                 TO  FLG-XX11-TUUKA
           END-EVALUATE
      *
           .
       210442C-ICHIBUFTN-KOH-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費実日数テーブル情報のセット
      *****************************************************************
       210443-KOHJNISSUTBL-SET-SEC               SECTION.
      *
           EVALUATE   WRK-PREFNUM
      *
             WHEN    "38"
      *
               IF   SYU-KOH-HKNNUM(IDX3)(1:1) = "1" OR "2" OR "3" OR
                                                "4" OR "5" OR "6" OR
                                                "7" OR "8"
                  PERFORM    VARYING   IDX7    FROM   1   BY   1
                               UNTIL   IDX7      >      31
                    IF   (SYU-DAY(IDX7)  =   "1"  OR  "2"  OR  "9")
                    AND  (RECE62-JNISSUTBL(IDX7)  =   "1"         )
                       MOVE   "1"   TO   RECE62-KOHJNISSUTBL(IDX7)
                    END-IF
                  END-PERFORM
               END-IF
      *
           END-EVALUATE
      *
           .
       210443-KOHJNISSUTBL-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *****************************************************************
       210444-FTNMONEY-FTN-HENSYU-SEC               SECTION.
      *
      *    老人保険＋全国公費
           IF   RECE62-SRYYM  >= "200604"
           AND  RECE62-SRYYM  <= "200803"
             IF  (( RECE62-RJNHKNNUM      NOT =    SPACE )  AND
                  ( SYU-KOH-HKNNUM(IDX3)(1:1) =    "0"   ))
      *
                    EVALUATE   IDX3
                      WHEN      2
      ***                  ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
      ***                                RECE62-FTNMONEY-FTN(KH-IDX)
                        COMPUTE  WRK-FTNKEI-FTN  =  SYU-TOTAL-HKNTEN
                                                 *  10
                                                 *  RECE62-KYURATE
                                                 /  100
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN +  5
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN / 10
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN * 10
                        ADD      WRK-FTNKEI-FTN  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                      WHEN      3
                      WHEN      4
                        IF    (RECE62-KOUREI        =  "1" OR "2"    )
                        AND   (SYU-KOH-HKNNUM(IDX3 - 1)
                                                    =  "015" OR "016"
                                                    OR "051" OR "021"
                                                    OR "024" OR "079"
                                                    OR "011" OR "012"
                                                    OR "020"         )
                           ADD   SYU-KOH-HKNFTNMONEY(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        ELSE
                           ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        END-IF
                    END-EVALUATE
      *
                    IF   ( SYU-KOH-HKNNUM(1) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "012" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   15000
                          MOVE   15000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                    ELSE
                     IF  ( SYU-KOH-HKNNUM(1) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "972" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   10000
                          MOVE   10000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                     ELSE
                      IF ( SYU-KOH-HKNNUM(1) =   "974" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "974" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "974" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "974" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   20000
                          MOVE   20000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                      ELSE
                       IF   RECE62-SRYYM  >= "200610"
                         IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   44400
                           MOVE  44400  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                         END-IF
                       ELSE
                         IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   40200
                           MOVE  40200  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                         END-IF
                       END-IF
                      END-IF
                     END-IF
                    END-IF
      *
             END-IF
           ELSE
             IF      RECE62-SRYYM      >=  "200404"
             AND     RECE62-SRYYM      <=  "200603"
              IF  (( RECE62-RJNHKNNUM      NOT =    SPACE )  AND
                   ( SYU-KOH-HKNNUM(IDX3)(1:1) =    "0"   ))
      *
                    EVALUATE   IDX3
                      WHEN      2
      ***                  ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
      ***                                RECE62-FTNMONEY-FTN(KH-IDX)
                        COMPUTE  WRK-FTNKEI-FTN  =  SYU-TOTAL-HKNTEN
                                                 *  10
                                                 *  RECE62-KYURATE
                                                 /  100
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN +  5
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN / 10
                        COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN * 10
                        ADD      WRK-FTNKEI-FTN  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                      WHEN      3
                      WHEN      4
                        IF    (RECE62-KOUREI        =  "1" OR "2"    )
                        AND   (SYU-KOH-HKNNUM(IDX3 - 1)
                                                    =  "015" OR "016"
                                                             OR "051")
                           ADD   SYU-KOH-HKNFTNMONEY(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        ELSE
                           ADD   SYU-KOH-COMPFTN(IDX3 - 1)  TO
                                         RECE62-FTNMONEY-FTN(KH-IDX)
                        END-IF
                    END-EVALUATE
      *
                    IF   ( SYU-KOH-HKNNUM(1) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "012" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "012" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   15000
                          MOVE   15000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                    ELSE
                     IF  ( SYU-KOH-HKNNUM(1) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "972" )
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   10000
                          MOVE   10000  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                     ELSE
                       IF    RECE62-FTNMONEY-FTN(KH-IDX)   >   40200
                          MOVE   40200  TO  RECE62-FTNMONEY-FTN(KH-IDX)
                       END-IF
                     END-IF
                    END-IF
      *
              END-IF
             END-IF
           END-IF
      *
           .
       210444-FTNMONEY-FTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事金額編集
      *****************************************************************
       210445-SKJ-KINGAKU-HENSYU-SEC               SECTION.
      *
           IF    RECE62-SRYYM  >= "200610"
      *
             PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1      >    10
      *
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                   CONTINUE
               ELSE
                   EVALUATE    ID1
                     WHEN       1
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(1)
                      MOVE  "１"   TO  RECE62-SHOKUJISYUBETU-KHN
                     WHEN       2
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(1)
                      MOVE  "２"   TO  RECE62-SHOKUJISYUBETU-KHN
                     WHEN       3
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(2)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(2)
                      MOVE  "特別" TO  RECE62-SHOKUJISYUBETU(1)
                     WHEN       4
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(3)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(3)
                      MOVE  "食堂" TO  RECE62-SHOKUJISYUBETU(2)
                     WHEN       5
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(1)
                      MOVE  "１"   TO  RECE62-SHOKUJISYUBETU-KHNSEI
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       6
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(1)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(1)
                      MOVE  "２"   TO  RECE62-SHOKUJISYUBETU-KHNSEI
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       7
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(2)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(2)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       8
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(3)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(3)
                      MOVE  "食堂" TO  RECE62-SHOKUJISYUBETU(2)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                     WHEN       9
                     WHEN      10
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(4)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(4)
                      MOVE  "環境" TO  RECE62-SHOKUJISYUBETU(3)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                   END-EVALUATE
               END-IF
      *
             END-PERFORM
      *
           ELSE
      *
            IF   RECE62-SRYYM  >= "200604"
      *
             PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1      >     4
      *
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                   CONTINUE
               ELSE
                   ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(ID1)
                   MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(ID1)
               END-IF
      *
             END-PERFORM
      *
            ELSE
      *
             PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1      >     5
      *
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                 CONTINUE
               ELSE
                 MOVE     ZERO     TO    FLG-ARI
                 PERFORM  VARYING  ID2    FROM    1   BY  1
                           UNTIL   ID2                       > 2
                             OR    RECE62-SHOKUJIKHNRYO(ID2) = ZERO
                             OR    FLG-ARI                   = 1
                    IF  SYU-SHOKUJI(ID1) = RECE62-SHOKUJIKHNRYO(ID2)
                        ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(ID2)
                        MOVE  1   TO   FLG-ARI
                    END-IF
                 END-PERFORM
                 IF  FLG-ARI  =  ZERO
                 AND ID2     <=   2
                   ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(ID2)
                   MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(ID2)
                 END-IF
      *
                 IF  FLG-ARI  =  ZERO
                 AND ID2      >   2
                   MOVE     ZERO     TO    FLG-ARI2
                   PERFORM  VARYING  ID3    FROM    1   BY  1
                             UNTIL   ID3                        > 3
                              OR  RECE62-SHOKUJIKHNRYO-ETC(ID3) = ZERO
                              OR  FLG-ARI2                      = 1
                      IF  SYU-SHOKUJI(ID1)   =
                                       RECE62-SHOKUJIKHNRYO-ETC(ID3)
                          ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-ETC(ID3)
                          MOVE  1   TO   FLG-ARI2
                      END-IF
                   END-PERFORM
                   IF  FLG-ARI2  =  ZERO
                   AND ID3      <=   3
                     ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-ETC(ID3)
                     MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-ETC(ID3)
                   END-IF
                 END-IF
      *
               END-IF
      *
             END-PERFORM
      *
             IF      SYU-SHOKUJI(6)  NOT =  ZERO
                ADD   SYU-SHOKUJI-NISSU(6)  TO
                                    RECE62-SHOKUJIKHNNISSU(3)
                MOVE  SYU-SHOKUJI(6)        TO
                                    RECE62-SHOKUJIKHNRYO(3)
             END-IF
             IF      SYU-SHOKUJI(7)  NOT =  ZERO
                ADD   SYU-SHOKUJI-NISSU(7)  TO
                                    RECE62-SHOKUJIKHNNISSU(4)
                MOVE  SYU-SHOKUJI(7)        TO
                                    RECE62-SHOKUJIKHNRYO(4)
             END-IF
      *
            END-IF
      *
           END-IF
      *
           .
       210445-SKJ-KINGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事金額編集（２０１６年４月以降）
      *****************************************************************
       210445-SKJ-KINGAKU-HENSYU2-SEC               SECTION.
      *
           PERFORM  VARYING  ID1    FROM    1   BY  1
                     UNTIL   ID1      >    14
               IF  SYU-SHOKUJI(ID1)   =   ZERO
                 CONTINUE
               ELSE
                 EVALUATE    ID1
                   WHEN       1
                   WHEN       2
                   WHEN      11
                   WHEN      12
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(1)
                      IF    RECE62-SHOKUJIKHNRYO(1) = ZERO
                          MOVE  SYU-SHOKUJI(ID1)
                                        TO  RECE62-SHOKUJIKHNRYO(1)
                      ELSE
                        IF  RECE62-SHOKUJIKHNRYO(1)  NOT =
                                                   SYU-SHOKUJI(ID1)
                          MOVE  999999999
                                        TO  RECE62-SHOKUJIKHNRYO(1)
                        END-IF
                      END-IF
                      EVALUATE    ID1
                        WHEN       1
                          IF    RECE62-SHOKUJISYUBETU-KHN = SPACE
                              MOVE  "１"  TO  RECE62-SHOKUJISYUBETU-KHN
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHN  NOT = "１"
                              MOVE  "９"  TO  RECE62-SHOKUJISYUBETU-KHN
                            END-IF
                          END-IF
                        WHEN       2
                          IF    RECE62-SHOKUJISYUBETU-KHN = SPACE
                              MOVE  "２"  TO  RECE62-SHOKUJISYUBETU-KHN
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHN  NOT = "２"
                              MOVE  "９"  TO  RECE62-SHOKUJISYUBETU-KHN
                            END-IF
                          END-IF
                        WHEN      11
                          IF    RECE62-SHOKUJISYUBETU-KHN = SPACE
                              MOVE  "３"  TO  RECE62-SHOKUJISYUBETU-KHN
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHN  NOT = "３"
                              MOVE  "９"  TO  RECE62-SHOKUJISYUBETU-KHN
                            END-IF
                          END-IF
                        WHEN      12
                          IF    RECE62-SHOKUJISYUBETU-KHN = SPACE
                              MOVE  "４"  TO  RECE62-SHOKUJISYUBETU-KHN
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHN  NOT = "４"
                              MOVE  "９"  TO  RECE62-SHOKUJISYUBETU-KHN
                            END-IF
                          END-IF
                      END-EVALUATE
                   WHEN       3
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(2)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(2)
                      MOVE  "特別" TO  RECE62-SHOKUJISYUBETU(1)
                   WHEN       4
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(3)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(3)
                      MOVE  "食堂" TO  RECE62-SHOKUJISYUBETU(2)
                   WHEN       5
                   WHEN       6
                   WHEN      13
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(1)
                      IF    RECE62-SHOKUJIKHNRYO-SEI(1) = ZERO
                          MOVE  SYU-SHOKUJI(ID1)
                                        TO  RECE62-SHOKUJIKHNRYO-SEI(1)
                      ELSE
                        IF  RECE62-SHOKUJIKHNRYO-SEI(1)  NOT =
                                                   SYU-SHOKUJI(ID1)
                          MOVE  999999999
                                        TO  RECE62-SHOKUJIKHNRYO-SEI(1)
                        END-IF
                      END-IF
                      EVALUATE    ID1
                        WHEN       5
                          IF    RECE62-SHOKUJISYUBETU-KHNSEI = SPACE
                             MOVE "１" TO  RECE62-SHOKUJISYUBETU-KHNSEI
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHNSEI NOT = "１"
                             MOVE "９" TO  RECE62-SHOKUJISYUBETU-KHNSEI
                            END-IF
                          END-IF
                        WHEN       6
                          IF    RECE62-SHOKUJISYUBETU-KHNSEI = SPACE
                             MOVE "２" TO  RECE62-SHOKUJISYUBETU-KHNSEI
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHNSEI NOT = "２"
                             MOVE "９" TO  RECE62-SHOKUJISYUBETU-KHNSEI
                            END-IF
                          END-IF
                        WHEN      13
                          IF    RECE62-SHOKUJISYUBETU-KHNSEI = SPACE
                             MOVE "３" TO  RECE62-SHOKUJISYUBETU-KHNSEI
                          ELSE
                            IF  RECE62-SHOKUJISYUBETU-KHNSEI NOT = "３"
                             MOVE "９" TO  RECE62-SHOKUJISYUBETU-KHNSEI
                            END-IF
                          END-IF
                      END-EVALUATE
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                   WHEN       7
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU-SEI(2)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO-SEI(2)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                   WHEN       8
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(3)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(3)
                      MOVE  "食堂" TO  RECE62-SHOKUJISYUBETU(2)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                   WHEN       9
                   WHEN      10
                      ADD   SYU-SHOKUJI-NISSU(ID1)  TO
                                       RECE62-SHOKUJIKHNNISSU(4)
                      MOVE  SYU-SHOKUJI(ID1)        TO
                                       RECE62-SHOKUJIKHNRYO(4)
                      MOVE  "環境" TO  RECE62-SHOKUJISYUBETU(3)
                      MOVE  "1"    TO  RECE62-SEIKATURYOYO
                   WHEN      14
                      CONTINUE
                 END-EVALUATE
               END-IF
           END-PERFORM
      *
           .
       210445-SKJ-KINGAKU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *****************************************************************
       210446-FTNMONEY-HENSYU-SEC               SECTION.
      *
           IF   RECE62-SRYYM  >= "200604"
      *
                IF  (WRK-PREFNUM       =  "32"                   )
                AND (RECE62-KOHNUM(KH-IDX - 1)
                              =  "190" OR "290" OR "191" OR "291")
                AND (RECE62-SRYYM     >=  "201410"               )
                AND (IDX3             <=   3                     )
                  COMPUTE   IDX-NEXT   =   IDX3   +   1
                  IF  SYU-KOH-HKNNUM(IDX-NEXT)(1:1) >=  "1" AND <=  "8"
                    PERFORM   2104461-KOHHBTNUM-CHECK-SEC
                    IF  RECE62-KOHHBTNUM(KH-IDX - 1) =  WRK-KOHHBTNUM
                     MOVE   IDX-NEXT  TO   IDX3
                    END-IF
                  END-IF
                END-IF
      *
                ADD      1    TO   RECE62-KOHKENSU(KH-IDX - 1)
                IF (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ((RECE62-KOHNUM(KH-IDX - 1)  =  "015" OR "016"
                                                 OR "051" OR "021"
                                                 OR "024" OR "079"
                                                 OR "052" OR "011"
                                                 OR "025" OR "038"
                                                 OR "012" OR "020"
                                                 OR "028" OR "029") OR
                     (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1         )))
                OR (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ( RECE62-KOHNUM(KH-IDX - 1)  =  "054"          ) AND
                    ( RECE62-SRYYM              >=  "201501"       ))
                OR (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ( RECE62-KOHNUM(KH-IDX - 1)  =  "092"          ) AND
                    ( RECE62-SRYYM              >=  "201812"       ))
                OR (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ( RECE62-KOHNUM(KH-IDX - 1)  =  "095"          ))
                OR (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ( RECE62-KOHNUM(KH-IDX - 1)  =  "096"          ) AND
                    ( RECE62-SRYYM              >=  "202310"       ))
                OR (( RECE62-KOUREI              =  "1" OR "2"     ) AND
                    ( WRK-KOHJGNGET-TEKIYOFLG(KH-IDX - 1)  =  1    ))
                OR (  TBL-HKNFTNDATA-FLG(KH-IDX - 1) =  1           )
                  IF  ((RECE62-KOUREI                  =  "2") AND
                       (SYU-KOHTAIYKZKBN           NOT =  "9") AND
                       (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                                   NOT = ZERO) AND
                       (TBL-HKNFTNDATA-FLG(KH-IDX - 1) = ZERO))
                  OR  ((RECE62-KOUREI                  =  "2") AND
                       (RECE62-KOHNUM(KH-IDX - 1)
                                          =  "015"  OR  "016") AND
                       (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                          = 9999999 OR 999999))
      **>         OR  ((RECE62-KOUREI           =  "1" OR "2") AND
      **>              (RECE62-KOHNUM(KH-IDX - 1)
      **>                                 =  "095"           ) AND
      **>              (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
      **>                                          NOT = ZERO) AND
      **>              (TBL-HKNFTNDATA-FLG(KH-IDX - 1) = ZERO))
      **>         OR  ((RECE62-KOUREI           =  "1" OR "2") AND
      **>              (RECE62-KOHNUM(KH-IDX - 1)
      **>                                 =  "096"           ) AND
      **>              (RECE62-SRYYM     >=  "202310"        ) AND
      **>              (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
      **>                                          NOT = ZERO) AND
      **>              (TBL-HKNFTNDATA-FLG(KH-IDX - 1) = ZERO))
                   ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   WRK-TAIHI-FTNMONEY(KH-IDX)
                                   WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                   ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                   WRK-TAIHI-FTNMONEY2(KH-IDX)
                   MOVE   1   TO   WRK-KOGAKU-TAISYOGAI(KH-IDX - 1)
                   IF   ( RECE62-KOUREI = "1" OR "2"           ) 
                   AND  ((RECE62-KOHNUM(KH-IDX - 1)(1:1) = "0") OR 
                         (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1 )) 
                   AND  ( IDX3                           =  1  ) 
                     ADD SYU-KOH-COMPFTN(IDX3)      TO 
                                   RECE62-KOHFTNKIN(IDX1 IDX3) 
                   END-IF 
                  ELSE
                   ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                   WRK-TAIHI-FTNMONEY(KH-IDX)
                                   WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                   IF   ( RECE62-KOUREI = "1" OR "2"           ) 
                   AND  ((RECE62-KOHNUM(KH-IDX - 1)(1:1) = "0") OR 
                         (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1 )) 
                   AND  ( IDX3                           =  1  ) 
                     ADD SYU-KOH-HKNFTNMONEY(IDX3)  TO 
                                   RECE62-KOHFTNKIN(IDX1 IDX3) 
                   END-IF 
                  END-IF
                ELSE
                  IF   ((RECE62-EKF-ENCHGKBN-K(KH-IDX) NOT = SPACE) AND
                        (RECE62-KOUREI-HANTEIFLG           = "1"  ))
                  OR   ((RECE62-EKF-ENCHGKBN-Y(KH-IDX) NOT = SPACE) AND
                        (RECE62-KOUREI-HANTEIFLG       NOT = "1"  ))
                   IF    RECE62-KOUREI-HANTEIFLG   =   "1"
                      EVALUATE   RECE62-EKF-ENCHGKBN-K(KH-IDX)
                        WHEN       "1"
                          ADD   SYU-KOH-HKNFTNMONEY(IDX3)    TO
                                     RECE62-FTNMONEY(KH-IDX)
                                     RECE62-FTNMONEY-KOJ(KH-IDX)
                        WHEN       "2"
                        WHEN       "3"
                          IF    RECE62-KOUREI   =  "1"
                            ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                     RECE62-FTNMONEY(KH-IDX)
                                     RECE62-FTNMONEY-KOJ(KH-IDX)
                            IF  (RECE62-EKF-FTNHASUKBN(KH-IDX)    = "1")
                            AND (RECE62-HON-NYUKFTNRATE(KH-IDX - 1)(3:1)
                                                              NOT = "0")
                              COMPUTE  WRK-CHIIKI-ENTANI            =
                                       SYU-KOH-COMPFTN-ENTANI(IDX3) +
                                       0.9
                              ADD   WRK-CHIIKI-ENTANI        TO
                                       WRK-TAIHI-FTNMONEY(KH-IDX)
                                       WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                            ELSE
                              ADD   SYU-KOH-COMPFTN(IDX3)    TO
                                       WRK-TAIHI-FTNMONEY(KH-IDX)
                                       WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                            END-IF
                          ELSE
                            IF  (RECE62-EKF-FTNHASUKBN(KH-IDX)    = "1")
                            AND (RECE62-HON-NYUKFTNRATE(KH-IDX - 1)(3:1)
                                                              NOT = "0")
                              COMPUTE  WRK-CHIIKI-ENTANI            =
                                       SYU-KOH-COMPFTN-ENTANI(IDX3) +
                                       0.9
                              ADD   WRK-CHIIKI-ENTANI        TO
                                       RECE62-FTNMONEY(KH-IDX)
                                       RECE62-FTNMONEY-KOJ(KH-IDX)
                            ELSE
                              ADD   SYU-KOH-COMPFTN(IDX3)    TO
                                       RECE62-FTNMONEY(KH-IDX)
                                       RECE62-FTNMONEY-KOJ(KH-IDX)
                            END-IF
                          END-IF
                      END-EVALUATE
                      ADD   SYU-SKJ-FTN(IDX3) TO
                               WRK-SKJ-FTN(KH-IDX)
                   ELSE
                      EVALUATE   RECE62-EKF-ENCHGKBN-Y(KH-IDX)
                        WHEN       "1"
                          ADD   SYU-KOH-HKNFTNMONEY(IDX3)    TO
                                     RECE62-FTNMONEY(KH-IDX)
                                     RECE62-FTNMONEY-KOJ(KH-IDX)
                        WHEN       "2"
                        WHEN       "3"
                          IF    RECE62-KOUREI   =  "2"
                            ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                     RECE62-FTNMONEY(KH-IDX)
                                     RECE62-FTNMONEY-KOJ(KH-IDX)
                            IF  (RECE62-EKF-FTNHASUKBN(KH-IDX)    = "1")
                            AND (RECE62-HON-NYUKFTNRATE(KH-IDX - 1)(3:1)
                                                              NOT = "0")
                              COMPUTE  WRK-CHIIKI-ENTANI            =
                                       SYU-KOH-COMPFTN-ENTANI(IDX3) +
                                       0.9
                              ADD   WRK-CHIIKI-ENTANI        TO
                                       WRK-TAIHI-FTNMONEY(KH-IDX)
                                       WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                            ELSE
                              ADD   SYU-KOH-COMPFTN(IDX3)    TO
                                       WRK-TAIHI-FTNMONEY(KH-IDX)
                                       WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                            END-IF
                          ELSE
                            IF  (RECE62-EKF-FTNHASUKBN(KH-IDX)    = "1")
                            AND (RECE62-HON-NYUKFTNRATE(KH-IDX - 1)(3:1)
                                                              NOT = "0")
                              COMPUTE  WRK-CHIIKI-ENTANI            =
                                       SYU-KOH-COMPFTN-ENTANI(IDX3) +
                                       0.9
                              ADD   WRK-CHIIKI-ENTANI        TO
                                       RECE62-FTNMONEY(KH-IDX)
                                       RECE62-FTNMONEY-KOJ(KH-IDX)
                            ELSE
                              ADD   SYU-KOH-COMPFTN(IDX3)    TO
                                       RECE62-FTNMONEY(KH-IDX)
                                       RECE62-FTNMONEY-KOJ(KH-IDX)
                            END-IF
                          END-IF
                      END-EVALUATE
                      ADD   SYU-SKJ-FTN(IDX3) TO
                               WRK-SKJ-FTN(KH-IDX)
                   END-IF
                  ELSE
                   IF    (RECE62-KOUREI             =   SPACE)
                   AND   (RECE62-KOHNUM(KH-IDX - 1) =  "010" )
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                   ELSE
                     IF   RECE62-KOHNUM(KH-IDX - 1) =  "019"
                       IF    SYU-KOH-COMPFTN-ENTANI(IDX3) NOT = ZERO
                         MOVE  1       TO  RECE62-GENBAKU-TOKFLG
                         ADD   SYU-KOH-COMPFTN-ENTANI(IDX3)
                                       TO  RECE62-GENBAKU-FTNKIN(IDX1)
                         MOVE  KH-IDX  TO  RECE62-GENBAKU-IDX(IDX1)
                       END-IF
                     ELSE
                       IF  (RECE62-EKF-FTNHASUKBN(KH-IDX)      = "1")
                       AND (RECE62-HON-NYUKFTNRATE(KH-IDX - 1)(3:1)
                                                           NOT = "0")
                         COMPUTE  WRK-CHIIKI-ENTANI            =
                                  SYU-KOH-COMPFTN-ENTANI(IDX3) +
                                  0.9
                         ADD   WRK-CHIIKI-ENTANI
                                       TO  RECE62-FTNMONEY(KH-IDX)
                                           RECE62-FTNMONEY-KOJ(KH-IDX)
                         ADD   SYU-SKJ-FTN(IDX3)
                                       TO  WRK-SKJ-FTN(KH-IDX)
                       ELSE
                         ADD   SYU-KOH-COMPFTN(IDX3)
                                       TO  RECE62-FTNMONEY(KH-IDX)
                                           RECE62-FTNMONEY-KOJ(KH-IDX)
                         ADD   SYU-SKJ-FTN(IDX3)
                                       TO  WRK-SKJ-FTN(KH-IDX)
                         IF   (RECE62-KOUREI = "1" OR "2"          ) 
                         AND  (RECE62-KOHNUM(KH-IDX - 1)(1:1) = "0") 
                         AND  (IDX3                           =  1 ) 
                           ADD SYU-KOH-COMPFTN(IDX3) 
                                       TO  RECE62-KOHFTNKIN(IDX1 IDX3) 
                         END-IF 
                       END-IF
                     END-IF
                   END-IF
                  END-IF
                END-IF
      *
                COMPUTE  WRK-TAIHI-FTNMONEY-EN(KH-IDX)  =
                         WRK-TAIHI-FTNMONEY-EN(KH-IDX)  +
                        (SYU-KOH-COMPFTN-ENTANI(IDX3)   + 0.9)
                COMPUTE  WRK-TAIHI-FTNMONEY-EN2(KH-IDX) =
                         WRK-TAIHI-FTNMONEY-EN2(KH-IDX) +
                         SYU-KOH-COMPFTN-ENTANI(IDX3)
      *
                IF   ( RECE62-KOHNUM(KH-IDX - 1) =
                       "010" OR "012" OR "015" OR "016" OR
                       "021" OR "024" OR "051" OR "052" OR
                       "079" OR "011" OR "025" OR "038" OR
                       "020" OR "028" OR "029" OR "095"          )
                OR   ((RECE62-KOHNUM(KH-IDX - 1) =  "054"       ) AND
                      (RECE62-SRYYM             >=  "201501"    ))
                OR   ((RECE62-KOHNUM(KH-IDX - 1) =  "092"       ) AND
                      (RECE62-SRYYM             >=  "201812"    ))
                OR   ((RECE62-KOHNUM(KH-IDX - 1) =  "096"       ) AND
                      (RECE62-SRYYM             >=  "202310"    ))
                  EVALUATE   RECE62-KOHNUM(KH-IDX - 1)
                    WHEN       "010"
                      MOVE     5                  TO   WRK-KYURATE2
                      PERFORM  2104463-KOH-KEISAN1-SEC
                      PERFORM  2104462-KOH-GEN-KEISAN-SEC
      *
                      MOVE     5                  TO   WRK-KYURATE2
                      PERFORM  2104464-KOH-KEISAN2-SEC
                    WHEN       "012"
                    WHEN       "051"
                    WHEN       "011"
                    WHEN       "025"
                    WHEN       "038"
                    WHEN       "020"
                    WHEN       "092"
                    WHEN       "028"
                    WHEN       "029"
                    WHEN       "095"
                    WHEN       "096"
                      IF  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                           (RECE62-KOHNUM(KH-IDX - 1)     = "051"))
                      OR  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                           (RECE62-KOHNUM(KH-IDX - 1)     = "038"))
                      OR  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                           (RECE62-KOHNUM(KH-IDX - 1)     = "092"))
                        MOVE   20                 TO   WRK-KYURATE2
                      ELSE
                        MOVE   RECE62-KYURATE     TO   WRK-KYURATE2
                      END-IF
                      PERFORM  2104463-KOH-KEISAN1-SEC
                      PERFORM  2104462-KOH-GEN-KEISAN-SEC
      *
                      MOVE     RECE62-KYURATE     TO   WRK-KYURATE2
                      PERFORM  2104464-KOH-KEISAN2-SEC
                    WHEN       "015"
                    WHEN       "016"
                    WHEN       "021"
                    WHEN       "024"
                    WHEN       "079"
                      MOVE     10                 TO   WRK-KYURATE2
                      PERFORM  2104463-KOH-KEISAN1-SEC
                      PERFORM  2104462-KOH-GEN-KEISAN-SEC
      *
                      MOVE     10                 TO   WRK-KYURATE2
                      PERFORM  2104464-KOH-KEISAN2-SEC
                    WHEN       "052"
                    WHEN       "054"
                      IF  ((FLG-ZENKI-TOKUREI         =  1      ) AND
                           (RECE62-KOHNUM(KH-IDX - 1) = "054"   ) AND
                           (RECE62-SRYYM             >= "201501"))
                      OR  ((RECE62-KYURATE           >=  20     ) AND
                           (RECE62-SRYYM             >= "201501"))
                        MOVE   20                 TO   WRK-KYURATE2
                      ELSE
                        MOVE   RECE62-KYURATE     TO   WRK-KYURATE2
                      END-IF
                      PERFORM  2104463-KOH-KEISAN1-SEC
                      PERFORM  2104462-KOH-GEN-KEISAN-SEC
      *
                      IF   (RECE62-KYURATE           >=  20     )
                      AND  (RECE62-SRYYM             >= "201501")
                        MOVE   20                 TO   WRK-KYURATE2
                      ELSE
                        MOVE   RECE62-KYURATE     TO   WRK-KYURATE2
                      END-IF
                      PERFORM  2104464-KOH-KEISAN2-SEC
                  END-EVALUATE
                END-IF
      *
                IF  ((WRK-PREFNUM               = "13" ) AND
                     (RECE62-KOHNUM(KH-IDX - 1) = "151"))
                OR  ((WRK-PREFNUM               = "23" ) AND
                     (RECE62-KOHNUM(KH-IDX - 1) = "191") AND
                     (RECE62-SRYYM         >=  "200910") AND
                     (RECE62-SRYYM         <=  "201509"))
                OR  ((WRK-PREFNUM               = "23"
                                               OR "24" ) AND
                     (RECE62-KOHNUM(KH-IDX - 1) = "152") AND
                     (RECE62-SRYYM         >=  "201104") AND
                     (RECE62-SRYYM         <=  "201412"))
                    IF    FLG-ZENKI-TOKUREI  =   1
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE62-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2104463-KOH-KEISAN1-SEC
                    PERFORM  2104462-KOH-GEN-KEISAN-SEC
      *
                    MOVE     RECE62-KYURATE     TO   WRK-KYURATE2
                    PERFORM  2104464-KOH-KEISAN2-SEC
                END-IF
      *
                IF    WRK-KOHJGNGET-TEKIYOFLG(KH-IDX - 1)  =   1
                    IF  (FLG-ZENKI-TOKUREI  =  1 )
                    OR  (RECE62-KYURATE    >=  20)
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE62-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2104463-KOH-KEISAN1-SEC
                    PERFORM  2104462-KOH-GEN-KEISAN-SEC
      *
                    IF   RECE62-KYURATE    >=  20
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE62-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2104464-KOH-KEISAN2-SEC
                END-IF
      *
                IF   RECE62-SRYYM    >=  "200610"
                  IF   WRK-TOKUSYU-SKJFLG2(KH-IDX - 1) = ZERO
                    IF    SYU-SKJ-FTNKBN(IDX3)  =
                                      "5" OR "7" OR "8" OR "9"
                      IF   SYU-SKJ-FTNKBN(IDX3)  =  "8" OR "9"
                        MOVE     2   TO    FLG-TOKUSYU-SKJ
                      ELSE
                        MOVE     1   TO    FLG-TOKUSYU-SKJ
                      END-IF
                    ELSE
                      MOVE    ZERO   TO    FLG-TOKUSYU-SKJ
                    END-IF
                  ELSE
                      MOVE    WRK-TOKUSYU-SKJFLG2(KH-IDX - 1)
                                     TO    FLG-TOKUSYU-SKJ
                  END-IF
                ELSE
                      MOVE    ZERO   TO    FLG-TOKUSYU-SKJ
                END-IF
      ****
                MOVE          ZERO   TO    FLG-MIYAGI
                IF ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304004" OR "8304009" OR
                                "8304017" OR "8304023" OR
                                "8304026" OR "8304028" OR
                                "8304036" OR "8304041"      ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SRYYM         >=  "200510"      ) AND
                    (RECE62-SRYYM         <   "200604"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304004" OR "8304009" OR
                                "8304017" OR "8304023" OR
                                "8304026" OR "8304028" OR
                                "8304036" OR "8304041"      ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "200604"      ) AND
                    (RECE62-SRYYM         <   "200610"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304017"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "200610"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "583" OR "783"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304017"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "201010"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                          "263" OR "363" OR "463" OR "563"  ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304017"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "201310"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304028"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "200610"      ) AND
                    (RECE62-SRYYM         <=  "202309"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "583" OR "783"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304028"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "201010"      ) AND
                    (RECE62-SRYYM         <=  "202309"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                          "263" OR "363" OR "463" OR "563"  ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304028"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "201310"      ) AND
                    (RECE62-SRYYM         <=  "202309"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304079"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "200610"      ) AND
                    (RECE62-SRYYM         <=  "201409"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "583" OR "783"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304079"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "201010"      ) AND
                    (RECE62-SRYYM         <=  "201409"      ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                          "263" OR "363" OR "463" OR "563"  ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)   =
                                "8304079"                   ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SKJRYOKBN-HON(KH-IDX) = "2"     ) AND
                    (RECE62-SRYYM         >=  "201310"      ) AND
                    (RECE62-SRYYM         <=  "201409"      ))
                   MOVE       1      TO    FLG-MIYAGI
                END-IF
      ****
                IF   SYU-SYUHKNNUM    NOT  =   SPACE
                  IF ((SYU-SKJ-FTNKBN(IDX3)  =  "1"              ) AND
                      (SYU-SKJ-FTN(IDX3) = SYU-SKJ-FTN-RECE(IDX3)) AND
                      (FLG-MIYAGI        = ZERO                  ))
                  OR ( SYU-SKJ-FTNKBN(IDX3)  =  "6"            )
      *           OR ( SYU-SKJ-NISSU(IDX3)   =   ZERO          )
                  OR ( SYU-SKJ-RYOYOHI(IDX3) =   ZERO          )
                  OR ((SYU-KOH-HKNNUM(IDX3)  =  "079" OR "024") AND
                      (SYS-200501-SHOKUJI-PRTKBN  =  "0"      ))
                  OR ((IDX3                  >   1            ) AND
                      (SYU-KOH-HKNNUM(IDX3)(1:1)
                                        >=  "1" AND <=  "8"   ) AND
                      (SYU-KOH-HKNNUM(1)     =  "079" OR "024") AND
                      (SYU-SKJ-FTN(1)        >   0            ) AND
                      (SYU-SKJ-FTN(1)   <=   SYU-SKJ-FTN(IDX3)))
                  OR ((IDX3                  >   1            ) AND
                      (SYU-KOH-HKNNUM(IDX3)(1:1)
                                        >=  "1" AND <=  "8"   ) AND
                      (SYU-KOH-HKNNUM(1)     =  "079" OR "024") AND
                      (SYS-200501-SHOKUJI-PRTKBN  =  "0"      ) AND
                      (SYU-SKJ-FTN(1)             =  ZERO     ) AND
                      (SYU-SKJ-FTN-RECE(1)   NOT  =  ZERO     ))
      *              IF   RECE62-SHOKUJINISSU(KH-IDX)  =  ZERO
                     IF   RECE62-SHOKUJIRYOYOHI(KH-IDX) =  ZERO
                         MOVE    "1"      TO
                                 RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                         IF   RECE62-SRYYM    >= "200610"
                         AND  FLG-TOKUSYU-SKJ  =  ZERO
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                         END-IF
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                  ELSE
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                                   RECE62-SHOKUJIFTN(KH-IDX)
                     MOVE  SPACE                  TO
                                 RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                     IF   RECE62-SRYYM    >=  "200610"
                     AND  FLG-TOKUSYU-SKJ  =   ZERO
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                  END-IF
                ELSE
                  IF  ( SYU-SKJ-RYOYOHI(IDX3)   =   ZERO  )
                  OR  ((SYU-KOH1HKNNUM      =  "010"     ) AND
                       (SYU-KOH2HKNNUM(1:1) =  "0"       ) AND
                       (SYU-KOH3HKNNUM      =   SPACE    ) AND
                       (SYU-KOH4HKNNUM      =   SPACE    ) AND
                       (RECE62-KOHNUM(KH-IDX - 1) = "010") AND
                       (KH-IDX              =   2        ))
                  OR  ((SYU-KOH1HKNNUM   = "079" OR "024") AND
                       (SYU-KOH2HKNNUM      =  "012"     ) AND
                       (SYU-KOH3HKNNUM      =   SPACE    ) AND
                       (SYU-KOH4HKNNUM      =   SPACE    ) AND
                       (RECE62-KOHNUM(KH-IDX - 1) = "012") AND
                       (KH-IDX              =   3        ) AND
                       (SYU-SKJ-FTN-RECE(1)  >=  14880   ) AND
                       (RECE62-HKNNUM       =  SPACE     ) AND
                       (RECE62-KOHNUM(1) = "079" OR "024") AND
                       (RECE62-KOHNUM(2)    =  "012"     ) AND
                       (RECE62-KOHNUM(3)    =  SPACE     ) AND
                       (RECE62-KOHNUM(4)    =  SPACE     ) AND
                       (RECE62-SRYYM       >=  "200804"  ))
                     IF   RECE62-SHOKUJIRYOYOHI(KH-IDX) =  ZERO
                         MOVE    "1"      TO
                                 RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                         IF   RECE62-SRYYM    >= "200610"
                         AND  FLG-TOKUSYU-SKJ  =  ZERO
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                            MOVE    "1"      TO
                              RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                         END-IF
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                     IF  (SYU-KOH1HKNNUM   = "079" OR "024")
                     AND (SYU-KOH2HKNNUM      =  "012"     )
                     AND (SYU-KOH3HKNNUM      =   SPACE    )
                     AND (SYU-KOH4HKNNUM      =   SPACE    )
                     AND (RECE62-KOHNUM(KH-IDX - 1) = "012")
                     AND (KH-IDX              =   3        )
                     AND (SYU-SKJ-FTN-RECE(1)  >=  14880   )
                     AND (RECE62-HKNNUM       =  SPACE     )
                     AND (RECE62-KOHNUM(1) = "079" OR "024")
                     AND (RECE62-KOHNUM(2)    =  "012"     )
                     AND (RECE62-KOHNUM(3)    =  SPACE     )
                     AND (RECE62-KOHNUM(4)    =  SPACE     )
                     AND (RECE62-SRYYM       >=  "200804"  )
                         MOVE     1    TO    FLG-SKJ-CHECK
                     END-IF
                  ELSE
                   IF   ((SYU-KOH1HKNNUM  NOT =
                          "010" AND "038" AND "024" AND "079" AND
                          "052" AND "015" AND "016" AND "054"   ) AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ))
                   OR   ((SYU-KOH1HKNNUM      =  "024" OR  "079") AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (SYU-SKJ-FTNKBN(IDX3)  =  "3"          ) AND
                         (SYS-200501-SHOKUJI-PRTKBN  =  "2"     ))
                   OR   ((SYU-KOH1HKNNUM      =  "015" OR  "016") AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                                         = ZERO ) AND
                         (SYU-KOH1SKJ-FTN                = ZERO ))
      ***          OR   ((SYU-KOH1HKNNUM      =  "015" OR  "016") AND
      ***                (SYU-KOH2HKNNUM      =  "012" OR  "025") AND
      ***                (SYU-KOH3HKNNUM      =   SPACE         ) AND
      ***                (SYU-KOH4HKNNUM      =   SPACE         ) AND
      ***                (RECE62-KOHNUM(KH-IDX - 1)
      ***                                     =  "015" OR  "016") AND
      ***                (KH-IDX              =   2             ) AND
      ***                (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
      ***                                                = ZERO ) AND
      ***                (SYU-KOH1SKJ-FTN                = ZERO ))
      ***          OR   ((SYU-KOH1HKNNUM      =  "015" OR  "016") AND
      ***                (SYU-KOH2HKNNUM      =  "012" OR  "025") AND
      ***                (SYU-KOH3HKNNUM      =   SPACE         ) AND
      ***                (SYU-KOH4HKNNUM      =   SPACE         ) AND
      ***                (RECE62-KOHNUM(KH-IDX - 2)
      ***                                     =  "015" OR  "016") AND
      ***                (RECE62-KOHNUM(KH-IDX - 1)
      ***                                     =  "012" OR  "025") AND
      ***                (KH-IDX              =   3             ) AND
      ***                (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 2)
      ***                                                = ZERO ) AND
      ***                (SYU-KOH1SKJ-FTN                = ZERO ))
                   OR   ((SYU-KOH1HKNNUM      =  "052"          ) AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (RECE62-SRYYM       <   "201501"       ))
                   OR   ((SYU-KOH1HKNNUM      =  "052" OR  "054") AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                                         = ZERO ) AND
                         (SYU-KOH1SKJ-FTN                = ZERO ) AND
                         (RECE62-SRYYM       >=  "201501"       ))
      ***          OR   ((SYU-KOH1HKNNUM      =  "052" OR  "054") AND
      ***                (SYU-KOH2HKNNUM      =  "012" OR  "025") AND
      ***                (SYU-KOH3HKNNUM      =   SPACE         ) AND
      ***                (SYU-KOH4HKNNUM      =   SPACE         ) AND
      ***                (RECE62-KOHNUM(KH-IDX - 1)
      ***                                     =  "052" OR  "054") AND
      ***                (KH-IDX              =   2             ) AND
      ***                (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
      ***                                                = ZERO ) AND
      ***                (SYU-KOH1SKJ-FTN                = ZERO ) AND
      ***                (RECE62-SRYYM       >=  "201501"       ))
      ***          OR   ((SYU-KOH1HKNNUM      =  "052" OR  "054") AND
      ***                (SYU-KOH2HKNNUM      =  "012" OR  "025") AND
      ***                (SYU-KOH3HKNNUM      =   SPACE         ) AND
      ***                (SYU-KOH4HKNNUM      =   SPACE         ) AND
      ***                (RECE62-KOHNUM(KH-IDX - 2)
      ***                                     =  "052" OR  "054") AND
      ***                (RECE62-KOHNUM(KH-IDX - 1)
      ***                                     =  "012" OR  "025") AND
      ***                (KH-IDX              =   3             ) AND
      ***                (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 2)
      ***                                                = ZERO ) AND
      ***                (SYU-KOH1SKJ-FTN                = ZERO ) AND
      ***                (RECE62-SRYYM       >=  "201501"       ))
                   OR   ((SYU-KOH1HKNNUM  NOT =   SPACE         ) AND
                         (SYU-KOH2HKNNUM      =   SPACE         ) AND
                         (SYU-KOH3HKNNUM      =   SPACE         ) AND
                         (SYU-KOH4HKNNUM      =   SPACE         ) AND
                         (RECE62-SRYYM       >=  "201101"       ) AND
                         (RECE62-SRYYM       <=  "201202"       ) AND
                         (WK-GENGAKUKBN       =   3  OR  4      ) AND
                         (FLG-SAIGAI-TAISYO   =   1             ))
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     MOVE  SPACE                  TO
                                   RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                     IF   RECE62-SRYYM    >=  "200610"
                     AND  FLG-TOKUSYU-SKJ  =   ZERO
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        MOVE  SPACE               TO
                                RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
      *
                     MOVE   "1"    TO   RECE62-SKJFTNFLG(KH-IDX - 1)
                   ELSE
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                                   RECE62-SHOKUJIFTN(KH-IDX)
                     IF     RECE62-SEIHOFLG   =  "1"
                       MOVE  "1"   TO  RECE62-SKJFTNFLG2
                     ELSE
                       MOVE  SPACE                  TO
                                     RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                       IF   RECE62-SRYYM    >=  "200610"
                       AND  FLG-TOKUSYU-SKJ  =   ZERO
                          MOVE  SPACE               TO
                                  RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                          MOVE  SPACE               TO
                                  RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                       END-IF
                     END-IF
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-HENSHOKUJIRYOYOHI(KH-IDX)
                   END-IF
                  END-IF
                END-IF
      *
                IF   FLG-TOKUSYU-SKJ  NOT =  ZERO
      *           IF    SYU-SKJ-NISSU(IDX3)  NOT =  ZERO
                  IF    SYU-SKJ-RYOYOHI(IDX3) NOT =  ZERO
                        MOVE    SPACE    TO
                            RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        EVALUATE  FLG-TOKUSYU-SKJ
      *                   生活療養（食事）（環境）を対象
                          WHEN       1
                            MOVE  "1"  TO
                                  RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
      *                   生活療養（環境）のみを対象
                          WHEN       2
                            MOVE  "2"  TO
                                  RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                        END-EVALUATE
                        MOVE     1       TO
                                  WRK-TOKUSYU-SKJFLG(KH-IDX - 1)
                  ELSE
                    IF  WRK-TOKUSYU-SKJFLG(KH-IDX - 1)  =  ZERO
                        MOVE    "1"      TO
                            RECE62-FUKUSHIFLG-SKJIPA(KH-IDX - 1)
                        MOVE    "1"      TO
                            RECE62-FUKUSHIFLG-SKJSEI(KH-IDX - 1)
                    END-IF
                  END-IF
                  MOVE  FLG-TOKUSYU-SKJ  TO
                                 WRK-TOKUSYU-SKJFLG2(KH-IDX - 1)
                END-IF
      *
                IF    SYU-SKJ-FTNKBN(IDX3)  =  "2"
                  MOVE  SYU-SKJ-FTNKBN(IDX3) TO RECE62-SKJRYYKBN(KH-IDX)
                END-IF
      *
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "051"
                AND  FLG-KOH      NOT =   2
                      MOVE     1   TO   FLG-KOH
                END-IF
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "010"
                      MOVE     2   TO   FLG-KOH
                END-IF
           ELSE
                ADD      1    TO   RECE62-KOHKENSU(KH-IDX - 1)
                IF   (RECE62-SRYYM              >=  "200404"      )
                AND  (RECE62-KOUREI              =  "1" OR "2"    )
                AND  (RECE62-KOHNUM(KH-IDX - 1)  =  "015" OR "016"
                                                          OR "051")
                   ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                   RECE62-FTNMONEY(KH-IDX)
                                   RECE62-FTNMONEY-KOJ(KH-IDX)
                   ADD   SYU-SKJ-FTN(IDX3)          TO
                                   WRK-SKJ-FTN(KH-IDX)
                ELSE
                   IF    (RECE62-KOUREI             =   SPACE        )
                   AND   (RECE62-KOHNUM(KH-IDX - 1) =  "010" OR "021")
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                   ELSE
                         ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                      RECE62-FTNMONEY(KH-IDX)
                                      RECE62-FTNMONEY-KOJ(KH-IDX)
                         ADD   SYU-SKJ-FTN(IDX3)      TO
                                      WRK-SKJ-FTN(KH-IDX)
                   END-IF
                END-IF
      *
                IF ((WRK-PREFNUM           =  "38"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1)(1:1)
                                     >=  "1" AND <=  "8"    ) AND
                    (IDZ                   =   1            ))
                OR ((WRK-PREFNUM           =  "04"          ) AND
                    (RECE62-KOHNUM(KH-IDX - 1) =
                                   "183" OR "483"           ) AND
                    (RECE62-KOHFTNJANUM(KH-IDX - 1)(1:7)  NOT =
                                "8304004" AND "8304009" AND
                                "8304017" AND "8304023" AND
                                "8304026" AND "8304028" AND
                                "8304036" AND "8304041"     ) AND
                    (SYU-SKJ-FTNKBN(IDX3)  =  "1"           ) AND
                    (RECE62-SRYYM         >=  "200510"      ))
                OR ((WRK-PREFNUM           =  "39"          ) AND
                    (RECE62-KOHHBTNUM(KH-IDX - 1)  =
                              "72" OR "73" OR "74" OR "75"  ) AND
                    (RECE62-SRYYM         >=  "200510"      ))
                   IF  SYU-SKJ-NISSU(IDX3)  NOT =  ZERO
                       MOVE    "1"      TO
                               RECE62-FUKUSHIFLG-SKJ(KH-IDX - 1)
                   END-IF
                ELSE
                  IF    (SYU-SYUHKNNUM       =   SPACE         )
                  AND   (SYU-KOH1HKNNUM      =   "012" OR "019" 
                                              OR "020" OR "053")
                  AND   (SYU-KOH2HKNNUM      =   SPACE         )
                  AND   (SYU-KOH3HKNNUM      =   SPACE         )
                  AND   (SYU-KOH4HKNNUM      =   SPACE         )
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                  ELSE
                     ADD   SYU-SKJ-NISSU(IDX3)    TO
                                   RECE62-SHOKUJINISSU(KH-IDX)
                     ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                                   RECE62-SHOKUJIRYOYOHI(KH-IDX)
                     ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                                   RECE62-SHOKUJIFTN(KH-IDX)
                  END-IF
                END-IF
      *
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "051"
                AND  FLG-KOH      NOT =   2
                      MOVE     1   TO   FLG-KOH
                END-IF
                IF   RECE62-KOHNUM(KH-IDX - 1) =  "010"  OR  "021"
                      MOVE     2   TO   FLG-KOH
                END-IF
           END-IF
      *
           IF  FLG-HANTEI  =  1
                IF    SYU-YKZKENNUM  NOT = ZERO
                  MOVE    1    TO    WRK-GENMEN-ARI-KOH (KH-IDX - 1)
                ELSE
                  MOVE    1    TO    WRK-GENMEN-NASI-KOH(KH-IDX - 1)
                END-IF
           END-IF
      *
           .
       210446-FTNMONEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    法別番号チェック
      *****************************************************************
       2104461-KOHHBTNUM-CHECK-SEC               SECTION.
      *
           MOVE     SPACE    TO    WRK-KOHHBTNUM
           MOVE     ZERO     TO    FLG-ARI
           PERFORM  VARYING  IDX24   FROM    1   BY  1
                     UNTIL  (IDX24             >  100 )
                      OR    (WRK-HKNNUM(IDX24) = SPACE)
                      OR    (FLG-ARI           =  1   )
             IF  SYU-KOH-HKNNUM(IDX-NEXT) = WRK-HKNNUM(IDX24)
                MOVE    1    TO    FLG-ARI
                MOVE    WRK-HKNNUM-KOHHBTNUM(IDX24)
                             TO    WRK-KOHHBTNUM
             END-IF
           END-PERFORM
           IF    FLG-ARI  =   ZERO
             INITIALIZE                     HKNNUM-REC
             MOVE    RECE62-HOSPNUM     TO  HKN-HOSPNUM
             MOVE    SYU-KOH-HKNNUM(IDX-NEXT)
                                        TO  HKN-HKNNUM
             MOVE    RECE62-SRYYM       TO  HKN-TEKSTYMD(1:6)
                                            HKN-TEKEDYMD(1:6)
             MOVE    "01"               TO  HKN-TEKSTYMD(7:2)
                                            HKN-TEKEDYMD(7:2)
             MOVE    "00"               TO  HKN-PAYKBN
             MOVE    HKNNUM-REC         TO  MCPDATA-REC
             MOVE    "tbl_hknnum"       TO  MCP-TABLE
             MOVE    "key"              TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF     MCP-RC   =   ZERO
               MOVE  "tbl_hknnum"       TO  MCP-TABLE
               MOVE  "key"              TO  MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF   MCP-RC   =   ZERO
                 MOVE    MCPDATA-REC    TO  HKNNUM-REC
                 IF  IDX24 <= 100
                   MOVE  HKN-HKNNUM     TO  WRK-HKNNUM(IDX24)
                   MOVE  HKN-HBTNUM     TO  WRK-HKNNUM-KOHHBTNUM(IDX24)
                 END-IF
                 MOVE    HKN-HBTNUM     TO  WRK-KOHHBTNUM
               END-IF
             END-IF
             MOVE    "tbl_hknnum"       TO  MCP-TABLE
             MOVE    "key"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
           END-IF
      *
           .
       2104461-KOHHBTNUM-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費に関わる一部負担金の減免計算
      *****************************************************************
       2104462-KOH-GEN-KEISAN-SEC               SECTION.
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
      *
              COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                         * 10
                                         * WRK-KYURATE2
                                         / 100
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKUKBN-KEISAN  =  2
                    CONTINUE
                  ELSE
                    IF  WK-GENGAKU-RITU = 100
                        MOVE   ZERO     TO   WRK-TAIHI-GENKIN2
                    ELSE
                        COMPUTE  WK-GENGAKU-RITUX =
                                 100 - WK-GENGAKU-RITU
                        IF    WRK-TAIHI-GENKIN2  NOT = ZERO
                          COMPUTE  WRK-TAIHI-GENKIN2  =
                                   WRK-TAIHI-GENKIN2  *
                                   WK-GENGAKU-RITUX   /
                                   100
                        END-IF
                    END-IF
                  END-IF
                WHEN        2
                  MOVE  WRK-TAIHI-GENKIN2  TO  WRK-FTNKEI-GENGAKU2
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 *  10
      *
                  IF  WRK-TAIHI-GENKIN2 < WK-GENGAKU-KIN3
                    MOVE   ZERO   TO   WRK-TAIHI-GENKIN2
                  ELSE
                    COMPUTE  WRK-TAIHI-GENKIN2  =
                             WRK-TAIHI-GENKIN2  -
                             WK-GENGAKU-KIN3
                  END-IF
      *
                  IF  WK-GENGAKU-KIN3  <=  WRK-FTNKEI-GENGAKU2
                    MOVE   ZERO   TO   WK-GENGAKU-KIN3
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN3   =
                             WK-GENGAKU-KIN3   -
                             WRK-FTNKEI-GENGAKU2
                  END-IF
                WHEN        3
                WHEN        4
                      MOVE   ZERO     TO   WRK-TAIHI-GENKIN2
                WHEN        5
                  MOVE  WRK-TAIHI-GENKIN2  TO  WRK-FTNKEI-GENGAKU2
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 *  10
      *
                  IF  WRK-TAIHI-GENKIN2 > WK-GENGAKU-KIN3
                    COMPUTE  WRK-TAIHI-GENKIN2  =
                             WK-GENGAKU-KIN3
                  END-IF
      *
                  IF  WK-GENGAKU-KIN3  <=  WRK-FTNKEI-GENGAKU2
                    MOVE   ZERO   TO   WK-GENGAKU-KIN3
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN3   =
                             WK-GENGAKU-KIN3   -
                             WRK-FTNKEI-GENGAKU2
                  END-IF
              END-EVALUATE
              ADD      WRK-TAIHI-GENKIN2  TO
                                  WRK-TAIHI-GENKIN-EN-GEN(KH-IDX - 1)
              MOVE     WRK-TAIHI-GENKIN2  TO
                                  WRK-TAIHI-GENKIN4
              COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 +  5
              COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 / 10
              COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 * 10
              ADD      WRK-TAIHI-GENKIN4  TO
                                  WRK-TAIHI-GENKIN-GEN(KH-IDX - 1)
      *
           END-IF
      *
           .
       2104462-KOH-GEN-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費に関わる一部負担金の計算１
      *****************************************************************
       2104463-KOH-KEISAN1-SEC               SECTION.
      *
           COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                      * 10
                                      * WRK-KYURATE2
                                      / 100
      *
           ADD      WRK-TAIHI-GENKIN2  TO
                               WRK-TAIHI-GENKIN-EN(KH-IDX - 1)
           MOVE     WRK-TAIHI-GENKIN2  TO
                               WRK-TAIHI-GENKIN4
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 +  5
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 / 10
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 * 10
           ADD      WRK-TAIHI-GENKIN4  TO
                               WRK-TAIHI-GENKIN(KH-IDX - 1)
      *
           .
       2104463-KOH-KEISAN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費に関わる一部負担金の計算２
      *****************************************************************
       2104464-KOH-KEISAN2-SEC               SECTION.
      *
           COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                      * 10
                                      * WRK-KYURATE2
                                      / 100
      *
           MOVE     WRK-TAIHI-GENKIN2  TO
                               WRK-TAIHI-GENKIN4
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 +  5
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 / 10
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 * 10
           ADD      WRK-TAIHI-GENKIN4  TO
                               WRK-TAIHI-GENKIN9(KH-IDX - 1)
      *
           .
       2104464-KOH-KEISAN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       210448-SKY-SYUNOU-HENSYU-SEC               SECTION.
      *
           ADD   SYU-TOTAL-HKNTEN   TO   RECE62-SKYIRYO-TOTALTEN
      *
           IF   SYU-SYUHKNNUM   NOT =  SPACE
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
                                       * (100 - RECE62-KYURATE)
                                       /  100
              IF   RECE62-RECESYUBETU  =  "6666"
                 MOVE  ZERO             TO   WRK-SKY-KEISAN
              END-IF
              ADD      WRK-SKY-KEISAN   TO   RECE62-SKYIRYO-HOKENJA
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-HOKENJA
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
                                       *  RECE62-KYURATE
                                       /  100
              IF   RECE62-RECESYUBETU  =  "6666"
                 COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                          *  10
              END-IF
      *
              IF    SYU-YKZKENNUM   =  3  OR  4  OR  7  OR  8
                ADD    WRK-SKY-KEISAN   TO   RECE62-SKYIRYO-HOKENJA
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-HOKENJA
              ELSE
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN +  5
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN / 10
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN * 10
      *
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-ICHIBUFTN
      *
                IF     SYU-KOH-HKNNUM(1) = "970"
                  COMPUTE  WRK-SKY-KEISAN  =   SYU-SYUCOMPFTN
                ELSE
                  COMPUTE  WRK-SKY-KEISAN  =   SYU-HKNTEKMONEY
                                           +   SYU-KOH-FTN
                END-IF
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY
                IF ((SYU-KOH-HKNNUM(1) = SPACE) AND
                    (SYU-KOH-HKNNUM(2) = SPACE) AND
                    (SYU-KOH-HKNNUM(3) = SPACE) AND
                    (SYU-KOH-HKNNUM(4) = SPACE))
                OR ( SYU-KOH-HKNNUM(1) = "970" )
                OR ((SYU-KOH-HKNNUM(1) = "092") AND
                    (SYU-NYNSHOKAISU   =  7   ) AND
                    (SYU-KOH-HKNNUM(2) = SPACE) AND
                    (SYU-KOH-HKNNUM(3) = SPACE) AND
                    (SYU-KOH-HKNNUM(4) = SPACE))
                  ADD  WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY3
                END-IF
      *
                IF     FLG-KOHSKY-ARI     =  1
                  IF ((SYU-KOH-HKNNUM(1) = SPACE) AND
                      (SYU-KOH-HKNNUM(2) = SPACE) AND
                      (SYU-KOH-HKNNUM(3) = SPACE) AND
                      (SYU-KOH-HKNNUM(4) = SPACE))
                  OR ( SYU-KOH-HKNNUM(1) = "970" )
                  OR ((SYU-KOH-HKNNUM(1) = "092") AND
                      (SYU-NYNSHOKAISU   =  7   ) AND
                      (SYU-KOH-HKNNUM(2) = SPACE) AND
                      (SYU-KOH-HKNNUM(3) = SPACE) AND
                      (SYU-KOH-HKNNUM(4) = SPACE))
                  OR ((SYU-KOH-HKNNUM(1) = "972" OR "974") AND
                      (SYU-KOH-HKNNUM(2) = SPACE         ) AND
                      (SYU-KOH-HKNNUM(3) = SPACE         ) AND
                      (SYU-KOH-HKNNUM(4) = SPACE         ))
                  OR ((SYU-KOH-HKNNUM(1) = "092"         ) AND
                      (SYU-NYNSHOKAISU   =  7            ) AND
                      (SYU-KOH-HKNNUM(2) = "972" OR "974") AND
                      (SYU-KOH-HKNNUM(3) = SPACE         ) AND
                      (SYU-KOH-HKNNUM(4) = SPACE         ))
                    ADD    WRK-SKY-KEISAN
                                        TO   WRK-SKY-FTNMONEY-JYOKEN
                  END-IF
                END-IF
      *
                IF     SYU-KOH-HKNNUM(1) = "970"
                  ADD  SYU-SYUCOMPFTN   TO   RECE62-SKYIRYO-ICHIBUFTN
                ELSE
                  ADD  SYU-HKNTEKMONEY  TO   RECE62-SKYIRYO-ICHIBUFTN
                  ADD  SYU-KOH-FTN      TO   RECE62-SKYIRYO-ICHIBUFTN
                END-IF
              END-IF
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-ZENGAKU
      *
              IF ((SYU-KOH-HKNNUM(1) = SPACE) AND
                  (SYU-KOH-HKNNUM(2) = SPACE) AND
                  (SYU-KOH-HKNNUM(3) = SPACE) AND
                  (SYU-KOH-HKNNUM(4) = SPACE))
              OR ( SYU-KOH-HKNNUM(1) = "970" )
              OR ((SYU-KOH-HKNNUM(1) = "092") AND
                  (SYU-NYNSHOKAISU   =  7   ) AND
                  (SYU-KOH-HKNNUM(2) = SPACE) AND
                  (SYU-KOH-HKNNUM(3) = SPACE) AND
                  (SYU-KOH-HKNNUM(4) = SPACE))
                CONTINUE
              ELSE
                IF    SYU-YKZKENNUM   =  3  OR  4  OR  7  OR  8
                  COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                           *  10
                  ADD       WRK-SKY-KEISAN   TO  WRK-SKY-HOKENJA-KOH
                ELSE
                  COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                           *  10
                                           * (100 - RECE62-KYURATE)
                                           /  100
                  ADD       WRK-SKY-KEISAN   TO  WRK-SKY-HOKENJA-KOH
                END-IF
      *
                COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                         *  10
                ADD       WRK-SKY-KEISAN   TO  WRK-SKY-ZENGAKU-KOH
      *
                IF  (RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                OR  (RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                OR  (RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                OR  (RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                  CONTINUE
                ELSE
                  IF (RECE62-KOHSKY-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                  OR (RECE62-KOHSKY-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                  OR (RECE62-KOHSKY-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                  OR (RECE62-KOHSKY-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                    IF  (SYU-KOH-HKNNUM(1)(1:1) >=  "1" AND <=  "8")
                    AND (SYU-JYO-COMPFTN     NOT =   ZERO          )
                    AND (RECE62-SRYYM           >=  "201010"       )
                    AND (IDZ                     =   1             )
                    AND (FLG-SKY-TOKKOH          =   ZERO          )
                       PERFORM   2104481-SKY-SYUNOU-HENSYU2-SEC
                    END-IF
                  END-IF
                END-IF
      *
                PERFORM   2104483-SKY-SYUNOU-HENSYU4-SEC
      *
                IF     FLG-KOHSKY-ARI     =  1
                  PERFORM 2104484-SKY-SYUNOU-HENSYU7-SEC
                END-IF
              END-IF
           ELSE
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-ZENGAKU2
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-HKNTEKMONEY
                                       +  SYU-KOH-FTN
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY2
      *
              ADD      SYU-HKNTEKMONEY  TO   RECE62-SKYIRYO-ICHIBUFTN
              ADD      SYU-KOH-FTN      TO   RECE62-SKYIRYO-ICHIBUFTN
           END-IF
      *
      *****
      *
           IF     SYU-KOH-HKNNUM(1) = "970"
             COMPUTE  WRK-SKY-KEISAN  =  SYU-SYUSKJ-RYOYOHI
                                      -  SYU-SYUSKJ-FTN
             ADD   WRK-SKY-KEISAN     TO   RECE62-SKYSKJ-RYOYOHI
           ELSE
             ADD   SYU-RYOYOHI-SKJ    TO   RECE62-SKYSKJ-RYOYOHI
             ADD   SYU-RYOYOHI-LIFE   TO   RECE62-SKYSKJ-RYOYOHI
           END-IF
      *
           IF   SYU-SYUHKNNUM   NOT =  SPACE
              ADD      SYU-SYUSKJ-NISSU TO   RECE62-SKYSKJ-KAISU
      *
              IF   (WK-GENGAKUKBN      =   3 OR 4)
              AND  (FLG-SAIGAI-TAISYO  =   1     )
              AND  (RECE62-SRYYM      >= "201101")
              AND  (RECE62-SRYYM      <= "201202")
                ADD    SYU-SYUSKJ-RYOYOHI
                                        TO   RECE62-SKYSKJ-HOKENJA
              ELSE
                COMPUTE  WRK-SKY-KEISAN  =   SYU-SYUSKJ-RYOYOHI
                                         -   SYU-SYUSKJ-FTN
                ADD    WRK-SKY-KEISAN   TO   RECE62-SKYSKJ-HOKENJA
      *
                IF     SYU-KOH-HKNNUM(1) = "970"
                  CONTINUE
                ELSE
                  ADD  SYU-SYUSKJ-FTN   TO   WRK-SKY-SKJ-ICHIBUFTN
      *
                  COMPUTE  WRK-SKY-KEISAN  =   SYU-SKYMONEY-SKJ
                                           +   SYU-SKYMONEY-LIFE
                  ADD  WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-FTNMONEY
      *
                  ADD  SYU-SKYMONEY-SKJ TO   RECE62-SKYSKJ-ICHIBUFTN
                  ADD  SYU-SKYMONEY-LIFE
                                        TO   RECE62-SKYSKJ-ICHIBUFTN
                END-IF
              END-IF
      *
              IF     SYU-KOH-HKNNUM(1) = "970"
                CONTINUE
              ELSE
                COMPUTE  WRK-SKY-KEISAN  =  SYU-RYOYOHI-SKJ
                                         +  SYU-RYOYOHI-LIFE
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-ZENGAKU
              END-IF
      *
              IF   (FLG-KOHSKY-ARI          =  1  )
              AND  (SYU-SYUSKJ-RYOYOHI  NOT = ZERO)
                MOVE    ZERO   TO   WRK-SKJFTN1-TAIHI
                MOVE    ZERO   TO   WRK-SKJFTN2-TAIHI
                MOVE    ZERO   TO   WRK-SKJFTN3-TAIHI
                PERFORM  VARYING  IDX34  FROM  4  BY  -1
                          UNTIL   IDX34    <   1
                  IF   SYU-KOH-HKNNUM(IDX34) NOT = SPACE
                   IF  SYU-KOH-HKNNUM(IDX34) NOT = "972" AND "974"
                     IF  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(1))
                     OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(2))
                     OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(3))
                     OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(4))
                       PERFORM   2104482-SKY-SKJFTN-HENSYU-SEC
                     ELSE
                       IF  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(1))
                       OR  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(2))
                       OR  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(3))
                       OR  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(4))
                         MOVE  2  TO  WRK-KOHSKY-XXX-SKJFLG(IDX1)
                       END-IF
                     END-IF
                   END-IF
                  END-IF
                END-PERFORM
              END-IF
           ELSE
              ADD      SYU-KOH1SKJ-NISSU
                                        TO   RECE62-SKYSKJ-KAISU
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-RYOYOHI-SKJ
                                       +  SYU-RYOYOHI-LIFE
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-ZENGAKU2
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-SKYMONEY-SKJ
                                       +  SYU-SKYMONEY-LIFE
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-SKJ-FTNMONEY2
      *
              ADD      SYU-SKYMONEY-SKJ TO   RECE62-SKYSKJ-ICHIBUFTN
              ADD      SYU-SKYMONEY-LIFE
                                        TO   RECE62-SKYSKJ-ICHIBUFTN
           END-IF
      *
           .
       210448-SKY-SYUNOU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集（システム管理２０１０編集）
      *****************************************************************
       2104481-SKY-SYUNOU-HENSYU2-SEC               SECTION.
      *
           INITIALIZE                    SYSKANRI-REC
           MOVE    "2010"            TO  SYS-KANRICD
           MOVE    SYU-KOH-HKNNUM(1) TO  SYS-KBNCD
           MOVE    RECE62-SRYYM      TO  SYS-STYUKYMD (1:6)
           MOVE    "01"              TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD      TO  SYS-EDYUKYMD
           MOVE    SPA-HOSPNUM       TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC      TO  MCPDATA-REC
           MOVE    "tbl_syskanri"    TO  MCP-TABLE
           MOVE    "key10"           TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC           =   ZERO
             MOVE  "tbl_syskanri"    TO  MCP-TABLE
             MOVE  "key10"           TO  MCP-PATHNAME
             PERFORM 960-KANRIMST-READ-SEC
             IF      FLG-SYSKANRI     =   ZERO
               MOVE   MCPDATA-REC    TO  SYS-2010-REC
             ELSE
               INITIALIZE                SYS-2010-REC
             END-IF
           ELSE
               INITIALIZE                SYS-2010-REC
           END-IF
           PERFORM   21044811-SKY-SYUNOU-HENSYU3-SEC
           MOVE    "tbl_syskanri"    TO  MCP-TABLE
           MOVE    "key10"           TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       2104481-SKY-SYUNOU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集（システム管理２０１０編集）
      *****************************************************************
       21044811-SKY-SYUNOU-HENSYU3-SEC               SECTION.
      *
           IF   RECE62-SRYYM  >= "201010"
             EVALUATE  SYS-2010-NINNASIKBN
               WHEN      SPACE
                 EVALUATE   WRK-PREFNUM
                   WHEN      "04"
                     IF   SYU-KOH1HKNNUM  =  "583" OR "683" OR "783"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "363" OR "563")
                     AND (RECE62-SRYYM   >=  "201201"      )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "263" OR "463")
                     AND (RECE62-SRYYM   >=  "201201"      )
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "763"         )
                     AND (RECE62-SRYYM   >=  "201310"      )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "663"         )
                     AND (RECE62-SRYYM   >=  "201310"      )
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                     END-IF
                   WHEN      "10"
                     IF  (SYU-KOH1HKNNUM  =  "145" OR "245" OR "146"
                                          OR "246" OR "143" OR "243")
                     AND (RECE62-SRYYM   >=  "201104"               )
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                     END-IF
                   WHEN      "11"
                     IF  (SYU-KOH1HKNNUM  =  "772"                  )
                     AND (RECE62-SRYYM   >=  "201304"               )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                   WHEN      "12"
                     IF  (SYU-KOH1HKNNUM  =  "263" OR "363" OR "463")
                     AND (RECE62-SRYYM   >=  "201203"               )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                   WHEN      "40"
                     IF   SYU-KOH1HKNNUM  =  "383"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                   WHEN      "44"
                     IF   SYU-KOH1HKNNUM  =  "183" OR "283"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
               WHEN       "5"
               WHEN       "6"
               WHEN       "7"
               WHEN       "8"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN
                   WHEN      "0"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                   WHEN      "1"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "2"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "3"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   RECE62-SRYYM  >= "201104"
             EVALUATE  SYS-2010-NINJYOKBN
               WHEN      SPACE
               WHEN       "0"
                 EVALUATE   WRK-PREFNUM
                   WHEN      "10"
                     IF   SYU-KOH1HKNNUM  =  "145" OR "245" OR "146"
                                          OR "246" OR "143" OR "243"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         IF   RECE62-SRYYM  <= "201412"
                           MOVE     1     TO    FLG-SKY-TOKKOH
                         END-IF
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
                 EVALUATE   SYS-2010-NINJYO-TAIKBN
                   WHEN      "0"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                   WHEN      "1"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "2"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "3"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   RECE62-SRYYM  >= "201808"
             EVALUATE  SYS-2010-NINNASIKBN-K
               WHEN       "2"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN-K
                   WHEN      "0"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                   WHEN      "1"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "2"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "3"
                       IF ((RECE62-HKNNUM    NOT =  SPACE) AND
                           (RECE62-HKNNUM        =  "060") AND
                           (RECE62-HKNJANUM(7:2) =  SPACE) AND
                           (RECE62-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           EVALUATE   WRK-PREFNUM
             WHEN      "04"
              IF  (SYU-KOH1HKNNUM  =
                             "363" OR "563" OR "263" OR "463")
              AND (RECE62-SRYYM    <  "201201"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
              IF  (SYU-KOH1HKNNUM  =           "663" OR "763")
              AND (RECE62-SRYYM    <  "201310"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
             WHEN      "10"
              IF  (SYU-KOH1HKNNUM  =  "145" OR "245" OR "146"
                                   OR "246" OR "143" OR "243")
              AND (RECE62-SRYYM    <  "201104"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
             WHEN      "11"
              IF  (SYU-KOH1HKNNUM  =  "772"   )
              AND (RECE62-SRYYM    <  "201304")
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
             WHEN      "12"
              IF  (SYU-KOH1HKNNUM  =  "263" OR "363" OR "463")
              AND (RECE62-SRYYM    <  "201203"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
           END-EVALUATE
      *
           .
       21044811-SKY-SYUNOU-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集（食事負担編集）
      *****************************************************************
       2104482-SKY-SKJFTN-HENSYU-SEC               SECTION.
      *
           EVALUATE  IDX34
             WHEN      1
                   ADD   SYU-SYUSKJ-FTN
                                 TO  WRK-KOHSKY-XXX-SYUSKJFTN-RUI
                   ADD   SYU-SKJ-FTN(IDX34)
                                 TO  WRK-KOHSKY-XXX-SKJFTN-RUI
                   MOVE  1       TO  WRK-KOHSKY-XXX-SKJFLG(IDX1)
                   MOVE  1       TO  IDX34
             WHEN      2
               IF  ( SYU-KOH-HKNNUM(1) NOT = SPACE          )
               AND ( SYU-KOH-HKNNUM(1) NOT = "972" AND "974")
               AND ((SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(1)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(2)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(3)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(4))  )
                   MOVE  SYU-SKJ-FTN(1)  TO  WRK-SKJFTN1-TAIHI
               ELSE
                   MOVE  999999999       TO  WRK-SKJFTN1-TAIHI
               END-IF
               IF    SYU-SKJ-FTN(IDX34)  <=  WRK-SKJFTN1-TAIHI
                   ADD   SYU-SYUSKJ-FTN
                                 TO  WRK-KOHSKY-XXX-SYUSKJFTN-RUI
                   ADD   SYU-SKJ-FTN(IDX34)
                                 TO  WRK-KOHSKY-XXX-SKJFTN-RUI
                   MOVE  1       TO  WRK-KOHSKY-XXX-SKJFLG(IDX1)
                   MOVE  1       TO  IDX34
               END-IF
             WHEN      3
               IF  ( SYU-KOH-HKNNUM(1) NOT = SPACE          )
               AND ( SYU-KOH-HKNNUM(1) NOT = "972" AND "974")
               AND ((SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(1)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(2)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(3)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(4))  )
                   MOVE  SYU-SKJ-FTN(1)  TO  WRK-SKJFTN1-TAIHI
               ELSE
                   MOVE  999999999       TO  WRK-SKJFTN1-TAIHI
               END-IF
               IF  ( SYU-KOH-HKNNUM(2) NOT = SPACE          )
               AND ( SYU-KOH-HKNNUM(2) NOT = "972" AND "974")
               AND ((SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(1)) OR
                    (SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(2)) OR
                    (SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(3)) OR
                    (SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(4))  )
                   MOVE  SYU-SKJ-FTN(2)  TO  WRK-SKJFTN2-TAIHI
               ELSE
                   MOVE  999999999       TO  WRK-SKJFTN2-TAIHI
               END-IF
               IF    SYU-SKJ-FTN(IDX34)  <=  WRK-SKJFTN1-TAIHI
               AND   SYU-SKJ-FTN(IDX34)  <=  WRK-SKJFTN2-TAIHI
                   ADD   SYU-SYUSKJ-FTN
                                 TO  WRK-KOHSKY-XXX-SYUSKJFTN-RUI
                   ADD   SYU-SKJ-FTN(IDX34)
                                 TO  WRK-KOHSKY-XXX-SKJFTN-RUI
                   MOVE  1       TO  WRK-KOHSKY-XXX-SKJFLG(IDX1)
                   MOVE  1       TO  IDX34
               END-IF
             WHEN      4
               IF  ( SYU-KOH-HKNNUM(1) NOT = SPACE          )
               AND ( SYU-KOH-HKNNUM(1) NOT = "972" AND "974")
               AND ((SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(1)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(2)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(3)) OR
                    (SYU-KOH-HKNNUM(1) = RECE62-KOHNUM(4))  )
                   MOVE  SYU-SKJ-FTN(1)  TO  WRK-SKJFTN1-TAIHI
               ELSE
                   MOVE  999999999       TO  WRK-SKJFTN1-TAIHI
               END-IF
               IF  ( SYU-KOH-HKNNUM(2) NOT = SPACE          )
               AND ( SYU-KOH-HKNNUM(2) NOT = "972" AND "974")
               AND ((SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(1)) OR
                    (SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(2)) OR
                    (SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(3)) OR
                    (SYU-KOH-HKNNUM(2) = RECE62-KOHNUM(4))  )
                   MOVE  SYU-SKJ-FTN(2)  TO  WRK-SKJFTN2-TAIHI
               ELSE
                   MOVE  999999999       TO  WRK-SKJFTN2-TAIHI
               END-IF
               IF  ( SYU-KOH-HKNNUM(3) NOT = SPACE          )
               AND ( SYU-KOH-HKNNUM(3) NOT = "972" AND "974")
               AND ((SYU-KOH-HKNNUM(3) = RECE62-KOHNUM(1)) OR
                    (SYU-KOH-HKNNUM(3) = RECE62-KOHNUM(2)) OR
                    (SYU-KOH-HKNNUM(3) = RECE62-KOHNUM(3)) OR
                    (SYU-KOH-HKNNUM(3) = RECE62-KOHNUM(4))  )
                   MOVE  SYU-SKJ-FTN(3)  TO  WRK-SKJFTN3-TAIHI
               ELSE
                   MOVE  999999999       TO  WRK-SKJFTN3-TAIHI
               END-IF
               IF    SYU-SKJ-FTN(IDX34)  <=  WRK-SKJFTN1-TAIHI
               AND   SYU-SKJ-FTN(IDX34)  <=  WRK-SKJFTN2-TAIHI
               AND   SYU-SKJ-FTN(IDX34)  <=  WRK-SKJFTN3-TAIHI
                   ADD   SYU-SYUSKJ-FTN
                                 TO  WRK-KOHSKY-XXX-SYUSKJFTN-RUI
                   ADD   SYU-SKJ-FTN(IDX34)
                                 TO  WRK-KOHSKY-XXX-SKJFTN-RUI
                   MOVE  1       TO  WRK-KOHSKY-XXX-SKJFLG(IDX1)
                   MOVE  1       TO  IDX34
               END-IF
           END-EVALUATE
      *
           .
       2104482-SKY-SKJFTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       2104483-SKY-SYUNOU-HENSYU4-SEC               SECTION.
      *
           MOVE     ZERO         TO     FLG-CHIIKI3
           PERFORM  VARYING  IDX34  FROM  4  BY  -1
                     UNTIL   IDX34    <   1
             IF  (SYU-KOH-HKNNUM(IDX34) NOT = SPACE          )
             AND (SYU-KOH-HKNNUM(IDX34) NOT = "972" AND "974")
               IF  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(1))
               OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(2))
               OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(3))
               OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(4))
                 IF SYU-KOH-HKNNUM(IDX34)(1:1) >= "1" AND <= "8"
                   PERFORM    21044831-SKY-SYUNOU-HENSYU5-SEC
                   MOVE   1   TO  FLG-CHIIKI3
                 END-IF
                 MOVE     1   TO  IDX34
               ELSE
                 IF  (SYU-KOH-HKNNUM(IDX34) =
                                      RECE62-KOHSKY-KOHNUM(1))
                 OR  (SYU-KOH-HKNNUM(IDX34) =
                                      RECE62-KOHSKY-KOHNUM(2))
                 OR  (SYU-KOH-HKNNUM(IDX34) =
                                      RECE62-KOHSKY-KOHNUM(3))
                 OR  (SYU-KOH-HKNNUM(IDX34) =
                                      RECE62-KOHSKY-KOHNUM(4))
                   PERFORM    21044832-SKY-SYUNOU-HENSYU6-SEC
                   MOVE   2   TO  FLG-CHIIKI3
                   MOVE   1   TO  IDX34
                 END-IF
               END-IF
             END-IF
           END-PERFORM
           IF  FLG-CHIIKI3  =  ZERO
             ADD    SYU-KOH-FTN-ENTANI
                              TO  WRK-SKY-FTNMONEY-KOH
                                  WRK-SKY-FTNMONEY-KOHX3
           END-IF
      *
           COMPUTE  WRK-CHIIKI-ENTANI   =
                    SYU-KOH-FTN-ENTANI  +
                    0.9
           ADD   WRK-CHIIKI-ENTANI
                       TO  WRK-SKY-FTNMONEY-KOH2
           ADD   SYU-KOH-FTN
                       TO  WRK-SKY-FTNMONEY-KOH3
      *
           .
       2104483-SKY-SYUNOU-HENSYU4-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       21044831-SKY-SYUNOU-HENSYU5-SEC               SECTION.
      *
           IF   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(1)) AND
                 (RECE62-HON-NYUKFTNRATE(1)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(2)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(2)) AND
                 (RECE62-HON-NYUKFTNRATE(2)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(3)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(3)) AND
                 (RECE62-HON-NYUKFTNRATE(3)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(4)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(4)) AND
                 (RECE62-HON-NYUKFTNRATE(4)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(5)            = "1" ))
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI   +   0.9
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
                                          WRK-SKY-FTNMONEY-KOHX3
           ELSE
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
      *
             MOVE     SYU-SYUCOMPFTN-ENTANI  TO  WRK-CHK-ENTANI
                                                 WRK-CHK-ENTANI2
             IF    IDX34  >  1
               MOVE   SYU-KOH-COMPFTN-ENTANI(IDX34 - 1)
                                             TO  WRK-CHK-ENTANI2
             END-IF
             IF    SYU-KOH-FTN  =  SYU-KOH-COMPFTN(IDX34)
               IF  (SYU-KOH-COMPFTN-ENTANI(IDX34) = WRK-CHK-ENTANI )
               OR  (SYU-KOH-COMPFTN-ENTANI(IDX34) = WRK-CHK-ENTANI2)
                 ADD  WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOHX3
               ELSE
                 ADD  SYU-KOH-FTN        TO  WRK-SKY-FTNMONEY-KOHX3
               END-IF
             ELSE
               ADD    WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOHX3
             END-IF
           END-IF
      *
           .
       21044831-SKY-SYUNOU-HENSYU5-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       21044832-SKY-SYUNOU-HENSYU6-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-SKY-TOKKOH2
           IF   (SYU-KOH-HKNNUM(IDX34)(1:1) >=  "1" AND <=  "8")
           AND  (IDX34                       =   1             )
           AND  (SYU-JYO-COMPFTN         NOT =   ZERO          )
           AND  (RECE62-SRYYM               >=  "201010"       )
           AND  (IDZ                         =   1             )
           AND  (FLG-SKY-TOKKOH              =   1             )
             MOVE    1     TO    FLG-SKY-TOKKOH2
           END-IF
      *
           IF   ((WRK-PREFNUM            = "43"             ) AND
                 (SYU-KOH-HKNNUM(IDX34)  = "143" OR "342"   ) AND
                 (RECE62-SRYYM          >= "200912"         ))
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI   +   0.9
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
                                          WRK-SKY-FTNMONEY-KOHX3
           ELSE
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
      *
             MOVE  SYU-KOH-FTN        TO  WRK-CHIIKI-ENTANI2
             IF    FLG-SKY-TOKKOH2  =  1
               IF  WRK-CHIIKI-ENTANI2  >  SYU-JYO-COMPFTN
                 COMPUTE  WRK-CHIIKI-ENTANI2 = WRK-CHIIKI-ENTANI2
                                             - SYU-JYO-COMPFTN
               ELSE
                 MOVE     ZERO        TO  WRK-CHIIKI-ENTANI2
               END-IF
             END-IF
      *
             MOVE     SYU-SYUCOMPFTN-ENTANI  TO  WRK-CHK-ENTANI
                                                 WRK-CHK-ENTANI2
             IF    IDX34  >  1
               MOVE   SYU-KOH-COMPFTN-ENTANI(IDX34 - 1)
                                             TO  WRK-CHK-ENTANI2
             END-IF
             IF    WRK-CHIIKI-ENTANI2  =  SYU-KOH-COMPFTN(IDX34)
               IF  (SYU-KOH-COMPFTN-ENTANI(IDX34) = WRK-CHK-ENTANI )
               OR  (SYU-KOH-COMPFTN-ENTANI(IDX34) = WRK-CHK-ENTANI2)
                 ADD  WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOHX3
               ELSE
                 ADD  SYU-KOH-FTN        TO  WRK-SKY-FTNMONEY-KOHX3
               END-IF
             ELSE
               ADD    WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOHX3
             END-IF
           END-IF
      *
           .
       21044832-SKY-SYUNOU-HENSYU6-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       2104484-SKY-SYUNOU-HENSYU7-SEC               SECTION.
      *
           IF ((SYU-KOH-HKNNUM(1) = "972" OR "974") AND
               (SYU-KOH-HKNNUM(2) = SPACE         ) AND
               (SYU-KOH-HKNNUM(3) = SPACE         ) AND
               (SYU-KOH-HKNNUM(4) = SPACE         ))
           OR ((SYU-KOH-HKNNUM(1) = "092"         ) AND
               (SYU-NYNSHOKAISU   =  7            ) AND
               (SYU-KOH-HKNNUM(2) = "972" OR "974") AND
               (SYU-KOH-HKNNUM(3) = SPACE         ) AND
               (SYU-KOH-HKNNUM(4) = SPACE         ))
             ADD   SYU-KOH-FTN-ENTANI
                              TO  WRK-SKY-FTNMONEY-KOH-JYOKEN
           END-IF
      *
           IF   SYU-TOTAL-HKNTEN   NOT =  ZERO
             PERFORM  VARYING  IDX34  FROM  4  BY  -1
                       UNTIL   IDX34    <   1
               IF   SYU-KOH-HKNNUM(IDX34) NOT = SPACE
                IF  SYU-KOH-HKNNUM(IDX34) NOT = "972" AND "974"
                 IF  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(1))
                 OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(2))
                 OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(3))
                 OR  (SYU-KOH-HKNNUM(IDX34) = RECE62-KOHNUM(4))
                   MOVE   ZERO  TO  FLG-SKY-CHECK
      ***          IF  (RECE62-KOUREI   = "2"     )
      ***          AND (IDX34           =  1      )
      ***          AND (RECE62-SRYYM   >= "202304")
      ***            PERFORM   21044842-SKY-SYUNOU-HEN7Y-SEC
      ***          END-IF
                   IF    FLG-SKY-CHECK = ZERO
                     ADD   SYU-KOH-HKNFTNMONEY(IDX34)
                                TO  WRK-KOHSKY-XXX-COMPFTN-RUI
                   ELSE
                     ADD   SYU-KOH-COMPFTN(IDX34)
                                TO  WRK-KOHSKY-XXX-COMPFTN-RUI
                   END-IF
                   IF  (WRK-KOHSKY-XXX-FLG(IDX1) = ZERO             )
                   AND (SYU-KOH-HKNNUM(IDX34)(1:1) >= "1" AND <= "8")
                     PERFORM   21044841-SKY-SYUNOU-HEN7X-SEC
                   ELSE
                     ADD   SYU-KOH-COMPFTN-ENTANI(IDX34)
                                TO  WRK-KOHSKY-XXX-COMPFTN-EN-RUI
                   END-IF
                   MOVE     1   TO  WRK-KOHSKY-XXX-FLG(IDX1)
                   MOVE     1   TO  IDX34
                 ELSE
                   IF  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(1))
                   OR  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(2))
                   OR  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(3))
                   OR  (SYU-KOH-HKNNUM(IDX34) =
                                        RECE62-KOHSKY-KOHNUM(4))
                     MOVE   2   TO  WRK-KOHSKY-XXX-FLG(IDX1)
                   END-IF
                 END-IF
                ELSE
                     MOVE   1   TO  WRK-KOHSKY-XXX-CYOKIFLG
                END-IF
               END-IF
             END-PERFORM
           END-IF
      *
           .
       2104484-SKY-SYUNOU-HENSYU7-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       21044841-SKY-SYUNOU-HEN7X-SEC               SECTION.
      *
           IF   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(1)) AND
                 (RECE62-HON-NYUKFTNRATE(1)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(2)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(2)) AND
                 (RECE62-HON-NYUKFTNRATE(2)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(3)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(3)) AND
                 (RECE62-HON-NYUKFTNRATE(3)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(4)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX34)  =  RECE62-KOHNUM(4)) AND
                 (RECE62-HON-NYUKFTNRATE(4)(3:1)  NOT = "0" ) AND
                 (RECE62-EKF-FTNHASUKBN(5)            = "1" ))
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI   +   0.9
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-KOHSKY-XXX-COMPFTN-EN-RUI
           ELSE
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI
      *
             MOVE     SYU-SYUCOMPFTN-ENTANI  TO  WRK-CHK-ENTANI
                                                 WRK-CHK-ENTANI2
             IF    IDX34  >  1
               MOVE   SYU-KOH-COMPFTN-ENTANI(IDX34 - 1)
                                             TO  WRK-CHK-ENTANI2
             END-IF
             IF    SYU-KOH-FTN  =  SYU-KOH-COMPFTN(IDX34)
               IF  (SYU-KOH-COMPFTN-ENTANI(IDX34) = WRK-CHK-ENTANI )
               OR  (SYU-KOH-COMPFTN-ENTANI(IDX34) = WRK-CHK-ENTANI2)
                 ADD  WRK-CHIIKI-ENTANI
                                   TO  WRK-KOHSKY-XXX-COMPFTN-EN-RUI
               ELSE
                 ADD  SYU-KOH-FTN  TO  WRK-KOHSKY-XXX-COMPFTN-EN-RUI
               END-IF
             ELSE
               ADD    WRK-CHIIKI-ENTANI
                                   TO  WRK-KOHSKY-XXX-COMPFTN-EN-RUI
             END-IF
           END-IF
      *
           .
       21044841-SKY-SYUNOU-HEN7X-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       21044842-SKY-SYUNOU-HEN7Y-SEC               SECTION.
      *
           MOVE     ZERO    TO    IDX46
           IF  (RECE62-KOHNUMHC(IDX1 1) NOT =  SPACE       )
           AND (RECE62-KOHNUMHC(IDX1 1) =  RECE62-KOHNUM(1))
           AND (RECE62-KOHIDHC (IDX1 1) =  RECE62-KOHID (1))
             MOVE     1     TO    IDX46
           END-IF
           IF  (RECE62-KOHNUMHC(IDX1 1) NOT =  SPACE       )
           AND (RECE62-KOHNUMHC(IDX1 1) =  RECE62-KOHNUM(2))
           AND (RECE62-KOHIDHC (IDX1 1) =  RECE62-KOHID (2))
             MOVE     2     TO    IDX46
           END-IF
           IF  (RECE62-KOHNUMHC(IDX1 1) NOT =  SPACE       )
           AND (RECE62-KOHNUMHC(IDX1 1) =  RECE62-KOHNUM(3))
           AND (RECE62-KOHIDHC (IDX1 1) =  RECE62-KOHID (3))
             MOVE     3     TO    IDX46
           END-IF
           IF  (RECE62-KOHNUMHC(IDX1 1) NOT =  SPACE       )
           AND (RECE62-KOHNUMHC(IDX1 1) =  RECE62-KOHNUM(4))
           AND (RECE62-KOHIDHC (IDX1 1) =  RECE62-KOHID (4))
             MOVE     4     TO    IDX46
           END-IF
           IF   IDX46  NOT = ZERO
             PERFORM   210448421-SKY-SYUNOU-HEN7Y1-SEC
           END-IF
      *
           .
       21044842-SKY-SYUNOU-HEN7Y-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       210448421-SKY-SYUNOU-HEN7Y1-SEC               SECTION.
      *
           IF  ( RECE62-KOHNUM(IDX46) =
                 "015" OR "016" OR "051" OR "021" OR "024" OR "079" OR
                 "052" OR "012" OR "025" OR "038" OR "054" OR
                 "011" OR "020" OR "028" OR "029" OR "092" OR "095"    )
           OR  ((RECE62-KOHNUM(IDX46) = "096"   ) AND
                (RECE62-SRYYM        >= "202310")                      )
           OR  ( TBL-TOKATUKAIFLG(IDX46)        =  1                   )
           OR  ( WRK-KOHJGNGET-TEKIYOFLG(IDX46) =  1                   )
             IF ((SYU-KOHTAIYKZKBN              NOT = "9" ) AND
                 (TBL-HKNFTNDATA-JGNXXX(IDX46)  NOT = ZERO) AND
                 (TBL-HKNFTNDATA-FLG(IDX46)         = ZERO))
             OR ((RECE62-KOHNUM(IDX46) = "015" OR "016"   ) AND
                 (TBL-HKNFTNDATA-JGNXXX(IDX46) =
                                    9999999 OR 999999     ))
                 MOVE     1     TO    FLG-SKY-CHECK
             END-IF
           END-IF
      *
           .
       210448421-SKY-SYUNOU-HEN7Y1-EXT.
           EXIT.
      *
      *****************************************************************
      *    該当保険組み合わせに含まれている公費が
      *    レセプト記載対象となっているか
      *****************************************************************
       210449-KOHARI-CHECK-SEC      SECTION.
      *
           MOVE    ZERO   TO   FLG-KOHARI-CHECK
           IF  ((RECE62-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(1)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(1)    = RECE62-KOHIDHC(IDX1 1) ))
           OR  ((RECE62-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(2)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(2)    = RECE62-KOHIDHC(IDX1 1) ))
           OR  ((RECE62-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(3)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(3)    = RECE62-KOHIDHC(IDX1 1) ))
           OR  ((RECE62-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE62-KOHNUM(4)   = RECE62-KOHNUMHC(IDX1 1)) AND
                (RECE62-KOHID(4)    = RECE62-KOHIDHC(IDX1 1) ))
             MOVE    1    TO   FLG-KOHARI-CHECK
           END-IF
      *
           .
       210449-KOHARI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *    （レセプト記載外公費用一部負担金編集）
      *****************************************************************
       21044A-FTNMONEY-HENSYU-ETC-SEC               SECTION.
      *
           ADD     SYU-KOH-COMPFTN(IDX3)
                                   TO  RECE62-ETC-FTNMONEY(IDX45)
                                       RECE62-ETC-FTNMONEY-KOJ(IDX45)
      *
           IF   RECE62-SRYYM  >= "200604"
             IF   SYU-SYUHKNNUM    NOT  =   SPACE
               IF ((SYU-SKJ-FTNKBN(IDX3)  =  "1"              ) AND
                   (SYU-SKJ-FTN(IDX3) = SYU-SKJ-FTN-RECE(IDX3)))
               OR ( SYU-SKJ-RYOYOHI(IDX3) =   ZERO          )
               OR ((IDX3                  >   1            ) AND
                   (SYU-KOH-HKNNUM(IDX3)(1:1)
                                     >=  "1" AND <=  "8"   ) AND
                   (SYU-KOH-HKNNUM(1)     =  "079" OR "024") AND
                   (SYU-SKJ-FTN(1)        >   0            ) AND
                   (SYU-SKJ-FTN(1)   <=   SYU-SKJ-FTN(IDX3)))
               OR ((IDX3                  >   1            ) AND
                   (SYU-KOH-HKNNUM(IDX3)(1:1)
                                     >=  "1" AND <=  "8"   ) AND
                   (SYU-KOH-HKNNUM(1)     =  "079" OR "024") AND
                   (SYS-200501-SHOKUJI-PRTKBN  =  "0"      ) AND
                   (SYU-SKJ-FTN(1)             =  ZERO     ) AND
                   (SYU-SKJ-FTN-RECE(1)   NOT  =  ZERO     ))
                 CONTINUE
               ELSE
                 ADD   SYU-SKJ-NISSU(IDX3)    TO
                               RECE62-ETC-SHOKUJINISSU(IDX45)
                 ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                               RECE62-ETC-SHOKUJIRYOYOHI(IDX45)
                 ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                               RECE62-ETC-SHOKUJIFTN(IDX45)
               END-IF
             ELSE
               IF   SYU-SKJ-RYOYOHI(IDX3) =   ZERO
                 CONTINUE
               ELSE
                 ADD   SYU-SKJ-NISSU(IDX3)    TO
                               RECE62-ETC-SHOKUJINISSU(IDX45)
                 ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                               RECE62-ETC-SHOKUJIRYOYOHI(IDX45)
                 ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                               RECE62-ETC-SHOKUJIFTN(IDX45)
               END-IF
             END-IF
           ELSE
                 ADD   SYU-SKJ-NISSU(IDX3)    TO
                               RECE62-ETC-SHOKUJINISSU(IDX45)
                 ADD   SYU-SKJ-RYOYOHI(IDX3)  TO
                               RECE62-ETC-SHOKUJIRYOYOHI(IDX45)
                 ADD   SYU-SKJ-FTN-RECE(IDX3) TO
                               RECE62-ETC-SHOKUJIFTN(IDX45)
           END-IF
      *
      *    老人保険＋原爆
           IF      RECE62-SRYYM      >=  "200404"
           AND     RECE62-SRYYM      <=  "200803"
             IF   (RECE62-RJNHKNNUM      NOT =    SPACE)
             AND  (SYU-KOH-HKNNUM(IDX3)      =    "019")
               EVALUATE   IDX3
                 WHEN      2
                   COMPUTE  WRK-FTNKEI-FTN  =  SYU-TOTAL-HKNTEN
                                            *  10
                                            *  RECE62-KYURATE
                                            /  100
                   COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN +  5
                   COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN / 10
                   COMPUTE  WRK-FTNKEI-FTN = WRK-FTNKEI-FTN * 10
                   ADD      WRK-FTNKEI-FTN  TO
                                 RECE62-ETC-FTNMONEY-FTN(IDX45)
                 WHEN      3
                 WHEN      4
                   ADD      SYU-KOH-COMPFTN(IDX3 - 1)  TO
                                 RECE62-ETC-FTNMONEY-FTN(IDX45)
               END-EVALUATE
      *
               IF     (SYU-KOH-HKNNUM(1)  =  "972")
               OR     (SYU-KOH-HKNNUM(2)  =  "972")
               OR     (SYU-KOH-HKNNUM(3)  =  "972")
               OR     (SYU-KOH-HKNNUM(4)  =  "972")
                     IF    RECE62-ETC-FTNMONEY-FTN(IDX45)   >   10000
                       MOVE  10000  TO  RECE62-ETC-FTNMONEY-FTN(IDX45)
                     END-IF
               ELSE
                 IF   (SYU-KOH-HKNNUM(1)  =  "974")
                 OR   (SYU-KOH-HKNNUM(2)  =  "974")
                 OR   (SYU-KOH-HKNNUM(3)  =  "974")
                 OR   (SYU-KOH-HKNNUM(4)  =  "974")
                     IF    RECE62-ETC-FTNMONEY-FTN(IDX45)   >   20000
                       MOVE  20000  TO  RECE62-ETC-FTNMONEY-FTN(IDX45)
                     END-IF
                 ELSE
                   IF   RECE62-SRYYM  >= "200610"
                     IF    RECE62-ETC-FTNMONEY-FTN(IDX45)   >   44400
                       MOVE  44400  TO  RECE62-ETC-FTNMONEY-FTN(IDX45)
                     END-IF
                   ELSE
                     IF    RECE62-ETC-FTNMONEY-FTN(IDX45)   >   40200
                       MOVE  40200  TO  RECE62-ETC-FTNMONEY-FTN(IDX45)
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       21044A-FTNMONEY-HENSYU-ETC-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事負担含む上限額のある公費の一部負担金額編集等
      *****************************************************************
       21045-KOH-FUTAN-SET-SEC               SECTION.
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                  UNTIL    KOHFTN-IDX    >    4
      *
             IF   (RECE62-KOHNUM(KOHFTN-IDX) =  "051"   )
             AND  (RECE62-SRYYM              <  "200310")
      *
                COMPUTE  WRK-FTNKEI2 = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                     + WRK-SKJ-FTN(KOHFTN-IDX + 1)
      *
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI2 +  5
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 / 10
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 * 10
      *
                MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)  
                                   TO  WRK-FTNKEI3
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 +  5
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 / 10
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 * 10
      *
                IF  WRK-FTNKEI3  =  14000
                    MOVE  WRK-FTNKEI3  
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
                IF  WRK-FTNKEI3  <  14000
                AND WRK-FTNKEI4  =  14000
                    MOVE  WRK-FTNKEI4
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
                IF  WRK-FTNKEI3  <  14000
                AND WRK-FTNKEI4  <  14000
                    MOVE  WRK-FTNKEI2
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
      *
             END-IF
      *
             IF  ((RECE62-KOHNUM(KOHFTN-IDX) =  "012"         )   AND
                  (RECE62-SRYYM             >=  "200604"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "015" OR "016")   AND
                  (RECE62-SRYYM             >=  "200304"      )   AND
                  (RECE62-SRYYM             <=  "200603"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )   AND
                  (RECE62-SRYYM             >=  "200310"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "052"         )   AND
                  (RECE62-SRYYM             >=  "200504"      )   AND
                  (RECE62-SRYYM             <=  "201412"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "025"         )   AND
                  (RECE62-SRYYM             >=  "200804"      ))
             OR  ((RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                        >=  "1" AND <=  "8"   )   AND
                  (WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)
                                                NOT  =  ZERO  )   AND
                  (RECE62-SKJRYYKBN(KOHFTN-IDX + 1)  =  "2"   ))
      *
               IF ((WRK-PREFNUM               =  "01"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )  AND
                   (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                   AND <= "95" )  AND
                   (RECE62-SRYYM             >=  "200510"      )  AND
                   (RECE62-SRYYM             <   "200810"      ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )  AND
                   (WK-GENGAKU-SKJKASANFLG(KOHFTN-IDX + 1)
                                              =   ZERO         ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (WRK-PREFNUM               =  "13"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "151"         )  AND
                   (WK-GENGAKU-SKJKASANFLG(KOHFTN-IDX + 1)
                                              =   ZERO         ))
               OR ((WRK-PREFNUM               =  "01"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "183"         )  AND
                   (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                   AND <= "95" )  AND
                   (RECE62-SRYYM             >=  "200810"      ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (WRK-PREFNUM               =  "23"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "191"         )  AND
                   (RECE62-SRYYM             >=  "200910"      )  AND
                   (RECE62-SRYYM             <=  "201108"      )  AND
                   (WK-GENGAKU-SKJKASANFLG(KOHFTN-IDX + 1)
                                              =   ZERO         ))
               OR ((FLG-ZENKI-TOKUREI         =   1            )  AND
                   (WRK-PREFNUM               =  "23"          )  AND
                   (RECE62-KOHNUM(KOHFTN-IDX) =  "191"         )  AND
                   (RECE62-TEISYUTUSAKI       =   1            )  AND
                   (RECE62-SRYYM             >=  "201109"      )  AND
                   (RECE62-SRYYM             <=  "201509"      )  AND
                   (WK-GENGAKU-SKJKASANFLG(KOHFTN-IDX + 1)
                                              =   ZERO         ))
                CONTINUE
               ELSE
                COMPUTE  WRK-FTNKEI2 = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                     + WRK-SKJ-FTN(KOHFTN-IDX + 1)
      *
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI2 +  5
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 / 10
                COMPUTE  WRK-FTNKEI4 = WRK-FTNKEI4 * 10
      *
                MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)  
                                   TO  WRK-FTNKEI3
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 +  5
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 / 10
                COMPUTE  WRK-FTNKEI3 = WRK-FTNKEI3 * 10
      *
                PERFORM  210451-KOHFTN-KINGAKU-SEC
      *
                IF  RECE62-KOHNUM(KOHFTN-IDX) =  "012" OR "025"
                  IF    RECE62-KOUREI   =  "1" OR "2"
                    CONTINUE
                  ELSE
                    IF  (KOHFTN-IDX       =   2   )
                    AND (RECE62-KOHNUM(1) =  "010")
                    AND (RECE62-KOHNUM(3) =  SPACE)
                    AND (RECE62-KOHNUM(4) =  SPACE)
                     IF  (WRK-NYUJGNGAK  NOT =  ZERO          )
                     AND (WRK-NYUJGNGAK  >
                               RECE62-FTNMONEY(KOHFTN-IDX + 1))
                       IF WRK-NYUJGNGAK  >
                                WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                        COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                                WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                                0.5
                        COMPUTE RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                                WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                                0.5
                       ELSE
                        COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                                WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                        COMPUTE RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                                WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                       END-IF
                     END-IF
                    END-IF
                  END-IF
                END-IF
                IF  (WRK-NYUJGNGAK  NOT =  ZERO               )
                AND (WRK-NYUJGNGAK  >
                         RECE62-FTNMONEY(KOHFTN-IDX + 1)      )
                AND (RECE62-HENSHOKUJIRYOYOHI(KOHFTN-IDX + 1)
                                    NOT =  ZERO               )
                    IF  WRK-NYUJGNGAK = WRK-FTNKEI3
                    OR  WRK-NYUJGNGAK = WRK-FTNKEI4
                      MOVE  WRK-NYUJGNGAK
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    ELSE
                      MOVE  WRK-FTNKEI2
                              TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                    END-IF
                END-IF
               END-IF
      *
             END-IF
      *
           END-PERFORM
      *
           EVALUATE   WRK-PREFNUM
      *
             WHEN    "01"
      *
               IF     (RECE62-KOHNUM(1)    =  "051" OR "091")
               AND    (RECE62-KOHHBTNUM(2) =  "41"          )
               AND    (RECE62-SRYYM       <=  "200803"      )
      *
                   MOVE     ZERO     TO   WRK-JYOGEN41
      *
                   COMPUTE  WRK-FTNKEI =  RECE62-TOTALTEN(3)
                                       *  10
                                       *  RECE62-HON-NYUKFTNRATE(2)
                                       /  100
                   IF  RECE62-HON-NYUKFTNRATE(2) = 10
                     EVALUATE    RECE62-TEISYOTOKU2(2)
                       WHEN    SPACE
                        IF  RECE62-SRYYM  >=  "200610"
                            MOVE   44400  TO  WRK-JYOGEN41
                        ELSE
                            MOVE   40200  TO  WRK-JYOGEN41
                        END-IF
                       WHEN    "1"
                       WHEN    "4"
                            MOVE   15000  TO  WRK-JYOGEN41
                       WHEN    "2"
                       WHEN    "3"
                            MOVE   24600  TO  WRK-JYOGEN41
                     END-EVALUATE
                   ELSE
                     IF    RECE62-SRYYM  >=  "200610"
                       COMPUTE   WRK-FTNKEI2  =
                                 RECE62-TOTALTEN(3)   *   10
                       IF   WRK-FTNKEI2  >  267000
                          COMPUTE  WRK-FTNKEI3 =
                         (( WRK-FTNKEI2 -  267000 ) * 0.01 )
                                                    + 0.5
                          COMPUTE  WRK-JYOGEN41  =   80100
                                                 +   WRK-FTNKEI3
                       ELSE
                          MOVE   80100   TO   WRK-JYOGEN41
                       END-IF
                     ELSE
                       COMPUTE   WRK-FTNKEI2  =
                                 RECE62-TOTALTEN(3)   *   10
                       IF   WRK-FTNKEI2  >  361500
                          COMPUTE  WRK-FTNKEI3 =
                         (( WRK-FTNKEI2 -  361500 ) * 0.01 )
                                                    + 0.5
                          COMPUTE  WRK-JYOGEN41  =   72300
                                                 +   WRK-FTNKEI3
                       ELSE
                          MOVE   72300   TO   WRK-JYOGEN41
                       END-IF
                     END-IF
                   END-IF
                   IF  ( WRK-JYOGEN41  NOT =  ZERO  )
                   AND ( WRK-JYOGEN41  >  WRK-FTNKEI)
                       MOVE   WRK-FTNKEI   TO  WRK-FTNKEI4
                   ELSE
                       MOVE   WRK-JYOGEN41 TO  WRK-FTNKEI4
                   END-IF
                   MOVE RECE62-FTNMONEY(3) TO RECE62-KOH-SAIKEI
                   MOVE 1                  TO RECE62-KOH-SAIKEIFLG
                   MOVE WRK-FTNKEI4        TO RECE62-FTNMONEY(3)
                                              RECE62-FTNMONEY-KOJ(3)
      *
               END-IF
      *
             WHEN    "05"
      *
               IF   RECE62-SRYYM   >=  "200508"
                 PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >    4
                   IF  (RECE62-KOHNUM(KOHFTN-IDX) =
                          "374" OR "474" OR "280"                 )
                   AND (RECE62-HON-NYUMJGNGAK(KOHFTN-IDX)
                                 > RECE62-FTNMONEY(KOHFTN-IDX + 1))
                     IF RECE62-HON-NYUMJGNGAK(KOHFTN-IDX) >
                               WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                       COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                               WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                               0.5
                       COMPUTE RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                               WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                               0.5
                     ELSE
                       COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                               WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                       COMPUTE RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                               WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
      *
                       COMPUTE WRK-KOH-KINGAKU                        =
                               RECE62-TOTALTEN(KOHFTN-IDX + 1)        *
                               10                                     *
                               RECE62-KYURATE                         /
                               100
                       COMPUTE WRK-KOH-KINGAKU                        =
                              (WRK-KOH-KINGAKU * 0.5) + 0.5
                       IF  WRK-KOH-KINGAKU
                                < RECE62-FTNMONEY(KOHFTN-IDX + 1)
                          COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1)     =
                                  WRK-KOH-KINGAKU
                          COMPUTE RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1) =
                                  WRK-KOH-KINGAKU
                       END-IF
                     END-IF
                     MOVE    RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                           TO  WRK-SKY-FTNMONEY-KOH
                                               WRK-SKY-FTNMONEY-KOHX3
                   END-IF
                 END-PERFORM
               END-IF
      *
             WHEN    "13"
      *
               IF   RECE62-SRYYM   >=  "200710"
               AND  RECE62-SRYYM   <=  "200909"
                 PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >    4
                   IF   RECE62-KOHNUM(KOHFTN-IDX) = "588"
                     COMPUTE  RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                     COMPUTE  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                   END-IF
                 END-PERFORM
               END-IF
      *
               IF    RECE62-KOUREI   =  SPACE
                 PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >    4
                   IF  (RECE62-KOHNUM(KOHFTN-IDX) = 
                          "180" OR "380" OR "181" OR "381"        )
                   AND (RECE62-HON-NYUMJGNGAK(KOHFTN-IDX)
                                 > RECE62-FTNMONEY(KOHFTN-IDX + 1))
                     COMPUTE  RECE62-FTNMONEY(KOHFTN-IDX + 1)        =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                     COMPUTE  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                   END-IF
                 END-PERFORM
               END-IF
      *
           END-EVALUATE
      *
      *    公費一部負担金レセ記載フラグの編集
      *    公費一部負担金０円記載フラグの編集
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX     >    4
      *
              IF   RECE62-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
      *
                IF  (RECE62-HON-NYUDJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE62-HON-NYUMJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE62-HON-NYUMJGNCNT(KOHFTN-IDX)    NOT = ZERO)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200404"
                  IF ((WRK-PREFNUM               =   05           ) AND
                      (RECE62-KOHNUM(KOHFTN-IDX) =  "174"         ))
                  OR ((WRK-PREFNUM               =   12           ) AND
                      (RECE62-KOHNUM(KOHFTN-IDX) =  "183"         ))
                  OR ((WRK-PREFNUM               =   34           ) AND
                      (RECE62-KOHNUM(KOHFTN-IDX) =  "391" OR "392"))
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200610"
                  IF  (WRK-PREFNUM               =   25      )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                    MOVE  "1" TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (WRK-PREFNUM               =   33      )
                  AND (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                    MOVE  "1" TO  RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF   (RECE62-SRYYM        >=  "200704")
                AND  (RECE62-SRYYM        <=  "200803")
                  IF  (WRK-PREFNUM               =   01            )
                  AND (RECE62-HKNNUM         NOT =  "060" AND "067")
                  AND (KOHFTN-IDX                =    1            )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "141" OR  "241")
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200810"
                  IF  (WRK-PREFNUM               =   01  )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "183")
                    MOVE "1" TO  RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF   WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)  NOT = ZERO
                   IF  (WRK-PREFNUM               =   28  )
                   AND (RECE62-KOHNUM(KOHFTN-IDX) =  "186")
                     MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                   ELSE
                     MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                     MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                     IF ((WRK-PREFNUM               =   01  ) AND
                         (RECE62-KOHNUM(KOHFTN-IDX) =  "183") AND
                         (RECE62-SRYYM           >= "200810"))
                     OR ((WRK-PREFNUM               =   23  ) AND
                         (RECE62-KOHNUM(KOHFTN-IDX) =  "191") AND
                         (RECE62-SRYYM           >= "200910") AND
                         (RECE62-SRYYM           <= "201509"))
                       IF  RECE62-KOHFTNJANUM(KOHFTN-IDX)(5:3)  = "602"
                         CONTINUE
                       ELSE
                         MOVE SPACE TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                         MOVE SPACE TO
                                   RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                       END-IF
                     END-IF
                   END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "201410"
                   IF  (WRK-PREFNUM        =  32             )
                   AND (RECE62-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                         MOVE SPACE TO
                                   RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                   END-IF
                END-IF
      *
                IF   (RECE62-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1) =  "2")
                AND  (RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)     =  "1")
                  MOVE  SPACE TO RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE62-MJK-JNISSUFLG(KOHFTN-IDX + 1)   =  "2")
                AND  (RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)   =  "1")
                  MOVE  SPACE TO RECE62-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE62-MJK-TOTALTENFLG(KOHFTN-IDX + 1) =  "2")
                AND  (RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1) =  "1")
                  MOVE  SPACE TO RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE62-MJK-KISAIFLG(KOHFTN-IDX + 1)    =  "2")
                AND  (RECE62-KISAIFLG(KOHFTN-IDX + 1)        =  "1")
                  MOVE  SPACE TO RECE62-KISAIFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE62-MJK-OCRFLG(KOHFTN-IDX + 1)      =  "2")
                AND  (RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)      =  "1")
                  MOVE  SPACE TO RECE62-EKF-OCRFLG(KOHFTN-IDX + 1)
                END-IF
      *
              ELSE
      *
                IF    RECE62-SRYYM        >=  "200404"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "015" OR "016"
                                                          OR "051"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "012"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE SPACE  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (RECE62-KOHNUM(KOHFTN-IDX) =  "010" OR "021")
                  AND (RECE62-HOTEIGAIFLG(KOHFTN-IDX + 1) = "1"   )
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200504"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "052"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF   (RECE62-SRYYM        >=  "200510")
                AND  (RECE62-SRYYM        <=  "200809")
                  IF  ( WRK-PREFNUM               =   01   )
                  AND ( RECE62-KOHNUM(KOHFTN-IDX) =  "051" )
                  AND ((RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                      >= "91" AND <= "95" ) OR
                       (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                      >= "71" AND <= "88" ))
                    MOVE  "1" TO  RECE62-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200604"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "021"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "012"
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    IF   ( KOHFTN-IDX        =     1   )
                    AND  ( RECE62-HKNNUM     =   SPACE )
                    AND  ( RECE62-KOHNUM(2)  =   SPACE )
                    AND  ( RECE62-KOHNUM(3)  =   SPACE )
                    AND  ( RECE62-KOHNUM(4)  =   SPACE )
                     MOVE SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200610"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "024" OR "079"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200704"
                  IF  (RECE62-KOUREI             =  "1" OR "2")
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =  "010"     )
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "011" OR "020"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE SPACE  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200804"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "038" OR "025"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "025"
                    IF   ( KOHFTN-IDX        =     1   )
                    AND  ( RECE62-HKNNUM     =   SPACE )
                    AND  ( RECE62-KOHNUM(2)  =   SPACE )
                    AND  ( RECE62-KOHNUM(3)  =   SPACE )
                    AND  ( RECE62-KOHNUM(4)  =   SPACE )
                     MOVE SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "201501"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "054"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "201812"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "092"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200704"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "028" OR "029"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE62-SRYYM        >=  "202004"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "093"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
                IF    RECE62-SRYYM        >=  "202005"
                  IF   RECE62-KOHNUM(KOHFTN-IDX) =  "094"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF     RECE62-KOHNUM(KOHFTN-IDX) =  "095" OR "096"
                    MOVE  "1"   TO  RECE62-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                END-IF
      *
                IF    RECE62-SRYYM        >=  "200804"
                  IF  (RECE62-HKNNUM       =   SPACE               )
                  AND (RECE62-KOHNUM(KOHFTN-IDX) =
                       "015" OR "016" OR "021" OR "024" OR "038" OR
                       "051" OR "052" OR "054" OR "079" OR
                       "012" OR "025"                              )
                  AND (TBL-HKNFTNDATA-JGNXXX(KOHFTN-IDX) = ZERO    )
                  AND (RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1) = "1"   )
                  AND (SYS-200501-KOUHI-ICHIBU-KSIKBN      = "0"   )
                    MOVE SPACE  TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
              END-IF
      *
           END-PERFORM
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX     >    4
      *
             IF  (RECE62-EKF-FTNKEIFLG(KOHFTN-IDX + 1)    =  "1")
             AND (RECE62-FTNMONEY(KOHFTN-IDX + 1)     NOT = ZERO)
                MOVE  ZERO  TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                MOVE  SPACE TO  RECE62-ZEROKISAIFLG(KOHFTN-IDX + 1)
             END-IF
      *
           END-PERFORM
      *
      *    一部負担金・食事療養費標準負担額区分の編集
      *
      ***  IF    RECE62-SRYYM        >=  "201501"
      ***    IF   (RECE62-TEISYOTOKU3   NOT = SPACE)
      ***    AND  (RECE62-SHOKUJIRYOYOHI(1) = ZERO )
      ***    AND  (RECE62-SHOKUJIRYOYOHI(2) = ZERO )
      ***    AND  (RECE62-SHOKUJIRYOYOHI(3) = ZERO )
      ***    AND  (RECE62-SHOKUJIRYOYOHI(4) = ZERO )
      ***    AND  (RECE62-SHOKUJIRYOYOHI(5) = ZERO )
      ***      MOVE   SPACE   TO   RECE62-TEISYOTOKU3
      ***      MOVE   SPACE   TO   RECE62-TEISYOTOKU3-KKSKBN
      ***    END-IF
      ***  END-IF
      *
           IF     (RECE62-KOUREI       NOT = SPACE)
           AND    (RECE62-TEISYOTOKU   NOT = SPACE)
               EVALUATE    RECE62-TEISYOTOKU
                   WHEN    "1"
                   WHEN    "4"
                       MOVE    "3"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "2"
                       MOVE    "1"   TO   RECE62-SHOKUJIFTNKBN
                       IF   RECE62-TEISYOTOKU3 = "3"
                         MOVE  "2"   TO   RECE62-SHOKUJIFTNKBN
                       END-IF
               END-EVALUATE
      **@      IF   (RECE62-SRYYM      >=  "201204"  )
      **@      AND  (RECE62-KOUREI      =  "2" OR "3")
      **@      AND  (RECE62-TEISYOTOKU  =  "1" OR "4")
      **@              MOVE    "1"   TO   RECE62-SHOKUJIFTNKBN
      **@              DISPLAY "SHOKUJIFTNKBN OKIKAE"
      **@      END-IF
           ELSE
               EVALUATE    RECE62-TEISYOTOKU3
                   WHEN    "1"
                   WHEN    "4"
                       MOVE    "3"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "2"
                       MOVE    "1"   TO   RECE62-SHOKUJIFTNKBN
                   WHEN    "3"
                       MOVE    "2"   TO   RECE62-SHOKUJIFTNKBN
               END-EVALUATE
           END-IF
           PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                     UNTIL    KOHFTN-IDX     >    4
             EVALUATE  RECE62-TEISYOTOKU2(KOHFTN-IDX)
               WHEN    "1"
                 MOVE   "3"  TO   RECE62-SHOKUJIFTNKBN2(KOHFTN-IDX)
               WHEN    "2"
                 MOVE   "1"  TO   RECE62-SHOKUJIFTNKBN2(KOHFTN-IDX)
             END-EVALUATE
           END-PERFORM
      *
      *    食事請求額等の置き換え
           PERFORM  210453-SEIKYUGAK-SKJ-HEN-SEC
      *
      *    ０７９＋０１２に関わる保険組み合わせチェック
           IF   (RECE62-SRYYM   >=  "200804")
           AND  (RECE62-HKNNUM   =   SPACE  )
             IF  ((RECE62-KOHNUM(1) = "079" OR "024"         ) AND
                  (RECE62-KOHNUM(2) = "012"                  ) AND
                  (RECE62-KOHNUM(3) = SPACE                  ) AND
                  (RECE62-KOHNUM(4) = SPACE                  ))
             OR  ((RECE62-KOHNUM(1) = "024"                  ) AND
                  (RECE62-KOHNUM(2) = "028" OR "093" OR "094") AND
                  (RECE62-KOHNUM(3) = "012"                  ) AND
                  (RECE62-KOHNUM(4) = SPACE                  ))
             OR  ((RECE62-KOHNUM(1) = "024"                  ) AND
                  (RECE62-KOHNUM(2) = "028" OR "093" OR "094") AND
                  (RECE62-KOHNUM(3) = "028" OR "093" OR "094") AND
                  (RECE62-KOHNUM(4) = "012"                  ))
             OR  ((RECE62-KOHNUM(1) = "028" OR "093" OR "094") AND
                  (RECE62-KOHNUM(2) = "079"                  ) AND
                  (RECE62-KOHNUM(3) = "012"                  ) AND
                  (RECE62-KOHNUM(4) = SPACE                  ))
             OR  ((RECE62-KOHNUM(1) = "028" OR "093" OR "094") AND
                  (RECE62-KOHNUM(2) = "028" OR "093" OR "094") AND
                  (RECE62-KOHNUM(3) = "079"                  ) AND
                  (RECE62-KOHNUM(4) = "012"                  ))
               PERFORM    210455-SYOGAISEIHO-CHK-SEC
             END-IF
           END-IF
      *
           IF   ( RECE62-SHOKUJIRYOYOHI(1) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(2) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(3) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(4) = ZERO )
           AND  ( RECE62-SHOKUJIRYOYOHI(5) = ZERO )
              PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                          UNTIL    KOHFTN-IDX     >    4
                MOVE  SPACE  TO  RECE62-FUKUSHIFLG-SKJ(KOHFTN-IDX)
                MOVE  SPACE  TO  RECE62-FUKUSHIFLG-SKJIPA(KOHFTN-IDX)
                MOVE  SPACE  TO  RECE62-FUKUSHIFLG-SKJSEI(KOHFTN-IDX)
              END-PERFORM
           END-IF
      *
           IF  (RECE62-HKNNUM      NOT =   SPACE )
           AND (RECE62-GENMENKBN       =   2 OR 3)
      *
             PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                       UNTIL   KOHFTN-IDX    >   4
               IF  (RECE62-KOHNUM(KOHFTN-IDX)      NOT = SPACE)
               AND (WRK-GENMEN-ARI-KOH (KOHFTN-IDX)    = 1    )
               AND (WRK-GENMEN-NASI-KOH(KOHFTN-IDX)    = ZERO )
                 COMPUTE  KOHFTN-IDX3 = KOHFTN-IDX + 1
      *
                 MOVE   ZERO  TO  RECE62-TOTALTEN(KOHFTN-IDX3)
                 PERFORM  VARYING  KOHFTN-IDX2  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX2   >   30
                   MOVE ZERO  TO  RECE62-TENSU(KOHFTN-IDX2 KOHFTN-IDX3)
                 END-PERFORM
                 PERFORM  VARYING  KOHFTN-IDX2  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX2   >   20
                   MOVE ZERO  TO
                              RECE62-NYUKHNKEI(KOHFTN-IDX2 KOHFTN-IDX3)
                              RECE62-NYUTOKKEI(KOHFTN-IDX2 KOHFTN-IDX3)
                 END-PERFORM
                 MOVE   ZERO  TO  RECE62-NYUKHNKEI2(KOHFTN-IDX3)
                                  RECE62-NYUTOKKEI2(KOHFTN-IDX3)
               END-IF
             END-PERFORM
      *
             PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                       UNTIL  (KOHFTN-IDX                  >  10 )
                         OR   (RECE62-HKNCOMBI(KOHFTN-IDX) = ZERO)
               PERFORM  VARYING  KOHFTN-IDX2   FROM   1   BY   1
                         UNTIL   KOHFTN-IDX2     >    4
                 IF RECE62-KOHNUMHC(KOHFTN-IDX KOHFTN-IDX2) NOT = SPACE
                   PERFORM  VARYING  KOHFTN-IDX3   FROM   1   BY   1
                             UNTIL   KOHFTN-IDX3     >    4
                     IF  (RECE62-KOHNUM(KOHFTN-IDX3)      NOT = SPACE)
                     AND (WRK-GENMEN-ARI-KOH (KOHFTN-IDX3)    = 1    )
                     AND (WRK-GENMEN-NASI-KOH(KOHFTN-IDX3)    = ZERO )
                     AND (RECE62-KOHNUMHC(KOHFTN-IDX KOHFTN-IDX2)
                                        =  RECE62-KOHNUM(KOHFTN-IDX3))
                     AND (RECE62-KOHIDHC (KOHFTN-IDX KOHFTN-IDX2)
                                        =  RECE62-KOHID (KOHFTN-IDX3))
                       MOVE  1  TO
                               RECE62-FTNKBNFLG(KOHFTN-IDX KOHFTN-IDX2)
                     END-IF
                   END-PERFORM
                 END-IF
               END-PERFORM
             END-PERFORM
      *
           END-IF
      *
      *    食事回数がゼロで、食事療養費がゼロでない場合の対応
      *
           IF   RECE62-SRYYM   >=  "201404"
             IF  (RECE62-HKNNUM            NOT = SPACE)
             AND (RECE62-SHOKUJINISSU(1)       = ZERO )
             AND (RECE62-SHOKUJIRYOYOHI(1) NOT = ZERO )
      *          特別食加算のみかチェック
      *          （食事療養費を７６円で割ってチェック）
                 COMPUTE  WRK-KEISAN4 = RECE62-SHOKUJIRYOYOHI(1) / 76
                 COMPUTE  WRK-KEISAN5 = WRK-KEISAN4 * 76
                 IF RECE62-SHOKUJIRYOYOHI(1) = WRK-KEISAN5
                   MOVE  WRK-KEISAN4  TO  RECE62-SHOKUJINISSU(1)
                 END-IF
             END-IF
      *
             PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                       UNTIL   KOHFTN-IDX    >   4
               IF  (RECE62-KOHNUM(KOHFTN-IDX)              NOT = SPACE)
               AND (RECE62-SHOKUJINISSU(KOHFTN-IDX + 1)        = ZERO )
               AND (RECE62-SHOKUJIRYOYOHI(KOHFTN-IDX + 1)  NOT = ZERO )
      *          特別食加算のみかチェック
      *          （食事療養費を７６円で割ってチェック）
                 COMPUTE  WRK-KEISAN4 =
                          RECE62-SHOKUJIRYOYOHI(KOHFTN-IDX + 1) / 76
                 COMPUTE  WRK-KEISAN5 = WRK-KEISAN4 * 76
                 IF RECE62-SHOKUJIRYOYOHI(KOHFTN-IDX + 1) = WRK-KEISAN5
                   MOVE  WRK-KEISAN4  TO
                                RECE62-SHOKUJINISSU(KOHFTN-IDX + 1)
                 END-IF
               END-IF
             END-PERFORM
      *
      *      レセプト記載外公費用一部負担金編集
             PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                       UNTIL   KOHFTN-IDX    >   4
               IF  (RECE62-ETC-KOHNUM(KOHFTN-IDX)         NOT = SPACE)
               AND (RECE62-ETC-SHOKUJINISSU(KOHFTN-IDX)       = ZERO )
               AND (RECE62-ETC-SHOKUJIRYOYOHI(KOHFTN-IDX) NOT = ZERO )
      *          特別食加算のみかチェック
      *          （食事療養費を７６円で割ってチェック）
                 COMPUTE  WRK-KEISAN4 =
                          RECE62-ETC-SHOKUJIRYOYOHI(KOHFTN-IDX) / 76
                 COMPUTE  WRK-KEISAN5 = WRK-KEISAN4 * 76
                 IF RECE62-ETC-SHOKUJIRYOYOHI(KOHFTN-IDX) = WRK-KEISAN5
                   MOVE  WRK-KEISAN4  TO
                                RECE62-ETC-SHOKUJINISSU(KOHFTN-IDX)
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
           .
       21045-KOH-FUTAN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費負担（金額）取込み処理
      *****************************************************************
       210451-KOHFTN-KINGAKU-SEC               SECTION.
      *
           MOVE      ZERO             TO  WRK-NYUJGNGAK
      *
      *    公費月上限額取得
           INITIALIZE                     LNK-ORCSJGNGET-REC
           MOVE   RECE62-HOSPNUM      TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE62-NYUGAIKBN    TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE62-PTID         TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE62-KOHNUM(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE62-KOHID(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SRYYM
           MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
           MOVE   "31"                TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
           IF     RECE62-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
              MOVE   WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-SETKBN
              MOVE   WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-SETKBN2
           END-IF
      *
           CALL    "ORCSJGNGET"       USING
                                      LNK-ORCSJGNGET-REC
                                      SPA-AREA
      *
           IF     LNK-ORCSJGNGET-RC   =   ZERO
             MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                      TO  WRK-NYUJGNGAK
           END-IF
      *
           .
       210451-KOHFTN-KINGAKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事請求額等の置き換え
      *****************************************************************
       210453-SEIKYUGAK-SKJ-HEN-SEC               SECTION.
      *
           IF  ( RECE62-HKNNUM       NOT = SPACE    )
           AND ( RECE62-KOHNUM(1)(1:1)   =  "0"     )
           AND ( RECE62-KOHNUM(2)(1:1)
                                   >= "1" AND <= "8")
           AND ( RECE62-EKF-KOH2SKJKBN(3)     =  "1")
           AND ( RECE62-SHOKUJIRYOYOHI(1) NOT =  ZERO           )
           AND ( RECE62-SHOKUJIRYOYOHI(2) NOT =  ZERO           )
           AND ((RECE62-SHOKUJINISSU(1)
                                 NOT = RECE62-SHOKUJINISSU(2)  ) OR
                (RECE62-SHOKUJIRYOYOHI(1)
                                 NOT = RECE62-SHOKUJIRYOYOHI(2)) OR
                (RECE62-SHOKUJIFTN(1)
                                 NOT = RECE62-SHOKUJIFTN(2)    ))
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(3)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(3)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(3)    ))
              COMPUTE  RECE62-SHOKUJINISSU(3) =
                       RECE62-SHOKUJINISSU(1) -
                       RECE62-SHOKUJINISSU(2)
              COMPUTE  RECE62-SHOKUJIRYOYOHI(3) =
                       RECE62-SHOKUJIRYOYOHI(1) -
                       RECE62-SHOKUJIRYOYOHI(2)
              COMPUTE  RECE62-SHOKUJIFTN(3) =
                       RECE62-SHOKUJIFTN(1) -
                       RECE62-SHOKUJIFTN(2)
              IF   RECE62-FUKUSHIFLG-SKJ(2)    = SPACE
              AND  RECE62-FUKUSHIFLG-SKJIPA(2) = SPACE
              AND  RECE62-FUKUSHIFLG-SKJSEI(2) = SPACE
                MOVE     "3"     TO   RECE62-FUKUSHIFLG-SKJIPA(2)
                MOVE     "3"     TO   RECE62-FUKUSHIFLG-SKJSEI(2)
                MOVE      2      TO   KOHFTN-IDX4
                PERFORM  2104531-SEIKYUGAK-SKJ-HEN2-SEC
              END-IF
           END-IF
      *
           IF  ( RECE62-HKNNUM       NOT = SPACE    )
           AND ( RECE62-KOHNUM(1)(1:1)   =  "0"     )
           AND ( RECE62-KOHNUM(2)(1:1)
                                   >= "1" AND <= "8")
           AND ( RECE62-EKF-KOH2SKJKBN(3)     =  "1")
           AND ( RECE62-SHOKUJIRYOYOHI(1) NOT =  ZERO           )
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(2)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(2)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(2)    ))
           AND ((RECE62-SHOKUJINISSU(1)
                                     = RECE62-SHOKUJINISSU(3)  ) AND
                (RECE62-SHOKUJIRYOYOHI(1)
                                     = RECE62-SHOKUJIRYOYOHI(3)) AND
                (RECE62-SHOKUJIFTN(1)
                                     = RECE62-SHOKUJIFTN(3)    ))
              MOVE     ZERO    TO   RECE62-SHOKUJINISSU(3)
              MOVE     ZERO    TO   RECE62-SHOKUJIRYOYOHI(3)
              MOVE     ZERO    TO   RECE62-SHOKUJIFTN(3)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJ(2)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJIPA(2)
              MOVE     "1"     TO   RECE62-FUKUSHIFLG-SKJSEI(2)
           END-IF
      *
           .
       210453-SEIKYUGAK-SKJ-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事請求額等の置き換え
      *****************************************************************
       2104531-SEIKYUGAK-SKJ-HEN2-SEC               SECTION.
      *
           PERFORM VARYING KOHFTN-IDX FROM  1  BY 1
                    UNTIL  KOHFTN-IDX  >   10
                     OR    RECE62-HKNCOMBI(KOHFTN-IDX) = ZERO
             MOVE    ZERO    TO   FLG-SKJ-HANTEI1
             MOVE    ZERO    TO   FLG-SKJ-HANTEI2
             MOVE    ZERO    TO   KOHFTN-IDX3
             PERFORM  VARYING  KOHFTN-IDX2  FROM  1  BY  1
                       UNTIL   KOHFTN-IDX2   >    4
               IF  (RECE62-KOHNUM(1) =
                           RECE62-KOHNUMHC(KOHFTN-IDX KOHFTN-IDX2))
               AND (RECE62-KOHID (1) =
                           RECE62-KOHIDHC (KOHFTN-IDX KOHFTN-IDX2))
                 MOVE    1             TO   FLG-SKJ-HANTEI1
               END-IF
               IF  (RECE62-KOHNUM(KOHFTN-IDX4) =
                           RECE62-KOHNUMHC(KOHFTN-IDX KOHFTN-IDX2))
               AND (RECE62-KOHID (KOHFTN-IDX4) =
                           RECE62-KOHIDHC (KOHFTN-IDX KOHFTN-IDX2))
                 MOVE    1             TO   FLG-SKJ-HANTEI2
                 MOVE    KOHFTN-IDX2   TO   KOHFTN-IDX3
               END-IF
             END-PERFORM
             IF   FLG-SKJ-HANTEI1  =  1
             AND  FLG-SKJ-HANTEI2  =  1
                 MOVE    1    TO
                           RECE62-FTNKBNFLG-SKJ(KOHFTN-IDX KOHFTN-IDX3)
             END-IF
           END-PERFORM
      *
           .
       2104531-SEIKYUGAK-SKJ-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ０７９＋０１２に関わる保険組み合わせチェック
      *****************************************************************
       210455-SYOGAISEIHO-CHK-SEC               SECTION.
      *
           MOVE    ZERO    TO   FLG-SYOGAISEIHO
           MOVE    ZERO    TO   FLG-SYOGAISEIHO2
           MOVE    ZERO    TO   FLG-SYOGAISEIHO3
           MOVE    ZERO    TO   FLG-SYOGAISEIHO4
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                       UNTIL   (KOHFTN-IDX                  >  10 )
                        OR     (RECE62-HKNCOMBI(KOHFTN-IDX) = ZERO)
              IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  = "079" OR "024")
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  = "012"         )
                MOVE    1    TO   FLG-SYOGAISEIHO
              END-IF
              IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  = "012"         )
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  =  SPACE        )
                MOVE    1    TO   FLG-SYOGAISEIHO2
              END-IF
              IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  = "079" OR "024")
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  =  SPACE        )
                MOVE    1    TO   FLG-SYOGAISEIHO3
              END-IF
              IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  =
                                           "028" OR "093" OR "094")
              AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  =  SPACE        )
                MOVE    1    TO   FLG-SYOGAISEIHO4
              END-IF
           END-PERFORM
      *
           IF   (FLG-SYOGAISEIHO  =  1  )
           AND  (FLG-SYOGAISEIHO2 =  1  )
           AND  (FLG-SYOGAISEIHO3 = ZERO)
           AND  (FLG-SYOGAISEIHO4 = ZERO)
               COMPUTE  RECE62-TOTALTEN(3) = RECE62-TOTALTEN(3)
                                           - RECE62-TOTALTEN(2)
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   30
                 COMPUTE  RECE62-TENSU(KOHFTN-IDX 3) =
                          RECE62-TENSU(KOHFTN-IDX 3) -
                          RECE62-TENSU(KOHFTN-IDX 2)
               END-PERFORM
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   20
                 COMPUTE  RECE62-NYUKHNKEI(KOHFTN-IDX 3) =
                          RECE62-NYUKHNKEI(KOHFTN-IDX 3) -
                          RECE62-NYUKHNKEI(KOHFTN-IDX 2)
                 COMPUTE  RECE62-NYUTOKKEI(KOHFTN-IDX 3) =
                          RECE62-NYUTOKKEI(KOHFTN-IDX 3) -
                          RECE62-NYUTOKKEI(KOHFTN-IDX 2)
               END-PERFORM
               COMPUTE    RECE62-NYUKHNKEI2(3) =
                          RECE62-NYUKHNKEI2(3) -
                          RECE62-NYUKHNKEI2(2)
               COMPUTE    RECE62-NYUTOKKEI2(3) =
                          RECE62-NYUTOKKEI2(3) -
                          RECE62-NYUTOKKEI2(2)
      *
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL   (KOHFTN-IDX                  >  10 )
                            OR     (RECE62-HKNCOMBI(KOHFTN-IDX) = ZERO)
                 IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
                 AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  = "079" OR "024")
                 AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  = "012"         )
                    MOVE   1    TO    RECE62-FTNKBNFLG(KOHFTN-IDX 2)
                 END-IF
               END-PERFORM
           END-IF
      *
           IF  ((FLG-SYOGAISEIHO  =  1  ) AND
                (FLG-SYOGAISEIHO2 = ZERO) AND
                (FLG-SYOGAISEIHO3 = ZERO) AND
                (FLG-SYOGAISEIHO4 = ZERO))
           OR  ((FLG-SYOGAISEIHO  =  1  ) AND
                (FLG-SYOGAISEIHO2 = ZERO) AND
                (FLG-SYOGAISEIHO3 =  1  ) AND
                (FLG-SYOGAISEIHO4 = ZERO))
               MOVE     ZERO    TO    RECE62-TOTALTEN(3)
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   30
                 MOVE   ZERO    TO    RECE62-TENSU(KOHFTN-IDX 3)
               END-PERFORM
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   20
                 MOVE   ZERO    TO    RECE62-NYUKHNKEI(KOHFTN-IDX 3)
                                      RECE62-NYUTOKKEI(KOHFTN-IDX 3)
               END-PERFORM
               MOVE     ZERO    TO    RECE62-NYUKHNKEI2(3)
                                      RECE62-NYUTOKKEI2(3)
      *
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL   (KOHFTN-IDX                  >  10 )
                            OR     (RECE62-HKNCOMBI(KOHFTN-IDX) = ZERO)
                 IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
                 AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  = "079" OR "024")
                 AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  = "012"         )
                    MOVE   1    TO    RECE62-FTNKBNFLG(KOHFTN-IDX 2)
                 END-IF
               END-PERFORM
           END-IF
      *
           IF   (FLG-SYOGAISEIHO  =  1  )
           AND  (FLG-SYOGAISEIHO2 = ZERO)
           AND  (FLG-SYOGAISEIHO3 = ZERO)
           AND  (FLG-SYOGAISEIHO4 =  1  )
             IF    RECE62-KOHNUM(3) = "012"
               MOVE     ZERO    TO    RECE62-TOTALTEN(4)
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   30
                 MOVE   ZERO    TO    RECE62-TENSU(KOHFTN-IDX 4)
               END-PERFORM
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   20
                 MOVE   ZERO    TO    RECE62-NYUKHNKEI(KOHFTN-IDX 4)
                                      RECE62-NYUTOKKEI(KOHFTN-IDX 4)
               END-PERFORM
               MOVE     ZERO    TO    RECE62-NYUKHNKEI2(4)
                                      RECE62-NYUTOKKEI2(4)
             END-IF
      *
             IF    RECE62-KOHNUM(4) = "012"
               MOVE     ZERO    TO    RECE62-TOTALTEN(5)
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   30
                 MOVE   ZERO    TO    RECE62-TENSU(KOHFTN-IDX 5)
               END-PERFORM
               PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                           UNTIL    KOHFTN-IDX     >   20
                 MOVE   ZERO    TO    RECE62-NYUKHNKEI(KOHFTN-IDX 5)
                                      RECE62-NYUTOKKEI(KOHFTN-IDX 5)
               END-PERFORM
               MOVE     ZERO    TO    RECE62-NYUKHNKEI2(5)
                                      RECE62-NYUTOKKEI2(5)
             END-IF
      *
             PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                         UNTIL   (KOHFTN-IDX                  >  10 )
                          OR     (RECE62-HKNCOMBI(KOHFTN-IDX) = ZERO)
               IF  (RECE62-HKNNUMHC(KOHFTN-IDX)    =  SPACE        )
               AND (RECE62-KOHNUMHC(KOHFTN-IDX 1)  = "079" OR "024")
               AND (RECE62-KOHNUMHC(KOHFTN-IDX 2)  = "012"         )
                  MOVE   1    TO    RECE62-FTNKBNFLG(KOHFTN-IDX 2)
               END-IF
             END-PERFORM
           END-IF
      *
           IF  (RECE62-HKNNUM          =  SPACE         )
           AND (RECE62-KOHNUM(1)       =  "079" OR "024")
           AND (RECE62-KOHNUM(2)       =  "012"         )
           AND (RECE62-KOHNUM(3)       =  SPACE         )
           AND (RECE62-KOHNUM(4)       =  SPACE         )
           AND (RECE62-SRYYM          >=  "200804"      )
      *
               IF   FLG-SKJ-CHECK   =   1
                 MOVE     "3"     TO   RECE62-FUKUSHIFLG-SKJIPA(2)
                 MOVE     "3"     TO   RECE62-FUKUSHIFLG-SKJSEI(2)
                 MOVE      2      TO   KOHFTN-IDX4
                 PERFORM  2104531-SEIKYUGAK-SKJ-HEN2-SEC
               END-IF
      *
           END-IF
      *
           .
       210455-SYOGAISEIHO-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    一部負担金再掲の計算処理
      *****************************************************************
       21046-SAIKEI-KEISAN-SEC               SECTION.
      *
           IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
           AND  (RECE62-KOHNUM(1)(1:1)    = "0"                )
           AND  (RECE62-KOHNUM(1)     NOT = "012" AND "025"    )
           AND  (RECE62-TOTALTEN(1)       =  RECE62-TOTALTEN(2))
           AND  (FLG-ZENKOKUKOHI-NISYU-SC =  1                 )
           AND  (RECE62-SRYYM            >= "201204"           )
             IF  FLG-ZENKI-TOKUREI = 1
               MOVE    20              TO   WRK-KYURATE3
             ELSE
               MOVE    RECE62-KYURATE  TO   WRK-KYURATE3
             END-IF
             COMPUTE   WRK-KEISAN10  =  RECE62-TOTALTEN(1)
                                     *  10
                                     *  WRK-KYURATE3
                                     /  100
             IF  FLG-TOKU75 = 1 OR 2 OR 3
               IF   5000   <  WRK-KEISAN10
                    MOVE     26     TO   FLG-TOKKI
                    PERFORM  21013-TOKKI-HENSYU-SEC
               END-IF
             ELSE
               IF   10000  <  WRK-KEISAN10
                    MOVE     26      TO   FLG-TOKKI
                    PERFORM  21013-TOKKI-HENSYU-SEC
               END-IF
             END-IF
           END-IF
      *
      *    請求点数から第三者行為の点数を差し引く
      *
           MOVE     RECE62-TOTALTEN(1)   TO   WRK-TAIHI-TOTALTEN
           IF   (RECE62-DAISAN-GAITO    =   1 OR 2)
           AND  (RECE62-DAISAN-GENBUTU-GAITO  =  1)
             CONTINUE
           ELSE
             COMPUTE  WRK-TAIHI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                         - RECE62-DAISAN-TOTALTEN
           END-IF
      *
           MOVE      ZERO             TO  FLG-CYOKI-MIXPAT
      *
           MOVE      ZERO             TO  FLG-TUUKA
                                          FLG-TUUKA2
      *
           MOVE      ZERO             TO  FLG-KEISAN-TOK1BAC
                                          FLG-KEISAN-TOK2BAC
           IF   FLG-ZENKOKUKOHI-NISYU2  =  1
              MOVE   FLG-KEISAN-TOK1  TO  FLG-KEISAN-TOK1BAC
              MOVE   FLG-KEISAN-TOK2  TO  FLG-KEISAN-TOK2BAC
              MOVE   ZERO             TO  FLG-KEISAN-TOK1
                                          FLG-KEISAN-TOK2
           END-IF
      *
           IF   FLG-KEISAN-TOK1  =  1
           AND  FLG-KEISAN-TOK2  =  1
              IF     FTN-KOH-XXX    >  WRK-CHK-ICHIBUGAKU
                COMPUTE  WRK-KINGAKU-TOK9 = FTN-KOH-XXX
                                          - WRK-CHK-ICHIBUGAKU
              ELSE
                MOVE      ZERO     TO  WRK-KINGAKU-TOK9
              END-IF
      *
              COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                        + WRK-KINGAKU-TOK1
              IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK7
                 MOVE  WRK-KINGAKU-TOK7  TO  FTN-KOH-XXX
                 IF    WRK-KINGAKU-TOK7  >   WRK-CHK-ICHIBUGAKU
                   COMPUTE  WRK-KINGAKU-TOK4 = WRK-KINGAKU-TOK7
                                             - WRK-CHK-ICHIBUGAKU
                 ELSE
                   MOVE   ZERO     TO  WRK-KINGAKU-TOK4
                 END-IF
              ELSE
                 MOVE  WRK-KINGAKU-TOK3  TO  FTN-KOH-XXX
                 MOVE  WRK-KINGAKU-TOK1  TO  WRK-KINGAKU-TOK4
                 IF    FLG-ZENKI-TOKUREI  =   1
                    COMPUTE  WRK-KINGAKU-TOK1X =
                             WRK-KINGAKU-TOK1X +  5
                    COMPUTE  WRK-KINGAKU-TOK1X =
                             WRK-KINGAKU-TOK1X / 10
                    COMPUTE  WRK-KINGAKU-TOK1X =
                             WRK-KINGAKU-TOK1X * 10
                    MOVE  WRK-KINGAKU-TOK1X
                                         TO  WRK-KINGAKU-TOK4
                 END-IF
              END-IF
      *
              IF  FLG-CYOKI-HENSYU  =  1
                 ADD   WRK-SYUNOU-CYOKI-FTNMONEY
                                         TO  WRK-KOH-GAI
              ELSE
               IF  WRK-KINGAKU-TOK9  >  WRK-KINGAKU-TOK4
                 COMPUTE    WRK-KINGAKU-TOK5 = WRK-KINGAKU-TOK9
                                             - WRK-KINGAKU-TOK4
                 ADD   WRK-KINGAKU-TOK5  TO  WRK-KOH-GAI
               END-IF
              END-IF
           END-IF
      *
      *    主＋地＋長、主＋長
           IF   (FLG-KEISAN-TOK1           =  ZERO)
           AND  (FLG-KEISAN-TOK2           =  1   )
           AND  (FLG-XX8-TUUKA             =  ZERO)
           AND  (FLG-XX2-TUUKA             =  ZERO)
           AND  (FLG-XX4-TUUKA             =  ZERO)
           AND  (FLG-XX7-TUUKA         NOT =  ZERO)
           AND  (FLG-XX7A-TUUKA        NOT =  ZERO)
           AND  (FLG-ZENKOKUKOHI-NISYU NOT =  4   )
              COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                        + FTN-KOH-XX7
              IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK8
                 MOVE  WRK-KINGAKU-TOK8  TO  FTN-KOH-XXX
              ELSE
                 MOVE  WRK-KINGAKU-TOK3  TO  FTN-KOH-XXX
              END-IF
           END-IF
      *    主＋地ａ、主＋地ｂ＋長
           IF   (FLG-KEISAN-TOK1           =  ZERO)
           AND  (FLG-KEISAN-TOK2           =  1   )
           AND  (FLG-XX8-TUUKA             =  ZERO)
           AND  (FLG-XX2-TUUKA             =  ZERO)
           AND  (FLG-XX4-TUUKA         NOT =  ZERO)
           AND  (FLG-XX7-TUUKA         NOT =  ZERO)
           AND  (FLG-XX7A-TUUKA            =  ZERO)
           AND  (FLG-ZENKOKUKOHI-NISYU     =  4   )
                 MOVE  FTN-KOH-XX4       TO  FTN-KOH-XXX
           END-IF
      *    主＋全、主＋地＋長
      *    主＋全、主＋長
      *    主＋全、主＋地＋長、主＋長
           IF   (FLG-KEISAN-TOK1           =  ZERO)
           AND  (FLG-KEISAN-TOK2           =  1   )
           AND  (FLG-XX8-TUUKA         NOT =  ZERO)
           AND  (FLG-XX2-TUUKA             =  ZERO)
           AND  (FLG-XX4-TUUKA             =  ZERO)
           AND  (FLG-ZENKOKUKOHI-NISYU NOT =  4   )
              MOVE      1          TO   FLG-CYOKI-MIXPAT
              MOVE      1          TO   FLG-TUUKA
              MOVE      5          TO   FLG-JYOGENKBN2
              MOVE    FTN-KOH-XX8  TO   FTN-KOH-XXX
              MOVE    WRK-KOH-GAI-GEN70-TEN8
                                   TO   WRK-KOH-GAI-GEN70-TEN1
              MOVE    WRK-CYOKI-JGNGAK
                                   TO   WRK-KINGAKU-GENBUTU4
              MOVE    WRK-KOH-GAI-GEN70-TEN9
                                   TO   WRK-KOH-GAI-GEN70-TEN3
           END-IF
      *
           IF    FLG-ZENKOKUKOHI-NISYU2  =  1
      *      全国公費が２つ以上あり、全国公費併用分のいずれかに
      *      長期が含まれているパターン（チェック金額・点数等の編集）
             IF    (FLG-XX5-TUUKA   NOT =  ZERO)
             OR    (FLG-XX6-TUUKA   NOT =  ZERO)
             OR    (FLG-XX11-TUUKA  NOT =  ZERO)
               MOVE     1     TO    FLG-CYOKI-MIXPAT
               PERFORM  21046C-CYOKI-MIXPAT-HEN-SEC
             ELSE
      *        全国公費が２つあり、全国公費併用分に長期が
      *        含まれていないパターン（チェック金額・点数等の編集）
               IF  (FLG-KEISAN-TOK1BAC      =  ZERO   )
               AND (FLG-KEISAN-TOK2BAC  NOT =  ZERO   )
               AND (FLG-XX8-TUUKA       NOT =  ZERO   )
               AND (FLG-XX3-TUUKA       NOT =  ZERO   )
               AND (FLG-XX10-TUUKA          =  ZERO   )
               AND (RECE62-SRYYM           >= "202301")
                 MOVE      1          TO   FLG-CYOKI-MIXPAT
                 MOVE      1          TO   FLG-TUUKA2
                 MOVE      5          TO   FLG-JYOGENKBN2
                 MOVE    FTN-KOH-XX8  TO   FTN-KOH-XXX
                 MOVE    WRK-KOH-GAI-GEN70-TEN8
                                      TO   WRK-KOH-GAI-GEN70-TEN1
                 MOVE    WRK-CYOKI-JGNGAK
                                      TO   WRK-KINGAKU-GENBUTU10
                 MOVE    WRK-KOH-GAI-GEN70-TEN9
                                      TO   WRK-KOH-GAI-GEN70-TEN10
               END-IF
             END-IF
           END-IF
      *
      *    請求額情報編集用
           IF  (IDZ             =     1    )
           AND (RECE62-SRYYM   >=  "201004")
             IF   FLG-KOHSKY-ARI     =   1
               PERFORM  21046G-KOHSKYDATA-HENSYU-SEC
             END-IF
      *
             MOVE   RECE62-FTNMONEY(1)  TO   RECE62-FTNMONEY-SKY
      *
             IF   FLG-WRKFILE-CLEAR  =   1
               MOVE   FTN-KOH-XXX       TO   WRK-JIRITU-SAIKEI
               MOVE   FTN-KOH-XX3       TO   WRK-JIRITU-SAIKEI2
               MOVE   ZERO              TO   RECE62-FTNMONEY(1)
               MOVE   ZERO              TO   FLG-KEISAN-TOK1
               MOVE   ZERO              TO   FLG-KEISAN-TOK2
               MOVE   ZERO              TO   FTN-KOH-XXX
               MOVE   ZERO              TO   FTN-KOH-XX2
               MOVE   ZERO              TO   FTN-KOH-XX3
               MOVE   ZERO              TO   FTN-KOH-XX4
               MOVE   ZERO              TO   FTN-KOH-XX5
               MOVE   ZERO              TO   FTN-KOH-XX6
               MOVE   ZERO              TO   FTN-KOH-XX7
               MOVE   ZERO              TO   FTN-KOH-XX7X
               MOVE   ZERO              TO   FTN-KOH-XX8
               MOVE   ZERO              TO   FTN-KOH-XX10
               MOVE   ZERO              TO   FTN-KOH-XX11
               MOVE   ZERO              TO   FTN-KOH-XX12
             END-IF
           END-IF
      *
           COMPUTE  WRK-KOH-GAI-GEN70-KIN  = WRK-KOH-GAI-GEN70-TEN
                                           * 10
                                           * RECE62-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN1 = WRK-KOH-GAI-GEN70-TEN1
                                           * 10
                                           * RECE62-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN2 = WRK-KOH-GAI-GEN70-TEN2
                                           * 10
                                           * RECE62-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN3 = WRK-KOH-GAI-GEN70-TEN3
                                           * 10
                                           * RECE62-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN4 = WRK-KOH-GAI-GEN70-TEN4
                                           * 10
                                           * RECE62-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN10
                                           = WRK-KOH-GAI-GEN70-TEN10
                                           * 10
                                           * RECE62-KYURATE
                                           / 100
      *
           COMPUTE  WRK-KOH-GAI-GEN70-KIN5 = WRK-KOH-GAI-GEN70-KIN1
                                           + WRK-CHK-ICHIBUGAKU2
      *
           MOVE    ZERO   TO   WRK-KEISAN-YYY
           MOVE    ZERO   TO   WRK-MADOGUCHIKBN
           MOVE    SPACE  TO   WRK-MADOGUCHI-KOUREI
           MOVE    ZERO   TO   FLG-KINGAKU-GENBUTU3X
      *
      *    レセプトの公費チェック
           MOVE    ZERO   TO   WRK-RECE-KOHI-CHECK1
           MOVE    ZERO   TO   WRK-RECE-KOHI-CHECK1X
           MOVE    ZERO   TO   WRK-RECE-KOHI-CHECK2
           MOVE    ZERO   TO   WRK-RECE-KOHI-CHECK2X
           MOVE    ZERO   TO   WRK-RECE-KOHI-CHKKIN
           MOVE    ZERO   TO   WRK-RECE-KOHI-FLG
           MOVE    ZERO   TO   WRK-RECE-KOHI-FTNMONEY2
           MOVE    ZERO   TO   WRK-RECE-KOHI-FTNMONEY3
           MOVE    ZERO   TO   WRK-RECE-KOHI-FTNMONEY4
           IF  RECE62-HKNCOMBI(2) NOT = ZERO
             PERFORM  21046K-RECE-KOHI-CHECK-SEC
           END-IF
      *
           IF      RECE62-KOUREI  =  "2"
      *
               IF    ( FLG-JYOGENKBN2    =   5 )
               AND   ( FLG-KOHYONKAIME   =   1 )
                  PERFORM   210461-KOHIHEIYO-KEISAN-SEC
               END-IF
      *
               IF      FLG-JYOGENKBN   =   1
                MOVE  WRK-JYOGENKBN-TEN  TO  WRK-HANTEI-TOTALTEN
      ***       IF   FLG-ZEROKOGAITO   =   1
      ***         PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
      ***       ELSE
                  PERFORM  210464-JYOGENGAKU-HENSYU-SEC
      ***       END-IF
               END-IF
      *
               MOVE    9999999    TO   WRK-CHK-KINGAKU
               MOVE    9999999    TO   WRK-CHK-KINGAKU2
               MOVE    9999999    TO   WRK-CHK-KINGAKU3
               MOVE    9999999    TO   WRK-CHK-KINGAKU10
               EVALUATE  FLG-JYOGENKBN  ALSO  FLG-JYOGENKBN2
                 WHEN       1           ALSO     ZERO
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                 WHEN       ANY         ALSO     1
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
      ****         IF  FLG-KOHYONKAIME = 1
      ****          IF  FLG-TOKU75 = 3
      ****           MOVE  12300                TO  WRK-CHK-KINGAKU2
      ****          ELSE
      ****           MOVE  24600                TO  WRK-CHK-KINGAKU2
      ****          END-IF
      ****         ELSE
                    IF  FLG-TOKU75 = 3
                     MOVE  17700                TO  WRK-CHK-KINGAKU2
                    ELSE
                     MOVE  35400                TO  WRK-CHK-KINGAKU2
                    END-IF
      ****         END-IF
                 WHEN       ZERO        ALSO     2
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       2           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     3
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       2           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       ZERO        ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                   MOVE    WRK-KINGAKU-GENBUTU10
                                                TO  WRK-CHK-KINGAKU10
                 WHEN       1           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                   MOVE    WRK-KINGAKU-GENBUTU10
                                                TO  WRK-CHK-KINGAKU10
                 WHEN       2           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                   MOVE    WRK-KINGAKU-GENBUTU10
                                                TO  WRK-CHK-KINGAKU10
               END-EVALUATE
               IF    (FLG-XX3-TUUKA   NOT =  ZERO)
               OR    (FLG-XX6-TUUKA   NOT =  ZERO)
               OR    (FLG-TUUKA       NOT =  ZERO)
                   CONTINUE
               ELSE
                   MOVE    9999999              TO  WRK-CHK-KINGAKU3
               END-IF
               IF    (FLG-XX10-TUUKA  NOT =  ZERO)
               OR    (FLG-XX11-TUUKA  NOT =  ZERO)
               OR    (FLG-TUUKA2      NOT =  ZERO)
                   CONTINUE
               ELSE
                   MOVE    9999999              TO  WRK-CHK-KINGAKU10
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                 MOVE   WRK-CHK-KINGAKU   TO   WRK-CHK-KEIKASOCHI1
                 IF  ( FLG-JYOGENKBN             =  1       )
                 AND ( FLG-GENBUTU-TAISYOOK      =  ZERO    )
                     MOVE   9999999  TO   WRK-CHK-KEIKASOCHI1
                 END-IF
                 IF    WRK-KOH-GAI-GEN70-KIN > WRK-CHK-KEIKASOCHI1
                    IF  FLG-KINGAKU-GENBUTU3  =  1
                      MOVE   2       TO   WRK-MADOGUCHIKBN
                    END-IF
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                IF   FLG-KEISAN-TOK1  =  1
                AND  FLG-KEISAN-TOK2  =  1
                 IF  WRK-KOH-GAI-GEN70-KIN1 > WRK-CHK-KINGAKU2
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                ELSE
                 IF  (WRK-KOH-GAI-GEN70-KIN1  >  WRK-CHK-KINGAKU2 )
                 OR  (WRK-KOH-GAI-GEN70-KIN3  >  WRK-CHK-KINGAKU3 )
                 OR  (WRK-KOH-GAI-GEN70-KIN10 >  WRK-CHK-KINGAKU10)
                 OR  (WRK-KOH-GAI-GEN70-KIN5  >  WRK-CHK-KINGAKU2 )
                    IF ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                        (FLG-KINGAKU-GENBUTU   =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                        (FLG-KINGAKU-GENBUTU2  =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                        (FLG-KINGAKU-GENBUTU5  =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                        (FLG-KINGAKU-GENBUTU4  =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN10
                                               >  WRK-CHK-KINGAKU10) AND
                        (FLG-KINGAKU-GENBUTU10 =  1                ))
                      MOVE   2       TO   WRK-MADOGUCHIKBN
                    END-IF
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                IF   FLG-JYOGENKBN  =  1
                  MOVE  WRK-CHK-KINGAKU  TO  WRK-CHK-KEIKASOCHI1
                  IF    FLG-GENBUTU-TAISYOOK  =  ZERO
                    MOVE   9999999       TO  WRK-CHK-KEIKASOCHI1
                  END-IF
                  IF    WRK-KOH-GAI-GEN70-KIN > WRK-CHK-KEIKASOCHI1
                    MOVE   ZERO          TO  WRK-CHK-KEIKASOCHI1
                  ELSE
                    MOVE   WRK-KINGAKU3  TO  WRK-CHK-KEIKASOCHI1
                  END-IF
                  COMPUTE  WRK-CHK-KEIKASOCHIXX  =  WRK-KOH-GAI-GEN70
                                                 +  WRK-KOH-FTN-GEN70
                  IF   WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1
                    IF  FLG-KINGAKU-GENBUTU3  =  1
                      MOVE    1          TO  FLG-KINGAKU-GENBUTU3X
                    END-IF
                  END-IF
                  IF   (FLG-JYOGENKBN2 = 5 )
                  AND  (FLG-JYOGENKBN3 = 1 )
                    MOVE   WRK-KINGAKU-GENBUTU
                                         TO  WRK-CHK-KINGAKU
                  END-IF
                ELSE
                  MOVE     9999999       TO  WRK-CHK-KEIKASOCHI1
                END-IF
                IF   WRK-JYOGENKBN-TEN5  NOT = ZERO
                  COMPUTE WRK-JYOGENKBN-TEN9 = WRK-JYOGENKBN-TEN4
                                             + WRK-JYOGENKBN-TEN5
                  COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                      * 10
                                      * RECE62-KYURATE
                                      / 100
                  IF    WRK-FTNKEI6        >=  21000
                    COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN4
                                                + WRK-JYOGENKBN-TEN5
                                                + WRK-JYOGENKBN-TEN2
                    PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                    IF  WRK-JYOGENKBN-TEN2  NOT = ZERO
                      IF  WRK-RECE-KOHI-CHECK1X =  1
                         IF WRK-KINGAKU-GENBUTU3 > WRK-RECE-KOHI-CHKKIN
                           COMPUTE  WRK-CHK-KOKIGAK9      =
                                    WRK-KINGAKU-GENBUTU3  -
                                    WRK-RECE-KOHI-CHKKIN
                         ELSE
                           MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                         END-IF
                         IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                           MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                           IF  FLG-KINGAKU-GENBUTU3  =  1
                             MOVE    1   TO   FLG-KINGAKU-GENBUTU3X
                           END-IF
                         END-IF
                      END-IF
                    ELSE
                      IF   WRK-KINGAKU-GENBUTU3 <  WRK-FTNKEI6
                           MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                           IF  FLG-KINGAKU-GENBUTU3  =  1
                             MOVE    1   TO   FLG-KINGAKU-GENBUTU3X
                           END-IF
                      END-IF
                    END-IF
                  END-IF
                END-IF
      *
                IF   (WRK-RECE-KOHI-CHECK2X  =  1  )
                AND  (WRK-JYOGENKBN-TEN2 NOT = ZERO)
                AND  (WRK-JYOGENKBN-TEN7 NOT = ZERO)
                AND  (FLG-HOKENICHIBU-SYU    = ZERO)
                AND  (FLG-ZENKOKUKOHI-NISYU4 =  1  )
                   COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN7
                                       * 10
                                       * RECE62-KYURATE
                                       / 100
                   IF    WRK-FTNKEI6     >=  21000
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN7
                                                 + WRK-JYOGENKBN-TEN2
                     PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                     IF WRK-KINGAKU-GENBUTU3 > WRK-RECE-KOHI-CHKKIN
                       COMPUTE  WRK-CHK-KOKIGAK9      =
                                WRK-KINGAKU-GENBUTU3  -
                                WRK-RECE-KOHI-CHKKIN
                     ELSE
                       MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                     END-IF
                     IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                       MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                       IF  FLG-KINGAKU-GENBUTU3  =  1
                         MOVE    1   TO   FLG-KINGAKU-GENBUTU3X
                       END-IF
                     END-IF
                   END-IF
                END-IF
      *
                IF   FLG-KEISAN-TOK1  =  1
                AND  FLG-KEISAN-TOK2  =  1
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2   )
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                ELSE
                 IF  (WRK-CHK-KEIKASOCHIXX   >=  WRK-CHK-KEIKASOCHI1)
                 OR  (WRK-KOH-GAI-GEN70-KIN1  >  WRK-CHK-KINGAKU2   )
                 OR  (WRK-KOH-GAI-GEN70-KIN3  >  WRK-CHK-KINGAKU3   )
                 OR  (WRK-KOH-GAI-GEN70-KIN10 >  WRK-CHK-KINGAKU10  )
                 OR  (WRK-KOH-GAI-GEN70-KIN2  >  WRK-CHK-KINGAKU    )
                 OR  (WRK-KOH-GAI-GEN70-KIN4  >  WRK-CHK-KINGAKU    )
                    IF ((WRK-CHK-KEIKASOCHIXX
                                           >=  WRK-CHK-KEIKASOCHI1 ) AND
                        (FLG-KINGAKU-GENBUTU3X =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                        (FLG-KINGAKU-GENBUTU   =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                        (FLG-KINGAKU-GENBUTU2  =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                        (FLG-KINGAKU-GENBUTU5  =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                        (FLG-KINGAKU-GENBUTU4  =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN10
                                               >  WRK-CHK-KINGAKU10) AND
                        (FLG-KINGAKU-GENBUTU10 =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN2
                                               >  WRK-CHK-KINGAKU  ) AND
                        (FLG-KINGAKU-GENBUTU   =  1                ))
                    OR ((WRK-KOH-GAI-GEN70-KIN4
                                               >  WRK-CHK-KINGAKU  ) AND
                        (FLG-KINGAKU-GENBUTU   =  1                ))
                      MOVE   2       TO   WRK-MADOGUCHIKBN
                    END-IF
                 ELSE
                    MOVE    "3"      TO   RECE62-KOUREI
                 END-IF
                END-IF
               END-IF
      *
      *        生保の公費給付対象額編集
               IF   (RECE62-SRYYM             >=  "202304")
               AND  (FLG-ZENKOKUKOHI-NISYU     =   5      )
                    PERFORM  21046J-SEIHO-KINGAKU-HENSYU-SEC
               END-IF
      *
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                    MOVE    "3"      TO   RECE62-KOUREI
               END-IF
      *
      ***      IF  (WRK-KEISAN-YYY    NOT =  ZERO)
      ***      AND (RECE62-KOUREI         =  "3" )
      ***           MOVE    "2"      TO   RECE62-KOUREI
      ***      END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-GENBUTU-HANTEI2   =   1  )
               AND (RECE62-KOUREI         =  "3" )
                    MOVE    "2"      TO   RECE62-KOUREI
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (RECE62-RECEIPT-KBN(4:1)
                                          =  "2" )
               AND (RECE62-KOUREI         =  "3" )
                    MOVE    "2"      TO   RECE62-KOUREI
               END-IF
      *
               IF   (WRK-PREFNUM       =  19     )
               AND  (RECE62-SRYYM     <= "201203")
                IF ( RECE62-KOHHBTNUM(1) =  "41"        )
                OR ((RECE62-KOHNUM(1)  = "051" OR "091") AND
                    (RECE62-KOHHBTNUM(2) =  "41"       ) AND
                    (RECE62-SRYYM       >=  "200804"   ))
                    MOVE    "3"      TO   RECE62-KOUREI
                END-IF
               END-IF
               IF   (WRK-PREFNUM       =  34     )
               AND  (RECE62-SRYYM     <= "201208")
                IF   RECE62-TEISYUTUSAKI   =   2
                  IF  (RECE62-KOHHBTNUM(1) =  "90" OR "91" OR "92")
                  OR  (RECE62-KOHHBTNUM(2) =  "90" OR "91" OR "92")
                  OR  (RECE62-KOHHBTNUM(3) =  "90" OR "91" OR "92")
                  OR  (RECE62-KOHHBTNUM(4) =  "90" OR "91" OR "92")
                    MOVE    "3"      TO   RECE62-KOUREI
                  END-IF
                END-IF
               END-IF
      *
               IF  (RECE62-EKF-KSINGKBN-Y(2) = "1")
               OR  (RECE62-EKF-KSINGKBN-Y(3) = "1")
               OR  (RECE62-EKF-KSINGKBN-Y(4) = "1")
               OR  (RECE62-EKF-KSINGKBN-Y(5) = "1")
                    MOVE    "3"      TO   RECE62-KOUREI
               END-IF
      *
               IF   WK-GENGAKUKBN    =   3 OR 4
                    MOVE    "3"      TO   RECE62-KOUREI
               END-IF
      *
               EVALUATE  WRK-TAIHI-OKIKAE
                 WHEN        1
                     IF  RECE62-KOUREI   = "2"
                       CONTINUE
                     ELSE
                       MOVE   "2"      TO   RECE62-KOUREI
                       MOVE    2       TO   RECE62-ICBKINKSI-ARI
                     END-IF
                 WHEN        2
                     IF  RECE62-KOUREI   = "3"
                       CONTINUE
                     ELSE
                       MOVE   "3"      TO   RECE62-KOUREI
                       MOVE    2       TO   RECE62-ICBKINKSI-NASI
                     END-IF
               END-EVALUATE
      *
               IF      RECE62-KOUREI  =  "3"
                 MOVE     ZERO    TO    RECE62-FTNMONEY(1)
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                  IF     TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  NOT =  1
                   IF  ( RECE62-KOHNUM(KOHFTN-IDX) =
                              "015" OR "016" OR "051" OR "021" OR
                              "024" OR "079" OR "052" OR "011" OR
                              "025" OR "038" OR "012" OR "020" OR
                              "028" OR "029"                       )
                   OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "054"       ) AND
                        (RECE62-SRYYM             >=  "201501"    ))
                   OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "092"       ) AND
                        (RECE62-SRYYM             >=  "201812"    ))
                   OR  ( RECE62-KOHNUM(KOHFTN-IDX) =  "095"        )
                   OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "096"       ) AND
                        (RECE62-SRYYM             >=  "202310"    ))
                   OR  ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =  1 )
                   OR  ( RECE62-EKF-ENCHGKBN-Y(KOHFTN-IDX + 1)
                                                    = "2" OR "3"   )
                   OR  ( TBL-TOKATUKAIFLG(KOHFTN-IDX)   =  1       )
                      MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                                TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                      MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                                TO  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                   END-IF
                   IF    RECE62-KOHNUM(KOHFTN-IDX) = "010"
                      MOVE  ZERO    TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                   END-IF
                  END-IF
                 END-PERFORM
               END-IF
      *
               IF  RECE62-KOUREI   =  "2"
                 IF  WRK-MADOGUCHIKBN  =  2
                   MOVE   "02"   TO    RECE62-MADOGUCHIKBN
                 ELSE
                   MOVE   "01"   TO    RECE62-MADOGUCHIKBN
                 END-IF
               END-IF
      *
           END-IF
      *
           IF     (RECE62-SRYYM   >=  "202109")
           AND    (RECE62-KOUREI   =  "1"     )
      *
               MOVE    "1"    TO    WRK-MADOGUCHI-KOUREI
      *
               IF      FLG-JYOGENKBN   =   1
                MOVE  WRK-JYOGENKBN-TEN  TO  WRK-HANTEI-TOTALTEN
      ***       IF   FLG-ZEROKOGAITO   =   1
      ***         PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
      ***       ELSE
                  PERFORM  210464-JYOGENGAKU-HENSYU-SEC
      ***       END-IF
               END-IF
      *
               MOVE    9999999    TO   WRK-CHK-KINGAKU
               MOVE    9999999    TO   WRK-CHK-KINGAKU2
               MOVE    9999999    TO   WRK-CHK-KINGAKU3
               MOVE    9999999    TO   WRK-CHK-KINGAKU10
               EVALUATE  FLG-JYOGENKBN  ALSO  FLG-JYOGENKBN2
                 WHEN       1           ALSO     ZERO
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                 WHEN       ANY         ALSO     1
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                      MOVE      7500      TO   WRK-CHK-KINGAKU2
                   ELSE
                      MOVE      15000     TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     3
                   IF  FLG-TOKU75 = 1 OR 2
                       MOVE     5000      TO   WRK-CHK-KINGAKU2
                   ELSE
                       MOVE     10000     TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                       MOVE     5000      TO   WRK-CHK-KINGAKU2
                   ELSE
                       MOVE     10000     TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       2           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                       MOVE     5000      TO   WRK-CHK-KINGAKU2
                   ELSE
                       MOVE     10000     TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       ZERO        ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                   MOVE    WRK-KINGAKU-GENBUTU10
                                                TO  WRK-CHK-KINGAKU10
                 WHEN       1           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                   MOVE    WRK-KINGAKU-GENBUTU10
                                                TO  WRK-CHK-KINGAKU10
                 WHEN       2           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                   MOVE    WRK-KINGAKU-GENBUTU10
                                                TO  WRK-CHK-KINGAKU10
               END-EVALUATE
               IF    (FLG-XX3-TUUKA   NOT =  ZERO)
               OR    (FLG-XX6-TUUKA   NOT =  ZERO)
               OR    (FLG-TUUKA       NOT =  ZERO)
                   CONTINUE
               ELSE
                   MOVE    9999999              TO  WRK-CHK-KINGAKU3
               END-IF
               IF    (FLG-XX10-TUUKA  NOT =  ZERO)
               OR    (FLG-XX11-TUUKA  NOT =  ZERO)
               OR    (FLG-TUUKA2      NOT =  ZERO)
                   CONTINUE
               ELSE
                   MOVE    9999999              TO  WRK-CHK-KINGAKU10
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                   MOVE   WRK-CHK-KINGAKU   TO   WRK-CHK-KEIKASOCHI1
                   IF     WRK-KOH-GAI-GEN70-KIN > WRK-CHK-KEIKASOCHI1
                        IF  FLG-KINGAKU-GENBUTU3  =  1
                          MOVE   2       TO   WRK-MADOGUCHIKBN
                        END-IF
                   ELSE
                        MOVE    "4"      TO   WRK-MADOGUCHI-KOUREI
                   END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                   IF   FLG-KEISAN-TOK1  =  1
                   AND  FLG-KEISAN-TOK2  =  1
                     IF WRK-KOH-GAI-GEN70-KIN1 > WRK-CHK-KINGAKU2
                        CONTINUE
                     ELSE
                        MOVE    "4"      TO   WRK-MADOGUCHI-KOUREI
                     END-IF
                   ELSE
                     IF  (WRK-KOH-GAI-GEN70-KIN1  >  WRK-CHK-KINGAKU2 )
                     OR  (WRK-KOH-GAI-GEN70-KIN3  >  WRK-CHK-KINGAKU3 )
                     OR  (WRK-KOH-GAI-GEN70-KIN10 >  WRK-CHK-KINGAKU10)
                     OR  (WRK-KOH-GAI-GEN70-KIN5  >  WRK-CHK-KINGAKU2 )
                        IF ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                            (FLG-KINGAKU-GENBUTU   =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                            (FLG-KINGAKU-GENBUTU2  =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                            (FLG-KINGAKU-GENBUTU5  =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                            (FLG-KINGAKU-GENBUTU4  =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN10
                                               >  WRK-CHK-KINGAKU10) AND
                            (FLG-KINGAKU-GENBUTU10 =  1            ))
                          MOVE   2       TO   WRK-MADOGUCHIKBN
                        END-IF
                     ELSE
                        MOVE    "4"      TO   WRK-MADOGUCHI-KOUREI
                     END-IF
                   END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                   IF   FLG-JYOGENKBN  =  1
                     MOVE  WRK-CHK-KINGAKU  TO  WRK-CHK-KEIKASOCHI1
                     IF    WRK-KOH-GAI-GEN70-KIN > WRK-CHK-KEIKASOCHI1
                       MOVE   ZERO          TO  WRK-CHK-KEIKASOCHI1
                     ELSE
                       MOVE   WRK-KINGAKU3  TO  WRK-CHK-KEIKASOCHI1
                     END-IF
                     COMPUTE  WRK-CHK-KEIKASOCHIXX  =  WRK-KOH-GAI-GEN70
                                                    +  WRK-KOH-FTN-GEN70
                     IF   WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1
                       IF  FLG-KINGAKU-GENBUTU3  =  1
                         MOVE    1          TO  FLG-KINGAKU-GENBUTU3X
                       END-IF
                     END-IF
                     IF   (FLG-JYOGENKBN2 = 5 )
                     AND  (FLG-JYOGENKBN3 = 1 )
                       MOVE   WRK-KINGAKU-GENBUTU
                                            TO  WRK-CHK-KINGAKU
                     END-IF
                   ELSE
                       MOVE   9999999       TO  WRK-CHK-KEIKASOCHI1
                   END-IF
      *
                   IF   WRK-JYOGENKBN-TEN5  NOT = ZERO
                     COMPUTE WRK-JYOGENKBN-TEN9 = WRK-JYOGENKBN-TEN4
                                                + WRK-JYOGENKBN-TEN5
                     COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                         * 10
                                         * RECE62-KYURATE
                                         / 100
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN4
                                                 + WRK-JYOGENKBN-TEN5
      ***                                        + WRK-JYOGENKBN-TEN2
                     PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                     IF  WRK-JYOGENKBN-TEN2  NOT = ZERO
                      IF  WRK-RECE-KOHI-CHECK1X =  1
                        IF WRK-KINGAKU-GENBUTU3 > WRK-RECE-KOHI-CHKKIN
                          COMPUTE  WRK-CHK-KOKIGAK9      =
                                   WRK-KINGAKU-GENBUTU3  -
                                   WRK-RECE-KOHI-CHKKIN
                        ELSE
                          MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                        END-IF
                        IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                          MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                          IF  FLG-KINGAKU-GENBUTU3  =  1
                            MOVE    1   TO   FLG-KINGAKU-GENBUTU3X
                          END-IF
                        END-IF
                      END-IF
                     ELSE
                      IF  WRK-KINGAKU-GENBUTU3 <  WRK-FTNKEI6
                          MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                          IF  FLG-KINGAKU-GENBUTU3  =  1
                            MOVE    1   TO   FLG-KINGAKU-GENBUTU3X
                          END-IF
                      END-IF
                     END-IF
                   END-IF
      *
                   IF   (WRK-RECE-KOHI-CHECK2X  =  1  )
                   AND  (WRK-JYOGENKBN-TEN2 NOT = ZERO)
                   AND  (WRK-JYOGENKBN-TEN7 NOT = ZERO)
                   AND  (FLG-HOKENICHIBU-SYU    = ZERO)
                   AND  (FLG-ZENKOKUKOHI-NISYU4 =  1  )
                      COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN7
                                          * 10
                                          * RECE62-KYURATE
                                          / 100
                      COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN7
      ***                                         + WRK-JYOGENKBN-TEN2
                      PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                      IF WRK-KINGAKU-GENBUTU3 > WRK-RECE-KOHI-CHKKIN
                        COMPUTE  WRK-CHK-KOKIGAK9      =
                                 WRK-KINGAKU-GENBUTU3  -
                                 WRK-RECE-KOHI-CHKKIN
                      ELSE
                        MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                      END-IF
                      IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                        MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                        IF  FLG-KINGAKU-GENBUTU3  =  1
                          MOVE    1   TO   FLG-KINGAKU-GENBUTU3X
                        END-IF
                      END-IF
                   END-IF
      *
                   IF   FLG-KEISAN-TOK1  =  1
                   AND  FLG-KEISAN-TOK2  =  1
                     IF (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                     OR (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2   )
                        CONTINUE
                     ELSE
                        MOVE    "4"      TO   WRK-MADOGUCHI-KOUREI
                     END-IF
                   ELSE
                     IF (WRK-CHK-KEIKASOCHIXX   >=  WRK-CHK-KEIKASOCHI1)
                     OR (WRK-KOH-GAI-GEN70-KIN1  >  WRK-CHK-KINGAKU2   )
                     OR (WRK-KOH-GAI-GEN70-KIN3  >  WRK-CHK-KINGAKU3   )
                     OR (WRK-KOH-GAI-GEN70-KIN10 >  WRK-CHK-KINGAKU10  )
                     OR (WRK-KOH-GAI-GEN70-KIN2  >  WRK-CHK-KINGAKU    )
                     OR (WRK-KOH-GAI-GEN70-KIN4  >  WRK-CHK-KINGAKU    )
                        IF ((WRK-CHK-KEIKASOCHIXX
                                           >=  WRK-CHK-KEIKASOCHI1 ) AND
                            (FLG-KINGAKU-GENBUTU3X =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                            (FLG-KINGAKU-GENBUTU   =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN1
                                               >  WRK-CHK-KINGAKU2 ) AND
                            (FLG-KINGAKU-GENBUTU2  =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                            (FLG-KINGAKU-GENBUTU5  =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN3
                                               >  WRK-CHK-KINGAKU3 ) AND
                            (FLG-KINGAKU-GENBUTU4  =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN10
                                               >  WRK-CHK-KINGAKU10) AND
                            (FLG-KINGAKU-GENBUTU10 =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN2
                                               >  WRK-CHK-KINGAKU  ) AND
                            (FLG-KINGAKU-GENBUTU   =  1            ))
                        OR ((WRK-KOH-GAI-GEN70-KIN4
                                               >  WRK-CHK-KINGAKU  ) AND
                            (FLG-KINGAKU-GENBUTU   =  1            ))
                          MOVE   2       TO   WRK-MADOGUCHIKBN
                        END-IF
                     ELSE
                        MOVE    "4"      TO   WRK-MADOGUCHI-KOUREI
                     END-IF
                   END-IF
               END-IF
      *
      *        生保の公費給付対象額編集
               IF   (RECE62-SRYYM             >=  "202304")
               AND  (FLG-ZENKOKUKOHI-NISYU     =   5      )
                    PERFORM  21046J-SEIHO-KINGAKU-HENSYU-SEC
               END-IF
      *
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                    MOVE    "4"      TO   WRK-MADOGUCHI-KOUREI
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-GENBUTU-HANTEI2   =   1  )
               AND (WRK-MADOGUCHI-KOUREI  =  "4" )
                    MOVE    "1"      TO   WRK-MADOGUCHI-KOUREI
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (RECE62-RECEIPT-KBN(4:1)
                                          =  "2" )
               AND (WRK-MADOGUCHI-KOUREI  =  "4" )
                    MOVE    "1"      TO   WRK-MADOGUCHI-KOUREI
               END-IF
      *
           END-IF
      *
           IF      RECE62-KOUREI  =  "1"
      *
               IF  (RECE62-EKF-KSINGKBN-K(2) = "1")
               OR  (RECE62-EKF-KSINGKBN-K(3) = "1")
               OR  (RECE62-EKF-KSINGKBN-K(4) = "1")
               OR  (RECE62-EKF-KSINGKBN-K(5) = "1")
                    MOVE    "4"      TO   RECE62-KOUREI
                                          WRK-MADOGUCHI-KOUREI
               END-IF
      *
               IF   WK-GENGAKUKBN    =   3 OR 4
                    MOVE    "4"      TO   RECE62-KOUREI
                                          WRK-MADOGUCHI-KOUREI
               END-IF
               IF   WK-GENGAKUKBN    =   1 OR 2 OR 5
                    MOVE    "1"      TO   RECE62-KOUREI
                                          WRK-MADOGUCHI-KOUREI
               END-IF
      *
               EVALUATE  WRK-TAIHI-OKIKAE
                 WHEN        1
                     IF  RECE62-KOUREI   = "1"
                       CONTINUE
                     ELSE
                       MOVE   "1"      TO   RECE62-KOUREI
                                            WRK-MADOGUCHI-KOUREI
                       MOVE    2       TO   RECE62-ICBKINKSI-ARI
                     END-IF
                 WHEN        2
                     IF  RECE62-KOUREI   = "4"
                       CONTINUE
                     ELSE
                       MOVE   "4"      TO   RECE62-KOUREI
                                            WRK-MADOGUCHI-KOUREI
                       MOVE    2       TO   RECE62-ICBKINKSI-NASI
                     END-IF
               END-EVALUATE
      *
               IF      RECE62-KOUREI  =  "4"
                 MOVE     ZERO    TO    RECE62-FTNMONEY(1)
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                  IF     TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  NOT =  1
                   IF  ( RECE62-KOHNUM(KOHFTN-IDX) =
                              "015" OR "016" OR "051" OR "021" OR
                              "024" OR "079" OR "052" OR "011" OR
                              "025" OR "038" OR "012" OR "020" OR
                              "028" OR "029"                       )
                   OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "054"       ) AND
                        (RECE62-SRYYM             >=  "201501"    ))
                   OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "092"       ) AND
                        (RECE62-SRYYM             >=  "201812"    ))
                   OR  ( RECE62-KOHNUM(KOHFTN-IDX) =  "095"        )
                   OR  ((RECE62-KOHNUM(KOHFTN-IDX) =  "096"       ) AND
                        (RECE62-SRYYM             >=  "202310"    ))
                   OR  ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =  1 )
                   OR  ( RECE62-EKF-ENCHGKBN-K(KOHFTN-IDX + 1)
                                                    = "2" OR "3"   )
                   OR  ( TBL-TOKATUKAIFLG(KOHFTN-IDX)   =  1       )
                      MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                                TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                      MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                                TO  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                   END-IF
                   IF    RECE62-KOHNUM(KOHFTN-IDX) = "010"
                      MOVE  ZERO    TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                   END-IF
                  END-IF
                 END-PERFORM
               END-IF
      *
               IF  WRK-MADOGUCHI-KOUREI   =  "1"
                 IF  WRK-MADOGUCHIKBN  =  2
                   MOVE   "02"   TO    RECE62-MADOGUCHIKBN
                 ELSE
                   MOVE   "01"   TO    RECE62-MADOGUCHIKBN
                 END-IF
               END-IF
      *
           END-IF
      *
           IF      RECE62-DAISAN-KOUREI   =   1
      *
               EVALUATE  WRK-TAIHI-OKIKAE
                 WHEN        2
                       MOVE    2       TO   RECE62-ICBKINKSI-NASI
               END-EVALUATE
      *
           END-IF
      *
           PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                     UNTIL    KOHFTN-IDX     >    4
             IF ((RECE62-EKF-ENCHGKBN-K(KOHFTN-IDX + 1) = "3") AND
                 (RECE62-KOUREI                         = "1") AND
                 (FLG-KOUGAKU                           =  1 ))
             OR ((RECE62-EKF-ENCHGKBN-Y(KOHFTN-IDX + 1) = "3") AND
                 (RECE62-KOUREI                         = "2") AND
                 (FLG-KOUGAKU                           =  1 ))
      *
               MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                         TO  RECE62-FTNMONEY(KOHFTN-IDX + 1)
               MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                         TO  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
      *
             END-IF
           END-PERFORM
      *
      ************
      *
           IF   FTN-KOH-XXX    >    WRK-CHK-ICHIBUGAKU
                COMPUTE  FTN-KOH-XXX = FTN-KOH-XXX - WRK-CHK-ICHIBUGAKU
           ELSE
                MOVE     ZERO    TO    FTN-KOH-XXX
           END-IF
      *
           IF   RECE62-KOUREI          =  "2"
             IF   WRK-KEISAN-YYY    NOT =  ZERO
               IF   WRK-KEISAN-YYY   <   RECE62-FTNMONEY(1)
                  COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
                                              -  WRK-KEISAN-YYY
               ELSE
                  MOVE     ZERO    TO    RECE62-FTNMONEY(1)
               END-IF
               IF   WRK-KEISAN-YYY   <   FTN-KOH-XXX
                  COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
                                              -  WRK-KEISAN-YYY
               ELSE
                  MOVE     ZERO    TO    FTN-KOH-XXX
               END-IF
             END-IF
           END-IF
      *
           PERFORM  21046A-CHIHO-ICHIBUFTN-HEN-SEC
      *
           MOVE    999999999   TO   WRK-FTNMONEY-MAE
           PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                     UNTIL   KOHFTN-IDX   >    4
      *          ７０歳代前半軽減特例措置対応
                IF  ((FLG-ZENKI-TOKUREI          =   1  ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "051"))
                OR  ((FLG-ZENKI-TOKUREI          =   1  ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "038"))
                OR  ((FLG-ZENKI-TOKUREI          =   1  ) AND
                     (WRK-PREFNUM                = "13" ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "151"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (WRK-PREFNUM                = "23"    ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "191"   ) AND
                     (RECE62-SRYYM              >= "200910") AND
                     (RECE62-SRYYM              <= "201108"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (WRK-PREFNUM                = "23"    ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "191"   ) AND
                     (RECE62-TEISYUTUSAKI        =   1     ) AND
                     (RECE62-SRYYM              >= "201109") AND
                     (RECE62-SRYYM              <= "201509"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "054"   ) AND
                     (RECE62-SRYYM              >= "201501"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (RECE62-KOHNUM(KOHFTN-IDX)  = "092"   ) AND
                     (RECE62-SRYYM              >= "201812"))
                OR  ((FLG-ZENKI-TOKUREI          =   1     ) AND
                     (WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
                                                 =   1     ))
                   IF   KOHFTN-IDX =  1
                     MOVE  RECE62-FTNMONEY(2)  TO  WRK-FTNMONEY-MAE
                   END-IF
                   PERFORM  210463-ZENKI-TOKUREI-OKIKAE-SEC
                ELSE
                   IF   RECE62-KOUREI   =  "1" OR "2"
                     IF  (RECE62-KOHNUM(KOHFTN-IDX) = "024" OR "079")
                     AND (TBL-HKNFTNDATA-FLG(KOHFTN-IDX)   =  1     )
                     AND (SYS-200501-GENBUTU-ICHIBU-KSIKBN = "1"    )
                       COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1) =
                               RECE62-FTNMONEY(KOHFTN-IDX + 1) +  5
                       COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1) =
                               RECE62-FTNMONEY(KOHFTN-IDX + 1) / 10
                       COMPUTE RECE62-FTNMONEY(KOHFTN-IDX + 1) =
                               RECE62-FTNMONEY(KOHFTN-IDX + 1) * 10
                       PERFORM  21046A-CHIHO-ICHIBUFTN-HEN-SEC
                     END-IF
                   ELSE
                     IF   TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  =  1
      ***              IF   TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
      ***                            = RECE62-FTNMONEY(KOHFTN-IDX + 1)
      ***                CONTINUE
      ***              ELSE
                         PERFORM  210465-KOH-ICHIBUFTN-HENSYU-SEC
                         PERFORM  21046A-CHIHO-ICHIBUFTN-HEN-SEC
      ***              END-IF
                     END-IF
                   END-IF
                END-IF
           END-PERFORM
      *
      *    減免公費対応
      *    ※入院補助公費・治療薬補助公費の減免計算はどのような対応を
      *      すべきか不明
           IF  (WK-GENGAKUKBN    NOT =   ZERO )
           AND (WK-GENGAKUKBN    NOT = 3 AND 4)
             IF  (RECE62-SRYYM        >= "200709")
             AND (RECE62-HKNNUM    NOT =  SPACE  )
               IF ( RECE62-KOHNUM(1) =
                    "010" OR "012" OR "015" OR "016" OR "021" OR
                    "024" OR "051" OR "052" OR "079" OR "025" OR
                    "038" OR "011" OR "020" OR "028" OR "029"     )
               OR ((RECE62-KOHNUM(1) = "054"                     ) AND
                   (RECE62-SRYYM    >= "201501"                  ))
               OR ((RECE62-KOHNUM(1) = "092"                     ) AND
                   (RECE62-SRYYM    >= "201812"                  ))
               OR ( TBL-TOKATUKAIFLG(1)   =  1                    )
                 IF  RECE62-KOHNUM(1)    = "010"
                   IF   RECE62-KOUREI    = "1" OR "2"
                      PERFORM  210462-GENGAKU-OKIKAE-SEC
                   END-IF
                 ELSE
                   IF  ( WRK-PREFNUM       =  "01"         )
                   AND ( RECE62-KOHNUM(1)  =  "051"        )
                   AND ((RECE62-KOHJKYSNUM(1)(1:2) >= "91"
                                               AND <= "95") OR
                        (RECE62-KOHJKYSNUM(1)(1:2) >= "71"
                                               AND <= "88"))
                   AND ( RECE62-SRYYM      <  "200810"     )
                      CONTINUE
                   ELSE
                      PERFORM  210462-GENGAKU-OKIKAE-SEC
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      ***
           MOVE     ZERO     TO    FLG-SAIKEI-KISAI
           EVALUATE   WRK-PREFNUM
             WHEN       "01"
               IF  (RECE62-SRYYM   >=  "200510")
               AND (RECE62-SRYYM   <   "200810")
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                   IF  ( RECE62-KOHNUM(KOHFTN-IDX) =  "051"         )
                   AND ((RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                        AND <= "95") OR
                        (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "71"
                                                        AND <= "88"))
                       MOVE     1     TO    FLG-SAIKEI-KISAI
                   END-IF
                 END-PERFORM
               END-IF
           END-EVALUATE
           PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                     UNTIL   KOHFTN-IDX   >    4
             IF ((RECE62-EKF-KAKKBN-K(KOHFTN-IDX + 1) = "1") AND
                 (RECE62-KOUREI                       = "1"))
             OR ((RECE62-EKF-KAKKBN-Y(KOHFTN-IDX + 1) = "1") AND
                 (RECE62-KOUREI                       = "2"))
                       MOVE     1     TO    FLG-SAIKEI-KISAI
             END-IF
           END-PERFORM
      *
           IF   RECE62-KOUREI  =  SPACE  OR  "3"  OR  "4"
                  PERFORM  21046H-SAIKEI-CLEAR-SEC
                  MOVE     ZERO         TO  FLG-ZENKOKUKOHI-NISYU
                                            FLG-ZENKOKUKOHI-NISYU8
           ELSE
              IF    RECE62-KOHNUM(1)  =  SPACE
              AND   RECE62-KOHNUM(2)  =  SPACE
              AND   RECE62-KOHNUM(3)  =  SPACE
              AND   RECE62-KOHNUM(4)  =  SPACE
                  PERFORM  21046H-SAIKEI-CLEAR-SEC
                  MOVE     ZERO         TO  FLG-ZENKOKUKOHI-NISYU
                                            FLG-ZENKOKUKOHI-NISYU8
              ELSE
                  IF  FLG-KOH  =   2
                     ADD   WRK-KOH-GAI  TO  RECE62-FTNMONEY(2)
                                            RECE62-FTNMONEY-KOJ(2)
                  END-IF
                  MOVE     FTN-KOH-XXX  TO  RECE62-KOUREI-SAIKEI
      *
                  IF  RECE62-KOHNUM(1)   =  SPACE
                     MOVE  ZERO         TO  RECE62-KOUREI-SAIKEI
                  ELSE
                    IF (FLG-SAIKEI-KISAI   NOT = ZERO                 )
                    OR (FLG-ZENKOKUKOHI-NISYU  = 1 OR 2 OR 3 OR 4 OR 5)
                    OR (FLG-ZENKOKUKOHI-NISYU8 = 1                    )
                         CONTINUE
                    ELSE
                      IF  (RECE62-TOTALTEN(1) = RECE62-TOTALTEN(2) )
                      AND (FTN-KOH-XXX        = RECE62-FTNMONEY(1) )
                           MOVE  ZERO     TO  RECE62-KOUREI-SAIKEI
                      END-IF
      *
                      IF  (RECE62-KOHNUM(1)   NOT =  SPACE         )
                      AND (RECE62-TOTALTEN(2)     =  ZERO          )
                      AND (FTN-KOH-XXX        = RECE62-FTNMONEY(1) )
                           MOVE  ZERO    TO  RECE62-KOUREI-SAIKEI
                      END-IF
                    END-IF
                  END-IF
      *
                  IF   FLG-ZENKOKUKOHI-NISYU7 = ZERO
                    IF    FLG-XX3-TUUKA   NOT = ZERO
                      MOVE    FTN-KOH-XX3     TO RECE62-KOUREI-SAIKEI2
                      MOVE    1               TO RECE62-SAIKEIZEROKSI2
                      IF  (FLG-KOH           =   2   )
                      AND (RECE62-KOHNUM(2)  =  "010")
                      AND (FLG-CYOKI-MIXPAT  =   ZERO)
                        COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                                  - FTN-KOH-XX3
                        ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(3)
                                                 RECE62-FTNMONEY-KOJ(3)
                      END-IF
                    ELSE
                      IF  FLG-XX4-TUUKA   NOT = ZERO
                        MOVE  FTN-KOH-XX4     TO RECE62-KOUREI-SAIKEI2
                        MOVE  1               TO RECE62-SAIKEIZEROKSI2
                      END-IF
                    END-IF
                  ELSE
                    IF    FLG-XX3-TUUKA   NOT = ZERO
                      MOVE    FTN-KOH-XX3     TO RECE62-KOUREI-SAIKEI2
                      MOVE    1               TO RECE62-SAIKEIZEROKSI2
                      IF  (FLG-KOH           =   2   )
                      AND (RECE62-KOHNUM(2)  =  "010")
                      AND (FLG-CYOKI-MIXPAT  =   ZERO)
                        COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                                  - FTN-KOH-XX3
                        ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(3)
                                                 RECE62-FTNMONEY-KOJ(3)
                      END-IF
                    END-IF
                    IF    RECE62-SRYYM  >=  "202301"
                     EVALUATE  FLG-ZENKOKUKOHI-NISYU7
                      WHEN       1
                      WHEN       2
                      WHEN       4
                       IF   FLG-XX10-TUUKA  NOT = ZERO
                        MOVE   FTN-KOH-XX10    TO RECE62-KOUREI-SAIKEI3
                        MOVE   1               TO RECE62-SAIKEIZEROKSI3
                        IF  (FLG-KOH           =   2   )
                        AND (RECE62-KOHNUM(3)  =  "010")
                        AND (FLG-CYOKI-MIXPAT  =   ZERO)
                         COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                                   - FTN-KOH-XX10
                         ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(4)
                                                  RECE62-FTNMONEY-KOJ(4)
                        END-IF
                       END-IF
                     END-EVALUATE
                     EVALUATE  FLG-ZENKOKUKOHI-NISYU7
                      WHEN       2
                       IF   FLG-XX4-TUUKA   NOT = ZERO
                         MOVE  FTN-KOH-XX4     TO RECE62-KOUREI-SAIKEI4
                         MOVE  1               TO RECE62-SAIKEIZEROKSI4
                       END-IF
                      WHEN       3
                       IF   FLG-XX4-TUUKA   NOT = ZERO
                         MOVE  FTN-KOH-XX4     TO RECE62-KOUREI-SAIKEI3
                         MOVE  1               TO RECE62-SAIKEIZEROKSI3
                       END-IF
                     END-EVALUATE
                    END-IF
                  END-IF
      *
                  IF    FLG-ZENKOKUKOHI-NISYU2  =  1
      *             全国公費が２つ以上あり、全国公費併用分のいずれかに
      *             長期が含まれているパターン（再掲等の編集）
                    IF    (FLG-XX5-TUUKA   NOT =  ZERO)
                    OR    (FLG-XX6-TUUKA   NOT =  ZERO)
                    OR    (FLG-XX11-TUUKA  NOT =  ZERO)
                      PERFORM  21046H-SAIKEI-CLEAR-SEC
                      PERFORM  21046D-CYOKI-MIXPAT-HEN2-SEC
                      PERFORM  21046F-KANSEN-FTNMONEY-HEN-SEC
                    ELSE
      *               全国公費が２つあり、全国公費併用分に長期が
      *               含まれていないパターン（再掲等の編集）
                      IF  (FLG-KEISAN-TOK1BAC      =  ZERO   )
                      AND (FLG-KEISAN-TOK2BAC  NOT =  ZERO   )
                      AND (FLG-XX8-TUUKA       NOT =  ZERO   )
                      AND (FLG-XX3-TUUKA       NOT =  ZERO   )
                      AND (FLG-XX10-TUUKA          =  ZERO   )
                      AND (RECE62-SRYYM           >= "202301")
                        PERFORM  21046H-SAIKEI-CLEAR-SEC
                        PERFORM  21046E-CYOKI-MIXPAT-HEN3-SEC
                        PERFORM  21046F-KANSEN-FTNMONEY-HEN-SEC
                      END-IF
                    END-IF
                  END-IF
      *           主＋全、主＋地＋長
      *           主＋全、主＋長
      *           主＋全、主＋地＋長、主＋長
                  IF   (FLG-KEISAN-TOK1           =  ZERO)
                  AND  (FLG-KEISAN-TOK2           =  1   )
                  AND  (FLG-XX8-TUUKA         NOT =  ZERO)
                  AND  (FLG-XX2-TUUKA             =  ZERO)
                  AND  (FLG-XX4-TUUKA             =  ZERO)
                  AND  (FLG-ZENKOKUKOHI-NISYU NOT =  4   )
                    PERFORM  21046H-SAIKEI-CLEAR-SEC
                    COMPUTE  RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                                + FTN-KOH-XX8
                                                + FTN-KOH-XX7X
                    MOVE     FTN-KOH-XX8   TO  RECE62-KOUREI-SAIKEI
                    IF  (FLG-XX7-TUUKA      NOT = ZERO)
                    AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                      MOVE   FTN-KOH-XX7   TO  RECE62-KOUREI-SAIKEI2
                      MOVE   1             TO  RECE62-SAIKEIZEROKSI2
                    END-IF
                    PERFORM  21046F-KANSEN-FTNMONEY-HEN-SEC
                  END-IF
      *           主＋地ａ、主＋地ｂ＋長
                  IF   (FLG-KEISAN-TOK1           =  ZERO)
                  AND  (FLG-KEISAN-TOK2           =  1   )
                  AND  (FLG-XX8-TUUKA             =  ZERO)
                  AND  (FLG-XX2-TUUKA             =  ZERO)
                  AND  (FLG-XX4-TUUKA         NOT =  ZERO)
                  AND  (FLG-XX7-TUUKA         NOT =  ZERO)
                  AND  (FLG-XX7A-TUUKA            =  ZERO)
                  AND  (FLG-ZENKOKUKOHI-NISYU     =  4   )
                    PERFORM  21046H-SAIKEI-CLEAR-SEC
                    COMPUTE  RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                                + FTN-KOH-XX4
                                                + FTN-KOH-XX7
                    MOVE   FTN-KOH-XX4   TO  RECE62-KOUREI-SAIKEI
                    MOVE   FTN-KOH-XX7   TO  RECE62-KOUREI-SAIKEI2
                    MOVE   1             TO  RECE62-SAIKEIZEROKSI2
                    MOVE   ZERO          TO  FTN-KOH-XX4
                  END-IF
      *           主＋全＋地＋長、主＋地＋長
      *           主＋全＋長、主＋地＋長
      *           主＋地ａ＋長、主＋地ｂ＋長
                  IF   ( FLG-KEISAN-TOK1          =  1    )
                  AND  ( FLG-KEISAN-TOK2          =  1    )
                  AND  ( FLG-XX8-TUUKA            =  ZERO )
                  AND  ( FLG-XX2-TUUKA            =  ZERO )
                  AND  ( FLG-XX4-TUUKA            =  ZERO )
                  AND  ( FLG-XX7-TUUKA        NOT =  ZERO )
                  AND  ( FLG-XX7A-TUUKA           =  ZERO )
                  AND  ((FLG-ZENKOKUKOHI-NISYU3   =  1) OR
                        (FLG-ZENKOKUKOHI-NISYU    =  4)   )
                    COMPUTE WRK-CYOKI-KEISAN  = RECE62-FTNMONEY(1)
                                              - WRK-KOH-GAI2
                    COMPUTE WRK-CYOKI-KEISAN2 = FTN-KOH-XXX
                                              + FTN-KOH-XX7
                    COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                              - FTN-KOH-XXX
      *
                    IF   FLG-KOH  =   2
                     COMPUTE  WRK-CYOKI-KEISAN5 = RECE62-FTNMONEY(2)
                                                - WRK-KOH-GAI
                    ELSE
                     IF  WRK-FTNMONEY-MAE  NOT = 999999999
                       MOVE WRK-FTNMONEY-MAE   TO WRK-CYOKI-KEISAN5
                     ELSE
                       MOVE RECE62-FTNMONEY(2) TO WRK-CYOKI-KEISAN5
                       IF  (RECE62-KOUREI           = "2")
                       AND (WRK-KOGAKU-TAISYOGAI(1) =  1 )
                         MOVE  WRK-TAIHI-FTNMONEY2(2)
                                               TO WRK-CYOKI-KEISAN5
                       END-IF
                     END-IF
                    END-IF
      *
                    IF   WRK-CYOKI-JGNGAK  >  WRK-CYOKI-KEISAN5
                     COMPUTE  WRK-CYOKI-KEISAN6 = WRK-CYOKI-JGNGAK
                                                - WRK-CYOKI-KEISAN5
                    ELSE
                     MOVE     ZERO             TO WRK-CYOKI-KEISAN6
                    END-IF
      *
                    IF  FLG-ZENKOKUKOHI-NISYU  =   2 OR 4
                      MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI2
                      MOVE   1           TO  RECE62-SAIKEIZEROKSI2
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                      AND   WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7
                          IF   FLG-ZENKOKUKOHI-NISYU4  =  2 OR 3
                            IF  (FTN-KOH-XX7      > WRK-CYOKI-KEISAN6)
                            AND (FLG-ZENKOKUKOHI-NISYU4  =  2        )
                             MOVE WRK-CYOKI-KEISAN6
                                                TO  WRK-CYOKI-KEISAN7
                             MOVE WRK-CYOKI-KEISAN6
                                          TO   RECE62-KOUREI-SAIKEI2
                            ELSE
                             MOVE  FTN-KOH-XX7  TO  WRK-CYOKI-KEISAN7
                            END-IF
                            IF  WRK-CYOKI-KEISAN7 > WRK-CYOKI-KEISAN3
                             COMPUTE WRK-CYOKI-KEISAN4
                                                  = WRK-CYOKI-KEISAN7
                                                  - WRK-CYOKI-KEISAN3
                            ELSE
                             MOVE  ZERO         TO  WRK-CYOKI-KEISAN4
                            END-IF
                            ADD   WRK-CYOKI-KEISAN4
                                          TO   RECE62-FTNMONEY(1)
                            IF     FLG-KOH  =   2
                              ADD WRK-CYOKI-KEISAN4
                                          TO   RECE62-FTNMONEY(2)
                                               RECE62-FTNMONEY-KOJ(2)
                              ADD WRK-CYOKI-KEISAN4
                                          TO   WRK-KOH-GAI
                            END-IF
                          ELSE
                            MOVE  WRK-CYOKI-KEISAN3
                                          TO   RECE62-KOUREI-SAIKEI2
                          END-IF
                      END-IF
                    END-IF
      *
                    IF  FLG-ZENKOKUKOHI-NISYU  =   ZERO
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                      AND   WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7
                        IF   FLG-ZENKOKUKOHI-NISYU4  =  2 OR 3
                            IF  (FTN-KOH-XX7      > WRK-CYOKI-KEISAN6)
                            AND (FLG-ZENKOKUKOHI-NISYU4  =  2        )
                             MOVE WRK-CYOKI-KEISAN6
                                                TO  WRK-CYOKI-KEISAN7
                            ELSE
                             MOVE  FTN-KOH-XX7  TO  WRK-CYOKI-KEISAN7
                            END-IF
                            IF  WRK-CYOKI-KEISAN7 > WRK-CYOKI-KEISAN3
                             COMPUTE WRK-CYOKI-KEISAN4
                                                  = WRK-CYOKI-KEISAN7
                                                  - WRK-CYOKI-KEISAN3
                            ELSE
                             MOVE  ZERO         TO  WRK-CYOKI-KEISAN4
                            END-IF
                            ADD   WRK-CYOKI-KEISAN4
                                          TO   RECE62-FTNMONEY(1)
                            IF     FLG-KOH  =   2
                              ADD WRK-CYOKI-KEISAN4
                                          TO   RECE62-FTNMONEY(2)
                                               RECE62-FTNMONEY-KOJ(2)
                              ADD WRK-CYOKI-KEISAN4
                                          TO   WRK-KOH-GAI
                            END-IF
                        END-IF
                      END-IF
                    END-IF
                  END-IF
      *
                  IF   RECE62-CYOKI-KSIKBN  =  "1"
                  OR   FLG-CYOKI-HENSYU4    =   1
                     IF   (CNT-CYOKI-HENSYU1   =  1)
                     AND  (CNT-CYOKI-HENSYU2   =  1)
                       COMPUTE WRK-CYOKI-KEISAN  = RECE62-FTNMONEY(1)
                                                 - WRK-KOH-GAI2
                       COMPUTE WRK-CYOKI-KEISAN2 = RECE62-KOUREI-SAIKEI
                       IF   WRK-CYOKI-KEISAN   >   WRK-CYOKI-KEISAN2
                         COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                                   - WRK-CYOKI-KEISAN2
                       ELSE
                         MOVE    ZERO    TO    WRK-CYOKI-KEISAN3
                       END-IF
                     ELSE
                       IF   WRK-CYOKI-JGNGAK   >   WRK-CYOKI-KOH-FTN4
                         COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-JGNGAK
                                                   - WRK-CYOKI-KOH-FTN4
                       ELSE
                         MOVE    ZERO    TO    WRK-CYOKI-KEISAN3
                       END-IF
                     END-IF
                     IF   WRK-CYOKI-KOH-FTN  >   WRK-CYOKI-KOH-FTN2
                       COMPUTE   WRK-CYOKI-KOH-FTN = WRK-CYOKI-KOH-FTN
                                                   - WRK-CYOKI-KOH-FTN2
                     ELSE
                       MOVE      ZERO    TO    WRK-CYOKI-KOH-FTN
                     END-IF
                     IF     WRK-CYOKI-KOH-FTN  >   WRK-CYOKI-KEISAN3
                       COMPUTE   WRK-CYOKI-KEISAN4 = WRK-CYOKI-KOH-FTN
                                                   - WRK-CYOKI-KEISAN3
                     ELSE
                       MOVE      ZERO    TO    WRK-CYOKI-KEISAN4
                     END-IF
                     IF   RECE62-CYOKI-KSIKBN  =  "1"
                       ADD     WRK-CYOKI-KEISAN4
                                     TO    RECE62-FTNMONEY(1)
                       IF   FLG-KOH  =   2
                         ADD   WRK-CYOKI-KEISAN4
                                     TO    RECE62-FTNMONEY(2)
                                           RECE62-FTNMONEY-KOJ(2)
                         ADD   WRK-CYOKI-KEISAN4
                                     TO    WRK-KOH-GAI
                       END-IF
                     ELSE
                       COMPUTE  WRK-SKY-FTNMONEY-XXX =
                                WRK-SKY-FTNMONEY-XXX +
                                WRK-CYOKI-KEISAN4
                       IF   WRK-CYOKI-KEISAN4  >  ZERO
                         DISPLAY  "6:WRK-SKY-FTNMONEY-XXX="
                                     WRK-SKY-FTNMONEY-XXX
                       END-IF
                     END-IF
                  END-IF
              END-IF
      *
              IF  (FLG-CYOKI-HENSYU        =    1  )
              AND (RECE62-KOUREI-SAIKEI    =   ZERO)
                IF   RECE62-KOHNUM(1)  =  SPACE
                  CONTINUE
                ELSE
                  MOVE    1    TO    RECE62-SAIKEIZEROKSI1
                END-IF
              END-IF
           END-IF
           IF      RECE62-SRYYM           >=  "200804"
             IF   (RECE62-KOHNUM(1)    NOT =   SPACE)
             AND  (RECE62-KOUREI-SAIKEI    =   ZERO )
             AND  (RECE62-SAIKEIZEROKSI1   =   ZERO )
               IF    RECE62-KOUREI         =  "1" OR "2"
                 IF ( FLG-SAIKEI-KISAI   NOT = ZERO                  )
                 OR ( FLG-ZENKOKUKOHI-NISYU  = 1 OR 2 OR 3 OR 4 OR 5 )
                 OR ( FLG-ZENKOKUKOHI-NISYU8 = 1                     )
                 OR ((FLG-ZENKOKUKOHI-NISYU     = ZERO ) AND
                     (RECE62-KOHNUM(1)      NOT = SPACE) AND
                     (RECE62-TOTALTEN(2)        = ZERO ) AND
                     (RECE62-FTNMONEY(1)    NOT = ZERO )             )
                    MOVE    1           TO  RECE62-SAIKEIZEROKSI1
                 ELSE
                    MOVE   999999999    TO  RECE62-KOUREI-SAIKEI
                 END-IF
               ELSE
                  MOVE     999999999    TO  RECE62-KOUREI-SAIKEI
               END-IF
             END-IF
             IF   (RECE62-KOHNUM(2)    NOT =   SPACE)
             AND  (RECE62-KOUREI-SAIKEI2   =   ZERO )
             AND  (RECE62-SAIKEIZEROKSI2   =   ZERO )
               IF    RECE62-KOUREI         =  "1" OR "2"
                 IF  (FLG-ZENKOKUKOHI-NISYU  = 1 OR 2 OR 3 OR 4 OR 5)
                 OR  (FLG-ZENKOKUKOHI-NISYU8 = 1                    )
                    MOVE    1           TO  RECE62-SAIKEIZEROKSI2
                 ELSE
                    MOVE   999999999    TO  RECE62-KOUREI-SAIKEI2
                 END-IF
               ELSE
                  MOVE     999999999    TO  RECE62-KOUREI-SAIKEI2
               END-IF
             END-IF
             IF   (RECE62-KOHNUM(3)    NOT =   SPACE)
             AND  (RECE62-KOUREI-SAIKEI3   =   ZERO )
             AND  (RECE62-SAIKEIZEROKSI3   =   ZERO )
               IF   (RECE62-KOUREI         =  "1" OR "2")
               AND  (RECE62-SRYYM         >=  "202301"  )
                 IF  (FLG-ZENKOKUKOHI-NISYU  = 1 OR 2 OR 3 OR 4 OR 5)
                 OR  (FLG-ZENKOKUKOHI-NISYU8 = 1                    )
                    MOVE    1           TO  RECE62-SAIKEIZEROKSI3
                 ELSE
                    MOVE   999999999    TO  RECE62-KOUREI-SAIKEI3
                 END-IF
               ELSE
                  MOVE     999999999    TO  RECE62-KOUREI-SAIKEI3
               END-IF
             END-IF
             IF   (RECE62-KOHNUM(4)    NOT =   SPACE)
             AND  (RECE62-KOUREI-SAIKEI4   =   ZERO )
             AND  (RECE62-SAIKEIZEROKSI4   =   ZERO )
               IF   (RECE62-KOUREI         =  "1" OR "2")
               AND  (RECE62-SRYYM         >=  "202301"  )
                 IF  (FLG-ZENKOKUKOHI-NISYU  = 1 OR 2 OR 3 OR 4 OR 5)
                 OR  (FLG-ZENKOKUKOHI-NISYU8 = 1                    )
                    MOVE    1           TO  RECE62-SAIKEIZEROKSI4
                 ELSE
                    MOVE   999999999    TO  RECE62-KOUREI-SAIKEI4
                 END-IF
               ELSE
                  MOVE     999999999    TO  RECE62-KOUREI-SAIKEI4
               END-IF
             END-IF
      *
             IF      RECE62-KOUREI-SAIKEI     = 999999999
               IF ((RECE62-SAIKEIZEROKSI2     = 1                 ) AND
                   (RECE62-KOUREI-SAIKEI2 NOT = 999999999         ))
               OR ((RECE62-SAIKEIZEROKSI2     = ZERO              ) AND
                   (RECE62-KOUREI-SAIKEI2 NOT = 999999999 AND ZERO))
                  MOVE     ZERO         TO  RECE62-KOUREI-SAIKEI
                  MOVE      1           TO  RECE62-SAIKEIZEROKSI1
               END-IF
             END-IF
           END-IF
      *
           IF      RECE62-RJNGENMENKBN   =   "1"
      *
               COMPUTE  WRK-CHK-KEISAN1 = WRK-KOH-FTN         +  5
               COMPUTE  WRK-CHK-KEISAN1 = WRK-CHK-KEISAN1     / 10
               COMPUTE  WRK-CHK-KEISAN1 = WRK-CHK-KEISAN1     * 10
      *
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KOHFTNGAKU  +  5
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KEISAN2     / 10
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KEISAN2     * 10
      *
               COMPUTE  WRK-CHK-KEIKASOCHIXX
                                  =   WRK-KOH-GAI2  +  WRK-CHK-KEISAN1
      *
               IF    RECE62-SRYYM  >=  "200610"
                     MOVE    44400    TO    WRK-CHK-KINGAKU
               ELSE
                     MOVE    40200    TO    WRK-CHK-KINGAKU
               END-IF
               EVALUATE   FLG-CYOKI
                 WHEN      ZERO
                   IF    RECE62-SRYYM  >=  "200610"
                     MOVE    44400    TO    WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    40200    TO    WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1
                   MOVE      10000    TO    WRK-CHK-KINGAKU2
                 WHEN       2
                   MOVE      20000    TO    WRK-CHK-KINGAKU2
               END-EVALUATE
               IF    RECE62-SRYYM  >=  "200610"
                     MOVE    44400    TO    WRK-CHK-KINGAKU3
               ELSE
                     MOVE    40200    TO    WRK-CHK-KINGAKU3
               END-IF
      *
               COMPUTE  WRK-CHK-KEIKASOCHI1  =  WRK-CHK-KINGAKU -
                                               (WRK-CHK-FTNGAKU +
                                                WRK-CHK-KEISAN2)
               COMPUTE  WRK-CHK-KEIKASOCHI2  =  WRK-CHK-KINGAKU2 -
                                                WRK-CHK-ICHIBUGAKU
               COMPUTE  WRK-CHK-KEIKASOCHI3  =  WRK-CHK-KINGAKU3 -
                                                WRK-CHK-ICHIBUGAKU
               IF   WRK-CHK-KEIKASOCHI1  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI1
               END-IF
               IF   WRK-CHK-KEIKASOCHI2  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI2
               END-IF
               IF   WRK-CHK-KEIKASOCHI3  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI3
               END-IF
               IF   FLG-ZENKOH-ARI  =  ZERO
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI3)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                 END-IF
               ELSE
                 IF  FLG-RJNGENMEN-CHIARI    =  ZERO
                   IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                   OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX3           >=  WRK-CHK-KEIKASOCHI2)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                   END-IF
                 ELSE
                   IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                   OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX3           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX2           >=  WRK-CHK-KEIKASOCHI3)
                   OR  (FTN-KOH-XX4           >=  WRK-CHK-KEIKASOCHI3)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
                   END-IF
                 END-IF
               END-IF
               IF   WK-GENGAKUKBN    NOT =   ZERO
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21013-TOKKI-HENSYU-SEC
               END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   ZERO
      *
            IF  (RECE62-SRYYM             >= "200210"       )
            AND (RECE62-ETC-KOHNUM(1)  NOT = "972" AND "974")
            AND (RECE62-ETC-KOHNUM(2)  NOT = "972" AND "974")
            AND (RECE62-ETC-KOHNUM(3)  NOT = "972" AND "974")
            AND (RECE62-ETC-KOHNUM(4)  NOT = "972" AND "974")
      *
             IF  (RECE62-KOUREI        =  "1" OR "2")
             AND (RECE62-KOHNUM(1)     =  SPACE     )
             AND (RECE62-KOHNUM(2)     =  SPACE     )
             AND (RECE62-KOHNUM(3)     =  SPACE     )
             AND (RECE62-KOHNUM(4)     =  SPACE     )
             AND (FLG-HOKENICHIBU  NOT =  ZERO      )
                 MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                 IF   FLG-ZEROKOGAITO  =   1
                   PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
                 ELSE
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                 END-IF
                 IF     RECE62-FTNMONEY(1)   >  WRK-KINGAKU3
                       COMPUTE  WRK-SKY-FTNMONEY-XXX =
                                WRK-SKY-FTNMONEY-XXX +
                               (RECE62-FTNMONEY(1)   -  WRK-KINGAKU3)
                       DISPLAY  "1:WRK-SKY-FTNMONEY-XXX="
                                   WRK-SKY-FTNMONEY-XXX
      *                地方公費がレセプト請求でない場合の対処
                       IF   RECE62-SRYYM   >=  "202001"
                         COMPUTE  WRK-SKY-FTNMONEY-XX2 =
                                  WRK-SKY-FTNMONEY-XX2 +
                                 (RECE62-FTNMONEY(1)   -  WRK-KINGAKU3)
                         DISPLAY  "1:WRK-SKY-FTNMONEY-XX2="
                                     WRK-SKY-FTNMONEY-XX2
                       END-IF
                       MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                       IF   RECE62-RJNGENMENKBN   =   "1"
                           MOVE    4    TO      FLG-TOKKI
                           PERFORM   21013-TOKKI-HENSYU-SEC
                       END-IF
                 END-IF
             END-IF
      *
             IF  ( RECE62-KOUREI            = "1" OR "2" )
             AND ( WRK-RECE-KOHI-CHECK1     =  1         )
             AND ( WRK-JYOGENKBN-TEN5   NOT = ZERO       )
                 MOVE     1       TO   FLG-KBN
                 PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
      *
             COMPUTE  WRK-CHK-KOKIGAK4  = RECE62-TOTALTEN(2)
                                        + RECE62-HENTOTALTEN(3)
             COMPUTE  WRK-CHK-KOKIGAK   = WRK-TAIHI-TOTALTEN
                                        - WRK-JYOGENKBN-TEN6
             IF  (RECE62-KOUREI          =  "2"              )
             AND (FLG-JIRITU-CYUKANSOU1  =   1               )
             AND (FLG-JIRITU-CYUKANSOU2  =   1               )
             AND (WRK-CHK-KOKIGAK        =   WRK-CHK-KOKIGAK4)
               MOVE   WRK-CHK-KOKIGAK   TO   WRK-HANTEI-TOTALTEN
               PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
               IF     WRK-KINGAKU-GENBUTU3  >  RECE62-KOUREI-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK2   =  WRK-KINGAKU-GENBUTU3
                                             -  RECE62-KOUREI-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK10  =  RECE62-KOUREI-SAIKEI2
                                             -  WRK-CHK-KOKIGAK2
                 MOVE     WRK-CHK-KOKIGAK2  TO  RECE62-KOUREI-SAIKEI2
                 COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
                                             -  WRK-CHK-KOKIGAK10
               END-IF
             END-IF
      *
      ***    IF  (RECE62-KOUREI          = "2"               )
      ***    AND (RECE62-KOHNUM(1)       = "015"  OR  "016"  )
      ***    AND (TBL-HKNFTNDATA-JGNXXX(1)
      ***                                = 9999999 OR 999999 )
      ***    AND (RECE62-KOHNUM(2)       = SPACE             )
      ***    AND (RECE62-KOHNUM(3)       = SPACE             )
      ***    AND (RECE62-KOHNUM(4)       = SPACE             )
      ***    AND (RECE62-HKNCOMBI(2) NOT = ZERO              )
      ***    AND (WRK-TAIHI-TOTALTEN NOT = RECE62-TOTALTEN(2))
      ***    AND (RECE62-TOTALTEN(2) NOT = ZERO              )
      ***    AND (FLG-HOKENICHIBU2       = ZERO              )
      ***    AND (FLG-HOKENICHIBU3       = ZERO              )
      ***    AND (FLG-HOKENICHIBU7       =  1                )
      ***    AND (FLG-HOKENICHIBU-SYU    =  1                )
      ***        MOVE     2       TO   FLG-KBN
      ***        PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
      ***    END-IF
      *
             IF  ( RECE62-KOUREI            = "1" OR "2" )
             AND ( WRK-RECE-KOHI-CHECK2     =  1         )
             AND ( WRK-JYOGENKBN-TEN7   NOT = ZERO       )
             AND ( FLG-HOKENICHIBU-SYU      = ZERO       )
             AND ( FLG-ZENKOKUKOHI-NISYU4   =  1         )
                 MOVE     3       TO   FLG-KBN
                 PERFORM  210466-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
      *
            END-IF
      *
            EVALUATE   WRK-PREFNUM
      *      群馬県地方公費
             WHEN    "10"
               IF  (RECE62-SRYYM        >=  "200804"  )
               AND (RECE62-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE62-KOUREI        =  "1" OR "2")
                 IF  (RECE62-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(2)       =  SPACE            )
                 AND (RECE62-KOHNUM(3)       =  SPACE            )
                 AND (RECE62-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE62-TOTALTEN(2))
                 AND (RECE62-TOTALTEN(2) NOT = ZERO              )
                 AND (RECE62-ETC-KOHNUM(1)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(2)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(3)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(4)  NOT = "972" AND "974")
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   IF   RECE62-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE   WRK-SKY-KEISAN3 = WRK-KINGAKU3
                                               / 2
                     COMPUTE   WRK-SKY-KEISAN4 = RECE62-KOUREI-SAIKEI
                                               - WRK-SKY-KEISAN3
                     COMPUTE   WRK-SKY-FTNMONEY-XXX =
                               WRK-SKY-FTNMONEY-XXX +
                             ((RECE62-FTNMONEY(1)   -  WRK-KINGAKU3)
                                                    -  WRK-SKY-KEISAN4)
                     DISPLAY   "2:WRK-SKY-FTNMONEY-XXX="
                                  WRK-SKY-FTNMONEY-XXX
                     MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                     IF   RECE62-RJNGENMENKBN   =   "1"
                       MOVE    4    TO      FLG-TOKKI
                       PERFORM   21013-TOKKI-HENSYU-SEC
                     END-IF
                   END-IF
                   MOVE  999999999  TO   RECE62-KOUREI-SAIKEI
                 END-IF
               END-IF
      *      愛媛県地方公費
             WHEN    "38"
               IF  (RECE62-SRYYM        >=  "200804"  )
               AND (RECE62-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE62-KOUREI        =  "1" OR "2")
                 IF  (RECE62-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(2)       =  SPACE            )
                 AND (RECE62-KOHNUM(3)       =  SPACE            )
                 AND (RECE62-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE62-TOTALTEN(2))
                 AND (RECE62-TOTALTEN(2) NOT = ZERO              )
                 AND (RECE62-ETC-KOHNUM(1)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(2)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(3)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(4)  NOT = "972" AND "974")
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   IF   RECE62-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                              - WRK-KINGAKU3
                     MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
                     IF RECE62-KOUREI-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE62-KOUREI-SAIKEI =
                                RECE62-KOUREI-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE     ZERO       TO  RECE62-KOUREI-SAIKEI
                       MOVE      1         TO  RECE62-SAIKEIZEROKSI1
                     END-IF
                   END-IF
                 END-IF
                 IF  (RECE62-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE62-KOHNUM(2)       =  SPACE            )
                 AND (RECE62-KOHNUM(3)       =  SPACE            )
                 AND (RECE62-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE62-TOTALTEN(2))
                 AND (RECE62-TOTALTEN(2) NOT = ZERO              )
                 AND ((RECE62-ETC-KOHNUM(1)  = "972" OR "974") OR
                      (RECE62-ETC-KOHNUM(2)  = "972" OR "974") OR
                      (RECE62-ETC-KOHNUM(3)  = "972" OR "974") OR
                      (RECE62-ETC-KOHNUM(4)  = "972" OR "974")   )
                 AND (FLG-CYOKI-HENSYU       = ZERO              )
                   EVALUATE   RECE62-KOUREI
                     WHEN      "1"
                       IF  (RECE62-ETC-KOHNUM(1)  = "972")
                       OR  (RECE62-ETC-KOHNUM(2)  = "972")
                       OR  (RECE62-ETC-KOHNUM(3)  = "972")
                       OR  (RECE62-ETC-KOHNUM(4)  = "972")
                         IF  FLG-TOKU75 = 1 OR 2
                           MOVE      5000   TO   WRK-KINGAKU
                         ELSE
                           MOVE     10000   TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF  FLG-TOKU75 = 1 OR 2
                           MOVE     10000   TO   WRK-KINGAKU
                         ELSE
                           MOVE     20000   TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     WHEN      "2"
                       IF  (RECE62-ETC-KOHNUM(1)  = "972")
                       OR  (RECE62-ETC-KOHNUM(2)  = "972")
                       OR  (RECE62-ETC-KOHNUM(3)  = "972")
                       OR  (RECE62-ETC-KOHNUM(4)  = "972")
                         IF  FLG-TOKU75 = 3
                           MOVE      5000   TO   WRK-KINGAKU
                         ELSE
                           MOVE     10000   TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF  FLG-TOKU75 = 3
                           MOVE     10000   TO   WRK-KINGAKU
                         ELSE
                           MOVE     20000   TO   WRK-KINGAKU
                         END-IF
                       END-IF
                   END-EVALUATE
                   IF   RECE62-FTNMONEY(1)  =  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = 
                          (WRK-TAIHI-TOTALTEN - RECE62-TOTALTEN(2)) 
                                              * 10
                                              * RECE62-KYURATE
                                              / 100
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK +  5
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK / 10
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK * 10
                     IF  RECE62-KOUREI-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE62-KOUREI-SAIKEI =
                                RECE62-KOUREI-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE   ZERO            TO  RECE62-KOUREI-SAIKEI
                       MOVE    1              TO  RECE62-SAIKEIZEROKSI1
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *      東京都地方公費
             WHEN    "13"
               IF  (RECE62-SRYYM        >=  "200804"  )
               AND (RECE62-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE62-KOUREI        =  "1" OR "2")
                 IF  (RECE62-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (TBL-TOKATUKAIFLG(1)    =  ZERO             )
      ***********IF  (RECE62-KOHNUM(1)   =  "282"                )
                 AND (RECE62-KOHNUM(2)   =  SPACE                )
                 AND (RECE62-KOHNUM(3)   =  SPACE                )
                 AND (RECE62-KOHNUM(4)   =  SPACE                )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE62-TOTALTEN(2))
                 AND (RECE62-TOTALTEN(2) NOT = ZERO              )
                 AND (RECE62-ETC-KOHNUM(1)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(2)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(3)  NOT = "972" AND "974")
                 AND (RECE62-ETC-KOHNUM(4)  NOT = "972" AND "974")
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  210464-JYOGENGAKU-HENSYU-SEC
                   IF   RECE62-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-SKY-FTNMONEY-XXX =
                              WRK-SKY-FTNMONEY-XXX +
                             (RECE62-FTNMONEY(1)   -  WRK-KINGAKU3)
                     DISPLAY  "3:WRK-SKY-FTNMONEY-XXX="
                                 WRK-SKY-FTNMONEY-XXX
                     MOVE   WRK-KINGAKU3   TO  RECE62-FTNMONEY(1)
      ***************IF RECE62-FTNMONEY(1)  >  RECE62-KOUREI-SAIKEI
      ***************   CONTINUE
      ***************ELSE
      ***************   MOVE   999999999   TO  RECE62-KOUREI-SAIKEI
      ***************END-IF
                     IF   RECE62-RJNGENMENKBN   =   "1"
                       MOVE    4    TO      FLG-TOKKI
                       PERFORM   21013-TOKKI-HENSYU-SEC
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *      三重県地方公費
             WHEN    "24"
      ***      IF  ( RECE62-SRYYM      >=  "201904"       )
               IF  ( RECE62-SRYYM      >=  "202012"       )
               AND ((RECE62-KOHNUM(1)   =  "361" OR "363") OR
                    (RECE62-KOHNUM(2)   =  "361" OR "363") OR
                    (RECE62-KOHNUM(3)   =  "361" OR "363") OR
                    (RECE62-KOHNUM(4)   =  "361" OR "363"))
      *
                 PERFORM   21046B-CHIHO-SYUNOU-CHECK-SEC
      *
               END-IF
            END-EVALUATE
      *
      *     保険欄の括弧再掲（下）金額加算
            PERFORM       210469-SAIKEIKIN-KASAN-SEC
      *
           ELSE
      *
            IF   (WK-GENGAKUKBN   =   3  OR  4)
            AND  (RECE62-SRYYM   >=   "201101")
            AND  (IDZ             =   1       )
              IF   RECE62-KOUREI        =  "1" OR "2"
                 MOVE     ZERO        TO   RECE62-FTNMONEY(1)
                 MOVE     999999999   TO   RECE62-KOUREI-SAIKEI
                                           RECE62-KOUREI-SAIKEI2
                                           RECE62-KOUREI-SAIKEI3
                                           RECE62-KOUREI-SAIKEI4
              END-IF
              IF   (FLG-SAIGAI-TAISYO   =   1      )
              AND  (RECE62-SRYYM       <=  "201202")
                 MOVE     ZERO        TO   RECE62-SHOKUJIFTN(1)
              END-IF
            END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   ZERO
           AND  RECE62-SRYYM   >=  "200210"
      *
             COMPUTE  WRK-CHK-KOKIGAK4  = RECE62-TOTALTEN(2)
                                        + RECE62-HENTOTALTEN(3)
             COMPUTE  WRK-CHK-KOKIGAK   = WRK-TAIHI-TOTALTEN
                                        - WRK-JYOGENKBN-TEN6
             IF  (RECE62-KOUREI          =  SPACE            )
             AND (FLG-JIRITU-CYUKANSOU1  =   1               )
             AND (FLG-JIRITU-CYUKANSOU2  =   1               )
             AND (WRK-CHK-KOKIGAK        =   WRK-CHK-KOKIGAK4)
               MOVE   WRK-CHK-KOKIGAK   TO   WRK-HANTEI-TOTALTEN
               PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
               IF     WRK-KINGAKU-GENBUTU3  >  WRK-JIRITU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK2     =  WRK-KINGAKU-GENBUTU3
                                               -  WRK-JIRITU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK10    =  WRK-JIRITU-SAIKEI2
                                               -  WRK-CHK-KOKIGAK2
                 COMPUTE  RECE62-FTNMONEY-SKY  =  RECE62-FTNMONEY-SKY
                                               -  WRK-CHK-KOKIGAK10
               END-IF
             END-IF
      *
           END-IF
      *
           IF   (IDZ               =     1      )
           AND  (RECE62-SRYYM     >=  "201004"  )
           AND  (RECE62-KOUREI     =  "1" OR "2")
             MOVE   RECE62-FTNMONEY(1)   TO   RECE62-FTNMONEY-SKY
           END-IF
      *
           IF    RECE62-SRYYM   >=  "202109"
             IF    RECE62-MADOGUCHIKBN  =   SPACE
               MOVE   "00"   TO   RECE62-MADOGUCHIKBN
             END-IF
           ELSE
               MOVE  SPACE   TO   RECE62-MADOGUCHIKBN
           END-IF
      *
           .
       21046-SAIKEI-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費併用時の計算処理（７０歳未満）
      *****************************************************************
       210461-KOHIHEIYO-KEISAN-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
             WHEN        1
             WHEN        2
               IF  FLG-TOKU75 = 3
                MOVE    22200   TO   WRK-KEISAN-XXX
               ELSE
                MOVE    44400   TO   WRK-KEISAN-XXX
               END-IF
             WHEN        3
               IF  FLG-TOKU75 = 3
                MOVE    12300   TO   WRK-KEISAN-XXX
               ELSE
                MOVE    24600   TO   WRK-KEISAN-XXX
               END-IF
           END-EVALUATE
      *
           MOVE     1      TO     KOHFTN-IDX
           MOVE    ZERO    TO     WRK-KEISAN9
      *
      ***  PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
      ***              UNTIL    KOHFTN-IDX     >    4
      *
             IF    RECE62-KOHNUM(KOHFTN-IDX) = "010" OR "015" OR "016"
                                            OR "021" OR "024" OR "079"
                                            OR "038"
               IF  RECE62-FTNMONEY(KOHFTN-IDX + 1)  <  WRK-KEISAN-XXX
                CONTINUE
               ELSE
                EVALUATE  RECE62-KOHNUM(KOHFTN-IDX)
                 WHEN      "010"
                    COMPUTE WRK-KEISAN1 =
                            RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                    IF  FLG-TOKU75 = 3
                     IF  WRK-KEISAN1  >  967890
                       COMPUTE WRK-KEISAN6 =
                            (( WRK-KEISAN1 - 133500 ) * 0.01 ) + 0.5
                       COMPUTE WRK-KEISAN3 = 40050 + WRK-KEISAN6
                     ELSE
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.05
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                     END-IF
                    ELSE
                     IF  WRK-KEISAN1  >  1935690
                       COMPUTE WRK-KEISAN6 =
                            (( WRK-KEISAN1 - 267000 ) * 0.01 ) + 0.5
                       COMPUTE WRK-KEISAN3 = 80100 + WRK-KEISAN6
                     ELSE
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.05
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                     END-IF
                    END-IF
                    IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                       COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                           - WRK-KEISAN-XXX
                    ELSE
                       MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD    WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "015"
                 WHEN      "016"
                 WHEN      "021"
                    PERFORM  210451-KOHFTN-KINGAKU-SEC
                    IF   WRK-NYUJGNGAK  =  9999999 OR 999999
                      COMPUTE WRK-KEISAN1 =
                              RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                      IF  FLG-TOKU75 = 3
                       IF  WRK-KEISAN1 >  430140
                         COMPUTE WRK-KEISAN6 =
                              (( WRK-KEISAN1 - 133500 ) * 0.01 ) + 0.5
                         COMPUTE WRK-KEISAN3 = 40050 + WRK-KEISAN6
                       ELSE
                         COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                       END-IF
                      ELSE
                       IF  WRK-KEISAN1 >  860340
                         COMPUTE WRK-KEISAN6 =
                              (( WRK-KEISAN1 - 267000 ) * 0.01 ) + 0.5
                         COMPUTE WRK-KEISAN3 = 80100 + WRK-KEISAN6
                       ELSE
                         COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                       END-IF
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "024"
                 WHEN      "079"
                    PERFORM  210451-KOHFTN-KINGAKU-SEC
                    IF   WRK-NYUJGNGAK  >  WRK-KEISAN-XXX
                      COMPUTE WRK-KEISAN1 =
                              RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                      IF      WRK-KEISAN3 > WRK-NYUJGNGAK
                         MOVE  WRK-NYUJGNGAK  TO  WRK-KEISAN3
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "038"
                    PERFORM  210451-KOHFTN-KINGAKU-SEC
                    IF   WRK-NYUJGNGAK  >  WRK-KEISAN-XXX
                      COMPUTE WRK-KEISAN1 =
                              RECE62-TOTALTEN(KOHFTN-IDX + 1) * 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * RECE62-KYURATE
                                                        / 100
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                      IF      WRK-KEISAN3 > WRK-NYUJGNGAK
                         MOVE  WRK-NYUJGNGAK  TO  WRK-KEISAN3
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                END-EVALUATE
               END-IF
             END-IF
      *
      ***  END-PERFORM
      *
           .
       210461-KOHIHEIYO-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    減免公費対応
      *****************************************************************
       210462-GENGAKU-OKIKAE-SEC               SECTION.
      *
           MOVE      1       TO     FLG-GENGAKU-OKIKAE
           MOVE      1       TO     IDX10
           PERFORM   2104G1-JGNGAK-SET-SEC
      *
      *    公費上限
           MOVE      ZERO         TO   WRK-JYOGEN-KOH
                                       WRK-JYOGEN-KOH9
                                       WRK-JIRITU-TAFTNRUIKEI
                                       WRK-JIRITU-CYUKANSOU
           MOVE      ZERO         TO   FLG-IRYOHI70K
           MOVE      ZERO         TO   FLG-KOUGAKUCYO-GEN70K
      *
           IF    RECE62-KOHNUM(1)    =  "010"
             IF   RECE62-KOUREI    =   "1"
                MOVE   WRK-KOH-GENDOGAKU    TO  WRK-JYOGEN-KOH
             END-IF
             IF  FLG-GENBUTU70   NOT =  ZERO
                MOVE   WRK-GEN70-GENDOGAKU  TO  WRK-JYOGEN-KOH
                EVALUATE  WRK-GEN70-GENDOGAKU
                  WHEN       80100
                  WHEN       40050
                     MOVE  1      TO   FLG-IRYOHI70K
                END-EVALUATE
             END-IF
             IF   RECE62-HOTEIGAIFLG(2) = "1"
                MOVE   ZERO                 TO  WRK-JYOGEN-KOH
                MOVE   ZERO                 TO  FLG-IRYOHI70K
             END-IF
           ELSE
             INITIALIZE                     LNK-ORCSJGNGET-REC
             MOVE   RECE62-HOSPNUM      TO  LNK-ORCSJGNGET-HOSPNUM
             MOVE   RECE62-NYUGAIKBN    TO  LNK-ORCSJGNGET-NYUGAIKBN
             MOVE   RECE62-PTID         TO  LNK-ORCSJGNGET-PTID
             MOVE   RECE62-KOHNUM(1)    TO  LNK-ORCSJGNGET-KOHHKNNUM
             MOVE   RECE62-KOHID(1)     TO  LNK-ORCSJGNGET-KOHID
             MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SRYYM
             MOVE   RECE62-SRYYM        TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
             MOVE   "31"                TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
             IF     RECE62-KOHNUM(1)(1:1) >=  "1" AND <=  "8"
               MOVE   WRK-KOHJGNGET-TAISYOKBN(1)
                                        TO  LNK-ORCSJGNGET-SETKBN
               MOVE   WRK-KOHJGNGET-TEKIYOFLG(1)
                                        TO  LNK-ORCSJGNGET-SETKBN2
             END-IF
      *
             CALL    "ORCSJGNGET"       USING
                                        LNK-ORCSJGNGET-REC
                                        SPA-AREA
      *
             IF     LNK-ORCSJGNGET-RC   =   ZERO
               MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                        TO  WRK-JYOGEN-KOH
                                            WRK-JYOGEN-KOH9
               MOVE    LNK-ORCSJGNGET-TAFTNRUIKEI
                                        TO  WRK-JIRITU-TAFTNRUIKEI
             END-IF
      *
             IF  (RECE62-KOUREI    =   "1")
             OR  (FLG-KOUREI-KBN   =    1 )
                 IF  RECE62-KOHNUM(1) = "012" OR "025"
                   IF    WRK-JYOGEN-KOH  >  WRK-SEIHO-GENDO
                      MOVE  WRK-SEIHO-GENDO   TO   WRK-JYOGEN-KOH
                   END-IF
                 ELSE
                   IF ( RECE62-KOHNUM(1) =
                        "015" OR "016" OR "021" OR "024" OR
                        "079" OR "038"                        )
                   OR ((RECE62-KOHNUM(1) =  "052" OR "054"   ) AND
                       (RECE62-SRYYM    >=  "201501"         ))
                     CONTINUE
                   ELSE
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                      MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                 END-IF
             END-IF
             IF  FLG-GENBUTU70   NOT =   ZERO
                 IF  RECE62-KOHNUM(1) = "012" OR "025"
                   IF    WRK-JYOGEN-KOH  >  WRK-SEIHO-GENDO70
                      MOVE  WRK-SEIHO-GENDO70    TO   WRK-JYOGEN-KOH
                   END-IF
                 ELSE
                   IF ( RECE62-KOHNUM(1) =
                        "015" OR "016" OR "021" OR "024" OR
                        "079" OR "038"                        )
                   OR ((RECE62-KOHNUM(1) =  "052" OR "054"   ) AND
                       (RECE62-SRYYM    >=  "201501"         ))
                   OR ((WRK-PREFNUM      =  "23" OR "24"     ) AND
                       (RECE62-KOHNUM(1) =  "152"            ) AND
                       (RECE62-SRYYM    >=  "201104"         ) AND
                       (RECE62-SRYYM    <=  "201412"         ))
                     CONTINUE
                   ELSE
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                      MOVE  WRK-GEN70-GENDOGAKU  TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                 END-IF
             END-IF
             IF ( RECE62-KOHNUM(1) =  "015" OR "016" OR "021" OR
                                      "024" OR "079" OR "038" OR
                                      "012" OR "025"             )
             OR ((RECE62-KOHNUM(1) =  "052" OR "054"            ) AND
                 (RECE62-SRYYM    >=  "201501"                  ))
             OR ((WRK-PREFNUM      =  "23" OR "24"              ) AND
                 (RECE62-KOHNUM(1) =  "152"                     ) AND
                 (RECE62-SRYYM    >=  "201104"                  ) AND
                 (RECE62-SRYYM    <=  "201412"                  ))
                 CONTINUE
             ELSE
                 IF   (RECE62-ETC-KOHNUM(1) = "972")
                 OR   (RECE62-ETC-KOHNUM(2) = "972")
                 OR   (RECE62-ETC-KOHNUM(3) = "972")
                 OR   (RECE62-ETC-KOHNUM(4) = "972")
                   IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                       MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                   END-IF
                 END-IF
                 IF   (RECE62-ETC-KOHNUM(1) = "974")
                 OR   (RECE62-ETC-KOHNUM(2) = "974")
                 OR   (RECE62-ETC-KOHNUM(3) = "974")
                 OR   (RECE62-ETC-KOHNUM(4) = "974")
                   IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                       MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                   END-IF
                 END-IF
             END-IF
             IF  RECE62-KOHNUM(1) = "015" OR "016" OR "021"
                   IF  WRK-JYOGEN-KOH = 9999999 OR 999999
                      MOVE  1     TO  WRK-JIRITU-CYUKANSOU
                   ELSE
                      MOVE  2     TO  WRK-JIRITU-CYUKANSOU
                      IF WRK-JIRITU-TAFTNRUIKEI < WRK-JYOGEN-KOH
                       COMPUTE WRK-JYOGEN-KOH = WRK-JYOGEN-KOH
                                              - WRK-JIRITU-TAFTNRUIKEI
                      ELSE
                       MOVE    ZERO    TO   WRK-JYOGEN-KOH
                      END-IF
      *               <** GAIRAIFTN**>
                   END-IF
                   IF  (RECE62-KOUREI    =   "1")
                   OR  (FLG-KOUREI-KBN   =    1 )
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                        MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF  FLG-GENBUTU70 NOT =   ZERO
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                        MOVE  WRK-GEN70-GENDOGAKU
                                                TO   WRK-JYOGEN-KOH
                        EVALUATE  WRK-GEN70-GENDOGAKU
                          WHEN       80100
                          WHEN       40050
                             MOVE    2          TO   FLG-IRYOHI70K
                        END-EVALUATE
                     END-IF
                   END-IF
                   IF   (RECE62-ETC-KOHNUM(1) = "972")
                   OR   (RECE62-ETC-KOHNUM(2) = "972")
                   OR   (RECE62-ETC-KOHNUM(3) = "972")
                   OR   (RECE62-ETC-KOHNUM(4) = "972")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                         MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                         MOVE  ZERO              TO  FLG-IRYOHI70K
                     END-IF
                   END-IF
                   IF   (RECE62-ETC-KOHNUM(1) = "974")
                   OR   (RECE62-ETC-KOHNUM(2) = "974")
                   OR   (RECE62-ETC-KOHNUM(3) = "974")
                   OR   (RECE62-ETC-KOHNUM(4) = "974")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                         MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                         MOVE  ZERO              TO  FLG-IRYOHI70K
                     END-IF
                   END-IF
                   IF    WRK-JYOGEN-KOH = 9999999 OR 999999
                     IF  FLG-TOKU75 = 1 OR 2 OR 3
                         MOVE  40050   TO   WRK-JYOGEN-KOH
                     ELSE
                         MOVE  80100   TO   WRK-JYOGEN-KOH
                     END-IF
                     MOVE    3         TO   FLG-IRYOHI70K
                   END-IF
             END-IF
             IF ( RECE62-KOHNUM(1) =  "024" OR "079" OR "038" )
             OR ((RECE62-KOHNUM(1) =  "052" OR "054"         ) AND
                 (RECE62-SRYYM    >=  "201501"               ))
             OR ((WRK-PREFNUM      =  "23" OR "24"           ) AND
                 (RECE62-KOHNUM(1) =  "152"                  ) AND
                 (RECE62-SRYYM    >=  "201104"               ) AND
                 (RECE62-SRYYM    <=  "201412"               ))
                   IF ( RECE62-KOHNUM(1) =  "038"          )
                   OR ((RECE62-KOHNUM(1) =  "052" OR "054") AND
                       (RECE62-SRYYM    >=  "201501"      ))
                   OR ((WRK-PREFNUM      =  "23" OR "24"  ) AND
                       (RECE62-KOHNUM(1) =  "152"         ) AND
                       (RECE62-SRYYM    >=  "201104"      ) AND
                       (RECE62-SRYYM    <=  "201412"      ))
                     IF  WRK-JIRITU-TAFTNRUIKEI  <  WRK-JYOGEN-KOH
                        COMPUTE WRK-JYOGEN-KOH = WRK-JYOGEN-KOH
                                               - WRK-JIRITU-TAFTNRUIKEI
                     ELSE
                        MOVE    ZERO    TO   WRK-JYOGEN-KOH
                     END-IF
      *              <** GAIRAIFTN**>
                   END-IF
                   IF  (RECE62-KOUREI    =   "1")
                   OR  (FLG-KOUREI-KBN   =    1 )
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                        MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF  FLG-GENBUTU70 NOT =   ZERO
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                        MOVE  WRK-GEN70-GENDOGAKU
                                                TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF   (RECE62-ETC-KOHNUM(1) = "972")
                   OR   (RECE62-ETC-KOHNUM(2) = "972")
                   OR   (RECE62-ETC-KOHNUM(3) = "972")
                   OR   (RECE62-ETC-KOHNUM(4) = "972")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                         MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF   (RECE62-ETC-KOHNUM(1) = "974")
                   OR   (RECE62-ETC-KOHNUM(2) = "974")
                   OR   (RECE62-ETC-KOHNUM(3) = "974")
                   OR   (RECE62-ETC-KOHNUM(4) = "974")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                         MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                     END-IF
                   END-IF
             END-IF
           END-IF
      *
      *    公費上限＋＠
           IF     FLG-IRYOHI70K    =  1
              COMPUTE  WRK-KOUREI-IRYOHI70 = RECE62-TOTALTEN(2)
                                           * 10
              IF  FLG-TOKU75 = 1 OR 2 OR 3
                IF  WRK-KOUREI-IRYOHI70 >  133500
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 133500 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >  967890
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              ELSE
                IF  WRK-KOUREI-IRYOHI70 >  267000
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >  1935690
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
           END-IF
           IF     FLG-IRYOHI70K    =  2  OR  3
              COMPUTE  WRK-KOUREI-IRYOHI70 = RECE62-TOTALTEN(2)
                                           * 10
              IF  FLG-TOKU75 = 1 OR 2 OR 3
                IF  WRK-KOUREI-IRYOHI70 >  133500
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 133500 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >   430140
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              ELSE
                IF  WRK-KOUREI-IRYOHI70 >  267000
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
           END-IF
      *
           MOVE   WRK-TAIHI-GENKIN(1)  TO   WRK-TAIHI-GENKIN-XXX
           COMPUTE  WRK-TAIHI-GENKIN-XXX-EN   =
                    WRK-TAIHI-GENKIN-EN(1)    +
                    0.9
      *
      *    公費の負担計算
           IF   WRK-JYOGEN-KOH   =    ZERO
               MOVE    ZERO    TO   WRK-FTNKEI-KOH
           ELSE
               IF  (RECE62-KOUREI    =   "1" OR "2")
      ***      OR  (RECE62-KOHNUM(1) =   "012"     )
                 IF   FLG-KOUGAKUCYO-GEN70K  =  1
                    MOVE   WRK-JYOGEN-KOH       TO WRK-FTNKEI-KOH
                 ELSE
                  IF  (RECE62-KOUREI           =   "2")
                  AND (WRK-KOGAKU-TAISYOGAI(1) =    1 )
                    IF     WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX-EN
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX-EN
                                                TO WRK-FTNKEI-KOH
                    END-IF
                  ELSE
                    IF     WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX
                                                TO WRK-FTNKEI-KOH
                    END-IF
                  END-IF
                 END-IF
               ELSE
                 IF        WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX-EN
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                 ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX-EN
                                                TO WRK-FTNKEI-KOH
                 END-IF
               END-IF
           END-IF
      *
           IF  ((WK-GENGAKUKBN      NOT =   2  ) AND
                (RECE62-FTNMONEY(2)     =  ZERO))
           OR  ((WK-GENGAKUKBN          =   2  ) AND
                (WRK-JYOGEN-KOH9        =  ZERO))
            CONTINUE
           ELSE
            IF   RECE62-KOUREI    =   "1" OR "2"
              MOVE   RECE62-FTNMONEY(2)      TO  WRK-TAIHI-GENKIN3
              MOVE   WRK-FTNKEI-KOH          TO  RECE62-FTNMONEY(2)
                                                 RECE62-FTNMONEY-KOJ(2)
              IF    RECE62-FTNMONEY(2)    NOT =  ZERO
              AND   RECE62-KOUREI             =  "1"
                IF   WK-GENGAKU-SKJMAEFLG(2)  =  1
                  MOVE  WK-GENGAKU-SKJMAE(2) TO  WRK-TAIHI-GENKIN3
                END-IF
                IF   RECE62-FTNMONEY(2) > WRK-TAIHI-GENKIN3
                  COMPUTE  WRK-TAIHI-GENKIN4 = RECE62-FTNMONEY(2)
                                             - WRK-TAIHI-GENKIN3
                ELSE
                  MOVE     ZERO        TO  WRK-TAIHI-GENKIN4
                END-IF
                IF   RECE62-FTNMONEY(1) > WRK-TAIHI-GENKIN4
                  COMPUTE  RECE62-FTNMONEY(1) =  RECE62-FTNMONEY(1)
                                              -  WRK-TAIHI-GENKIN4
                ELSE
                  MOVE     ZERO        TO  RECE62-FTNMONEY(1)
                END-IF
                IF   FTN-KOH-XXX        > WRK-TAIHI-GENKIN4
                  COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
                                              -  WRK-TAIHI-GENKIN4
                ELSE
                  MOVE     ZERO        TO  FTN-KOH-XXX
                END-IF
              END-IF
            ELSE
              MOVE   WRK-FTNKEI-KOH          TO  RECE62-FTNMONEY(2)
                                                 RECE62-FTNMONEY-KOJ(2)
            END-IF
           END-IF
      *
           MOVE      1      TO     WK-GENGAKU-SKJKASANFLG(2)
      *
           .
       210462-GENGAKU-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳代前半軽減特例措置対応
      *****************************************************************
       210463-ZENKI-TOKUREI-OKIKAE-SEC               SECTION.
      *
           MOVE      1       TO     FLG-GENGAKU-OKIKAE
           MOVE   KOHFTN-IDX TO     IDX10
           PERFORM   2104G1-JGNGAK-SET-SEC
      *
      *    公費上限
           MOVE   TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
                                          TO   WRK-JYOGEN-KOH
                                               WRK-JYOGEN-KOH2
      ****
           IF    WK-GENGAKUKBN    NOT =  ZERO
           AND   WK-GENGAKUKBN-KEISAN =  ZERO
            IF  ((RECE62-KOHNUM(KOHFTN-IDX)      = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX)  =   1  ))
            OR  ((WRK-PREFNUM                    = "13" ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)      = "151") AND
                 (RECE62-SRYYM               <  "200905"))
             CONTINUE
            ELSE
             IF  WRK-KOH-GENDOGAKU   NOT =  ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-KOH-GENDOGAKU
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WRK-KOH-GENDOGAKU   =
                                  WRK-KOH-GENDOGAKU   *
                                  WK-GENGAKU-RITUX    /
                                  100
                     END-IF
                   WHEN        2
                     IF  WRK-KOH-GENDOGAKU < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WRK-KOH-GENDOGAKU
                     ELSE
                       COMPUTE  WRK-KOH-GENDOGAKU     =
                                WRK-KOH-GENDOGAKU     -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN        3
                   WHEN        4
                         MOVE   ZERO     TO   WRK-KOH-GENDOGAKU
                   WHEN        5
                     IF  WRK-KOH-GENDOGAKU > WK-GENGAKU-KIN
                       COMPUTE  WRK-KOH-GENDOGAKU     =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  +   5
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  /  10
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  *  10
             END-IF
             IF  WRK-JYOGEN-KOH   NOT =  ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-JYOGEN-KOH
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WRK-JYOGEN-KOH      =
                                  WRK-JYOGEN-KOH      *
                                  WK-GENGAKU-RITUX    /
                                  100
                     END-IF
                   WHEN        2
                     IF  WRK-JYOGEN-KOH < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WRK-JYOGEN-KOH
                     ELSE
                       COMPUTE  WRK-JYOGEN-KOH     =
                                WRK-JYOGEN-KOH     -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN        3
                   WHEN        4
                         MOVE   ZERO     TO   WRK-JYOGEN-KOH
                   WHEN        5
                     IF  WRK-JYOGEN-KOH > WK-GENGAKU-KIN
                       COMPUTE  WRK-JYOGEN-KOH     =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH +  5
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH / 10
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH * 10
             END-IF
            END-IF
           END-IF
      *
           MOVE     WRK-TAIHI-GENKIN(KOHFTN-IDX)
                                     TO   WRK-TAIHI-GENKIN-XXX
           COMPUTE  WRK-TAIHI-GENKIN-XXX-EN         =
                    WRK-TAIHI-GENKIN-EN(KOHFTN-IDX) +
                    0.9
      *
           IF   ((RECE62-KOHNUM(KOHFTN-IDX)      = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX)  =   1  ))
           OR   ((WRK-PREFNUM                    = "13" ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)      = "151") AND
                 (RECE62-SRYYM               <  "200905"))
             CONTINUE
           ELSE
             IF   WK-GENGAKUKBN    NOT =   ZERO
               MOVE     WRK-TAIHI-GENKIN-GEN(KOHFTN-IDX)
                                     TO   WRK-TAIHI-GENKIN-XXX
               COMPUTE  WRK-TAIHI-GENKIN-XXX-EN             =
                        WRK-TAIHI-GENKIN-EN-GEN(KOHFTN-IDX) +
                        0.9
             END-IF
           END-IF
      *
           IF ( RECE62-KOHNUM(KOHFTN-IDX) = "038"         )
           OR ((RECE62-KOHNUM(KOHFTN-IDX) = "054"        ) AND
               (RECE62-SRYYM             >= "201501"     ))
           OR ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX) =   1 )
              IF  TBL-HKNFTNDATA-TAF(KOHFTN-IDX)    <  WRK-JYOGEN-KOH
                  COMPUTE  WRK-JYOGEN-KOH =
                           WRK-JYOGEN-KOH -
                           TBL-HKNFTNDATA-TAF(KOHFTN-IDX)
              ELSE
                  MOVE     ZERO          TO   WRK-JYOGEN-KOH
              END-IF
      ***     IF  TBL-HKNFTNDATA-GAIRAI(KOHFTN-IDX) <  WRK-JYOGEN-KOH
      ***         COMPUTE  WRK-JYOGEN-KOH =
      ***                  WRK-JYOGEN-KOH -
      ***                  TBL-HKNFTNDATA-GAIRAI(KOHFTN-IDX)
      ***     ELSE
      ***         MOVE     ZERO          TO   WRK-JYOGEN-KOH
      ***     END-IF
           END-IF
      *
           IF  (  RECE62-KOUREI                 =  SPACE )
           AND (((RECE62-KOHNUM(KOHFTN-IDX)     = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX) =   1  ))
             OR ((WRK-PREFNUM                   = "13" ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)     = "151") AND
                 (RECE62-SRYYM              <  "200905")))
             CONTINUE
           ELSE
             IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                MOVE   WRK-KOH-GENDOGAKU  TO   WRK-JYOGEN-KOH
             END-IF
           END-IF
      *
      *    公費の負担計算
           IF  ((WK-GENGAKUKBN                 NOT =   2    ) AND
                (RECE62-FTNMONEY(KOHFTN-IDX + 1)   =  ZERO  ))
           OR  ((WK-GENGAKUKBN                     =   2    ) AND
                (TBL-HKNFTNDATA-JGN(KOHFTN-IDX)    =  ZERO  ))
           OR  ( TBL-HKNFTNDATA-FLG(KOHFTN-IDX)    =  1 OR 2 )
            IF   RECE62-KOUREI               NOT =  "1"
            AND  TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  =   1
              IF  WRK-JYOGEN-KOH = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                CONTINUE
              ELSE
                PERFORM  210465-KOH-ICHIBUFTN-HENSYU-SEC
                PERFORM  21046A-CHIHO-ICHIBUFTN-HEN-SEC
              END-IF
            END-IF
           ELSE
            IF   WRK-JYOGEN-KOH   =    ZERO
               MOVE    ZERO    TO   WRK-FTNKEI-KOH
            ELSE
             IF  RECE62-KOUREI    =   "1"
               IF   WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX
                  MOVE  WRK-JYOGEN-KOH       TO   WRK-FTNKEI-KOH
               ELSE
                  MOVE  WRK-TAIHI-GENKIN-XXX TO   WRK-FTNKEI-KOH
               END-IF
             ELSE
               IF   WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX-EN
                  MOVE  WRK-JYOGEN-KOH       TO   WRK-FTNKEI-KOH
               ELSE
                  MOVE  WRK-TAIHI-GENKIN-XXX-EN
                                             TO   WRK-FTNKEI-KOH
               END-IF
             END-IF
            END-IF
            MOVE   WRK-FTNKEI-KOH   TO
                            RECE62-FTNMONEY    (KOHFTN-IDX + 1)
                            RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
           END-IF
      *
           IF   ( RECE62-KOHNUM(KOHFTN-IDX)  = "051"          )
           OR   ((WRK-PREFNUM                = "13"          ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)  = "151"         ) AND
                 (RECE62-SKJRYYKBN(KOHFTN-IDX + 1)   =  "2"  ))
           OR   ((WRK-PREFNUM                = "23"          ) AND
                 (RECE62-KOHNUM(KOHFTN-IDX)  = "191"         ) AND
                 (RECE62-SRYYM              >= "200910"      ) AND
                 (RECE62-SRYYM              <= "201509"      ) AND
                 (RECE62-SKJRYYKBN(KOHFTN-IDX + 1)   =  "2"  ))
             IF  ((WRK-PREFNUM                 =  "01"           ) AND
                  (RECE62-KOHNUM(KOHFTN-IDX)   =  "051"          ) AND
                  (RECE62-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                              >= "91" AND <= "95") AND
                  (RECE62-SRYYM             <  "200810"          ))
              CONTINUE
             ELSE
              COMPUTE  WRK-FTNKEI2 = RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                   + WRK-SKJ-FTN    (KOHFTN-IDX + 1)
              MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)
                              TO  WRK-FTNKEI3
      *
              MOVE     1      TO  WK-GENGAKU-SKJMAEFLG(KOHFTN-IDX + 1)
              MOVE     RECE62-FTNMONEY(KOHFTN-IDX + 1)
                              TO  WK-GENGAKU-SKJMAE(KOHFTN-IDX + 1)
      *
              IF  WRK-JYOGEN-KOH2  NOT =  ZERO
                IF   WRK-FTNKEI3  =  WRK-JYOGEN-KOH2
                   MOVE  WRK-FTNKEI3
                              TO  RECE62-FTNMONEY    (KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                ELSE
                   MOVE  WRK-FTNKEI2
                              TO  RECE62-FTNMONEY    (KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
              END-IF
             END-IF
           END-IF
      *
           .
       210463-ZENKI-TOKUREI-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集
      *****************************************************************
       210464-JYOGENGAKU-HENSYU-SEC               SECTION.
      *
           MOVE     ZERO     TO   FLG-KOUGAKU2
           MOVE     ZERO     TO   WRK-KINGAKU3
           MOVE     ZERO     TO   WRK-KINGAKU-GENBUTU3
           MOVE     ZERO     TO   FLG-KINGAKU-GENBUTUX
           MOVE     ZERO     TO   FLG-KINGAKU-GENBUTU3
      *
           EVALUATE   RECE62-KOUREI
             WHEN        "1"
               IF     RECE62-TEISYOTOKU  NOT =  SPACE
                 EVALUATE   RECE62-TEISYOTOKU
                   WHEN  "1"
                   WHEN  "4"
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE  7500   TO   WRK-KINGAKU3
                     ELSE
                       MOVE  15000  TO   WRK-KINGAKU3
                     END-IF
                   WHEN  "2"
                   WHEN  "3"
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE  12300  TO   WRK-KINGAKU3
                     ELSE
                       MOVE  24600  TO   WRK-KINGAKU3
                     END-IF
                 END-EVALUATE
               ELSE
                 IF   ((RECE62-KYURATE       =   30     ) AND
                       (RECE62-SRYYM        >=  "201808"))
                 OR   ((RECE62-KYURATE       =   30     ) AND
                       (RECE62-SRYYM         <  "201808") AND
                       (RECE62-RJNGENMENKBN  =   SPACE  ) AND
                       (FLG-KOHYONKAIME      =   ZERO   ))
                 OR   ((RECE62-KYURATE       =   20     ) AND
                       (RECE62-SRYYM         <  "200804") AND
                       (RECE62-RJNGENMENKBN  =   SPACE  ) AND
                       (FLG-KOHYONKAIME      =   ZERO   ))
                   IF      RECE62-SRYYM   >=  "201808"
                     EVALUATE   FLG-KOUREI-GENEKIKBN
                       WHEN        1
                         IF    FLG-KOHYONKAIME    =  1
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    70050     TO   WRK-KINGAKU3
                           ELSE
                             MOVE   140100     TO   WRK-KINGAKU3
                           END-IF
                           MOVE   1   TO   FLG-KINGAKU-GENBUTUX
                         ELSE
                           COMPUTE WRK-CHIHOU-KIN6     =
                                   WRK-HANTEI-TOTALTEN * 10
                           IF  FLG-TOKU75 = 1 OR 2
                             IF   WRK-CHIHOU-KIN6  >  421000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 421000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 126300
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE    126300  TO   WRK-KINGAKU3
                             END-IF
                           ELSE
                             IF   WRK-CHIHOU-KIN6  >  842000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 842000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 252600
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE    252600  TO   WRK-KINGAKU3
                             END-IF
                           END-IF
                         END-IF
                       WHEN        2
                         IF    FLG-KOHYONKAIME    =  1
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    46500     TO   WRK-KINGAKU3
                           ELSE
                             MOVE    93000     TO   WRK-KINGAKU3
                           END-IF
                           MOVE   1   TO   FLG-KINGAKU-GENBUTUX
                         ELSE
                           COMPUTE WRK-CHIHOU-KIN6     =
                                   WRK-HANTEI-TOTALTEN * 10
                           IF  FLG-TOKU75 = 1 OR 2
                             IF   WRK-CHIHOU-KIN6  >  279000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 279000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 83700
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE     83700  TO   WRK-KINGAKU3
                             END-IF
                           ELSE
                             IF   WRK-CHIHOU-KIN6  >  558000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 558000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 167400
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE    167400  TO   WRK-KINGAKU3
                             END-IF
                           END-IF
                         END-IF
                       WHEN        3
                         IF    FLG-KOHYONKAIME    =  1
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    22200     TO   WRK-KINGAKU3
                           ELSE
                             MOVE    44400     TO   WRK-KINGAKU3
                           END-IF
                           MOVE   1   TO   FLG-KINGAKU-GENBUTUX
                         ELSE
                           COMPUTE WRK-CHIHOU-KIN6     =
                                   WRK-HANTEI-TOTALTEN * 10
                           IF  FLG-TOKU75 = 1 OR 2
                             IF   WRK-CHIHOU-KIN6  >  133500
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 133500 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 40050
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE     40050  TO   WRK-KINGAKU3
                             END-IF
                           ELSE
                             IF   WRK-CHIHOU-KIN6  >  267000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 267000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 80100
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE     80100  TO   WRK-KINGAKU3
                             END-IF
                           END-IF
                         END-IF
                     END-EVALUATE
                   ELSE
                     IF    RECE62-SRYYM   >=  "200610"
                       COMPUTE WRK-CHIHOU-KIN6     =
                               WRK-HANTEI-TOTALTEN * 10
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN6  >  133500
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN6 - 133500 )
                                                    * 0.01 ) + 0.5
                           COMPUTE  WRK-KINGAKU3 = 40050
                                                 + WRK-KINGAKU2
                           MOVE   1       TO   FLG-KOUGAKU2
                         ELSE
                           MOVE   40050   TO   WRK-KINGAKU3
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN6  >  267000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN6 - 267000 )
                                                    * 0.01 ) + 0.5
                           COMPUTE  WRK-KINGAKU3 = 80100
                                                 + WRK-KINGAKU2
                           MOVE   1       TO   FLG-KOUGAKU2
                         ELSE
                           MOVE   80100   TO   WRK-KINGAKU3
                         END-IF
                       END-IF
                     ELSE
                       COMPUTE WRK-CHIHOU-KIN6     =
                               WRK-HANTEI-TOTALTEN * 10
                       IF   WRK-CHIHOU-KIN6  >  361500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 - 361500 )
                                                  * 0.01 ) + 0.5
                         COMPUTE  WRK-KINGAKU3 = 72300
                                               + WRK-KINGAKU2
                         MOVE   1       TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   72300   TO   WRK-KINGAKU3
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF      RECE62-SRYYM   >=  "201708"
                     IF    FLG-KOHYONKAIME  =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE   22200  TO   WRK-KINGAKU3
                       ELSE
                         MOVE   44400  TO   WRK-KINGAKU3
                       END-IF
                       MOVE   1   TO   FLG-KINGAKU-GENBUTUX
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE   28800  TO   WRK-KINGAKU3
                       ELSE
                         MOVE   57600  TO   WRK-KINGAKU3
                       END-IF
                     END-IF
                   ELSE
                     IF    RECE62-SRYYM   >=  "200610"
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE   22200  TO   WRK-KINGAKU3
                       ELSE
                         MOVE   44400  TO   WRK-KINGAKU3
                       END-IF
                     ELSE
                       MOVE     40200  TO   WRK-KINGAKU3
                     END-IF
                   END-IF
                 END-IF
               END-IF
             WHEN        "2"
               IF  RECE62-SRYYM  >= "201501"
                 PERFORM 210464-JYOGENGAKU-HENSYU2-SEC
               ELSE
                 PERFORM 210464-JYOGENGAKU-HENSYU1-SEC
               END-IF
           END-EVALUATE
      *
      *
           MOVE   WRK-KINGAKU3   TO   WRK-KINGAKU-GENBUTU3
           IF  FLG-KINGAKU-GENBUTUX  =  1
             MOVE    1           TO   FLG-KINGAKU-GENBUTU3
           END-IF
      *
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
           AND  WK-GENGAKUKBN-KEISAN =   ZERO
             EVALUATE   WK-GENGAKUKBN
               WHEN        1
                 IF  WK-GENGAKU-RITU = 100
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE WK-GENGAKU-RITUX = 100 - WK-GENGAKU-RITU
                   IF    WRK-KINGAKU3  NOT = ZERO
                     IF  FLG-KOUGAKU2 = ZERO
                       COMPUTE WRK-KINGAKU3 =
                               WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 +  5
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 / 10
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 * 10
                     ELSE
                       COMPUTE WRK-KINGAKU3 =
                              (WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100)
                                                               + 0.5
                     END-IF
                   END-IF
                 END-IF
               WHEN        2
                 IF  WRK-KINGAKU3 < WK-GENGAKU-KIN
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE  WRK-KINGAKU3     =
                            WRK-KINGAKU3     -
                            WK-GENGAKU-KIN
                 END-IF
               WHEN        3
               WHEN        4
                 MOVE   ZERO     TO   WRK-KINGAKU3
               WHEN        5
                 IF  WRK-KINGAKU3 > WK-GENGAKU-KIN
                   COMPUTE  WRK-KINGAKU3     =
                            WK-GENGAKU-KIN
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
       210464-JYOGENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集１（平成２６年１２月まで）
      *****************************************************************
       210464-JYOGENGAKU-HENSYU1-SEC               SECTION.
      *
           EVALUATE     FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU3
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU3
                 END-IF
               ELSE
                 COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN6  >  250000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 250000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 75000  + WRK-KINGAKU2
                    MOVE   1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE   75000   TO   WRK-KINGAKU3
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN6  >  500000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 500000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 150000 + WRK-KINGAKU2
                    MOVE   1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE   150000  TO   WRK-KINGAKU3
                  END-IF
                 END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU3
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU3
                 END-IF
               ELSE
                 COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN6  >  133500
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 135000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 40050  + WRK-KINGAKU2
                    MOVE   1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE   40050   TO   WRK-KINGAKU3
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN6  >  267000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 267000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 80100  + WRK-KINGAKU2
                    MOVE   1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE   80100   TO   WRK-KINGAKU3
                  END-IF
                 END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU3
                ELSE
                  MOVE   24600   TO   WRK-KINGAKU3
                END-IF
               ELSE
                IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU3
                ELSE
                  MOVE   35400   TO   WRK-KINGAKU3
                END-IF
               END-IF
           END-EVALUATE
      *
           .
       210464-JYOGENGAKU-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集２（平成２７年１月から）
      *****************************************************************
       210464-JYOGENGAKU-HENSYU2-SEC               SECTION.
      *
           EVALUATE    FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU3
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU3
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU3
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU3
                   END-EVALUATE
                END-IF
                MOVE   1   TO   FLG-KINGAKU-GENBUTUX
               ELSE
                COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN6 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 = 126300 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN6 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 =  83700 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU3
                       END-IF
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN6 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 = 252600 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN6  >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 = 167400 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU3
                       END-IF
                   END-EVALUATE
                END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU3
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU3
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU3
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU3
                   END-EVALUATE
                END-IF
                MOVE   1   TO   FLG-KINGAKU-GENBUTUX
               ELSE
                COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN6 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 =  40050 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU3
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN6 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 =  80100 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU3
                   END-EVALUATE
                END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU3
                ELSE
                       MOVE    24600   TO   WRK-KINGAKU3
                END-IF
                MOVE   1   TO   FLG-KINGAKU-GENBUTUX
               ELSE
                IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU3
                ELSE
                       MOVE    35400   TO   WRK-KINGAKU3
                END-IF
               END-IF
           END-EVALUATE
      *
           .
       210464-JYOGENGAKU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集（０１公）他
      *****************************************************************
       210464X-JYOGENGAKU-HENSYU2-SEC               SECTION.
      *
           MOVE     ZERO     TO   FLG-KOUGAKU2
           MOVE     ZERO     TO   WRK-KINGAKU3
           MOVE     ZERO     TO   WRK-KINGAKU-GENBUTU3
      *
           EVALUATE   RECE62-KOUREI
             WHEN        "1"
               IF      RECE62-SRYYM   >=  "201708"
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE  28800   TO  WRK-KINGAKU3
                 ELSE
                   MOVE  57600   TO  WRK-KINGAKU3
                 END-IF
               ELSE
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE  22200   TO  WRK-KINGAKU3
                 ELSE
                   MOVE  44400   TO  WRK-KINGAKU3
                 END-IF
               END-IF
             WHEN        "2"
             WHEN        " "
               COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
               IF  FLG-TOKU75 = 3
                 IF   WRK-CHIHOU-KIN6  >  133500
                   COMPUTE  WRK-KINGAKU2 =
                      (( WRK-CHIHOU-KIN6 -  133500 ) * 0.01 )
                                                     + 0.5
                   COMPUTE WRK-KINGAKU3 =  40050 + WRK-KINGAKU2
                   MOVE    1       TO  FLG-KOUGAKU2
                 ELSE
                   MOVE    40050   TO  WRK-KINGAKU3
                 END-IF
               ELSE
                 IF   WRK-CHIHOU-KIN6  >  267000
                   COMPUTE  WRK-KINGAKU2 =
                      (( WRK-CHIHOU-KIN6 -  267000 ) * 0.01 )
                                                     + 0.5
                   COMPUTE WRK-KINGAKU3 =  80100 + WRK-KINGAKU2
                   MOVE    1       TO  FLG-KOUGAKU2
                 ELSE
                   MOVE    80100   TO  WRK-KINGAKU3
                 END-IF
               END-IF
           END-EVALUATE
      *
      *
           MOVE   WRK-KINGAKU3   TO   WRK-KINGAKU-GENBUTU3
      *
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
           AND  WK-GENGAKUKBN-KEISAN =   ZERO
             EVALUATE   WK-GENGAKUKBN
               WHEN        1
                 IF  WK-GENGAKU-RITU = 100
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE WK-GENGAKU-RITUX = 100 - WK-GENGAKU-RITU
                   IF    WRK-KINGAKU3  NOT = ZERO
                     IF  FLG-KOUGAKU2 = ZERO
                       COMPUTE WRK-KINGAKU3 =
                               WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 +  5
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 / 10
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 * 10
                     ELSE
                       COMPUTE WRK-KINGAKU3 =
                              (WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100)
                                                               + 0.5
                     END-IF
                   END-IF
                 END-IF
               WHEN        2
                 IF  WRK-KINGAKU3 < WK-GENGAKU-KIN
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE  WRK-KINGAKU3     =
                            WRK-KINGAKU3     -
                            WK-GENGAKU-KIN
                 END-IF
               WHEN        3
               WHEN        4
                 MOVE   ZERO     TO   WRK-KINGAKU3
               WHEN        5
                 IF  WRK-KINGAKU3 > WK-GENGAKU-KIN
                   COMPUTE  WRK-KINGAKU3     =
                            WK-GENGAKU-KIN
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
       210464X-JYOGENGAKU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額のある全国公費の一部負担金編集
      *****************************************************************
       210465-KOH-ICHIBUFTN-HENSYU-SEC               SECTION.
      *
           MOVE    ZERO    TO   WRK-KOH-KINGAKU
      *
           IF   RECE62-KOHNUM(KOHFTN-IDX) =
                "015" OR "016" OR "024" OR "079"
             COMPUTE  WRK-KOH-KINGAKU = RECE62-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * 10
                                      / 100
           END-IF
      *
           IF ( RECE62-KOHNUM(KOHFTN-IDX) =
                "038" OR "051" OR "011" OR "020" OR
                "012" OR "025" OR "028" OR "029"          )
           OR ((RECE62-KOHNUM(KOHFTN-IDX) =  "092"       ) AND
               (RECE62-SRYYM             >=  "201812"    ))
           OR ( RECE62-KOHNUM(KOHFTN-IDX) =  "095"        )
           OR ((RECE62-KOHNUM(KOHFTN-IDX) =  "096"       ) AND
               (RECE62-SRYYM             >=  "202310"    ))
           OR ((WRK-PREFNUM               =  "13"        ) AND
               (RECE62-KOHNUM(KOHFTN-IDX) =  "151"       ))
           OR ((WRK-PREFNUM               =  "23"        ) AND
               (RECE62-KOHNUM(KOHFTN-IDX) =  "191"       ) AND
               (RECE62-SRYYM             >=  "200910"    ) AND
               (RECE62-SRYYM             <=  "201509"    ))
           OR ((WRK-PREFNUM               =  "23" OR "24") AND
               (RECE62-KOHNUM(KOHFTN-IDX) =  "152"       ) AND
               (RECE62-SRYYM             >=  "201104"    ) AND
               (RECE62-SRYYM             <=  "201412"    ))
             COMPUTE  WRK-KOH-KINGAKU = RECE62-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * RECE62-KYURATE
                                      / 100
           END-IF
      *
           IF  (RECE62-KOHNUM(KOHFTN-IDX) =  "052" OR "054")
           OR  (WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =   1 )
            IF  (RECE62-KYURATE    >=   20     )
            AND (RECE62-SRYYM      >=  "201501")
             COMPUTE  WRK-KOH-KINGAKU = RECE62-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * 20
                                      / 100
            ELSE
             COMPUTE  WRK-KOH-KINGAKU = RECE62-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * RECE62-KYURATE
                                      / 100
            END-IF
           END-IF
      *
           IF   WRK-KOH-KINGAKU   NOT = ZERO
            IF    WRK-KOH-KINGAKU < RECE62-FTNMONEY(KOHFTN-IDX + 1)
                MOVE  WRK-KOH-KINGAKU  TO
                                  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
            ELSE
              IF  WRK-KOH-KINGAKU = WRK-TAIHI-FTNMONEY(KOHFTN-IDX + 1)
                MOVE  WRK-KOH-KINGAKU  TO
                                  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
              ELSE
                IF  (WRK-TAIHI-GENKIN9(KOHFTN-IDX)
                                  = RECE62-FTNMONEY(KOHFTN-IDX + 1))
                AND (WRK-TAIHI-FTNMONEY(KOHFTN-IDX + 1)
                                  = RECE62-FTNMONEY(KOHFTN-IDX + 1))
                AND (TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
                              NOT = RECE62-FTNMONEY(KOHFTN-IDX + 1))
                  MOVE  WRK-KOH-KINGAKU  TO
                                  RECE62-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE62-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
              END-IF
            END-IF
           END-IF
      *
           .
       210465-KOH-ICHIBUFTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄一部負担金チェック
      *****************************************************************
       210466-HOKEN-ICHIBUFTN-CHK-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-HOKENICHIBU-CHK
           IF  (RECE62-KOUREI           = "2" )
           AND (WRK-JYOGENKBN-TEN2  NOT = ZERO)
                 COMPUTE WRK-FTNKEI5 = WRK-JYOGENKBN-TEN6
                                     * 10
                                     * RECE62-KYURATE
                                     / 100
                 IF    WRK-FTNKEI5  >=  21000
                    MOVE     1     TO    FLG-HOKENICHIBU-CHK
                 END-IF
           END-IF
      *
           EVALUATE  RECE62-KOUREI
             WHEN      "1"
               EVALUATE  FLG-KBN
                 WHEN      1
                   COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN4
                                               + WRK-JYOGENKBN-TEN5
                 WHEN      3
                   COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN7
               END-EVALUATE
             WHEN      "2"
               EVALUATE  FLG-KBN
                 WHEN      1
                   IF    FLG-HOKENICHIBU-CHK  =  1
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN4
                                                 + WRK-JYOGENKBN-TEN5
                                                 + WRK-JYOGENKBN-TEN2
                   ELSE
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN4
                                                 + WRK-JYOGENKBN-TEN5
                   END-IF
                 WHEN      2
                   IF    FLG-HOKENICHIBU-CHK  =  1
                     MOVE  WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   ELSE
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                                 - RECE62-TOTALTEN(2)
                   END-IF
                 WHEN      3
                   IF    FLG-HOKENICHIBU-CHK  =  1
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN7
                                                 + WRK-JYOGENKBN-TEN2
                   ELSE
                     COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN7
                   END-IF
               END-EVALUATE
           END-EVALUATE
           IF   FLG-KBN      =   3
           AND  FLG-CHIIKI2  =   1
             PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
           ELSE
             PERFORM  210464-JYOGENGAKU-HENSYU-SEC
           END-IF
      *
           EVALUATE  FLG-KBN
             WHEN      1
                IF  WRK-RECE-KOHI-CHECK1X =  1
                  MOVE  WRK-RECE-KOHI-CHKKIN   TO  WRK-CHK-KOKIGAK2
                END-IF
             WHEN      2
                MOVE    RECE62-FTNMONEY(2)     TO  WRK-CHK-KOKIGAK2
                IF  (RECE62-KOUREI           = "2")
                AND (WRK-KOGAKU-TAISYOGAI(1) =  1 )
                  MOVE  WRK-TAIHI-FTNMONEY2(2) TO  WRK-CHK-KOKIGAK2
                END-IF
             WHEN      3
                IF  WRK-RECE-KOHI-CHECK2X =  1
                  MOVE  WRK-RECE-KOHI-CHKKIN   TO  WRK-CHK-KOKIGAK2
                END-IF
           END-EVALUATE
      *
           EVALUATE  RECE62-KOUREI
             WHEN      "1"
                 IF   WRK-KINGAKU3  >  WRK-CHK-KOKIGAK2
                   COMPUTE  WRK-CHK-KOKIGAK5  =  WRK-KINGAKU3
                                              -  WRK-CHK-KOKIGAK2
                 ELSE
                   MOVE     ZERO         TO    WRK-CHK-KOKIGAK5
                 END-IF
             WHEN      "2"
               IF    FLG-HOKENICHIBU-CHK  =  1
                 IF   WRK-KINGAKU3  >  WRK-CHK-KOKIGAK2
                   COMPUTE  WRK-CHK-KOKIGAK5  =  WRK-KINGAKU3
                                              -  WRK-CHK-KOKIGAK2
                 ELSE
                   MOVE     ZERO         TO    WRK-CHK-KOKIGAK5
                 END-IF
               ELSE
                 MOVE     WRK-KINGAKU3   TO    WRK-CHK-KOKIGAK5
               END-IF
           END-EVALUATE
      ***
           MOVE     ZERO                 TO    FLG-OK3
           EVALUATE  FLG-KBN
             WHEN      1
                COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN4
                                            + WRK-JYOGENKBN-TEN5
             WHEN      2
                COMPUTE WRK-HANTEI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                            - RECE62-TOTALTEN(2)
             WHEN      3
                COMPUTE WRK-HANTEI-TOTALTEN = WRK-JYOGENKBN-TEN7
           END-EVALUATE
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-HANTEI-TOTALTEN
                                     * 10
                                     * RECE62-KYURATE
                                     / 100
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 +  5
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 / 10
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 * 10
      *
           IF   WRK-CHK-KOKIGAK5  >  WRK-CHK-KOKIGAK6
             MOVE   WRK-CHK-KOKIGAK6   TO  WRK-CHK-KOKIGAK7
           ELSE
             MOVE   WRK-CHK-KOKIGAK5   TO  WRK-CHK-KOKIGAK7
             MOVE   1                  TO  FLG-OK3
           END-IF
      ***
           IF   FLG-KBN  =   2
                 COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                          - FTN-KOH-XXX
           ELSE
             EVALUATE  WRK-RECE-KOHI-FLG
               WHEN       1
                 COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                          - FTN-KOH-XXX
               WHEN       2
                 COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                          - FTN-KOH-XXX
                                          - FTN-KOH-XX3
               WHEN       3
                 COMPUTE  WRK-CHK-KOKIGAK = RECE62-FTNMONEY(1)
                                          - FTN-KOH-XXX
                                          - FTN-KOH-XX3
                                          - FTN-KOH-XX10
             END-EVALUATE
           END-IF
           IF   WRK-CHK-KOKIGAK  NOT =  WRK-CHK-KOKIGAK7
           AND  FLG-OK3              =  1
             IF   FLG-KBN  =   2
                   COMPUTE  RECE62-FTNMONEY(1) = WRK-CHK-KOKIGAK7
                                               + FTN-KOH-XXX
             ELSE
               EVALUATE  WRK-RECE-KOHI-FLG
                 WHEN       1
                   COMPUTE  RECE62-FTNMONEY(1) = WRK-CHK-KOKIGAK7
                                               + FTN-KOH-XXX
                   IF  (FLG-KOH           =   2   )
                   AND (RECE62-KOHNUM(1)  =  "010")
                     COMPUTE WRK-RECE-KOHI-CAL = WRK-RECE-KOHI-FTNMONEY2
                                               + WRK-CHK-KOKIGAK7
                     MOVE WRK-RECE-KOHI-CAL TO RECE62-FTNMONEY(2)
                                               RECE62-FTNMONEY-KOJ(2)
                   END-IF
                 WHEN       2
                   COMPUTE  RECE62-FTNMONEY(1) = WRK-CHK-KOKIGAK7
                                               + FTN-KOH-XXX
                                               + FTN-KOH-XX3
                   IF  (FLG-KOH           =   2   )
                   AND (RECE62-KOHNUM(1)  =  "010")
                     COMPUTE WRK-RECE-KOHI-CAL = WRK-RECE-KOHI-FTNMONEY2
                                               + FTN-KOH-XX3
                                               + WRK-CHK-KOKIGAK7
                     MOVE WRK-RECE-KOHI-CAL TO RECE62-FTNMONEY(2)
                                               RECE62-FTNMONEY-KOJ(2)
                   END-IF
                   IF  (FLG-KOH           =   2   )
                   AND (RECE62-KOHNUM(2)  =  "010")
                     COMPUTE WRK-RECE-KOHI-CAL = WRK-RECE-KOHI-FTNMONEY3
                                               + FTN-KOH-XXX
                                               + WRK-CHK-KOKIGAK7
                     MOVE WRK-RECE-KOHI-CAL TO RECE62-FTNMONEY(3)
                                               RECE62-FTNMONEY-KOJ(3)
                   END-IF
                 WHEN       3
                   COMPUTE  RECE62-FTNMONEY(1) = WRK-CHK-KOKIGAK7
                                               + FTN-KOH-XXX
                                               + FTN-KOH-XX3
                                               + FTN-KOH-XX10
                   IF  (FLG-KOH           =   2   )
                   AND (RECE62-KOHNUM(1)  =  "010")
                     COMPUTE WRK-RECE-KOHI-CAL = WRK-RECE-KOHI-FTNMONEY2
                                               + FTN-KOH-XX3
                                               + FTN-KOH-XX10
                                               + WRK-CHK-KOKIGAK7
                     MOVE WRK-RECE-KOHI-CAL TO RECE62-FTNMONEY(2)
                                               RECE62-FTNMONEY-KOJ(2)
                   END-IF
                   IF  (FLG-KOH           =   2   )
                   AND (RECE62-KOHNUM(2)  =  "010")
                     COMPUTE WRK-RECE-KOHI-CAL = WRK-RECE-KOHI-FTNMONEY3
                                               + FTN-KOH-XXX
                                               + FTN-KOH-XX10
                                               + WRK-CHK-KOKIGAK7
                     MOVE WRK-RECE-KOHI-CAL TO RECE62-FTNMONEY(3)
                                               RECE62-FTNMONEY-KOJ(3)
                   END-IF
                   IF  (FLG-KOH           =   2   )
                   AND (RECE62-KOHNUM(3)  =  "010")
                     COMPUTE WRK-RECE-KOHI-CAL = WRK-RECE-KOHI-FTNMONEY4
                                               + FTN-KOH-XXX
                                               + FTN-KOH-XX3
                                               + WRK-CHK-KOKIGAK7
                     MOVE WRK-RECE-KOHI-CAL TO RECE62-FTNMONEY(4)
                                               RECE62-FTNMONEY-KOJ(4)
                   END-IF
               END-EVALUATE
             END-IF
      *
             IF   FLG-KBN  =   3
               EVALUATE  WRK-RECE-KOHI-FLG
                 WHEN       1
                   IF   RECE62-KOUREI-SAIKEI2  NOT =  999999999
                     MOVE  WRK-CHK-KOKIGAK7  TO  RECE62-KOUREI-SAIKEI2
                     MOVE       1            TO  RECE62-SAIKEIZEROKSI2
                   END-IF
                 WHEN       2
                   IF   RECE62-KOUREI-SAIKEI3  NOT =  999999999
                     MOVE  WRK-CHK-KOKIGAK7  TO  RECE62-KOUREI-SAIKEI3
                     MOVE       1            TO  RECE62-SAIKEIZEROKSI3
                   END-IF
                 WHEN       3
                   IF   RECE62-KOUREI-SAIKEI4  NOT =  999999999
                     MOVE  WRK-CHK-KOKIGAK7  TO  RECE62-KOUREI-SAIKEI4
                     MOVE       1            TO  RECE62-SAIKEIZEROKSI4
                   END-IF
               END-EVALUATE
             END-IF
      *
             IF  (  FLG-KBN                 =  1                  )
             AND (((RECE62-KOHNUM(1)(1:1)   = "0"            ) AND
                   (RECE62-KOHNUM(1)    NOT = "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)     =  1              )   )
             AND (  RECE62-KOHNUM(2)        = SPACE               )
             AND (  RECE62-KOHNUM(3)        = SPACE               )
             AND (  RECE62-KOHNUM(4)        = SPACE               )
             AND (  WRK-TAIHI-TOTALTEN      = WRK-JYOGENKBN-TEN8  )
             AND (  WRK-JYOGENKBN-TEN8  NOT = ZERO                )
                  MOVE   1    TO   RECE62-RJNNYUKOHFTN(3)
             END-IF
           END-IF
      *
           .
       210466-HOKEN-ICHIBUFTN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の括弧再掲（下）金額加算
      *****************************************************************
       210469-SAIKEIKIN-KASAN-SEC               SECTION.
      *
           IF   FLG-ZENKOKUKOHI-NISYU   =   2
             IF  (((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))
             AND (  RECE62-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
               IF ((RECE62-TOTALTEN(1) NOT =  ZERO                 ) AND
                   (RECE62-TOTALTEN(1)     =  RECE62-TOTALTEN(2)   ) AND
                   (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(3)) AND
                   (RECE62-KOHNUM(3)       =  SPACE                ) AND
                   (RECE62-KOHNUM(4)       =  SPACE                ))
               OR ((RECE62-TOTALTEN(1) NOT =  ZERO                 ) AND
                   (RECE62-TOTALTEN(1)     =  RECE62-TOTALTEN(2)   ) AND
                   (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(3)) AND
                   (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(4)) AND
                   (RECE62-KOHNUM(4)       =  SPACE                ))
                 IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974") 
                 OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                 OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                 OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                   IF   FLG-ZENKOKUKOHI-NISYU5X = 4
                      PERFORM       2104691-SAIKEIKIN-KASAN2-SEC
                   END-IF
                 ELSE
                   IF   FLG-ZENKOKUKOHI-NISYU5X = 3
                      PERFORM       2104691-SAIKEIKIN-KASAN2-SEC
                   END-IF
                 END-IF
               ELSE
                 IF  (WRK-TAIHI-TOTALTEN   =  RECE62-HENTOTALTEN(3))
                 OR  (CNT-HKNCOMBI-KOHARI  =   1                   )
                   IF   FLG-ZENKOKUKOHI-NISYU5 = 2
                      PERFORM       2104691-SAIKEIKIN-KASAN2-SEC
                   END-IF
                 ELSE
                      PERFORM       2104692-SAIKEIKIN-KASAN3-SEC
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   FLG-ZENKOKUKOHI-NISYU   =   3
             IF  (((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))
             AND (  RECE62-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
               IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974") 
               OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
               OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
               OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 4
                      PERFORM       2104691-SAIKEIKIN-KASAN2-SEC
                 END-IF
               ELSE
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 3
                      PERFORM       2104691-SAIKEIKIN-KASAN2-SEC
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   FLG-ZENKOKUKOHI-NISYU   =   1  OR  2
             IF ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (  RECE62-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(3)    =  ZERO             ))
             OR ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (((RECE62-KOHNUM(3)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(3)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(3)    =   1              ))  AND
                 (  RECE62-KOHNUM(4)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(4)    =  ZERO             )  AND
                 (  RECE62-SRYYM          >=  "202301"         ))
                      PERFORM       2104692-SAIKEIKIN-KASAN3-SEC
             END-IF
           END-IF
      *
           .
       210469-SAIKEIKIN-KASAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の括弧再掲（下）金額加算
      *****************************************************************
       2104691-SAIKEIKIN-KASAN2-SEC               SECTION.
      *
           IF   FLG-KOH  =   2
             COMPUTE  WRK-CHK-KOKIGAK8 = RECE62-FTNMONEY(2)
                                       - WRK-KOH-GAI
           ELSE
             IF  WRK-FTNMONEY-MAE  NOT = 999999999
               MOVE  WRK-FTNMONEY-MAE   TO  WRK-CHK-KOKIGAK8
             ELSE
               MOVE  RECE62-FTNMONEY(2) TO  WRK-CHK-KOKIGAK8
             END-IF
           END-IF
      *
           IF  RECE62-KOUREI-SAIKEI2 = 999999999
             MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI2
             MOVE    1     TO   RECE62-SAIKEIZEROKSI2
           END-IF
           ADD      WRK-CHK-KOKIGAK8
                           TO   RECE62-KOUREI-SAIKEI2
      *
           .
       2104691-SAIKEIKIN-KASAN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の括弧再掲（下）金額加算２
      *****************************************************************
       2104692-SAIKEIKIN-KASAN3-SEC               SECTION.
      *
           MOVE     ZERO     TO   IDY7 
           PERFORM  VARYING  IDY5  FROM  2  BY  1 
                     UNTIL  (IDY5                    >   5  ) 
                      OR    (RECE62-KOHNUM(IDY5 - 1) = SPACE) 
             ADD     1       TO   IDY7 
             IF  ( RECE62-EKF-SAIKEIKSI(IDY5) = "1"      )
             OR  ((RECE62-EKF-SAIKEIKSI(IDY5) = "4"     ) AND
                  (RECE62-SRYYM              >= "202301"))
               MOVE       ZERO     TO   FLG-CHECK-OK 
               MOVE       ZERO     TO   WRK-KASANKIN 
               PERFORM  VARYING  IDY6  FROM  1  BY  1 
                          UNTIL (IDY6                  >  10 ) 
                           OR   (RECE62-HKNCOMBI(IDY6) = ZERO) 
                 IF  (RECE62-KOHNUM(IDY5 - 1) = 
                                       RECE62-KOHNUMHC(IDY6 2)) 
                 AND (RECE62-KOHID (IDY5 - 1) = 
                                       RECE62-KOHIDHC (IDY6 2)) 
                   IF ((RECE62-KOHNUMHC(IDY6 1)(1:1) = "0"  ) AND 
                       (RECE62-KOHNUMHC(IDY6 1)  NOT = 
                                             "012" AND "025"))  
                   OR ((WRK-PREFNUM                  = "13" ) AND 
                       (RECE62-KOHNUMHC(IDY6 1)      = "151") AND 
                       (RECE62-SRYYM             >= "200905")) 
                   OR ((WRK-PREFNUM                  = "23" ) AND 
                       (RECE62-KOHNUMHC(IDY6 1)      = "191") AND 
                       (RECE62-SRYYM             >= "200910") AND
                       (RECE62-SRYYM             <= "201509"))
                   OR ((WRK-PREFNUM          = "23" OR "24" ) AND 
                       (RECE62-KOHNUMHC(IDY6 1)      = "152") AND 
                       (RECE62-SRYYM             >= "201104") AND 
                       (RECE62-SRYYM             <= "201412")) 
                     MOVE    1     TO   FLG-CHECK-OK 
                     IF   RECE62-EKF-KINGAKKSN(IDY5) = "1" 
                       COMPUTE WRK-KASANKIN = WRK-KASANKIN 
                                            + RECE62-KOHFTNKIN(IDY6 1) 
                     END-IF 
                   END-IF 
                 END-IF 
               END-PERFORM 
               IF    FLG-CHECK-OK  =  1 
                 EVALUATE    IDY5 
                   WHEN       3 
                         IF  RECE62-KOUREI-SAIKEI2 = 999999999
                           MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI2
                           MOVE    1     TO   RECE62-SAIKEIZEROKSI2
                         END-IF
                         ADD    WRK-KASANKIN
                                         TO   RECE62-KOUREI-SAIKEI2
                   WHEN       4 
                     EVALUATE  IDY7 
                       WHEN      2 
                         IF  RECE62-KOUREI-SAIKEI2 = 999999999
                           MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI2
                           MOVE    1     TO   RECE62-SAIKEIZEROKSI2
                         END-IF
                         ADD    WRK-KASANKIN
                                         TO   RECE62-KOUREI-SAIKEI2
                       WHEN      3 
                         IF  RECE62-KOUREI-SAIKEI3 = 999999999
                           MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI3
                           MOVE    1     TO   RECE62-SAIKEIZEROKSI3
                         END-IF
                         ADD    WRK-KASANKIN
                                         TO   RECE62-KOUREI-SAIKEI3
                     END-EVALUATE 
                   WHEN       5 
                     EVALUATE  IDY7 
                       WHEN      2 
                         IF  RECE62-KOUREI-SAIKEI2 = 999999999
                           MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI2
                           MOVE    1     TO   RECE62-SAIKEIZEROKSI2
                         END-IF
                         ADD    WRK-KASANKIN
                                         TO   RECE62-KOUREI-SAIKEI2
                       WHEN      3 
                         IF  RECE62-KOUREI-SAIKEI3 = 999999999
                           MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI3
                           MOVE    1     TO   RECE62-SAIKEIZEROKSI3
                         END-IF
                         ADD    WRK-KASANKIN
                                         TO   RECE62-KOUREI-SAIKEI3
                       WHEN      4 
                         IF  RECE62-KOUREI-SAIKEI4 = 999999999
                           MOVE   ZERO   TO   RECE62-KOUREI-SAIKEI4
                           MOVE    1     TO   RECE62-SAIKEIZEROKSI4
                         END-IF
                         ADD    WRK-KASANKIN
                                         TO   RECE62-KOUREI-SAIKEI4
                     END-EVALUATE 
                 END-EVALUATE 
               END-IF 
             END-IF 
           END-PERFORM 
      *
           .
       2104692-SAIKEIKIN-KASAN3-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費併用時の地方公費一部負担金編集
      *****************************************************************
       21046A-CHIHO-ICHIBUFTN-HEN-SEC               SECTION.
      *
           IF  (((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025"))  OR
                ( TBL-TOKATUKAIFLG(1)   =  1              ))
           AND (RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
           AND (TBL-TOKATUKAIFLG(2)    = ZERO              )
           AND (RECE62-TOTALTEN(2)  = RECE62-HENTOTALTEN(3))
            MOVE   1   TO   IDX38
            MOVE   2   TO   IDX39
            PERFORM  21046A1-CHIHO-ICHIBUFTN-HE1-SEC
            IF    FLG-OK = ZERO
             IF   (WRK-TAIHI-FTNMONEY-EN2(2) =
                                     WRK-TAIHI-FTNMONEY-EN2(3))
             AND  (WRK-TAIHI-FTNMONEY-EN2(2) NOT = ZERO       )
             AND  (RECE62-FTNMONEY(2)        NOT = ZERO       )
                MOVE  RECE62-FTNMONEY(2)     TO  RECE62-FTNMONEY(3)
                MOVE  RECE62-FTNMONEY-KOJ(2) TO  RECE62-FTNMONEY-KOJ(3)
             END-IF
             IF    RECE62-FTNMONEY(2)            = ZERO
             AND   RECE62-FTNMONEY-KOJ(2)        = ZERO
                MOVE  ZERO                   TO  RECE62-FTNMONEY(3)
                                                 RECE62-FTNMONEY-KOJ(3)
             END-IF
            END-IF
           END-IF
      *
           .
       21046A-CHIHO-ICHIBUFTN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費併用時の地方公費一部負担金編集
      *****************************************************************
       21046A1-CHIHO-ICHIBUFTN-HE1-SEC               SECTION.
      *
           MOVE    ZERO   TO   FLG-OK
           IF   RECE62-HKNCOMBI(2)  =  ZERO
            CONTINUE
           ELSE
            PERFORM  VARYING  IDX37  FROM  1  BY  1
                      UNTIL  (IDX37                  >  10 )
                       OR    (RECE62-HKNCOMBI(IDX37) = ZERO)
                       OR    (FLG-OK                 =  1  )
             IF ((RECE62-KOHNUMHC(IDX37 1) =  RECE62-KOHNUM(IDX38)) AND
                 (RECE62-KOHIDHC (IDX37 1) =  RECE62-KOHID (IDX38)))
             OR ((RECE62-KOHNUMHC(IDX37 2) =  RECE62-KOHNUM(IDX38)) AND
                 (RECE62-KOHIDHC (IDX37 2) =  RECE62-KOHID (IDX38)))
             OR ((RECE62-KOHNUMHC(IDX37 3) =  RECE62-KOHNUM(IDX38)) AND
                 (RECE62-KOHIDHC (IDX37 3) =  RECE62-KOHID (IDX38)))
             OR ((RECE62-KOHNUMHC(IDX37 4) =  RECE62-KOHNUM(IDX38)) AND
                 (RECE62-KOHIDHC (IDX37 4) =  RECE62-KOHID (IDX38)))
              IF ((RECE62-KOHNUMHC(IDX37 1) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 1) =  RECE62-KOHID (IDX39)))
              OR ((RECE62-KOHNUMHC(IDX37 2) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 2) =  RECE62-KOHID (IDX39)))
              OR ((RECE62-KOHNUMHC(IDX37 3) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 3) =  RECE62-KOHID (IDX39)))
              OR ((RECE62-KOHNUMHC(IDX37 4) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 4) =  RECE62-KOHID (IDX39)))
                CONTINUE
              ELSE
                MOVE   1   TO   FLG-OK
              END-IF
             ELSE
              IF ((RECE62-KOHNUMHC(IDX37 1) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 1) =  RECE62-KOHID (IDX39)))
              OR ((RECE62-KOHNUMHC(IDX37 2) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 2) =  RECE62-KOHID (IDX39)))
              OR ((RECE62-KOHNUMHC(IDX37 3) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 3) =  RECE62-KOHID (IDX39)))
              OR ((RECE62-KOHNUMHC(IDX37 4) =  RECE62-KOHNUM(IDX39)) AND
                  (RECE62-KOHIDHC (IDX37 4) =  RECE62-KOHID (IDX39)))
                MOVE   1   TO   FLG-OK
              END-IF
             END-IF
            END-PERFORM
           END-IF
      *
           .
       21046A1-CHIHO-ICHIBUFTN-HE1-EXT.
           EXIT.
      *
      *****************************************************************
      *    収納データ（本収納）を元にした一部負担金置換
      *****************************************************************
       21046B-CHIHO-SYUNOU-CHECK-SEC               SECTION.
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY7-AREA
           MOVE      "71"              TO  LNK-DAY7-IRAI
           MOVE      RECE62-SRYYM      TO  LNK-DAY7-YM
           CALL      "ORCSDAY"         USING   STS-AREA-DAY
                                               LNK-DAY7-AREA
           MOVE      LNK-DAY7-KOYOMI   TO  WRK-EDYMD
      *
           MOVE      ZERO    TO    FLG-SAINYUUIN-ARI
           MOVE      ZERO    TO    FLG-SYUNOUEDYMD-ARI
           MOVE      ZERO    TO    WRK-NRRK-CHECK-RRKNUM
           MOVE      SPACE   TO    WRK-NRRK-CHECK-NYUINYMD
           MOVE      SPACE   TO    WRK-NRRK-CHECK-TEIKIYMD
           MOVE      SPACE   TO    WRK-NRRK-CHECK-TEIKIYMD2
           INITIALIZE              WRK-SYUNOU-CHECK-T
      *
           PERFORM   21046B1-CHIHO-SYUNOU-CHECK1-SEC
      *
           IF   FLG-SAINYUUIN-ARI   =   1
             INITIALIZE                        SYUNOU-REC
             MOVE    RECE62-HOSPNUM     TO     SYU-HOSPNUM
             MOVE    RECE62-NYUGAIKBN   TO     SYU-NYUGAIKBN
             MOVE    RECE62-PTID        TO     SYU-PTID
             MOVE    RECE62-SRYYM       TO     SYU-SRYYMD(1:6)
             MOVE    "__"               TO     SYU-SRYYMD(7:2)
             MOVE    SYUNOU-REC         TO     MCPDATA-REC
             MOVE    "tbl_syunou"       TO     MCP-TABLE
             MOVE    "key14"            TO     MCP-PATHNAME
             PERFORM  900-DBSELECT-SEC
             IF      MCP-RC             =      ZERO
               MOVE    "tbl_syunou"     TO     MCP-TABLE
               MOVE    "key14"          TO     MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
               PERFORM  UNTIL   FLG-SYUNOU  =   1
                 PERFORM VARYING IDX1 FROM 1 BY 1
                          UNTIL (IDX1                  >  10 )
                           OR   (RECE62-HKNCOMBI(IDX1) = ZERO)
                   IF  SYU-DENPJTIKBN   NOT =  "3"
                     IF    SYU-SKYEDYMD     =  WRK-EDYMD
                       MOVE    1        TO     FLG-SYUNOUEDYMD-ARI
                     END-IF
                     IF   (WRK-NRRK-CHECK-TEIKIYMD = SPACE       )
                     OR   (WRK-NRRK-CHECK-TEIKIYMD < SYU-SKYEDYMD)
                       MOVE    SYU-SKYEDYMD
                                        TO     WRK-NRRK-CHECK-TEIKIYMD
                     END-IF
                     IF    SYU-HKNCOMBINUM  =  RECE62-HKNCOMBI(IDX1)
                       PERFORM   21046B2-CHIHO-SYUNOU-CHECK2-SEC
                       MOVE    10       TO     IDX1
                     END-IF
                   ELSE
                     MOVE      10       TO     IDX1
                   END-IF
                 END-PERFORM
                 MOVE    "tbl_syunou"   TO     MCP-TABLE
                 MOVE    "key14"        TO     MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
               END-PERFORM
             END-IF
             MOVE    "tbl_syunou"       TO     MCP-TABLE
             MOVE    "key14"            TO     MCP-PATHNAME
             PERFORM  900-CLOSE-SEC
      *
             IF  (WRK-NRRK-CHECK-NYUINYMD  NOT = SPACE)
             AND (FLG-SYUNOUEDYMD-ARI          = ZERO )
               PERFORM   21046B3-CHIHO-SYUNOU-CHECK3-SEC
             END-IF
             PERFORM     21046B4-CHIHO-SYUNOU-CHECK4-SEC
           END-IF
      *
           .
       21046B-CHIHO-SYUNOU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    該当診療年月の入退院情報取得
      *****************************************************************
       21046B1-CHIHO-SYUNOU-CHECK1-SEC               SECTION.
      *
           INITIALIZE                     PTNYUINRRK-REC
           MOVE    RECE62-HOSPNUM     TO  PTNYUINRRK-HOSPNUM
           MOVE    RECE62-PTID        TO  PTNYUINRRK-PTID
           MOVE    RECE62-SRYYM       TO  PTNYUINRRK-NYUINYMD(1:6)
           MOVE    "31"               TO  PTNYUINRRK-NYUINYMD(7:2)
           MOVE    RECE62-SRYYM       TO  PTNYUINRRK-TAIINYMD(1:6)
           MOVE    "01"               TO  PTNYUINRRK-TAIINYMD(7:2)
           MOVE    PTNYUINRRK-REC     TO  MCPDATA-REC
           MOVE    "tbl_ptnyuinrrk"   TO  MCP-TABLE
           MOVE    "key23"            TO  MCP-PATHNAME
           PERFORM  900-DBSELECT-SEC
           IF      MCP-RC             =   ZERO
             MOVE      "tbl_ptnyuinrrk"     TO  MCP-TABLE
             MOVE      "key23"              TO  MCP-PATHNAME
             PERFORM    900-PTNYUINRRK-READ-SEC
             PERFORM    UNTIL  FLG-PTNYUINRRK  =  1
               IF    PTNYUINRRK-JTIKBN  = "1"
                 IF  WRK-NRRK-CHECK-RRKNUM  =  ZERO
                   MOVE  PTNYUINRRK-RRKNUM  TO  WRK-NRRK-CHECK-RRKNUM
                 ELSE
                   IF  PTNYUINRRK-RRKNUM  NOT = WRK-NRRK-CHECK-RRKNUM
                     MOVE    1              TO  FLG-SAINYUUIN-ARI
                   END-IF
                 END-IF
      *
                 IF  WRK-NRRK-CHECK-NYUINYMD  =  SPACE
                   IF  (PTNYUINRRK-NYUINYMD(1:6) = RECE62-SRYYM)
                   AND (PTNYUINRRK-TAIINYMD      = "99999999"  )
                     MOVE    PTNYUINRRK-NYUINYMD
                                            TO  WRK-NRRK-CHECK-NYUINYMD
                   END-IF
                 END-IF
               END-IF
               MOVE    "tbl_ptnyuinrrk"     TO  MCP-TABLE
               MOVE    "key23"              TO  MCP-PATHNAME
               PERFORM  900-PTNYUINRRK-READ-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_ptnyuinrrk"   TO  MCP-TABLE
           MOVE    "key23"            TO  MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
       21046B1-CHIHO-SYUNOU-CHECK1-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求点数と一部負担金の集計
      *****************************************************************
       21046B2-CHIHO-SYUNOU-CHECK2-SEC               SECTION.
      *
           PERFORM VARYING IDX43 FROM 1 BY 1
                    UNTIL  IDX43  >   4
             IF RECE62-KOHNUMHC(IDX1 IDX43) = "361" OR "363"
               IF  (RECE62-KOHNUMHC(IDX1 IDX43) = RECE62-KOHNUM(1))
               AND (RECE62-KOHIDHC (IDX1 IDX43) = RECE62-KOHID(1) )
                 PERFORM VARYING IDX44 FROM 1 BY 1
                          UNTIL (IDX44                 >   4  )
                           OR   (SYU-KOH-HKNNUM(IDX44) = SPACE)
                   IF RECE62-KOHNUM(1) = SYU-KOH-HKNNUM(IDX44)
                     ADD SYU-TOTAL-HKNTEN TO WRK-SYUNOU-CHECK-HKNTEN(1)
                     ADD SYU-KOH-COMPFTN(IDX44)
                                          TO WRK-SYUNOU-CHECK-KIN(1)
                     MOVE   4             TO IDX44
                   END-IF
                 END-PERFORM
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 IDX43) = RECE62-KOHNUM(2))
               AND (RECE62-KOHIDHC (IDX1 IDX43) = RECE62-KOHID(2) )
                 PERFORM VARYING IDX44 FROM 1 BY 1
                          UNTIL (IDX44                 >   4  )
                           OR   (SYU-KOH-HKNNUM(IDX44) = SPACE)
                   IF RECE62-KOHNUM(2) = SYU-KOH-HKNNUM(IDX44)
                     ADD SYU-TOTAL-HKNTEN TO WRK-SYUNOU-CHECK-HKNTEN(2)
                     ADD SYU-KOH-COMPFTN(IDX44)
                                          TO WRK-SYUNOU-CHECK-KIN(2)
                     MOVE   4             TO IDX44
                   END-IF
                 END-PERFORM
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 IDX43) = RECE62-KOHNUM(3))
               AND (RECE62-KOHIDHC (IDX1 IDX43) = RECE62-KOHID(3) )
                 PERFORM VARYING IDX44 FROM 1 BY 1
                          UNTIL (IDX44                 >   4  )
                           OR   (SYU-KOH-HKNNUM(IDX44) = SPACE)
                   IF RECE62-KOHNUM(3) = SYU-KOH-HKNNUM(IDX44)
                     ADD SYU-TOTAL-HKNTEN TO WRK-SYUNOU-CHECK-HKNTEN(3)
                     ADD SYU-KOH-COMPFTN(IDX44)
                                          TO WRK-SYUNOU-CHECK-KIN(3)
                     MOVE   4             TO IDX44
                   END-IF
                 END-PERFORM
               END-IF
               IF  (RECE62-KOHNUMHC(IDX1 IDX43) = RECE62-KOHNUM(4))
               AND (RECE62-KOHIDHC (IDX1 IDX43) = RECE62-KOHID(4) )
                 PERFORM VARYING IDX44 FROM 1 BY 1
                          UNTIL (IDX44                 >   4  )
                           OR   (SYU-KOH-HKNNUM(IDX44) = SPACE)
                   IF RECE62-KOHNUM(4) = SYU-KOH-HKNNUM(IDX44)
                     ADD SYU-TOTAL-HKNTEN TO WRK-SYUNOU-CHECK-HKNTEN(4)
                     ADD SYU-KOH-COMPFTN(IDX44)
                                          TO WRK-SYUNOU-CHECK-KIN(4)
                     MOVE   4             TO IDX44
                   END-IF
                 END-PERFORM
               END-IF
             END-IF
           END-PERFORM
      *
           .
       21046B2-CHIHO-SYUNOU-CHECK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    未退院分の収納データ作成
      *****************************************************************
       21046B3-CHIHO-SYUNOU-CHECK3-SEC               SECTION.
      *
           IF     WRK-NRRK-CHECK-TEIKIYMD   NOT = SPACE
             INITIALIZE                           STS-AREA-DAY
             INITIALIZE                           LNK-DAY6-AREA
             MOVE    "61"                     TO  LNK-DAY6-IRAI
             MOVE    WRK-NRRK-CHECK-TEIKIYMD  TO  LNK-DAY6-KIJUN
             MOVE    "1"                      TO  LNK-DAY6-ZOGENPTN
             MOVE     1                       TO  LNK-DAY6-ZOGEN
             CALL    "ORCSDAY"                USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
             MOVE    LNK-DAY6-KEISAN   TO   WRK-NRRK-CHECK-TEIKIYMD2
             IF  (WRK-NRRK-CHECK-TEIKIYMD2  NOT = SPACE             )
             AND (WRK-NRRK-CHECK-NYUINYMD < WRK-NRRK-CHECK-TEIKIYMD2)
               MOVE  WRK-NRRK-CHECK-TEIKIYMD2
                                       TO   WRK-NRRK-CHECK-NYUINYMD
             END-IF
           END-IF
      *
           INITIALIZE                    LNK-ORCS02-REC
                                         LNK-SYUNOU-REC-T
                                         LNK-SYUDAY-REC-T
      *
           MOVE    RECE62-HOSPNUM    TO  LNK-S02-HOSPNUM
           MOVE    RECE62-NYUGAIKBN  TO  LNK-S02-NYUGAIKBN
           MOVE    RECE62-PTID       TO  LNK-S02-PTID
           MOVE    WRK-NRRK-CHECK-NYUINYMD
                                     TO  LNK-S02-SKYSTYMD
           MOVE    WRK-EDYMD         TO  LNK-S02-SKYEDYMD
           MOVE    "A"               TO  LNK-S02-TEIKI-KBN
           MOVE    WRK-EDYMD         TO  LNK-S02-SYSYMD
           MOVE    "2"               TO  LNK-S02-SYORI-KBN
      *
           CALL    "ORCSNYUFTN"      USING
                                     SPA-AREA
                                     LNK-ORCS02-REC
                                     LNK-SYUNOU-REC-T
                                     LNK-SYUDAY-REC-T
      *
      *    仮収納出力処理
           IF      LNK-S02-RC  =  ZERO
             PERFORM VARYING IDX42 FROM 1 BY 1
                      UNTIL (IDX42                   >   10  )
                       OR   (LNK-SYU-SKYSTYMD(IDX42) =  SPACE)
               MOVE   LNK-SYUNOU-REC(IDX42)  TO  SYUNOU-REC
               PERFORM VARYING IDX1 FROM 1 BY 1
                        UNTIL (IDX1                  >  10 )
                         OR   (RECE62-HKNCOMBI(IDX1) = ZERO)
                 IF   SYU-HKNCOMBINUM  =  RECE62-HKNCOMBI(IDX1)
                   PERFORM   21046B2-CHIHO-SYUNOU-CHECK2-SEC
                   MOVE    10         TO  IDX1
                 END-IF
               END-PERFORM
             END-PERFORM
           ELSE
             DISPLAY   "SKYSTYMD="     WRK-NRRK-CHECK-NYUINYMD
             DISPLAY   "SKYEDYMD="     WRK-EDYMD
             DISPLAY   "LNK-S02-RC="   LNK-S02-RC
           END-IF
      *
           .
       21046B3-CHIHO-SYUNOU-CHECK3-EXT.
           EXIT.
      *
      *****************************************************************
      *    一部負担金置換
      *****************************************************************
       21046B4-CHIHO-SYUNOU-CHECK4-SEC               SECTION.
      *
           IF   RECE62-KOHNUM(1) =  "361" OR "363"
             IF   RECE62-HENTOTALTEN(2) =  WRK-SYUNOU-CHECK-HKNTEN(1)
               IF   RECE62-FTNMONEY(2)  NOT = WRK-SYUNOU-CHECK-KIN(1)
                 MOVE WRK-SYUNOU-CHECK-KIN(1) TO RECE62-FTNMONEY(2)
                                                 RECE62-FTNMONEY-KOJ(2)
                 DISPLAY  "<MIE1 FTNMONEY OKIKAE>"
               END-IF
             ELSE
                 MOVE      1      TO     FLG-SYUNOUTENSU-NG
                 DISPLAY  "<MIE1 SYUNOU NOT TOTALTEN>"
             END-IF
           END-IF
      *
           IF   RECE62-KOHNUM(2) =  "361" OR "363"
             IF   RECE62-HENTOTALTEN(3) =  WRK-SYUNOU-CHECK-HKNTEN(2)
               IF   RECE62-FTNMONEY(3)  NOT = WRK-SYUNOU-CHECK-KIN(2)
                 MOVE WRK-SYUNOU-CHECK-KIN(2) TO RECE62-FTNMONEY(3)
                                                 RECE62-FTNMONEY-KOJ(3)
                 DISPLAY  "<MIE2 FTNMONEY OKIKAE>"
               END-IF
             ELSE
                 MOVE      1      TO     FLG-SYUNOUTENSU-NG
                 DISPLAY  "<MIE2 SYUNOU NOT TOTALTEN>"
             END-IF
           END-IF
      *
           IF   RECE62-KOHNUM(3) =  "361" OR "363"
             IF   RECE62-HENTOTALTEN(4) =  WRK-SYUNOU-CHECK-HKNTEN(3)
               IF   RECE62-FTNMONEY(4)  NOT = WRK-SYUNOU-CHECK-KIN(3)
                 MOVE WRK-SYUNOU-CHECK-KIN(3) TO RECE62-FTNMONEY(4)
                                                 RECE62-FTNMONEY-KOJ(4)
                 DISPLAY  "<MIE3 FTNMONEY OKIKAE>"
               END-IF
             ELSE
                 MOVE      1      TO     FLG-SYUNOUTENSU-NG
                 DISPLAY  "<MIE3 SYUNOU NOT TOTALTEN>"
             END-IF
           END-IF
      *
           IF   RECE62-KOHNUM(4) =  "361" OR "363"
             IF   RECE62-HENTOTALTEN(5) =  WRK-SYUNOU-CHECK-HKNTEN(4)
               IF   RECE62-FTNMONEY(5)  NOT = WRK-SYUNOU-CHECK-KIN(4)
                 MOVE WRK-SYUNOU-CHECK-KIN(4) TO RECE62-FTNMONEY(5)
                                                 RECE62-FTNMONEY-KOJ(5)
                 DISPLAY  "<MIE4 FTNMONEY OKIKAE>"
               END-IF
             ELSE
                 MOVE      1      TO     FLG-SYUNOUTENSU-NG
                 DISPLAY  "<MIE4 SYUNOU NOT TOTALTEN>"
             END-IF
           END-IF
      *
           .
       21046B4-CHIHO-SYUNOU-CHECK4-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費が２つ以上あり、全国公費併用分のいずれかに
      *    長期が含まれているパターン（チェック金額・点数等の編集）
      *    ・全国公費が２つ以上
      *    ・全国公費が２つ以上、主＋長
      *    ・全国公費が２つ以上、主＋地＋長
      *    ・全国公費が２つ以上、主＋地
      *    ・全国公費が２つ以上、主＋長と主＋地＋長
      *    （補足）
      *    202301以前は、主＋長、主＋地＋長、主＋地が含まれる想定無し
      *    202301以降は、主＋長のみ、主＋地＋長のみ、主＋地のみ、
      *                  主＋長と主＋地＋長が含まれる想定有り
      *                  （主＋地＋長と主＋地、主＋長と主＋地が
      *                    含まれる想定無し）
      *****************************************************************
       21046C-CYOKI-MIXPAT-HEN-SEC               SECTION.
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO)
           AND  (FLG-XX6-TUUKA       =   ZERO)
           AND  (FLG-XX11-TUUKA      =   ZERO)
           AND  (FLG-XX8-TUUKA       =   ZERO)
           AND  (FLG-XX3-TUUKA   NOT =   ZERO)
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE    WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU2
             MOVE    WRK-KOH-GAI-GEN70-TEN5
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      *      全国公費併用でない長期併用分の点数
      **>    IF  RECE62-SRYYM  >=  "202301"
               ADD   WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      **>    END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO)
           AND  (FLG-XX6-TUUKA   NOT =   ZERO)
           AND  (FLG-XX11-TUUKA      =   ZERO)
           AND  (FLG-XX8-TUUKA   NOT =   ZERO)
           AND  (FLG-XX3-TUUKA       =   ZERO)
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE    FTN-KOH-XX8  TO   FTN-KOH-XXX
             MOVE    WRK-KOH-GAI-GEN70-TEN8
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      *
             MOVE    WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU4
             MOVE    WRK-KOH-GAI-GEN70-TEN6
                                  TO   WRK-KOH-GAI-GEN70-TEN3
      *      全国公費併用でない長期併用分の点数
      **>    IF  RECE62-SRYYM  >=  "202301"
               ADD   WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN3
      **>    END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO   )
           AND  (FLG-XX6-TUUKA       =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX3-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE    FTN-KOH-XX8  TO   FTN-KOH-XXX
             MOVE    WRK-KOH-GAI-GEN70-TEN8
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      *
             MOVE    WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU10
             MOVE    WRK-KOH-GAI-GEN70-TEN11
                                  TO   WRK-KOH-GAI-GEN70-TEN10
      *      全国公費併用でない長期併用分の点数
             ADD     WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN10
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO)
           AND  (FLG-XX6-TUUKA   NOT =   ZERO)
           AND  (FLG-XX11-TUUKA      =   ZERO)
           AND  (FLG-XX8-TUUKA       =   ZERO)
           AND  (FLG-XX3-TUUKA       =   ZERO)
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE      WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU2
             COMPUTE   WRK-KOH-GAI-GEN70-TEN1  =
                       WRK-KOH-GAI-GEN70-TEN5  +
                       WRK-KOH-GAI-GEN70-TEN6
      *      全国公費併用でない長期併用分の点数
      **>    IF  RECE62-SRYYM  >=  "202301"
               ADD   WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      **>    END-IF
      *
             MOVE      9999999    TO   WRK-KINGAKU-GENBUTU4
             MOVE      ZERO       TO   WRK-KOH-GAI-GEN70-TEN3
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX6-TUUKA       =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA       =   ZERO   )
           AND  (FLG-XX3-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE      WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU2
             COMPUTE   WRK-KOH-GAI-GEN70-TEN1  =
                       WRK-KOH-GAI-GEN70-TEN5  +
                       WRK-KOH-GAI-GEN70-TEN11
      *      全国公費併用でない長期併用分の点数
             ADD     WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      *
             MOVE      9999999    TO   WRK-KINGAKU-GENBUTU10
             MOVE      ZERO       TO   WRK-KOH-GAI-GEN70-TEN10
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO   )
           AND  (FLG-XX6-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX3-TUUKA       =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE    FTN-KOH-XX8  TO   FTN-KOH-XXX
             MOVE    WRK-KOH-GAI-GEN70-TEN8
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      *
             MOVE      WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU4
             COMPUTE   WRK-KOH-GAI-GEN70-TEN3  =
                       WRK-KOH-GAI-GEN70-TEN6  +
                       WRK-KOH-GAI-GEN70-TEN11
      *      全国公費併用でない長期併用分の点数
             ADD     WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN3
      *
             MOVE      9999999    TO   WRK-KINGAKU-GENBUTU10
             MOVE      ZERO       TO   WRK-KOH-GAI-GEN70-TEN10
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX6-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA       =   ZERO   )
           AND  (FLG-XX3-TUUKA       =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE      5          TO   FLG-JYOGENKBN2
      *
             MOVE      WRK-CYOKI-JGNGAK
                                  TO   WRK-KINGAKU-GENBUTU2
             COMPUTE   WRK-KOH-GAI-GEN70-TEN1  =
                       WRK-KOH-GAI-GEN70-TEN5  +
                       WRK-KOH-GAI-GEN70-TEN6  +
                       WRK-KOH-GAI-GEN70-TEN11
      *      全国公費併用でない長期併用分の点数
             ADD     WRK-KOH-GAI-GEN70-TEN9
                                  TO   WRK-KOH-GAI-GEN70-TEN1
      *
             MOVE      9999999    TO   WRK-KINGAKU-GENBUTU4
             MOVE      ZERO       TO   WRK-KOH-GAI-GEN70-TEN3
             MOVE      9999999    TO   WRK-KINGAKU-GENBUTU10
             MOVE      ZERO       TO   WRK-KOH-GAI-GEN70-TEN10
           END-IF
      *
           .
       21046C-CYOKI-MIXPAT-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費が２つ以上あり、全国公費併用分のいずれかに
      *    長期が含まれているパターン（再掲等の編集）
      *    ・全国公費が２つ以上
      *    ・全国公費が２つ以上、主＋長
      *    ・全国公費が２つ以上、主＋地＋長
      *    ・全国公費が２つ以上、主＋地
      *    ・全国公費が２つ以上、主＋長と主＋地＋長
      *    （補足）
      *    202301以前は、主＋長、主＋地＋長、主＋地が含まれる想定無し
      *    202301以降は、主＋長のみ、主＋地＋長のみ、主＋地のみ、
      *                  主＋長と主＋地＋長が含まれる想定有り
      *                  （主＋地＋長と主＋地、主＋長と主＋地が
      *                    含まれる想定無し）
      *****************************************************************
       21046D-CYOKI-MIXPAT-HEN2-SEC               SECTION.
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO)
           AND  (FLG-XX6-TUUKA   NOT =   ZERO)
           AND  (FLG-XX11-TUUKA      =   ZERO)
           AND  (FLG-XX8-TUUKA       =   ZERO)
           AND  (FLG-XX3-TUUKA       =   ZERO)
           AND  (FLG-XX10-TUUKA      =   ZERO)
             MOVE   FTN-KOH-XX5   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX6   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             IF  RECE62-SRYYM  >= "202301"
               COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                          + FTN-KOH-XX4
                                          + FTN-KOH-XX2
                                          + FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                          + FTN-KOH-XX6
                                          + FTN-KOH-XX7
               IF    FLG-XX4-TUUKA   NOT = ZERO
                 MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI3
                 MOVE    1            TO  RECE62-SAIKEIZEROKSI3
               ELSE
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                   MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI3
                   MOVE  1            TO  RECE62-SAIKEIZEROKSI3
                 END-IF
               END-IF
               IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX5
                 IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX6
                   MOVE  WRK-CYOKI-KEISAN3
                                   TO   RECE62-KOUREI-SAIKEI2
                   IF  (FLG-XX7-TUUKA      NOT = ZERO)
                   AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                      MOVE  ZERO   TO   RECE62-KOUREI-SAIKEI3
                   END-IF
                 ELSE
                   COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                             - FTN-KOH-XX5
                                             - FTN-KOH-XX6
                   IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                   AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                   AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                     MOVE  WRK-CYOKI-KEISAN3
                                   TO   RECE62-KOUREI-SAIKEI3
                   END-IF
                 END-IF
               END-IF
             ELSE
      **>      COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
      **>                                 + WRK-KINGAKU-TOK1
      **>      COMPUTE WRK-CYOKI-KEISAN   = WRK-KINGAKU-TOK1
      **>      COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
      **>                                 + FTN-KOH-XX6
               COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                          + FTN-KOH-XX4
                                          + FTN-KOH-XX2
                                          + FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                          + FTN-KOH-XX6
                                          + FTN-KOH-XX7
      *
               IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX5
                 IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX6
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI2
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX6-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX11-TUUKA      =   ZERO   )
           AND  (FLG-XX8-TUUKA       =   ZERO   )
           AND  (FLG-XX3-TUUKA       =   ZERO   )
           AND  (FLG-XX10-TUUKA  NOT =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX5   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX6   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX10  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX10
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                        + FTN-KOH-XX6
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX5
               IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX6
                 MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI2
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                    MOVE  ZERO   TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               ELSE
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX5
                                           - FTN-KOH-XX6
                 IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                 AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO)
           AND  (FLG-XX6-TUUKA       =   ZERO)
           AND  (FLG-XX11-TUUKA      =   ZERO)
           AND  (FLG-XX8-TUUKA       =   ZERO)
           AND  (FLG-XX3-TUUKA   NOT =   ZERO)
           AND  (FLG-XX10-TUUKA      =   ZERO)
             MOVE   FTN-KOH-XX5   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX3   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             IF  RECE62-SRYYM  >= "202301"
               COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                          + FTN-KOH-XX3
                                          + FTN-KOH-XX4
                                          + FTN-KOH-XX2
                                          + FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                          + FTN-KOH-XX7
               IF    FLG-XX4-TUUKA   NOT = ZERO
                 MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI3
                 MOVE    1            TO  RECE62-SAIKEIZEROKSI3
               ELSE
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                   MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI3
                   MOVE  1            TO  RECE62-SAIKEIZEROKSI3
                 END-IF
               END-IF
               IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX5
                 IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                 AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI3
                 END-IF
               END-IF
             ELSE
      **>      COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
      **>                                 + FTN-KOH-XX5
      **>                                 + FTN-KOH-XX3
               COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                          + FTN-KOH-XX3
                                          + FTN-KOH-XX4
                                          + FTN-KOH-XX2
                                          + FTN-KOH-XX12
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX6-TUUKA       =   ZERO   )
           AND  (FLG-XX11-TUUKA      =   ZERO   )
           AND  (FLG-XX8-TUUKA       =   ZERO   )
           AND  (FLG-XX3-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX10-TUUKA  NOT =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX5   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX3   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX10  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX3
                                        + FTN-KOH-XX10
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX5
               IF  (FLG-XX7-TUUKA      NOT = ZERO    )
               AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
               AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                 MOVE  WRK-CYOKI-KEISAN3
                               TO   RECE62-KOUREI-SAIKEI4
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO)
           AND  (FLG-XX6-TUUKA   NOT =   ZERO)
           AND  (FLG-XX11-TUUKA      =   ZERO)
           AND  (FLG-XX8-TUUKA   NOT =   ZERO)
           AND  (FLG-XX3-TUUKA       =   ZERO)
           AND  (FLG-XX10-TUUKA      =   ZERO)
             MOVE   FTN-KOH-XX8   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX6   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             IF  RECE62-SRYYM  >= "202301"
               COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                          + FTN-KOH-XX8
                                          + FTN-KOH-XX4
                                          + FTN-KOH-XX2
                                          + FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
               COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX6
                                          + FTN-KOH-XX7
               IF    FLG-XX4-TUUKA   NOT = ZERO
                 MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI3
                 MOVE    1            TO  RECE62-SAIKEIZEROKSI3
               ELSE
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                   MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI3
                   MOVE  1            TO  RECE62-SAIKEIZEROKSI3
                 END-IF
               END-IF
               IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX6
                 IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                 AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI3
                 END-IF
               END-IF
             ELSE
      **>      COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
      **>                                 + FTN-KOH-XX8
      **>                                 + FTN-KOH-XX6
               COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                          + FTN-KOH-XX8
                                          + FTN-KOH-XX4
                                          + FTN-KOH-XX2
                                          + FTN-KOH-XX12
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO   )
           AND  (FLG-XX6-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX11-TUUKA      =   ZERO   )
           AND  (FLG-XX8-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX3-TUUKA       =   ZERO   )
           AND  (FLG-XX10-TUUKA  NOT =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX8   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX6   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX10  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX8
                                        + FTN-KOH-XX10
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX6
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX6
               IF  (FLG-XX7-TUUKA      NOT = ZERO    )
               AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
               AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                 MOVE  WRK-CYOKI-KEISAN3
                               TO   RECE62-KOUREI-SAIKEI4
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO   )
           AND  (FLG-XX6-TUUKA       =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX3-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX8   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX3   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX11  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX8
                                        + FTN-KOH-XX3
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX11
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX11
               IF  (FLG-XX7-TUUKA      NOT = ZERO    )
               AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
               AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                 MOVE  WRK-CYOKI-KEISAN3
                               TO   RECE62-KOUREI-SAIKEI4
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX6-TUUKA       =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA       =   ZERO   )
           AND  (FLG-XX3-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX5   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX3   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX11  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX3
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                        + FTN-KOH-XX11
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX5
               IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX11
                 MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI3
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                    MOVE  ZERO   TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               ELSE
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX5
                                           - FTN-KOH-XX11
                 IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                 AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA       =   ZERO   )
           AND  (FLG-XX6-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX3-TUUKA       =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX8   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX6   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX11  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX8
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX6
                                        + FTN-KOH-XX11
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX6
               IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX11
                 MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI3
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                    MOVE  ZERO   TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               ELSE
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX6
                                           - FTN-KOH-XX11
                 IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                 AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   (FLG-XX5-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX6-TUUKA   NOT =   ZERO   )
           AND  (FLG-XX11-TUUKA  NOT =   ZERO   )
           AND  (FLG-XX8-TUUKA       =   ZERO   )
           AND  (FLG-XX3-TUUKA       =   ZERO   )
           AND  (FLG-XX10-TUUKA      =   ZERO   )
           AND  (RECE62-SRYYM       >=  "202301")
             MOVE   FTN-KOH-XX5   TO  RECE62-KOUREI-SAIKEI
             MOVE   FTN-KOH-XX6   TO  RECE62-KOUREI-SAIKEI2
             MOVE   1             TO  RECE62-SAIKEIZEROKSI2
             MOVE   FTN-KOH-XX11  TO  RECE62-KOUREI-SAIKEI3
             MOVE   1             TO  RECE62-SAIKEIZEROKSI3
             COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                        + FTN-KOH-XX4
                                        + FTN-KOH-XX2
                                        + FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN   = FTN-KOH-XX12
             COMPUTE WRK-CYOKI-KEISAN2  = FTN-KOH-XX5
                                        + FTN-KOH-XX6
                                        + FTN-KOH-XX11
                                        + FTN-KOH-XX7
             IF    FLG-XX4-TUUKA   NOT = ZERO
               MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI4
               MOVE    1            TO  RECE62-SAIKEIZEROKSI4
             ELSE
               IF  (FLG-XX7-TUUKA      NOT = ZERO)
               AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                 MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI4
                 MOVE  1            TO  RECE62-SAIKEIZEROKSI4
               END-IF
             END-IF
             IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
               COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                         - FTN-KOH-XX5
               IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX6
                 MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI2
                 MOVE     ZERO   TO   RECE62-KOUREI-SAIKEI3
                 IF  (FLG-XX7-TUUKA      NOT = ZERO)
                 AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                    MOVE  ZERO   TO   RECE62-KOUREI-SAIKEI4
                 END-IF
               ELSE
                 COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                           - FTN-KOH-XX5
                                           - FTN-KOH-XX6
                 IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX11
                   MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI3
                   IF  (FLG-XX7-TUUKA      NOT = ZERO)
                   AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
                      MOVE  ZERO TO   RECE62-KOUREI-SAIKEI4
                   END-IF
                 ELSE
                   COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                             - FTN-KOH-XX5
                                             - FTN-KOH-XX6
                                             - FTN-KOH-XX11
                   IF  (FLG-XX7-TUUKA      NOT = ZERO    )
                   AND (FLG-ZENKOKUKOHI-NISYU  =  2      )
                   AND (WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7)
                     MOVE  WRK-CYOKI-KEISAN3
                                 TO   RECE62-KOUREI-SAIKEI4
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       21046D-CYOKI-MIXPAT-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費が２つあり、全国公費併用分に長期が含まれていない
      *    パターン（再掲等の編集）
      *    ・全国公費が２つ、主＋長
      *    ・全国公費が２つ、主＋地＋長
      *    ・全国公費が２つ、主＋長と主＋地＋長
      *    （補足）
      *      主＋長のみ、主＋地＋長のみ、
      *      主＋長と主＋地＋長が含まれる想定有り
      *      （主＋地＋長と主＋地、主＋長と主＋地が含まれる想定無し）
      *****************************************************************
       21046E-CYOKI-MIXPAT-HEN3-SEC               SECTION.
      *
           MOVE   FTN-KOH-XX8   TO  RECE62-KOUREI-SAIKEI
           MOVE   FTN-KOH-XX3   TO  RECE62-KOUREI-SAIKEI2
           MOVE   1             TO  RECE62-SAIKEIZEROKSI2
           COMPUTE RECE62-FTNMONEY(1) = WRK-KOH-GAI2
                                      + FTN-KOH-XX8
                                      + FTN-KOH-XX3
      ***                             + FTN-KOH-XX4
      ***                             + FTN-KOH-XX2
                                      + FTN-KOH-XX12
      ***  IF    FLG-XX4-TUUKA   NOT = ZERO
      ***    MOVE    FTN-KOH-XX4  TO  RECE62-KOUREI-SAIKEI3
      ***    MOVE    1            TO  RECE62-SAIKEIZEROKSI3
      ***  ELSE
             IF  (FLG-XX7-TUUKA      NOT = ZERO)
             AND (FLG-ZENKOKUKOHI-NISYU  =  2  )
               MOVE  FTN-KOH-XX7  TO  RECE62-KOUREI-SAIKEI3
               MOVE  1            TO  RECE62-SAIKEIZEROKSI3
             END-IF
      ***  END-IF
      *
           .
       21046E-CYOKI-MIXPAT-HEN3-EXT.
           EXIT.
      *
      *****************************************************************
      *    ０１０（感３７の２）の一部負担金編集
      *****************************************************************
       21046F-KANSEN-FTNMONEY-HEN-SEC               SECTION.
      *
           IF  (FLG-KOH           =   2   )
           AND (RECE62-KOHNUM(1)  =  "010")
             COMPUTE RECE62-FTNMONEY(2)     =
                     RECE62-FTNMONEY(2)     - WRK-KOH-GAI
             COMPUTE RECE62-FTNMONEY-KOJ(2) =
                     RECE62-FTNMONEY-KOJ(2) - WRK-KOH-GAI
             COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                       - RECE62-KOUREI-SAIKEI
             ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(2)
                                      RECE62-FTNMONEY-KOJ(2)
           END-IF
      *
           IF  (FLG-KOH           =   2   )
           AND (RECE62-KOHNUM(2)  =  "010")
             COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                       - RECE62-KOUREI-SAIKEI2
             ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(3)
                                      RECE62-FTNMONEY-KOJ(3)
           END-IF
      *
           IF  (FLG-KOH           =   2   )
           AND (RECE62-KOHNUM(3)  =  "010")
             COMPUTE WRK-CYOKI-KEISAN3 = RECE62-FTNMONEY(1)
                                       - RECE62-KOUREI-SAIKEI3
             ADD WRK-CYOKI-KEISAN3 TO RECE62-FTNMONEY(4)
                                      RECE62-FTNMONEY-KOJ(4)
           END-IF
      *
           .
       21046F-KANSEN-FTNMONEY-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費請求分データ編集
      *****************************************************************
       21046G-KOHSKYDATA-HENSYU-SEC               SECTION.
      *
           PERFORM  VARYING  IDX34  FROM  1  BY  1
                     UNTIL   IDX34    >  10
             EVALUATE   WRK-KOHSKY-XXX-FLG(IDX34)
               WHEN         1
                 MOVE     1   TO   WRK-KOHSKY-XXX-FLG-RUI1
               WHEN         2
                 MOVE     1   TO   WRK-KOHSKY-XXX-FLG-RUI2
             END-EVALUATE
             EVALUATE   WRK-KOHSKY-XXX-SKJFLG(IDX34)
               WHEN         1
                 MOVE     1   TO   WRK-KOHSKY-XXX-SKJFLG-RUI1
               WHEN         2
                 MOVE     1   TO   WRK-KOHSKY-XXX-SKJFLG-RUI2
             END-EVALUATE
           END-PERFORM
      *
           IF   (WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO)
           AND  (WRK-KOHSKY-XXX-FLG-RUI2  =   1  )
             CONTINUE
           ELSE
      *      マル長併用時（複数の保険組み合わせがある場合）は未対応
             IF   WRK-KOHSKY-XXX-CYOKIFLG  =   1
             AND  RECE62-HKNCOMBI(2)   NOT =  ZERO
               MOVE   1           TO  FLG-SKYIRYO-KOHFTN
             ELSE
               COMPUTE  WRK-SAIKEI-TAIHI = FTN-KOH-XXX
                                         + FTN-KOH-XX3
                                         + FTN-KOH-XX10
               COMPUTE   WRK-KOHSKY-XXX-COMPFTN-EN-RUI9 =
                         WRK-KOHSKY-XXX-COMPFTN-EN-RUI  +
                         0.9
             END-IF
           END-IF
      *
           .
       21046G-KOHSKYDATA-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    再掲クリア
      *****************************************************************
       21046H-SAIKEI-CLEAR-SEC               SECTION.
      *
           MOVE     ZERO    TO    RECE62-KOUREI-SAIKEI
                                  RECE62-KOUREI-SAIKEI2
                                  RECE62-KOUREI-SAIKEI3
                                  RECE62-KOUREI-SAIKEI4
                                  RECE62-SAIKEIZEROKSI1
                                  RECE62-SAIKEIZEROKSI2
                                  RECE62-SAIKEIZEROKSI3
                                  RECE62-SAIKEIZEROKSI4
      *
           .
       21046H-SAIKEI-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    生保の公費給付対象額編集
      *****************************************************************
       21046J-SEIHO-KINGAKU-HENSYU-SEC               SECTION.
      *
           IF   (RECE62-KOHNUM(1)(1:1)  = "0"                )
           AND  (RECE62-KOHNUM(1)   NOT = "012" AND "025"    )
           AND  (RECE62-KOHNUM(2)       = "012" OR "025"     )
           AND  (RECE62-KOHNUM(3)       =  SPACE             )
           AND  (RECE62-KOHNUM(4)       =  SPACE             )
           AND  (FLG-XX3-TUUKA      NOT =  ZERO              )
           AND  (WRK-TAIHI-TOTALTEN     =  RECE62-TOTALTEN(3))
             IF    WRK-KOGAKU-TAISYOGAI(1) =  1
               MOVE  WRK-TAIHI-FTNMONEY2(2)  TO  WRK-KEISAN11
             ELSE
               MOVE  RECE62-FTNMONEY(2)      TO  WRK-KEISAN11
             END-IF
      *
             COMPUTE  WRK-KEISAN12 = FTN-KOH-XX3 + WRK-KEISAN11
             IF  WRK-KINGAKU-GENBUTU4  <  WRK-KEISAN12
               IF     RECE62-KOUREI  =  "3"
                 MOVE   "2"   TO   RECE62-KOUREI
               END-IF
               IF     WRK-MADOGUCHI-KOUREI  =  "4"
                 MOVE   "1"   TO   WRK-MADOGUCHI-KOUREI
               END-IF
               COMPUTE  WRK-KEISAN13 = WRK-KEISAN12
                                     - WRK-KINGAKU-GENBUTU4
               IF  FTN-KOH-XX3  >=  WRK-KEISAN13
                 COMPUTE  RECE62-FTNMONEY(1) = RECE62-FTNMONEY(1)
                                             - WRK-KEISAN13
                 COMPUTE  FTN-KOH-XX3 = FTN-KOH-XX3 - WRK-KEISAN13
                 COMPUTE  WRK-KOH-GAI = WRK-KOH-GAI - WRK-KEISAN13
               ELSE
                 COMPUTE  RECE62-FTNMONEY(1) = RECE62-FTNMONEY(1)
                                             - FTN-KOH-XX3
                 MOVE     ZERO     TO   FTN-KOH-XX3
                 COMPUTE  WRK-KOH-GAI = WRK-KOH-GAI - FTN-KOH-XX3
               END-IF
             END-IF
           END-IF
      *
           IF   (RECE62-KOHNUM(1)(1:1)  = "0"                )
           AND  (RECE62-KOHNUM(1)   NOT = "012" AND "025"    )
           AND  (RECE62-KOHNUM(2)(1:1)  = "0"                )
           AND  (RECE62-KOHNUM(2)   NOT = "012" AND "025"    )
           AND  (RECE62-KOHNUM(3)       = "012" OR  "025"    )
           AND  (RECE62-KOHNUM(4)       =  SPACE             )
           AND  (FLG-XX10-TUUKA     NOT =  ZERO              )
           AND  (WRK-TAIHI-TOTALTEN     =  RECE62-TOTALTEN(4))
             IF    WRK-KOGAKU-TAISYOGAI(1) =  1
               MOVE  WRK-TAIHI-FTNMONEY2(2)  TO  WRK-KEISAN11
             ELSE
               MOVE  RECE62-FTNMONEY(2)      TO  WRK-KEISAN11
             END-IF
             IF    WRK-KOGAKU-TAISYOGAI(2) =  1
               MOVE  WRK-TAIHI-FTNMONEY2(3)  TO  WRK-KEISAN112
             ELSE
               MOVE  RECE62-FTNMONEY(3)      TO  WRK-KEISAN112
             END-IF
      *
             COMPUTE  WRK-KEISAN12 = FTN-KOH-XX10 + WRK-KEISAN11
                                                  + WRK-KEISAN112
             IF  WRK-KINGAKU-GENBUTU10  <  WRK-KEISAN12
               IF     RECE62-KOUREI  =  "3"
                 MOVE   "2"   TO   RECE62-KOUREI
               END-IF
               IF     WRK-MADOGUCHI-KOUREI  =  "4"
                 MOVE   "1"   TO   WRK-MADOGUCHI-KOUREI
               END-IF
               COMPUTE  WRK-KEISAN13 = WRK-KEISAN12
                                     - WRK-KINGAKU-GENBUTU10
               IF  FTN-KOH-XX10  >=  WRK-KEISAN13
                 COMPUTE  RECE62-FTNMONEY(1) = RECE62-FTNMONEY(1)
                                             - WRK-KEISAN13
                 COMPUTE  FTN-KOH-XX10 = FTN-KOH-XX10 - WRK-KEISAN13
                 COMPUTE  WRK-KOH-GAI  = WRK-KOH-GAI  - WRK-KEISAN13
               ELSE
                 COMPUTE  RECE62-FTNMONEY(1) = RECE62-FTNMONEY(1)
                                             - FTN-KOH-XX10
                 MOVE     ZERO     TO   FTN-KOH-XX10
                 COMPUTE  WRK-KOH-GAI = WRK-KOH-GAI - FTN-KOH-XX10
               END-IF
             END-IF
           END-IF
      *
           .
       21046J-SEIHO-KINGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトの公費チェック
      *****************************************************************
       21046K-RECE-KOHI-CHECK-SEC               SECTION.
      *
           IF ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (  RECE62-KOHNUM(2)      =  SPACE           ) AND
               (  RECE62-KOHNUM(3)      =  SPACE           ) AND
               (  RECE62-KOHNUM(4)      =  SPACE           ) AND
               (  RECE62-SRYYM         >= "200804"         ))
           OR ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (((RECE62-KOHNUM(2)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(2)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)   =  1              )) AND
               (  RECE62-KOHNUM(3)      =  SPACE           ) AND
               (  RECE62-KOHNUM(4)      =  SPACE           ) AND
               (  RECE62-SRYYM         >= "202301"         ))
           OR ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (((RECE62-KOHNUM(2)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(2)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)   =  1              )) AND
               (((RECE62-KOHNUM(3)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(3)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(3)   =  1              )) AND
               (  RECE62-KOHNUM(4)      =  SPACE           ) AND
               (  RECE62-SRYYM         >= "202301"         ))
      *
             MOVE        1     TO   WRK-RECE-KOHI-CHECK1
             IF   WRK-JYOGENKBN-TEN2 NOT = ZERO
               IF ((WRK-JYOGENKBN-TEN21 NOT = ZERO          ) AND
                   (WRK-JYOGENKBN-TEN21 = RECE62-TOTALTEN(2)))
               OR ((WRK-JYOGENKBN-TEN22 NOT = ZERO          ) AND
                   (WRK-JYOGENKBN-TEN22 = RECE62-TOTALTEN(3)))
               OR ((WRK-JYOGENKBN-TEN23 NOT = ZERO          ) AND
                   (WRK-JYOGENKBN-TEN23 = RECE62-TOTALTEN(4)))
                 MOVE    1     TO   WRK-RECE-KOHI-CHECK1X
                 PERFORM 21046K1-RECE-KOHI-CHECK8-SEC
               END-IF
             END-IF
      *
             PERFORM     21046K2-RECE-KOHI-CHECK9-SEC
      *
           END-IF
      *
           IF ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (  RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(2)   =  ZERO            ) AND
               (  RECE62-KOHNUM(3)      =  SPACE           ) AND
               (  RECE62-KOHNUM(4)      =  SPACE           ) AND
               (  RECE62-SRYYM         >= "200804"         ))
           OR ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (((RECE62-KOHNUM(2)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(2)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)   =  1              )) AND
               (  RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(3)   =  ZERO            ) AND
               (  RECE62-KOHNUM(4)      =  SPACE           ) AND
               (  RECE62-SRYYM         >= "202301"         ))
           OR ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (((RECE62-KOHNUM(2)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(2)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)   =  1              )) AND
               (((RECE62-KOHNUM(3)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(3)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(3)   =  1              )) AND
               (  RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(4)   =  ZERO            ) AND
               (  RECE62-SRYYM         >= "202301"         ))
           OR ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (  RECE62-KOHNUM(2)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(2)   =  ZERO            ) AND
               (  RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(3)   =  ZERO            ) AND
               (  RECE62-KOHNUM(4)      =  SPACE           ) AND
               (  WRK-JYOGENKBN-TEN72   NOT =  ZERO        ) AND
               (  WRK-JYOGENKBN-TEN73       =  ZERO        ) AND
               (  FLG-ZENKOKUKOHI-NISYU4X   =  1           ) AND
               (  RECE62-SRYYM         >= "202301"         ))
           OR ((((RECE62-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(1)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)   =  1              )) AND
               (((RECE62-KOHNUM(2)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(2)  NOT = "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)   =  1              )) AND
               (  RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(3)   =  ZERO            ) AND
               (  RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
               (  TBL-TOKATUKAIFLG(4)   =  ZERO            ) AND
               (  WRK-JYOGENKBN-TEN73   NOT =  ZERO        ) AND
               (  WRK-JYOGENKBN-TEN74       =  ZERO        ) AND
               (  FLG-ZENKOKUKOHI-NISYU4Y   =  1           ) AND
               (  RECE62-SRYYM         >= "202301"         ))
      *
             MOVE        1     TO   WRK-RECE-KOHI-CHECK2
             IF   WRK-JYOGENKBN-TEN2 NOT = ZERO
               IF ((WRK-JYOGENKBN-TEN21 NOT = ZERO          ) AND
                   (WRK-JYOGENKBN-TEN21 = RECE62-TOTALTEN(2)))
               OR ((WRK-JYOGENKBN-TEN22 NOT = ZERO          ) AND
                   (WRK-JYOGENKBN-TEN22 = RECE62-TOTALTEN(3)))
               OR ((WRK-JYOGENKBN-TEN23 NOT = ZERO          ) AND
                   (WRK-JYOGENKBN-TEN23 = RECE62-TOTALTEN(4)))
                 MOVE    1     TO   WRK-RECE-KOHI-CHECK2X
                 PERFORM 21046K1-RECE-KOHI-CHECK8-SEC
               END-IF
             END-IF
      *
             PERFORM     21046K2-RECE-KOHI-CHECK9-SEC
      *
           END-IF
      *
           .
       21046K-RECE-KOHI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトの公費チェック
      *****************************************************************
       21046K1-RECE-KOHI-CHECK8-SEC               SECTION.
      *
           IF  (WRK-JYOGENKBN-TEN21 NOT = ZERO          )
           AND (WRK-JYOGENKBN-TEN21 = RECE62-TOTALTEN(2))
             IF   (RECE62-KOUREI           = "2")
             AND  (WRK-KOGAKU-TAISYOGAI(1) =  1 )
               ADD WRK-TAIHI-FTNMONEY2(2) TO WRK-RECE-KOHI-CHKKIN
             ELSE
               ADD RECE62-FTNMONEY(2)     TO WRK-RECE-KOHI-CHKKIN
             END-IF
           END-IF
           IF  (WRK-JYOGENKBN-TEN22 NOT = ZERO          )
           AND (WRK-JYOGENKBN-TEN22 = RECE62-TOTALTEN(3))
             IF   (RECE62-KOUREI           = "2")
             AND  (WRK-KOGAKU-TAISYOGAI(2) =  1 )
               ADD WRK-TAIHI-FTNMONEY2(3) TO WRK-RECE-KOHI-CHKKIN
             ELSE
               ADD RECE62-FTNMONEY(3)     TO WRK-RECE-KOHI-CHKKIN
             END-IF
           END-IF
           IF  (WRK-JYOGENKBN-TEN23 NOT = ZERO          )
           AND (WRK-JYOGENKBN-TEN23 = RECE62-TOTALTEN(4))
             IF   (RECE62-KOUREI           = "2")
             AND  (WRK-KOGAKU-TAISYOGAI(3) =  1 )
               ADD WRK-TAIHI-FTNMONEY2(4) TO WRK-RECE-KOHI-CHKKIN
             ELSE
               ADD RECE62-FTNMONEY(4)     TO WRK-RECE-KOHI-CHKKIN
             END-IF
           END-IF
      *
           .
       21046K1-RECE-KOHI-CHECK8-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトの公費チェック
      *****************************************************************
       21046K2-RECE-KOHI-CHECK9-SEC               SECTION.
      *
           IF   ((RECE62-KOHNUM(3)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(3)  NOT = "012" AND "025"))
           OR   ( TBL-TOKATUKAIFLG(3)   =  1              )
                MOVE    3    TO   WRK-RECE-KOHI-FLG
           ELSE
             IF ((RECE62-KOHNUM(2)(1:1) = "0"            ) AND
                 (RECE62-KOHNUM(2)  NOT = "012" AND "025"))
             OR ( TBL-TOKATUKAIFLG(2)   =  1              )
                MOVE    2    TO   WRK-RECE-KOHI-FLG
             ELSE
                MOVE    1    TO   WRK-RECE-KOHI-FLG
             END-IF
           END-IF
      *
           MOVE   RECE62-FTNMONEY(2) TO  WRK-RECE-KOHI-FTNMONEY2
           MOVE   RECE62-FTNMONEY(3) TO  WRK-RECE-KOHI-FTNMONEY3
           MOVE   RECE62-FTNMONEY(4) TO  WRK-RECE-KOHI-FTNMONEY4
      *
           .
       21046K2-RECE-KOHI-CHECK9-EXT.
           EXIT.
      *
      *****************************************************************
      *    食事略称編集
      *****************************************************************
       21047-SKJ-RAYKU-HENSYU-SEC               SECTION.
      *
           PERFORM  VARYING  ID1    FROM    1   BY  1
                     UNTIL   ID1      >     4
      *
               IF  RECE62-SHOKUJIKHNNISSU(ID1)   =   ZERO
                   CONTINUE
               ELSE
                   EVALUATE   ID1
                     WHEN      1
                       MOVE   "１"    TO   RECE62-SHOKUJISYUBETU(1)
                     WHEN      2
                       MOVE   "２"    TO   RECE62-SHOKUJISYUBETU(1)
                     WHEN      3
                       MOVE   "特別"  TO   RECE62-SHOKUJISYUBETU(2)
                     WHEN      4
                       MOVE   "食堂"  TO   RECE62-SHOKUJISYUBETU(3)
                   END-EVALUATE
               END-IF
      *
           END-PERFORM
      *
           IF    RECE62-SHOKUJIKHNNISSU(1)      =  ZERO
           AND   RECE62-SHOKUJIKHNNISSU(2)  NOT =  ZERO
               MOVE    RECE62-SHOKUJIKHNNISSU(2)
                              TO  RECE62-SHOKUJIKHNNISSU(1)
               MOVE    RECE62-SHOKUJIKHNRYO(2)
                              TO  RECE62-SHOKUJIKHNRYO(1)
      *
               MOVE    ZERO   TO  RECE62-SHOKUJIKHNNISSU(2)
                                  RECE62-SHOKUJIKHNRYO(2)
           END-IF
      *
           .
       21047-SKJ-RAYKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者高額現物給付対象者の所得区分編集
      *****************************************************************
       2104M-KOUREI-GENBUTU-HENSYU-SEC      SECTION.
      *
           IF   (RECE62-HKNNUM  = "002"            )
           AND  (RECE62-HOJOKBN = "1" OR "2" OR "3")
             INITIALIZE                    PTHKNINF-REC
             MOVE    RECE62-HOSPNUM    TO  PTHKN-HOSPNUM
             MOVE    RECE62-PTID       TO  PTHKN-PTID
             MOVE    RECE62-HKNID      TO  PTHKN-HKNID
             MOVE    PTHKNINF-REC      TO  MCPDATA-REC
             PERFORM 900-PTHKNINF-INV-SEC
             IF      FLG-PTHKNINF      =   ZERO
               MOVE  PTHKN-HOJOKBN     TO  WRK-SENIN-HOJOKBN
             END-IF
           END-IF
      *
           IF  ( RECE62-KYURATE =  30               )
           OR  ((RECE62-HKNNUM  = "002"            ) AND
                (RECE62-HOJOKBN = "G" OR "H" OR "I"))
           OR  ((RECE62-HKNNUM  = "031" OR "032" OR
                                  "033" OR "034"   ) AND
                (RECE62-HOJOKBN = "H"              ))
           OR  ((RECE62-HKNNUM  = "002"            ) AND
                (WRK-SENIN-HOJOKBN
                                = "G" OR "H" OR "I"))
             MOVE     1      TO      FLG-KOUREI-GENEKIKBN
      *
             MOVE     RECE62-SRYYM            TO   WRK-GEN70-YM
             IF   RECE62-TEKSTYMD(1:6)    >=  RECE62-SRYYM
               MOVE   RECE62-TEKSTYMD(7:2)    TO   WRK-GEN70-DD
             ELSE
               MOVE   01                      TO   WRK-GEN70-DD
             END-IF
      *
             MOVE     RECE62-SRYYM            TO   WRK-GEN702-YM
             IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
               MOVE   RECE62-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
             ELSE
               MOVE   01                      TO   WRK-GEN702-DD
             END-IF
      *
             INITIALIZE                       PTKOHINF-REC
             MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
             MOVE    RECE62-PTID          TO  PTKOH-PTID
             MOVE    "946"                TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM  900-DBSELECT-SEC
             IF      MCP-RC  =  ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key14"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL  FLG-PTKOHINF  =  1
                 IF ((PTKOH-TEKSTYMD  <=  WRK-GEN70-YMD ) AND
                     (WRK-GEN70-YMD   <=  PTKOH-TEKEDYMD) AND
                     (PTKOH-SAKJOKBN   =  SPACE         ))
                 OR ((PTKOH-TEKSTYMD  <=  WRK-GEN702-YMD) AND
                     (WRK-GEN702-YMD  <=  PTKOH-TEKEDYMD) AND
                     (PTKOH-SAKJOKBN   =  SPACE         ))
                   IF  (PTKOH-JKYSNUM(1:2) = "２")
                   OR  (PTKOH-JKYSNUM(1:1) = "2" )
                       MOVE    2   TO  FLG-KOUREI-GENEKIKBN
                   ELSE
                     IF  (PTKOH-JKYSNUM(1:2) = "１")
                     OR  (PTKOH-JKYSNUM(1:1) = "1" )
                       MOVE    3   TO  FLG-KOUREI-GENEKIKBN
                     ELSE
                       MOVE    1   TO  FLG-KOUREI-GENEKIKBN
                     END-IF
                   END-IF
                   MOVE     1      TO  FLG-PTKOHINF
                 ELSE
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key14"            TO  MCP-PATHNAME
                   PERFORM  900-PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM  900-CLOSE-SEC
           ELSE
             IF  RECE62-TEISYOTOKU  =  SPACE
               MOVE   4   TO   FLG-KOUREI-GENEKIKBN
             ELSE
               MOVE   5   TO   FLG-KOUREI-GENEKIKBN
             END-IF
           END-IF
      *
           .
       2104M-KOUREI-GENBUTU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者高額現物給付対象者の判定
      *****************************************************************
       21048-KOUREI-GENBUTU-HANTEI-SEC      SECTION.
      *
      *    一般経過措置対象者
      *
           IF   (RECE62-SRYYM   >=  "200608")
           AND  (RECE62-SRYYM   <=  "200812")
           AND  (RECE62-KYURATE  =  20 OR 30)
             INITIALIZE                      PTKOHINF-REC
             MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
             MOVE    RECE62-PTID         TO  PTKOH-PTID
             MOVE    "978"               TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC        TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC  =  ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key4"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL  FLG-PTKOHINF  =  1
                 IF  (PTKOH-TEKSTYMD(1:6) <= RECE62-SRYYM       )
                 AND (RECE62-SRYYM        <= PTKOH-TEKEDYMD(1:6))
                 AND (PTKOH-SAKJOKBN       = SPACE              )
                   MOVE    "1"    TO  RECE62-RJNGENMENKBN
                   MOVE     1     TO  FLG-PTKOHINF
                 ELSE
                   MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                   MOVE    "key4"            TO  MCP-PATHNAME
                   PERFORM  900-PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM  900-CLOSE-SEC
           END-IF
      *
           IF   (RECE62-SRYYM   >=  "201204"   )
           AND  (RECE62-KYURATE  =   30        )
           AND  (RECE62-TEISYOTOKU  NOT = SPACE)
             MOVE    SPACE    TO      RECE62-TEISYOTOKU
           END-IF
      *    後期高齢者２割の方は低所得者ではない
           IF   (RECE62-SRYYM   >=  "202210"   )
           AND  (RECE62-HKNNUM   =  "039"      )
           AND  (RECE62-KYURATE  =   20        )
           AND  (RECE62-TEISYOTOKU  NOT = SPACE)
             MOVE    SPACE    TO      RECE62-TEISYOTOKU
           END-IF
      *
      *    高額４回目対象者の判定
           PERFORM   210481-KOHYONKAIME-HANTEI-SEC
      *
           IF    RECE62-SRYYM   >=  "201808"
             IF  (FLG-KISAIOK        =  ZERO )
             AND (FLG-KISAIOK2       =  ZERO )
             AND (WRK-SENIN-HOJOKBN  =  SPACE)
               MOVE    19   TO   FLG-TOKKI
               PERFORM   21013-TOKKI-HENSYU-SEC
             END-IF
           END-IF
      *
           .
       21048-KOUREI-GENBUTU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    高額４回目対象者の判定
      *****************************************************************
       210481-KOHYONKAIME-HANTEI-SEC      SECTION.
      *
           MOVE     RECE62-SRYYM            TO   WRK-GEN70-YM
           IF   RECE62-TEKSTYMD(1:6)    >=  RECE62-SRYYM
             MOVE   RECE62-TEKSTYMD(7:2)    TO   WRK-GEN70-DD
           ELSE
             MOVE   01                      TO   WRK-GEN70-DD
           END-IF
      *
           MOVE     RECE62-SRYYM            TO   WRK-GEN702-YM
           IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
             MOVE   RECE62-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
             MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE62-PTID          TO  PTKOH-PTID
           MOVE    "965"                TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM  900-DBSELECT-SEC
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key14"            TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL  FLG-PTKOHINF  =  1
               IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                   (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                   (PTKOH-SAKJOKBN   =   SPACE         ))
               OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                   (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                   (PTKOH-SAKJOKBN   =   SPACE         ))
                   MOVE     1      TO  FLG-KOHYONKAIME
                   MOVE     1      TO  FLG-PTKOHINF
               ELSE
                   MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                   MOVE    "key14"          TO  MCP-PATHNAME
                   PERFORM  900-PTKOHINF-READ-SEC
               END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       210481-KOHYONKAIME-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳未満高額現物給付対象者の判定
      *****************************************************************
       21049-GENBUTU70-HANTEI-SEC      SECTION.
      *
      *    ７０歳未満高額現物給付対象者
           MOVE      RECE62-SRYYM          TO   WRK-GEN70-YM
           IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
           ELSE
              MOVE   01                    TO   WRK-GEN70-DD
           END-IF
      *
           MOVE      RECE62-SRYYM            TO   WRK-GEN702-YM
           IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
              MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                      UNTIL   (GEN-IDX    >    TBL-GENBUTU70-MAX)
                        OR    (FLG-GENBUTU70   NOT = ZERO       )
                INITIALIZE                      PTKOHINF-REC
                MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    RECE62-PTID         TO  PTKOH-PTID
                MOVE    TBL-GENBUTU70(GEN-IDX)
                                            TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC        TO  MCPDATA-REC
                MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE    "key14"             TO  MCP-PATHNAME
                PERFORM   900-DBSELECT-SEC
                IF      MCP-RC               =       ZERO
                  MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                  MOVE    "key14"           TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                         (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                     OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                         (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                         EVALUATE   GEN-IDX
                           WHEN        1
                             MOVE    1   TO  FLG-GENBUTU70
                             IF  RECE62-SRYYM  >= "201501"
                              IF  PTKOH-JKYSNUM(1:2) = "イ"
                               MOVE  12  TO  FLG-GENBUTU70-KBN
                              ELSE
                               MOVE  11  TO  FLG-GENBUTU70-KBN
                              END-IF
                             END-IF
                             IF   (RECE62-SRYYM   >=  "201204"   )
                             AND  (RECE62-TEISYOTOKU  NOT = SPACE)
                               MOVE  SPACE  TO  RECE62-TEISYOTOKU
                             END-IF
                           WHEN        2
                             IF  RECE62-TEISYOTOKU  =  SPACE
                               MOVE  2   TO  FLG-GENBUTU70
                               IF  RECE62-SRYYM  >= "201501"
                                IF  PTKOH-JKYSNUM(1:2) = "エ"
                                 MOVE 22 TO  FLG-GENBUTU70-KBN
                                ELSE
                                 MOVE 21 TO  FLG-GENBUTU70-KBN
                                END-IF
                               END-IF
                             ELSE
                               MOVE  3   TO  FLG-GENBUTU70
                               IF  RECE62-SRYYM  >= "201501"
                                 MOVE 31 TO  FLG-GENBUTU70-KBN
                               END-IF
                             END-IF
                         END-EVALUATE
                         MOVE     1      TO  FLG-PTKOHINF
                     ELSE
                         MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                         MOVE    "key14"          TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                     END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE    "key14"             TO  MCP-PATHNAME
                PERFORM   900-CLOSE-SEC
           END-PERFORM
      *
           IF   (RECE62-HKNNUM   =  "002"                )
           AND  (RECE62-HOJOKBN  =  "1" OR "2" OR "3" OR
                                    "A" OR "B" OR "C" OR
                                    "D" OR "E" OR "F" OR
                                    "G" OR "H" OR "I"    )
                MOVE    ZERO           TO   FLG-GENBUTU70
                MOVE    ZERO           TO   FLG-GENBUTU70-KBN
           END-IF
           IF   (RECE62-HKNNUM   =  "031" OR "032" OR "033" OR "034")
           AND  (RECE62-HOJOKBN  =  "2" OR "B" OR "E" OR "H"        )
                MOVE    ZERO           TO   FLG-GENBUTU70
                MOVE    ZERO           TO   FLG-GENBUTU70-KBN
           END-IF
      *
           IF    FLG-GENBUTU70      =  ZERO
             IF  FLG-TOKUSITU   NOT =  ZERO
                MOVE    FLG-TOKUSITU   TO   FLG-GENBUTU70
                IF  RECE62-SRYYM   >=  "201501"
                  MOVE  FLG-TOKUSITU-KBN
                                       TO   FLG-GENBUTU70-KBN
                END-IF
                IF   (RECE62-SRYYM   >=  "201204"   )
                AND  (FLG-TOKUSITU    =   1         )
                AND  (RECE62-TEISYOTOKU  NOT = SPACE)
                  MOVE  SPACE  TO  RECE62-TEISYOTOKU
                END-IF
             END-IF
           END-IF
      *
           IF    FLG-GENBUTU70  =  ZERO
                MOVE    SPACE    TO     RECE62-KOUREI
           ELSE
      *         高額４回目対象者の判定
                PERFORM   210481-KOHYONKAIME-HANTEI-SEC
      *
                IF  FLG-KISAIOK   =  ZERO
                AND FLG-KISAIOK2  =  ZERO
                   IF  RECE62-SRYYM   >=  "201501"
                     MOVE   14    TO    FLG-TOKKI
                   ELSE
                     MOVE    5    TO    FLG-TOKKI
                   END-IF
                   PERFORM   21013-TOKKI-HENSYU-SEC
                END-IF
           END-IF
      *
           EVALUATE   FLG-GENBUTU70
             WHEN     1
               IF  RECE62-SRYYM   >=  "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      11
                     MOVE     "26"   TO    RECE62-DISCOUNTTENTNK
                   WHEN      12
                     MOVE     "27"   TO    RECE62-DISCOUNTTENTNK
                 END-EVALUATE
               ELSE
                 MOVE   "17"   TO    RECE62-DISCOUNTTENTNK
               END-IF
             WHEN     2
               IF  RECE62-SRYYM   >=  "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      21
                     MOVE     "28"   TO    RECE62-DISCOUNTTENTNK
                   WHEN      22
                     MOVE     "29"   TO    RECE62-DISCOUNTTENTNK
                 END-EVALUATE
               ELSE
                 MOVE   "18"   TO    RECE62-DISCOUNTTENTNK
               END-IF
             WHEN     3
               IF  RECE62-SRYYM   >=  "201501"
                 MOVE   "30"   TO    RECE62-DISCOUNTTENTNK
               ELSE
                 MOVE   "19"   TO    RECE62-DISCOUNTTENTNK
               END-IF
           END-EVALUATE
      *
           .
       21049-GENBUTU70-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患０５１チェック
      *****************************************************************
       2104B-TOKUTEISIKKAN-CHECK-SEC               SECTION.
      *
           INITIALIZE                TBL-DOTANDOKU
      *
           IF   ( WRK-PREFNUM         =  "01"     )
           AND  ( RECE62-SRYYM       >=  "200510" )
           AND  ( RECE62-SRYYM       <   "200810" )
             PERFORM   VARYING  IDX1    FROM    1   BY  1
                        UNTIL   IDX1      >     4
               IF  ( RECE62-KOHNUM(IDX1) =  "051"         )
               AND ((RECE62-KOHJKYSNUM(IDX1)(1:2) >= "91"
                                              AND <= "95") OR
                    (RECE62-KOHJKYSNUM(IDX1)(1:2) >= "71"
                                              AND <= "88"))
                   MOVE    1     TO    TBL-DOTANDOKU-FLG(IDX1)
               END-IF
             END-PERFORM
           END-IF
      *
           .
       2104B-TOKUTEISIKKAN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ０１公該当対象者の判定
      *****************************************************************
       2104J-ZEROKOGAITO-CHECK-SEC      SECTION.
      *
           MOVE      RECE62-SRYYM          TO   WRK-GEN70-YM
           IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
           ELSE
              MOVE   01                    TO   WRK-GEN70-DD
           END-IF
      *
           MOVE      RECE62-SRYYM            TO   WRK-GEN702-YM
           IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
              MOVE   RECE62-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
              MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
           MOVE    RECE62-PTID         TO  PTKOH-PTID
           MOVE    "955"               TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC        TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
           MOVE    "key4"              TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
             MOVE    "key4"            TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                    (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                    (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                    MOVE     1      TO  FLG-ZEROKOGAITO
                    MOVE     1      TO  FLG-PTKOHINF
                ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
           MOVE    "key4"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           IF   (RECE62-KOUREI      =  "1" OR "2"    )
           AND  (RECE62-KOHNUM(1)   =  SPACE         )
           AND  (RECE62-KOHNUM(2)   =  SPACE         )
           AND  (RECE62-KOHNUM(3)   =  SPACE         )
           AND  (RECE62-KOHNUM(4)   =  SPACE         )
           AND  (RECE62-HKNCOMBI(2) =  ZERO          )
           AND  (FLG-ZEROKOGAITO    =   1            )
             INITIALIZE                    HKNCOMBI-REC
             MOVE  RECE62-HOSPNUM      TO  COMB-HOSPNUM
             MOVE  RECE62-PTID         TO  COMB-PTID
             MOVE  RECE62-HKNCOMBI(1)  TO  COMB-HKNCOMBINUM
             MOVE  HKNCOMBI-REC        TO  MCPDATA-REC
             PERFORM 900-HKNCOMBI-INV-SEC
             IF    FLG-HKNCOMBI  =  ZERO
               IF  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM = SPACE                ) AND
                    (COMB-KOH3HKNNUM = SPACE                ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
               OR  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH3HKNNUM = SPACE                ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
               OR  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM = "972" OR "974"       ) AND
                    (COMB-KOH3HKNNUM = SPACE                ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
               OR  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH3HKNNUM = "972" OR "974"       ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO   FLG-ZEROKOGAITO
               END-IF
             ELSE
               MOVE     ZERO   TO   FLG-ZEROKOGAITO
             END-IF
           ELSE
             MOVE       ZERO   TO   FLG-ZEROKOGAITO
           END-IF
      *
           IF   FLG-ZEROKOGAITO   =   1
             MOVE   12    TO      FLG-TOKKI
             PERFORM   21013-TOKKI-HENSYU-SEC
           END-IF
      *
           .
       2104J-ZEROKOGAITO-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費２種チェック
      *****************************************************************
       2104C-ZENKOKUKOHI-NISYU-CHK-SEC               SECTION.
      *
           IF     (RECE62-SRYYM          >=  "200804")
           AND    (RECE62-HKNNUM      NOT =  SPACE   )
      *
      *      主＋全Ａ、主＋全Ｂ
             IF ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (((RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(3)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(3)       =  SPACE           ))  AND
                 (((RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(4)       =  SPACE           )))
      *      主＋全Ａ、主＋全Ｂ、主＋全Ｃ
             OR ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (((RECE62-KOHNUM(3)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(3)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(3)    =   1              ))  AND
                 (((RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE62-KOHNUM(4)       =  SPACE           ))  AND
                 (  RECE62-SRYYM          >=  "202301"         ))
      *
               MOVE       1               TO   FLG-ZENKOKUKOHI-NISYU
      *
               IF    RECE62-HKNCOMBI(2)   =   ZERO
                  MOVE    ZERO            TO   FLG-ZENKOKUKOHI-NISYU
               ELSE
                  IF ((RECE62-KOHNUM(3)(1:1)  =  "0"            ) AND
                      (RECE62-KOHNUM(3)   NOT =  "012" AND "025"))
                  OR ( TBL-TOKATUKAIFLG(3)    =   1              )
                    MOVE       1          TO   FLG-ZENKOKUKOHI-NISYU7
                    IF  (RECE62-KOHNUM(4)(1:1) >= "1" AND <= "8")
                    AND (TBL-TOKATUKAIFLG(4)    =  ZERO         )
                      MOVE     2          TO   FLG-ZENKOKUKOHI-NISYU7
                    END-IF
                  END-IF
                  IF    (RECE62-KOHNUM(3)(1:1) >= "1" AND <= "8")
                  AND   (TBL-TOKATUKAIFLG(3)    =  ZERO         )
                      MOVE     3          TO   FLG-ZENKOKUKOHI-NISYU7
                  END-IF
               END-IF
      *
             END-IF
      *
      *      主＋生保、主＋全
             IF (( RECE62-KOHNUM(1)(1:1)  =  "0"             )  AND
                 ( RECE62-KOHNUM(1)   NOT =  "012" AND "025" )  AND
                 ( RECE62-KOHNUM(2)       =  "012" OR  "025" )  AND
                 ( RECE62-KOHNUM(3)       =  SPACE           )  AND
                 ( RECE62-KOHNUM(4)       =  SPACE           ))
             OR (( RECE62-KOHNUM(1)(1:1)  =  "0"             )  AND
                 ( RECE62-KOHNUM(1)   NOT =  "012" AND "025" )  AND
                 ( RECE62-KOHNUM(2)(1:1)  =  "0"             )  AND
                 ( RECE62-KOHNUM(2)   NOT =  "012" AND "025" )  AND
                 ( RECE62-KOHNUM(3)       =  "012" OR  "025" )  AND
                 ( RECE62-KOHNUM(4)       =  SPACE           ))
             OR (( RECE62-KOHNUM(1)(1:1)  =  "0"             )  AND
                 ( RECE62-KOHNUM(1)   NOT =  "012" AND "025" )  AND
                 ( RECE62-KOHNUM(2)       =  "012" OR  "025" )  AND
                 ( RECE62-KOHNUM(3)       =  "012" OR  "025" )  AND
                 ( RECE62-KOHNUM(4)       =  SPACE           ))
             OR (( RECE62-KOHNUM(1)       =  "012" OR  "025" )  AND
                 ( RECE62-KOHNUM(2)       =  "012" OR  "025" )  AND
                 ( RECE62-KOHNUM(3)       =  SPACE           )  AND
                 ( RECE62-KOHNUM(4)       =  SPACE           ))
      *
               MOVE        1           TO     FLG-ZENKOKUKOHI-NISYU
               IF    RECE62-HKNCOMBI(2)   =   ZERO
                  MOVE     ZERO        TO     FLG-ZENKOKUKOHI-NISYU
               ELSE
                  PERFORM   VARYING  IDX1  FROM  1  BY  1
                             UNTIL  (IDX1                  >  10 )
                              OR    (RECE62-HKNCOMBI(IDX1) = ZERO)
                     IF ( RECE62-KOHNUMHC(IDX1 1) = "012" OR "025" )
                     OR ( RECE62-KOHNUMHC(IDX1 2) = "012" OR "025" )
                     OR ( RECE62-KOHNUMHC(IDX1 3) = "012" OR "025" )
                     OR ( RECE62-KOHNUMHC(IDX1 4) = "012" OR "025" )
                     OR ((RECE62-KOHNUMHC(IDX1 1) = SPACE) AND
                         (RECE62-KOHNUMHC(IDX1 2) = SPACE) AND
                         (RECE62-KOHNUMHC(IDX1 3) = SPACE) AND
                         (RECE62-KOHNUMHC(IDX1 4) = SPACE)         )
                       CONTINUE
                     ELSE
                       MOVE     5      TO     FLG-ZENKOKUKOHI-NISYU
      *
                       INITIALIZE                    HKNCOMBI-REC
                       MOVE RECE62-HOSPNUM        TO COMB-HOSPNUM
                       MOVE RECE62-PTID           TO COMB-PTID
                       MOVE RECE62-HKNCOMBI(IDX1) TO COMB-HKNCOMBINUM
                       MOVE HKNCOMBI-REC          TO MCPDATA-REC
                       PERFORM 900-HKNCOMBI-INV-SEC
                       IF   FLG-HKNCOMBI  =  ZERO
                         IF  (COMB-KOH1HKNNUM  =  "972")
                         OR  (COMB-KOH2HKNNUM  =  "972")
                         OR  (COMB-KOH3HKNNUM  =  "972")
                         OR  (COMB-KOH4HKNNUM  =  "972")
                           MOVE   1    TO     FLG-ZENKOKUKOHI-NISYU-SC
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
               END-IF
               IF    FLG-ZENKOKUKOHI-NISYU  =   1
                 IF  CNT-HKNCOMBI-KOHARI    >   1
                   MOVE     5          TO   FLG-ZENKOKUKOHI-NISYU
                   MOVE     1          TO   FLG-ZENKOKUKOHI-NISYU9
                 ELSE
                   MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                   IF   RECE62-SRYYM  >=  "202301"
                     MOVE   1          TO   FLG-ZENKOKUKOHI-NISYU8
                   END-IF
                 END-IF
               END-IF
      *
               IF    FLG-ZENKOKUKOHI-NISYU  =   5
                 IF   (RECE62-KOHNUM(3) = "012" OR "025")
                 AND  (RECE62-KOHNUM(4) = SPACE         )
                     MOVE   4          TO   FLG-ZENKOKUKOHI-NISYU7
                 END-IF
               END-IF
      *
             END-IF
      *
      *      主＋全＋地
             IF ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (  RECE62-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(2)    =  ZERO             ))
      *      主＋全＋全＋地
             OR ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (  RECE62-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(3)    =  ZERO             )  AND
                 (  RECE62-SRYYM          >=  "202301"         ))
      *      主＋全＋全＋全＋地
             OR ((((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (((RECE62-KOHNUM(3)(1:1)  =  "0"            ) AND
                   (RECE62-KOHNUM(3)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(3)    =   1              ))  AND
                 (  RECE62-KOHNUM(4)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(4)    =  ZERO             )  AND
                 (  RECE62-SRYYM          >=  "202301"         ))
      *
                 MOVE           1           TO   FLG-ZENKOKUKOHI-NISYU3
      *
                 IF   RECE62-KOUREI-HANTEIFLG   =  "1"
      *            保険欄の括弧再掲（下）記載（高齢者）
      *            主＋全＋地（＋長）（分点ありの場合）
                   IF  ( RECE62-EKF-KAK21KBN-K(3)  =  "1"      )
                   OR  ((RECE62-EKF-KAK21KBN-K(4)  =  "1"     ) AND
                        (RECE62-SRYYM             >=  "202301"))
                   OR  ((RECE62-EKF-KAK21KBN-K(5)  =  "1"     ) AND
                        (RECE62-SRYYM             >=  "202301"))
                     MOVE        2          TO   FLG-ZENKOKUKOHI-NISYU
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                        IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                          IF ( RECE62-EKF-KAK23KBN-K(3) =  "1"      )
                          OR ((RECE62-EKF-KAK23KBN-K(4) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                          OR ((RECE62-EKF-KAK23KBN-K(5) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        ELSE
                          IF ( RECE62-EKF-KAK22KBN-K(3) =  "1"      )
                          OR ((RECE62-EKF-KAK22KBN-K(4) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                          OR ((RECE62-EKF-KAK22KBN-K(5) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        END-IF
                     END-IF
                   END-IF
      *            保険欄の括弧再掲（下）金額計算（高齢者）
      *            主＋全＋地　　　　（分点ありの場合）
                   IF ( RECE62-EKF-KAK31KBN-K(3) =  "1"      )
                   OR ((RECE62-EKF-KAK31KBN-K(4) =  "1"     ) AND
                       (RECE62-SRYYM            >=  "202301"))
                   OR ((RECE62-EKF-KAK31KBN-K(5) =  "1"     ) AND
                       (RECE62-SRYYM            >=  "202301"))
                     IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                             CONTINUE
                     ELSE
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
      *
                     IF  (FLG-ZENKOKUKOHI-NISYU4   =   1 )
                     AND (RECE62-EKF-KAK31KBN-K(3) =  "1")
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4X
                     END-IF
                     IF  (FLG-ZENKOKUKOHI-NISYU4   =   1 )
                     AND (RECE62-EKF-KAK31KBN-K(4) =  "1")
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4Y
                     END-IF
                   END-IF
      *            保険欄の括弧再掲（下）金額計算（高齢者）
      *            主＋全＋地＋長　　（分点ありの場合）
                   IF  ( RECE62-EKF-KAK32KBN-K(3)  =  "1"      )
                     IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                             MOVE     2     TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                   END-IF
                   IF  ( RECE62-EKF-KAK32KBN-K(3)  =  "2"      )
                     IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                   END-IF
      *            保険欄の括弧再掲（下）金額加算（高齢者）
      *            主＋全＋地（＋長）（分点ありの場合）
                   IF  ( RECE62-EKF-KAK41KBN-K(3)  =  "1"      )
                     MOVE        2          TO   FLG-ZENKOKUKOHI-NISYU5
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU5
                        IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                          IF ( RECE62-EKF-KAK43KBN-K(3) =  "1"      )
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        ELSE
                          IF ( RECE62-EKF-KAK42KBN-K(3) =  "1"      )
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        END-IF
                     END-IF
      *              チェック用
                     IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                          IF ( RECE62-EKF-KAK43KBN-K(3) =  "1"      )
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5X
                          END-IF
                     ELSE
                          IF ( RECE62-EKF-KAK42KBN-K(3) =  "1"      )
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5X
                          END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF  ( RECE62-EKF-KAK21KBN-Y(3)  =  "1"      )
                   OR  ((RECE62-EKF-KAK21KBN-Y(4)  =  "1"     ) AND
                        (RECE62-SRYYM             >=  "202301"))
                   OR  ((RECE62-EKF-KAK21KBN-Y(5)  =  "1"     ) AND
                        (RECE62-SRYYM             >=  "202301"))
                     MOVE        2          TO   FLG-ZENKOKUKOHI-NISYU
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                        IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                          IF ( RECE62-EKF-KAK23KBN-Y(3) =  "1"      )
                          OR ((RECE62-EKF-KAK23KBN-Y(4) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                          OR ((RECE62-EKF-KAK23KBN-Y(5) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        ELSE
                          IF ( RECE62-EKF-KAK22KBN-Y(3) =  "1"      )
                          OR ((RECE62-EKF-KAK22KBN-Y(4) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                          OR ((RECE62-EKF-KAK22KBN-Y(5) =  "1"     ) AND
                              (RECE62-SRYYM            >=  "202301"))
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        END-IF
                     END-IF
                   END-IF
                   IF ( RECE62-EKF-KAK31KBN-Y(3) =  "1"      )
                   OR ((RECE62-EKF-KAK31KBN-Y(4) =  "1"     ) AND
                       (RECE62-SRYYM            >=  "202301"))
                   OR ((RECE62-EKF-KAK31KBN-Y(5) =  "1"     ) AND
                       (RECE62-SRYYM            >=  "202301"))
                     IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                             CONTINUE
                     ELSE
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
      *
                     IF  (FLG-ZENKOKUKOHI-NISYU4   =   1 )
                     AND (RECE62-EKF-KAK31KBN-Y(3) =  "1")
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4X
                     END-IF
                     IF  (FLG-ZENKOKUKOHI-NISYU4   =   1 )
                     AND (RECE62-EKF-KAK31KBN-Y(4) =  "1")
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4Y
                     END-IF
                   END-IF
                   IF  ( RECE62-EKF-KAK32KBN-Y(3)  =  "1"      )
                     IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                             MOVE     2     TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                   END-IF
                   IF  ( RECE62-EKF-KAK32KBN-Y(3)  =  "2"      )
                     IF  (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR  (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                     END-IF
                   END-IF
                   IF  ( RECE62-EKF-KAK41KBN-Y(3)  =  "1"      )
                     MOVE        2          TO   FLG-ZENKOKUKOHI-NISYU5
                     IF   RECE62-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU5
                        IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                        OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                          IF ( RECE62-EKF-KAK43KBN-Y(3) =  "1"      )
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        ELSE
                          IF ( RECE62-EKF-KAK42KBN-Y(3) =  "1"      )
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        END-IF
                     END-IF
      *              チェック用
                     IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                          IF ( RECE62-EKF-KAK43KBN-Y(3) =  "1"      )
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5X
                          END-IF
                     ELSE
                          IF ( RECE62-EKF-KAK42KBN-Y(3) =  "1"      )
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5X
                          END-IF
                     END-IF
                   END-IF
                 END-IF
      *
             END-IF
      *
      *      主＋地Ａ、主＋地Ｂ
             IF   (RECE62-KOHNUM(1)(1:1) >=  "1" AND <= "8"   ) AND
                  (TBL-TOKATUKAIFLG(1)    =  ZERO             ) AND
                  (RECE62-KOHNUM(2)(1:1) >=  "1" AND <= "8"   ) AND
                  (TBL-TOKATUKAIFLG(2)    =  ZERO             ) AND
                  (RECE62-KOHNUM(3)       =  SPACE            ) AND
                  (RECE62-KOHNUM(4)       =  SPACE            )
      *
                  MOVE        4           TO   FLG-ZENKOKUKOHI-NISYU
      *
                  IF    RECE62-HKNCOMBI(2)   =   ZERO
                     MOVE     ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                  ELSE
                     MOVE      ZERO       TO   FLG-NISYUOK1
                     MOVE      ZERO       TO   FLG-NISYUOK2
                     PERFORM   VARYING  IDX1  FROM  1  BY  1
                                UNTIL  (IDX1                  >  10 )
                                 OR    (RECE62-HKNCOMBI(IDX1) = ZERO)
                       IF  RECE62-KOHNUM(1) = RECE62-KOHNUMHC(IDX1 1)
                       AND RECE62-KOHID(1)  = RECE62-KOHIDHC(IDX1 1)
                         MOVE    1    TO   FLG-NISYUOK1
                       END-IF
                       IF  RECE62-KOHNUM(2) = RECE62-KOHNUMHC(IDX1 1)
                       AND RECE62-KOHID(2)  = RECE62-KOHIDHC(IDX1 1)
                         MOVE    1    TO   FLG-NISYUOK2
                       END-IF
                     END-PERFORM
                     IF   FLG-NISYUOK1 = 1
                     AND  FLG-NISYUOK2 = 1
                       CONTINUE
                     ELSE
                       MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU
                       IF   RECE62-SRYYM  >=  "202301"
                         MOVE   1     TO   FLG-ZENKOKUKOHI-NISYU8
                       END-IF
                     END-IF
                  END-IF
             END-IF
      *
      *      第２公費から４公費の情報編集
             PERFORM   VARYING  IDY5  FROM  3  BY  1
                        UNTIL  (IDY5                    >   5  )
                          OR   (RECE62-KOHNUM(IDY5 - 1) = SPACE)
               IF   (RECE62-KOHNUM(IDY5 - 1)(1:1) >=  "1" AND <= "8")
               AND  (TBL-TOKATUKAIFLG(IDY5 - 1)    =  ZERO          )
                 IF   RECE62-KOUREI-HANTEIFLG   =  "1"
                   IF   RECE62-EKF-KAK21KBN-K(IDY5)  =  "1"
                     MOVE      "1"     TO  RECE62-EKF-SAIKEIKSI(IDY5)
                     IF   RECE62-HKNCOMBI(2)  =  ZERO
                       MOVE    SPACE   TO  RECE62-EKF-SAIKEIKSI(IDY5)
                       IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                       OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                       OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                       OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                         IF   RECE62-EKF-KAK23KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       ELSE
                         IF   RECE62-EKF-KAK22KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       END-IF
                     END-IF
      *              チェック用
                     IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                         IF   RECE62-EKF-KAK23KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI2(IDY5)
                         END-IF
                     ELSE
                         IF   RECE62-EKF-KAK22KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI2(IDY5)
                         END-IF
                     END-IF
                   END-IF
                   IF   RECE62-EKF-KAK41KBN-K(IDY5)  =  "1" 
                     MOVE      "1"     TO  RECE62-EKF-KINGAKKSN(IDY5) 
                     IF   RECE62-HKNCOMBI(2)  =  ZERO 
                       MOVE    SPACE   TO  RECE62-EKF-KINGAKKSN(IDY5) 
                       IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974") 
                       OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974") 
                       OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974") 
                       OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974") 
                         IF   RECE62-EKF-KAK43KBN-K(IDY5)  =  "1" 
                            MOVE  "1"  TO  RECE62-EKF-KINGAKKSN(IDY5) 
                         END-IF 
                       ELSE 
                         IF   RECE62-EKF-KAK42KBN-K(IDY5)  =  "1" 
                            MOVE  "1"  TO  RECE62-EKF-KINGAKKSN(IDY5) 
                         END-IF 
                       END-IF 
                     END-IF 
                   END-IF 
                 ELSE
                   IF   RECE62-EKF-KAK21KBN-Y(IDY5)  =  "1"
                     MOVE      "1"     TO  RECE62-EKF-SAIKEIKSI(IDY5)
                     IF   RECE62-HKNCOMBI(2)  =  ZERO
                       MOVE    SPACE   TO  RECE62-EKF-SAIKEIKSI(IDY5)
                       IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                       OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                       OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                       OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                         IF   RECE62-EKF-KAK23KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       ELSE
                         IF   RECE62-EKF-KAK22KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       END-IF
                     END-IF
      *              チェック用
                     IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974")
                     OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974")
                         IF   RECE62-EKF-KAK23KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI2(IDY5)
                         END-IF
                     ELSE
                         IF   RECE62-EKF-KAK22KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE62-EKF-SAIKEIKSI2(IDY5)
                         END-IF
                     END-IF
                   END-IF
                   IF   RECE62-EKF-KAK41KBN-Y(IDY5)  =  "1" 
                     MOVE      "1"     TO  RECE62-EKF-KINGAKKSN(IDY5) 
                     IF   RECE62-HKNCOMBI(2)  =  ZERO 
                       MOVE    SPACE   TO  RECE62-EKF-KINGAKKSN(IDY5) 
                       IF (RECE62-ETC-KOHNUM(1)  = "972" OR "974") 
                       OR (RECE62-ETC-KOHNUM(2)  = "972" OR "974") 
                       OR (RECE62-ETC-KOHNUM(3)  = "972" OR "974") 
                       OR (RECE62-ETC-KOHNUM(4)  = "972" OR "974") 
                         IF   RECE62-EKF-KAK43KBN-Y(IDY5)  =  "1" 
                            MOVE  "1"  TO  RECE62-EKF-KINGAKKSN(IDY5) 
                         END-IF 
                       ELSE 
                         IF   RECE62-EKF-KAK42KBN-Y(IDY5)  =  "1" 
                            MOVE  "1"  TO  RECE62-EKF-KINGAKKSN(IDY5) 
                         END-IF 
                       END-IF 
                     END-IF 
                   END-IF 
                 END-IF
               ELSE
                 IF (RECE62-KOHNUM(IDY5 - 1)(1:1)  =  "0")
                 OR (TBL-TOKATUKAIFLG(IDY5 - 1)    =   1 )
                   MOVE        "3"     TO  RECE62-EKF-SAIKEIKSI(IDY5)
                 END-IF
               END-IF
      *
               IF    RECE62-EKF-SAIKEIKSI(IDY5)  NOT =  SPACE
                 PERFORM   VARYING  IDX1  FROM  1  BY  1
                             UNTIL (IDX1                  >  10 )
                              OR   (RECE62-HKNCOMBI(IDX1) = ZERO)
                   IF  (RECE62-KOHNUM(IDY5 - 1) =
                                         RECE62-KOHNUMHC(IDX1 1))
                   AND (RECE62-KOHID (IDY5 - 1) =
                                         RECE62-KOHIDHC (IDX1 1))
                     IF    RECE62-EKF-SAIKEIKSI(IDY5)  =  "1"
                       MOVE    "4"     TO  RECE62-EKF-SAIKEIKSI(IDY5)
                     ELSE
                       MOVE   SPACE    TO  RECE62-EKF-SAIKEIKSI(IDY5)
                     END-IF
                     MOVE     10       TO  IDX1
                   END-IF
                 END-PERFORM
               END-IF
             END-PERFORM
      *
           END-IF
      *
      *    主＋全Ａ、主＋全Ｂ
           IF  (((RECE62-KOHNUM(1)(1:1)  =  "0"            ) AND
                 (RECE62-KOHNUM(1)   NOT =  "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
               (((RECE62-KOHNUM(2)(1:1)  =  "0"            ) AND
                 (RECE62-KOHNUM(2)   NOT =  "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)    =   1              ))
      *
                  MOVE      1       TO     FLG-ZENKOKUKOHI-NISYU2
      *
           END-IF
      *
           .
       2104C-ZENKOKUKOHI-NISYU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７５歳到達月の特例判定
      *****************************************************************
       2104D-TOKU75-HANTEI-SEC               SECTION.
      *
           MOVE      ZERO       TO    FLG-TOKU75
                                      FLG-TOKU75-KIZON
           MOVE      SPACE      TO    WRK-TOKU75-BIRTHDAY
           MOVE      ZERO       TO    FLG-SYOGAI75
      *
           IF   (RECE62-SRYYM       >=  "200901")
           AND  (RECE62-HKNNUM   NOT =   SPACE  )
             IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
             OR  (RECE62-HKNNUM       =   "068" OR "069" OR "040")
               CONTINUE
             ELSE
               IF   RECE62-KOUREI-HANTEIFLG   =   "1"
                 INITIALIZE                      PTKOHINF-REC
                 MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
                 MOVE    RECE62-PTID         TO  PTKOH-PTID
                 MOVE    "977"               TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC        TO  MCPDATA-REC
                 MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                 MOVE    "key4"              TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) <= RECE62-SRYYM       )
                      AND (RECE62-SRYYM        <= PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN       = SPACE              )
                         MOVE     1          TO  FLG-KOKI-HIGAITO
                         MOVE     1          TO  FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key4"               TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                 MOVE    "key4"               TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
      *
                 INITIALIZE                      ORCSAGECHKAREA
                 MOVE    RECE62-HOSPNUM      TO  AGECHK-HOSPNUM
                 MOVE    RECE62-PTID         TO  AGECHK-PTID
                 MOVE    RECE62-SRYYM        TO  AGECHK-SRYYMD(1:6)
                 MOVE    "01"                TO  AGECHK-SRYYMD(7:2)
                 MOVE    RECE62-BIRTHDAY     TO  AGECHK-BIRTHDAY
                 CALL    "ORCSAGECHK"        USING
                                             ORCSAGECHKAREA
                                             SPA-AREA
                 IF      AGECHK-RC       =   ZERO
                   IF  (AGECHK-NENREI        =  74              )
                   AND (AGECHK-ROUJIN2       =  0               )
                   AND (RECE62-BIRTHDAY(5:2) = RECE62-SRYYM(5:2))
                   AND (RECE62-BIRTHDAY(7:2)  NOT =  "01"       )
                   AND (RECE62-BIRTHDAY(5:4)  NOT =  "0229"     )
                   AND (FLG-KOKI-HIGAITO          =   ZERO      )
                       MOVE   1    TO    FLG-TOKU75
                       MOVE   RECE62-BIRTHDAY
                                   TO    WRK-TOKU75-BIRTHDAY
                   END-IF
                   IF  ( AGECHK-NENREI       >=  75 )
                   OR  ( AGECHK-ROUJIN2       =  1  )
                       MOVE   1    TO    FLG-TOKU75-KIZON
                   END-IF
                   IF  (AGECHK-NENREI        =  74              )
                   AND (AGECHK-ROUJIN2       =  1               )
                   AND (RECE62-BIRTHDAY(5:2) = RECE62-SRYYM(5:2))
                   AND (RECE62-BIRTHDAY(7:2)  NOT =  "01"       )
                   AND (RECE62-BIRTHDAY(5:4)  NOT =  "0229"     )
                       MOVE   1    TO    FLG-SYOGAI75
                   END-IF
                 END-IF
               END-IF
      *
               IF (FLG-TOKU75         =    1)
               OR (FLG-TOKU75-KIZON   =    1)
                 CONTINUE
               ELSE
                 INITIALIZE                   PTKOHINF-REC
                 MOVE    RECE62-HOSPNUM   TO  PTKOH-HOSPNUM
                 MOVE    RECE62-PTID      TO  PTKOH-PTID
                 MOVE    "969"            TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC     TO  MCPDATA-REC
                 MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                 MOVE    "key4"           TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) =  RECE62-SRYYM       )
                      AND (RECE62-SRYYM        =  PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN      =  SPACE              )
                         IF  PTKOH-TEKSTYMD(5:4)   NOT =  "0229"
                           IF   RECE62-KOUREI-HANTEIFLG   =   "1"
                              MOVE  2   TO   FLG-TOKU75
                           ELSE
                              MOVE  3   TO   FLG-TOKU75
                           END-IF
                           MOVE  PTKOH-TEKSTYMD
                                        TO   WRK-TOKU75-BIRTHDAY
                         END-IF
                         MOVE    1      TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key4"               TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                 MOVE    "key4"               TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
               END-IF
             END-IF
           END-IF
      *
      *    ７５歳到達月の特例非該当
           IF   FLG-TOKU75   =  1  OR  2  OR  3
             MOVE      RECE62-SRYYM          TO   WRK-GEN70-YM
             IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                MOVE   RECE62-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
             ELSE
                MOVE   01                    TO   WRK-GEN70-DD
             END-IF
      *
             MOVE      RECE62-SRYYM            TO   WRK-GEN702-YM
             IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                MOVE   RECE62-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
             ELSE
                MOVE   01                      TO   WRK-GEN702-DD
             END-IF
      *
             INITIALIZE                      PTKOHINF-REC
             MOVE    RECE62-HOSPNUM      TO  PTKOH-HOSPNUM
             MOVE    RECE62-PTID         TO  PTKOH-PTID
             MOVE    "954"               TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC        TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key4"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                      MOVE     ZERO   TO  FLG-TOKU75
                      MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                      MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                      MOVE    "key4"           TO  MCP-PATHNAME
                      PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
           END-IF
      *
           EVALUATE   FLG-TOKU75
             WHEN        1
             WHEN        2
               IF    RECE62-KOUREI   =   "1"
                 CONTINUE
               ELSE
                IF      IDZ   =   1
                 IF (RECE62-ETC-KOHNUM(1) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(2) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(3) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(4) = "972" OR "974")
                 OR (RECE62-KOHNUM(1)(1:1) = "0"          )
                 OR (RECE62-KOHNUM(2)(1:1) = "0"          )
                 OR (RECE62-KOHNUM(3)(1:1) = "0"          )
                 OR (RECE62-KOHNUM(4)(1:1) = "0"          )
                 OR (TBL-TOKATUKAIFLG(1)   =  1           )
                 OR (TBL-TOKATUKAIFLG(2)   =  1           )
                 OR (TBL-TOKATUKAIFLG(3)   =  1           )
                 OR (TBL-TOKATUKAIFLG(4)   =  1           )
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                ELSE
                 PERFORM   2104D1-TOKU75-HANTEI-KOHSKY-SEC
                 IF  FLG-TOKU75-KOHSKY = 1
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                END-IF
               END-IF
             WHEN        3
               IF    RECE62-KOUREI   =   "2"
                 CONTINUE
               ELSE
                IF      IDZ   =   1
                 IF (RECE62-ETC-KOHNUM(1) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(2) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(3) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(4) = "972" OR "974")
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                ELSE
                 PERFORM   2104D1-TOKU75-HANTEI-KOHSKY-SEC
                 IF  FLG-TOKU75-KOHSKY = 1
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                END-IF
               END-IF
           END-EVALUATE
      *
           IF  FLG-TOKU75    =  2  OR  3
               MOVE      6      TO     FLG-TOKKI
               PERFORM   21013-TOKKI-HENSYU-SEC
           END-IF
      *
           IF  FLG-TOKU75    =  1  OR  2  OR  3
              EVALUATE  FLG-TOKU75
                WHEN       1
                  MOVE   1    TO   RECE62-RJNNYUKOHFTN(1)
                WHEN       2
                  MOVE   2    TO   RECE62-RJNNYUKOHFTN(1)
                WHEN       3
                  MOVE   3    TO   RECE62-RJNNYUKOHFTN(1)
              END-EVALUATE
           END-IF
      *
           IF  FLG-SYOGAI75  =  1
               IF    RECE62-KOUREI       =   "1"
                    MOVE    1    TO    RECE62-RJNGAIKOHFTN(3)
               ELSE
                 IF (RECE62-ETC-KOHNUM(1) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(2) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(3) = "972" OR "974")
                 OR (RECE62-ETC-KOHNUM(4) = "972" OR "974")
                 OR (RECE62-KOHNUM(1)(1:1) = "0"          )
                 OR (RECE62-KOHNUM(2)(1:1) = "0"          )
                 OR (RECE62-KOHNUM(3)(1:1) = "0"          )
                 OR (RECE62-KOHNUM(4)(1:1) = "0"          )
                 OR (TBL-TOKATUKAIFLG(1)   =  1           )
                 OR (TBL-TOKATUKAIFLG(2)   =  1           )
                 OR (TBL-TOKATUKAIFLG(3)   =  1           )
                 OR (TBL-TOKATUKAIFLG(4)   =  1           )
                    MOVE    1    TO    RECE62-RJNGAIKOHFTN(3)
                 END-IF
               END-IF
           END-IF
      *
           .
       2104D-TOKU75-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７５歳到達月の特例判定（公費請求分）
      *****************************************************************
       2104D1-TOKU75-HANTEI-KOHSKY-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-TOKU75-KOHSKY
      *
           PERFORM   VARYING   TOKU75-IDX    FROM    1   BY  1
                      UNTIL   (TOKU75-IDX                   >  10  )
                       OR     (RECE62-HKNCOMBI(TOKU75-IDX)  =  ZERO)
                       OR     (FLG-TOKU75-KOHSKY            =  1   )
      *
             INITIALIZE                  HKNCOMBI-REC
             MOVE    RECE62-HOSPNUM  TO  COMB-HOSPNUM
             MOVE    RECE62-PTID     TO  COMB-PTID
             MOVE    RECE62-HKNCOMBI(TOKU75-IDX)
                                     TO  COMB-HKNCOMBINUM
             MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
             PERFORM 900-HKNCOMBI-INV-SEC
             IF      FLG-HKNCOMBI    =   ZERO
                 PERFORM   VARYING   TOKU75-IDX2   FROM    1   BY  1
                            UNTIL   (TOKU75-IDX2        >  4)
                              OR    (FLG-TOKU75-KOHSKY  =  1)
                   IF ( COMB-KOHHKNNUM(TOKU75-IDX2)
                                              = "972" OR "974" )
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2)(1:1) = "0"))
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (WRK-PREFNUM                 = "13"    ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2) = "151"   ) AND
                       (TOKU75-IDX2                 =  1      ) AND
                       (RECE62-SRYYM               >= "200905"))
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (WRK-PREFNUM                 = "23"    ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2) = "191"   ) AND
                       (TOKU75-IDX2                 =  1      ) AND
                       (RECE62-SRYYM               >= "200910") AND
                       (RECE62-SRYYM               <= "201509"))
                     INITIALIZE               ORCSFTNJGNCHKAREA
                     MOVE RECE62-HOSPNUM   TO LNK-FTNJGNCHK-HOSPNUM
                     MOVE RECE62-PTID      TO LNK-FTNJGNCHK-PTID
                     MOVE "1"              TO LNK-FTNJGNCHK-NYUGAIKBN
                     MOVE RECE62-SRYYM     TO LNK-FTNJGNCHK-SRYYM
                     MOVE COMB-KOHHKNNUM(TOKU75-IDX2)
                                           TO LNK-FTNJGNCHK-KOHNUM
                     MOVE COMB-KOHID(TOKU75-IDX2)
                                           TO LNK-FTNJGNCHK-KOHID
                     MOVE WRK-PREFNUM      TO LNK-FTNJGNCHK-PREFNUM
                     MOVE COMB-HKNCOMBINUM TO LNK-FTNJGNCHK-HKNCOMBINUM
                     MOVE COMB-HKNID       TO LNK-FTNJGNCHK-HKNID
                     CALL "ORCSFTNJGNCHK"  USING
                                           ORCSFTNJGNCHKAREA
                                           SPA-AREA
                     IF     LNK-FTNJGNCHK-RC   =   ZERO
                         MOVE    1    TO    FLG-TOKU75-KOHSKY
                     END-IF
                   END-IF
                 END-PERFORM
             END-IF
      *
           END-PERFORM
      *
           .
       2104D1-TOKU75-HANTEI-KOHSKY-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の判定
      *****************************************************************
       2104E-TOKUSITU-HANTEI-SEC               SECTION.
      *
           INITIALIZE               TBL-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU-TASU
           MOVE     ZERO      TO    FLG-TOKUSITU-KBN
           MOVE     ZERO      TO    FLG-KISAIOK
      *
           INITIALIZE               TBL-KANGAN
           MOVE     ZERO      TO    FLG-KANGAN
           MOVE     ZERO      TO    FLG-KANGAN-TASU
           MOVE     ZERO      TO    FLG-KANGAN-KBN
           MOVE     ZERO      TO    FLG-KISAIOK2
      *
           IF   (RECE62-SRYYM       >=  "200905")
           AND  (RECE62-HKNNUM   NOT =   SPACE  )
             IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
             OR  (RECE62-HKNNUM       =   "068" OR "069" OR "040")
               CONTINUE
             ELSE
               IF (((RECE62-KOHNUM(1)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(1)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "51"           ))
               OR (((RECE62-KOHNUM(1)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(1)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              <= "201412"       ))
               OR (((RECE62-KOHNUM(1)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(1)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(1)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(1)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201804"       ))
               OR (((RECE62-KOHNUM(2)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(2)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "51"           ))
               OR (((RECE62-KOHNUM(2)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(2)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              <= "201412"       ))
               OR (((RECE62-KOHNUM(2)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(2)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(2)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(2)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201804"       ))
               OR (((RECE62-KOHNUM(3)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(3)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "51"           ))
               OR (((RECE62-KOHNUM(3)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(3)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              <= "201412"       ))
               OR (((RECE62-KOHNUM(3)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(3)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(3)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(3)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201804"       ))
               OR (((RECE62-KOHNUM(4)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(4)(5:3) = "601" OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "51"           ))
               OR (((RECE62-KOHNUM(4)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(4)(5:2) = "60"           ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              <= "201412"       ))
               OR (((RECE62-KOHNUM(4)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE62-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(4)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(4)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201501"       ))
               OR (( RECE62-KOHNUM(4)    = "054"                 ) AND
                   ( RECE62-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                   ( RECE62-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                   ( RECE62-SRYYM              >= "201804"       ))
               OR (  WRK-KOHJGNGET-TEKIYOFLG(1) =  1              )
               OR (  WRK-KOHJGNGET-TEKIYOFLG(2) =  1              )
               OR (  WRK-KOHJGNGET-TEKIYOFLG(3) =  1              )
               OR (  WRK-KOHJGNGET-TEKIYOFLG(4) =  1              )
      *
                 IF (((RECE62-KOHNUM(1)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(1)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "51"           ))
                 OR (((RECE62-KOHNUM(1)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(1)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              <= "201412"       ))
                 OR (((RECE62-KOHNUM(1)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(1)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(1)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(1)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(1) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(1)
                 END-IF
                 IF (((RECE62-KOHNUM(2)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(2)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "51"           ))
                 OR (((RECE62-KOHNUM(2)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(2)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              <= "201412"       ))
                 OR (((RECE62-KOHNUM(2)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(2)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(2)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(2)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(2) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(2)
                 END-IF
                 IF (((RECE62-KOHNUM(3)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(3)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "51"           ))
                 OR (((RECE62-KOHNUM(3)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(3)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              <= "201412"       ))
                 OR (((RECE62-KOHNUM(3)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(3)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(3)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(3)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(3) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(3)
                 END-IF
                 IF (((RECE62-KOHNUM(4)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(4)(5:3) = "601" OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "51"           ))
                 OR (((RECE62-KOHNUM(4)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(4)(5:2) = "60"           ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              <= "201412"       ))
                 OR (((RECE62-KOHNUM(4)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE62-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(4)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(4)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201501"       ))
                 OR (( RECE62-KOHNUM(4)    = "054"                 ) AND
                     ( RECE62-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                     ( RECE62-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                     ( RECE62-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(4) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(4)
                 END-IF
      *
                 MOVE      RECE62-SRYYM         TO   WRK-GEN70-YM
                 IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                   MOVE    RECE62-TEKSTYMD(7:2) TO   WRK-GEN70-DD
                 ELSE
                   MOVE    01                   TO   WRK-GEN70-DD
                 END-IF
      *
                 MOVE      RECE62-SRYYM         TO   WRK-GEN702-YM
                 IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                   MOVE    RECE62-TEKSTYMD-X(7:2)
                                                TO   WRK-GEN702-DD
                 ELSE
                   MOVE    01                   TO   WRK-GEN702-DD
                 END-IF
      *
                 IF   RECE62-KOUREI-HANTEIFLG   =   "1"
                   IF    RECE62-KYURATE     =   30
                        MOVE    1    TO   FLG-TOKUSITU
                   ELSE
                     IF  RECE62-TEISYOTOKU  =  SPACE
                        MOVE    2    TO   FLG-TOKUSITU
                     ELSE
                        MOVE    3    TO   FLG-TOKUSITU
                     END-IF
                   END-IF
                 ELSE
                   PERFORM   2104E1-TOKUSITU-HANTEI2-SEC
                 END-IF
      *
                 IF     FLG-TOKUSITU   NOT =  ZERO
                   PERFORM   2104E2-TOKUSITU-HANTEI3-SEC
                   PERFORM   2104E4-TOKUSITU-HENSYU5-SEC
                 ELSE
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(1)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(2)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(3)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(4)
                 END-IF
      *
               ELSE
      *
                 IF      IDZ   =   2
                   MOVE      RECE62-SRYYM         TO   WRK-GEN70-YM
                   IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                     MOVE    RECE62-TEKSTYMD(7:2) TO   WRK-GEN70-DD
                   ELSE
                     MOVE    01                   TO   WRK-GEN70-DD
                   END-IF
      *
                   MOVE      RECE62-SRYYM         TO   WRK-GEN702-YM
                   IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                     MOVE    RECE62-TEKSTYMD-X(7:2)
                                                  TO   WRK-GEN702-DD
                   ELSE
                     MOVE    01                   TO   WRK-GEN702-DD
                   END-IF
      *
                   IF   RECE62-KOUREI-HANTEIFLG   =   "1"
                     INITIALIZE                      SSRHKOH-AREA
                     MOVE    RECE62-PTID         TO  SSRHKOH-PTID
                     MOVE    "1"                 TO  SSRHKOH-NYUGAIKBN
                     MOVE    RECE62-SRYYM        TO  SSRHKOH-SRYYM
                     MOVE    RECE62-HKNCOMBI(1)  TO  SSRHKOH-HKNCOMBI
                     CALL    "ORCSSRHKOH"        USING
                                                 SSRHKOH-AREA
                                                 SPA-AREA
                     IF   SSRHKOH-RC  =  1
                        IF    RECE62-KYURATE     =   30
                             MOVE    1    TO   FLG-TOKUSITU
                        ELSE
                          IF  RECE62-TEISYOTOKU  =  SPACE
                             MOVE    2    TO   FLG-TOKUSITU
                          ELSE
                             MOVE    3    TO   FLG-TOKUSITU
                          END-IF
                        END-IF
                     END-IF
                   ELSE
                     INITIALIZE                      SSRHKOH-AREA
                     MOVE    RECE62-PTID         TO  SSRHKOH-PTID
                     MOVE    "1"                 TO  SSRHKOH-NYUGAIKBN
                     MOVE    RECE62-SRYYM        TO  SSRHKOH-SRYYM
                     MOVE    RECE62-HKNCOMBI(1)  TO  SSRHKOH-HKNCOMBI
                     CALL    "ORCSSRHKOH"        USING
                                                 SSRHKOH-AREA
                                                 SPA-AREA
                     IF   SSRHKOH-RC  =  1
                        PERFORM   2104E1-TOKUSITU-HANTEI2-SEC
                     END-IF
                   END-IF
                   IF     FLG-TOKUSITU   NOT =  ZERO
                        PERFORM   2104E2-TOKUSITU-HANTEI3-SEC
                        PERFORM   2104E4-TOKUSITU-HENSYU5-SEC
                   END-IF
                 END-IF
      *
               END-IF
      *
               IF    RECE62-SRYYM       >=  "201812"
                 IF  (RECE62-KOHNUM(1)   =  "092")
                 OR  (RECE62-KOHNUM(2)   =  "092")
                 OR  (RECE62-KOHNUM(3)   =  "092")
                 OR  (RECE62-KOHNUM(4)   =  "092")
                   IF  RECE62-KOHNUM(1)  = "092"
                     MOVE     1     TO    TBL-KANGANFLG(1)
                   END-IF
                   IF  RECE62-KOHNUM(2)  = "092"
                     MOVE     1     TO    TBL-KANGANFLG(2)
                   END-IF
                   IF  RECE62-KOHNUM(3)  = "092"
                     MOVE     1     TO    TBL-KANGANFLG(3)
                   END-IF
                   IF  RECE62-KOHNUM(4)  = "092"
                     MOVE     1     TO    TBL-KANGANFLG(4)
                   END-IF
      *
                   PERFORM       2104E5-KANGAN-HANTEI-SEC
                   IF     FLG-KANGAN   NOT =  ZERO
                     PERFORM     2104E6-KANGAN-HANTEI2-SEC
                   ELSE
                     MOVE   ZERO    TO    TBL-KANGANFLG(1)
                     MOVE   ZERO    TO    TBL-KANGANFLG(2)
                     MOVE   ZERO    TO    TBL-KANGANFLG(3)
                     MOVE   ZERO    TO    TBL-KANGANFLG(4)
                   END-IF
                 ELSE
                   IF     IDZ  =  2
                     PERFORM     2104E5-KANGAN-HANTEI-SEC
                     IF   FLG-KANGAN   NOT =  ZERO
                       PERFORM   2104E6-KANGAN-HANTEI2-SEC
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       2104E-TOKUSITU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       2104E1-TOKUSITU-HANTEI2-SEC               SECTION.
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE  RECE62-PTID           TO  PTKOH-PTID
           MOVE  "966"                 TO  PTKOH-KOHNUM
           MOVE  PTKOHINF-REC          TO  MCPDATA-REC
           MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
           MOVE  "key14"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
             MOVE    "key14"           TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                    (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                    (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                  MOVE     1      TO  FLG-TOKUSITU
                  IF  RECE62-SRYYM  >= "201501"
                    IF  PTKOH-JKYSNUM(1:2) = "イ"
                      MOVE   12   TO  FLG-TOKUSITU-KBN
                    ELSE
                      MOVE   11   TO  FLG-TOKUSITU-KBN
                    END-IF
                  END-IF
                  MOVE     1      TO  FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key14"          TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF    FLG-TOKUSITU  =  ZERO
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE62-PTID           TO  PTKOH-PTID
             MOVE  "967"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key14"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key14"           TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    IF  RECE62-TEISYOTOKU  =  SPACE
                         MOVE    2    TO   FLG-TOKUSITU
                         IF  RECE62-SRYYM  >= "201501"
                          IF  PTKOH-JKYSNUM(1:2) = "エ"
                            MOVE  22  TO   FLG-TOKUSITU-KBN
                          ELSE
                            MOVE  21  TO   FLG-TOKUSITU-KBN
                          END-IF
                         END-IF
                    ELSE
                         MOVE    3    TO   FLG-TOKUSITU
                         IF  RECE62-SRYYM  >= "201501"
                            MOVE  31  TO   FLG-TOKUSITU-KBN
                         END-IF
                    END-IF
                    MOVE         1    TO   FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key14"          TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
      ***
      *
           IF    FLG-TOKUSITU  =  ZERO
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE62-PTID           TO  PTKOH-PTID
             MOVE  "956"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key14"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key14"           TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    MOVE     1      TO  FLG-TOKUSITU
                    IF  RECE62-SRYYM  >= "201501"
                      IF  PTKOH-JKYSNUM(1:2) = "イ"
                        MOVE   12   TO  FLG-TOKUSITU-KBN
                      ELSE
                        MOVE   11   TO  FLG-TOKUSITU-KBN
                      END-IF
                    END-IF
                    MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key14"          TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           IF    FLG-TOKUSITU  =  ZERO
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE62-PTID           TO  PTKOH-PTID
             MOVE  "957"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key14"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key14"           TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    IF  RECE62-TEISYOTOKU  =  SPACE
                         MOVE    2    TO   FLG-TOKUSITU
                         IF  RECE62-SRYYM  >= "201501"
                          IF  PTKOH-JKYSNUM(1:2) = "エ"
                            MOVE  22  TO   FLG-TOKUSITU-KBN
                          ELSE
                            MOVE  21  TO   FLG-TOKUSITU-KBN
                          END-IF
                         END-IF
                    ELSE
                         MOVE    3    TO   FLG-TOKUSITU
                         IF  RECE62-SRYYM  >= "201501"
                            MOVE  31  TO   FLG-TOKUSITU-KBN
                         END-IF
                    END-IF
                    MOVE         1    TO   FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key14"          TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           .
       2104E1-TOKUSITU-HANTEI2-EXT.
           EXIT.
      *
      *****************************************************************
      *    多数該当
      *****************************************************************
       2104E2-TOKUSITU-HANTEI3-SEC               SECTION.
      *
           IF  ((RECE62-KOUREI-HANTEIFLG   =   "1"      ) AND
                (FLG-TOKUSITU              =    2  OR  3) AND
                (RECE62-SRYYM             <    "201708" ))
           OR  ((RECE62-KOUREI-HANTEIFLG   =   "1"      ) AND
                (FLG-TOKUSITU              =    3       ) AND
                (RECE62-SRYYM             >=   "201708" ))
             CONTINUE
           ELSE
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE62-PTID           TO  PTKOH-PTID
             MOVE  "958"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key4"                TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key4"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    MOVE     1      TO  FLG-TOKUSITU-TASU
                    MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           .
       2104E2-TOKUSITU-HANTEI3-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       2104E3-TOKUSITU-HANTEI4-SEC               SECTION.
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE  RECE62-PTID           TO  PTKOH-PTID
           MOVE  "957"                 TO  PTKOH-KOHNUM
           MOVE  PTKOHINF-REC          TO  MCPDATA-REC
           MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
           MOVE  "key14"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
             MOVE    "key14"           TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                    (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                    (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                  MOVE    1    TO   FLG-KISAIOK
                  MOVE    1    TO   FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key14"          TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       2104E3-TOKUSITU-HANTEI4-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       2104E4-TOKUSITU-HENSYU5-SEC               SECTION.
      *
           IF   RECE62-KOUREI-HANTEIFLG   =   "1"
             IF    RECE62-KYURATE     =   30
               MOVE      1   TO   FLG-KISAIOK
             ELSE
               IF  RECE62-TEISYOTOKU  =  SPACE
                 IF  RECE62-SRYYM  >= "201808"
                   MOVE  1   TO   FLG-KISAIOK
                 ELSE
                   PERFORM 2104E3-TOKUSITU-HANTEI4-SEC
                 END-IF
               ELSE
                 MOVE    1   TO   FLG-KISAIOK
               END-IF
             END-IF
           ELSE
             MOVE        1   TO   FLG-KISAIOK
           END-IF
      *
           IF   FLG-KISAIOK  =  1
             IF  RECE62-KOUREI-HANTEIFLG = "1"
               IF    RECE62-SRYYM  >= "201808"
                   IF   FLG-TOKUSITU-TASU  =  1
                     MOVE  21    TO   FLG-TOKKI
                   ELSE
                     MOVE  20    TO   FLG-TOKKI
                   END-IF
               ELSE
                 IF  RECE62-SRYYM  >= "201708"
                   IF   FLG-TOKUSITU-TASU  =  1
                     MOVE  18    TO   FLG-TOKKI
                   ELSE
                     MOVE   7    TO   FLG-TOKKI
                   END-IF
                 ELSE
                   IF   FLG-TOKUSITU-TASU  =  1
                     MOVE   8    TO   FLG-TOKKI
                   ELSE
                     MOVE   7    TO   FLG-TOKKI
                   END-IF
                 END-IF
               END-IF
             ELSE
               IF  RECE62-SRYYM   >=  "201501"
                 IF   FLG-TOKUSITU-TASU  =  1
                   MOVE  16    TO   FLG-TOKKI
                 ELSE
                   MOVE  15    TO   FLG-TOKKI
                 END-IF
               ELSE
                 IF   FLG-TOKUSITU-TASU  =  1
                   MOVE   8    TO   FLG-TOKKI
                 ELSE
                   MOVE   7    TO   FLG-TOKKI
                 END-IF
               END-IF
             END-IF
             PERFORM   21013-TOKKI-HENSYU-SEC
             IF  RECE62-SRYYM   >=  "201501"
               IF   FLG-TOKUSITU   NOT =  ZERO
                     MOVE   1    TO   RECE62-RJNNYUKOHFTN(2)
               END-IF
             ELSE
               IF   FLG-TOKUSITU-TASU  =  1
                 EVALUATE  FLG-TOKUSITU
                   WHEN       1
                     MOVE   4    TO   RECE62-RJNNYUKOHFTN(2)
                   WHEN       2
                     MOVE   5    TO   RECE62-RJNNYUKOHFTN(2)
                   WHEN       3
                     MOVE   6    TO   RECE62-RJNNYUKOHFTN(2)
                 END-EVALUATE
               ELSE
                 EVALUATE  FLG-TOKUSITU
                   WHEN       1
                     MOVE   1    TO   RECE62-RJNNYUKOHFTN(2)
                   WHEN       2
                     MOVE   2    TO   RECE62-RJNNYUKOHFTN(2)
                   WHEN       3
                     MOVE   3    TO   RECE62-RJNNYUKOHFTN(2)
                 END-EVALUATE
               END-IF
             END-IF
           END-IF
      *
           IF     (IDZ             =   1      )
           AND    (RECE62-SRYYM   >=  "201501")
             MOVE     ZERO    TO     IDX29
             PERFORM  VARYING  IDX27  FROM  1  BY  1
                       UNTIL  (IDX27                  >  10  )
                         OR   (RECE62-HKNCOMBI(IDX27) =  ZERO)
               INITIALIZE                  HKNCOMBI-REC
               MOVE    RECE62-HOSPNUM  TO  COMB-HOSPNUM
               MOVE    RECE62-PTID     TO  COMB-PTID
               MOVE    RECE62-HKNCOMBI(IDX27)
                                       TO  COMB-HKNCOMBINUM
               MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
               PERFORM 900-HKNCOMBI-INV-SEC
               IF      FLG-HKNCOMBI    =   ZERO
                 PERFORM  VARYING  IDX28  FROM  1  BY  1
                           UNTIL   IDX28    >   4
                   IF ((COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(1)) AND
                       (COMB-KOHID(IDX28)     = RECE62-KOHID(1) ) AND
                       (TBL-TOKUSITUFLG(1)    =   1             ))
                   OR ((COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(2)) AND
                       (COMB-KOHID(IDX28)     = RECE62-KOHID(2) ) AND
                       (TBL-TOKUSITUFLG(2)    =   1             ))
                   OR ((COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(3)) AND
                       (COMB-KOHID(IDX28)     = RECE62-KOHID(3) ) AND
                       (TBL-TOKUSITUFLG(3)    =   1             ))
                   OR ((COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(4)) AND
                       (COMB-KOHID(IDX28)     = RECE62-KOHID(4) ) AND
                       (TBL-TOKUSITUFLG(4)    =   1             ))
                     INITIALIZE               ORCSFTNJGNCHKAREA
                     MOVE RECE62-HOSPNUM   TO LNK-FTNJGNCHK-HOSPNUM
                     MOVE RECE62-PTID      TO LNK-FTNJGNCHK-PTID
                     MOVE "1"              TO LNK-FTNJGNCHK-NYUGAIKBN
                     MOVE RECE62-SRYYM     TO LNK-FTNJGNCHK-SRYYM
                     MOVE COMB-KOHHKNNUM(IDX28)
                                           TO LNK-FTNJGNCHK-KOHNUM
                     MOVE COMB-KOHID(IDX28)
                                           TO LNK-FTNJGNCHK-KOHID
                     MOVE WRK-PREFNUM      TO LNK-FTNJGNCHK-PREFNUM
                     MOVE COMB-HKNCOMBINUM TO LNK-FTNJGNCHK-HKNCOMBINUM
                     MOVE COMB-HKNID       TO LNK-FTNJGNCHK-HKNID
                     CALL "ORCSFTNJGNCHK"  USING
                                           ORCSFTNJGNCHKAREA
                                           SPA-AREA
                     IF   LNK-FTNJGNCHK-SKYZEROFLG  =  SPACE
                       ADD     1    TO     IDX29
                     ELSE
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(1))
                       AND (COMB-KOHID(IDX28)     = RECE62-KOHID(1) )
                       AND (TBL-TOKUSITUFLG(1)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(1)
                       END-IF
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(2))
                       AND (COMB-KOHID(IDX28)     = RECE62-KOHID(2) )
                       AND (TBL-TOKUSITUFLG(2)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(2)
                       END-IF
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(3))
                       AND (COMB-KOHID(IDX28)     = RECE62-KOHID(3) )
                       AND (TBL-TOKUSITUFLG(3)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(3)
                       END-IF
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE62-KOHNUM(4))
                       AND (COMB-KOHID(IDX28)     = RECE62-KOHID(4) )
                       AND (TBL-TOKUSITUFLG(4)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(4)
                       END-IF
                     END-IF
                   END-IF
                 END-PERFORM
               END-IF
             END-PERFORM
             IF  IDX29  =  ZERO
               MOVE     ZERO      TO    FLG-TOKUSITU
               MOVE     ZERO      TO    FLG-TOKUSITU-KBN
               MOVE     ZERO      TO    FLG-TOKUSITU-TASU
               MOVE     ZERO      TO    RECE62-RJNNYUKOHFTN(2)
             END-IF
           END-IF
      *
           .
       2104E4-TOKUSITU-HENSYU5-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       2104E5-KANGAN-HANTEI-SEC               SECTION.
      *
           MOVE      ZERO      TO      FLG-KANGAN-ARI
      *
           PERFORM  VARYING  IDX36   FROM    1   BY  1
                     UNTIL  (IDX36                   >   10 )
                       OR   (RECE62-HKNCOMBI(IDX36)  =  ZERO)
                       OR   (FLG-KANGAN-ARI      NOT =  ZERO)
      *
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE62-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE62-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE62-PTID            TO  SYU-PTID
               MOVE  RECE62-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE62-HKNCOMBI(IDX36) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key19"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key19"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU          =   1  )
                           OR    (FLG-KANGAN-ARI  NOT =  ZERO)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     IF   SYU-SKJ-FTNDAY(3) = 11 OR 12 OR 21 OR 22 OR
                                              31 OR 41 OR 42 OR 43
                       MOVE   SYU-SKJ-FTNDAY(3)
                                            TO  FLG-KANGAN-ARI
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key19"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key19"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
           END-PERFORM
      *
           EVALUATE   FLG-KANGAN-ARI
             WHEN       41
                    MOVE    1    TO   FLG-KANGAN
             WHEN       42
                    MOVE    2    TO   FLG-KANGAN
             WHEN       43
                    MOVE    3    TO   FLG-KANGAN
      *
             WHEN       11
                    MOVE    1    TO   FLG-KANGAN
                    MOVE   11    TO   FLG-KANGAN-KBN
             WHEN       12
                    MOVE    1    TO   FLG-KANGAN
                    MOVE   12    TO   FLG-KANGAN-KBN
             WHEN       21
                    MOVE    2    TO   FLG-KANGAN
                    MOVE   21    TO   FLG-KANGAN-KBN
             WHEN       22
                    MOVE    2    TO   FLG-KANGAN
                    MOVE   22    TO   FLG-KANGAN-KBN
             WHEN       31
                    MOVE    3    TO   FLG-KANGAN
                    MOVE   31    TO   FLG-KANGAN-KBN
           END-EVALUATE
      *
           .
       2104E5-KANGAN-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    多数該当
      *****************************************************************
       2104E6-KANGAN-HANTEI2-SEC               SECTION.
      *
           MOVE      RECE62-SRYYM         TO   WRK-GEN70-YM
           IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
             MOVE    RECE62-TEKSTYMD(7:2) TO   WRK-GEN70-DD
           ELSE
             MOVE    01                   TO   WRK-GEN70-DD
           END-IF
      *
           MOVE      RECE62-SRYYM         TO   WRK-GEN702-YM
           IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
             MOVE    RECE62-TEKSTYMD-X(7:2)
                                          TO   WRK-GEN702-DD
           ELSE
             MOVE    01                   TO   WRK-GEN702-DD
           END-IF
      *
           IF   (RECE62-KOUREI-HANTEIFLG  =  "1")
           AND  (FLG-KANGAN               =   3 )
             CONTINUE
           ELSE
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE62-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE62-PTID           TO  PTKOH-PTID
             MOVE  "945"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key4"                TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key4"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    MOVE     1      TO  FLG-KANGAN-TASU
                    MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           MOVE      1     TO   FLG-KISAIOK2
      *
           IF  RECE62-KOUREI-HANTEIFLG = "1"
             IF   FLG-KANGAN-TASU  =  1
               MOVE  23    TO   FLG-TOKKI
             ELSE
               MOVE  22    TO   FLG-TOKKI
             END-IF
           ELSE
             IF   FLG-KANGAN-TASU  =  1
               MOVE  25    TO   FLG-TOKKI
             ELSE
               MOVE  24    TO   FLG-TOKKI
             END-IF
           END-IF
           PERFORM   21013-TOKKI-HENSYU-SEC
      *
           .
       2104E6-KANGAN-HANTEI2-EXT.
           EXIT.
      *
      *****************************************************************
      *    減免適用チェック
      *****************************************************************
       21043-GENMEN-TEK-CHECK-SEC      SECTION.
      *
           IF   (WK-GENGAKUKBN             =   1  )
           AND  (WK-GENGAKUKBN-KEISAN  NOT =  ZERO)
           AND  (FLG-GENGAKU5              =  ZERO)
      *
             IF      RECE62-KOUREI   =  "1" OR "2"
               IF      FLG-JYOGENKBN   =   1
                  MOVE  WRK-JYOGENKBN-TEN  TO  WRK-HANTEI-TOTALTEN
      ***         IF   FLG-ZEROKOGAITO   =   1
      ***           PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
      ***         ELSE
                    PERFORM  210464-JYOGENGAKU-HENSYU-SEC
      ***         END-IF
                  MOVE   WRK-KINGAKU-GENBUTU3  TO  WK-GENGAKU-KEISAN9
               END-IF
             END-IF
      *
             IF   WK-GENGAKU-KEISAN9  NOT =  ZERO
             AND  WK-GENGAKU-KEISAN9      =  RECE62-FTNMONEY(1)
                   MOVE    ZERO    TO   RECE62-GENMENKBN
                   MOVE    ZERO    TO   RECE62-GENGAKURATE
                   MOVE    ZERO    TO   RECE62-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
             END-IF
      *
           END-IF
      *
           IF   (WK-GENGAKUKBN   =    5  )
           AND  (FLG-GENGAKU5    =   ZERO)
      *
             IF      RECE62-KOUREI   =  "1" OR "2"
               IF      FLG-JYOGENKBN   =   1
                  MOVE  WRK-JYOGENKBN-TEN  TO  WRK-HANTEI-TOTALTEN
      ***         IF   FLG-ZEROKOGAITO   =   1
      ***           PERFORM  210464X-JYOGENGAKU-HENSYU2-SEC
      ***         ELSE
                    PERFORM  210464-JYOGENGAKU-HENSYU-SEC
      ***         END-IF
                  MOVE   WRK-KINGAKU-GENBUTU3  TO  WK-GENGAKU-KEISAN9
               END-IF
             END-IF
      *
             IF   WK-GENGAKU-KEISAN9  NOT =  ZERO
               IF   WK-GENGAKU-KEISAN9  <=  RECE62-GENGAKU
                   MOVE    ZERO    TO   RECE62-GENMENKBN
                   MOVE    ZERO    TO   RECE62-GENGAKU
                   MOVE    ZERO    TO   RECE62-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
               ELSE
                 IF   RECE62-GENGAKU  >=  WK-GENGAKU-KEISAN3
                   MOVE    ZERO    TO   RECE62-GENMENKBN
                   MOVE    ZERO    TO   RECE62-GENGAKU
                   MOVE    ZERO    TO   RECE62-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
                 ELSE
                   IF   WK-GENGAKU-KEISAN9  <  WK-GENGAKU-KEISAN3
                     MOVE  WK-GENGAKU-KEISAN9
                                   TO   WK-GENGAKU-KEISAN3
                   END-IF
                 END-IF
               END-IF
             ELSE
                 IF   RECE62-GENGAKU  >=  WK-GENGAKU-KEISAN3
                   MOVE    ZERO    TO   RECE62-GENMENKBN
                   MOVE    ZERO    TO   RECE62-GENGAKU
                   MOVE    ZERO    TO   RECE62-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
                 END-IF
             END-IF
      *
           END-IF
      *
      **>  IF   (WK-GENGAKUKBN   =    5)
      **>  AND  (FLG-GENGAKU5    =    1)
      **>        IF   RECE62-GENGAKU  >=  WK-GENGAKU-KEISAN3
      **>          MOVE    ZERO    TO   RECE62-GENMENKBN
      **>          MOVE    ZERO    TO   RECE62-GENGAKU
      **>          MOVE    ZERO    TO   RECE62-GENMEN-COM
      **>          MOVE    ZERO    TO   WK-GENGAKUKBN
      **>        END-IF
      **>  END-IF
      *
           IF  ((WK-GENGAKUKBN             =   1  ) AND
                (WK-GENGAKUKBN-KEISAN  NOT =  ZERO) AND
                (FLG-GENGAKU5              =   1  ))
           OR  ((WK-GENGAKUKBN             =   2  ) AND
                (FLG-GENGAKU5              =   1  ))
           OR  ((WK-GENGAKUKBN             =   5  ) AND
                (FLG-GENGAKU5              =   1  ))
             DISPLAY "WK-GENGAKUKBN="  WK-GENGAKUKBN
             DISPLAY "WK-GENGAKUKBN-KEISAN="  WK-GENGAKUKBN-KEISAN
             DISPLAY "公費併用の保険組み合わせ有"
           END-IF
      *
           .
       21043-GENMEN-TEK-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    包括点数の治験減点分編集
      *****************************************************************
       2113-GENTEN-HENSYU-SEC      SECTION.
      *
      *    指導のレセ点数の編集（減点）
           IF   RECE62-TENSU(2 1)  >=  RECE6G-TENSU(2 1)
             COMPUTE  RECE62-TENSU(2 1)  =
                      RECE62-TENSU(2 1)  -  RECE6G-TENSU(2 1)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 1)
           END-IF
           IF   RECE62-TENSU(2 2)  >=  RECE6G-TENSU(2 2)
             COMPUTE  RECE62-TENSU(2 2)  =
                      RECE62-TENSU(2 2)  -  RECE6G-TENSU(2 2)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 2)
           END-IF
           IF   RECE62-TENSU(2 3)  >=  RECE6G-TENSU(2 3)
             COMPUTE  RECE62-TENSU(2 3)  =
                      RECE62-TENSU(2 3)  -  RECE6G-TENSU(2 3)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 3)
           END-IF
           IF   RECE62-TENSU(2 4)  >=  RECE6G-TENSU(2 4)
             COMPUTE  RECE62-TENSU(2 4)  =
                      RECE62-TENSU(2 4)  -  RECE6G-TENSU(2 4)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 4)
           END-IF
           IF   RECE62-TENSU(2 5)  >=  RECE6G-TENSU(2 5)
             COMPUTE  RECE62-TENSU(2 5)  =
                      RECE62-TENSU(2 5)  -  RECE6G-TENSU(2 5)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(2 5)
           END-IF
           IF   RECE62-SYUTANTEN(2)  >=  RECE6G-SYUTANTEN(2)
             COMPUTE  RECE62-SYUTANTEN(2)  =
                      RECE62-SYUTANTEN(2)  -  RECE6G-SYUTANTEN(2)
           ELSE
             MOVE     ZERO    TO   RECE62-SYUTANTEN(2)
           END-IF
           IF   RECE62-ALLTENSU(2)   >=  RECE6G-ALLTENSU(2)
             COMPUTE  RECE62-ALLTENSU(2)   =
                      RECE62-ALLTENSU(2)   -  RECE6G-ALLTENSU(2)
           ELSE
             MOVE     ZERO    TO   RECE62-ALLTENSU(2)
           END-IF
      *
           IF   RECE62-SKYHENTEN(2 3)  >=  RECE6G-SKYHENTEN(2 3)
             COMPUTE  RECE62-SKYHENTEN(2 3)  =
                      RECE62-SKYHENTEN(2 3)  -  RECE6G-SKYHENTEN(2 3)
           ELSE
             MOVE     ZERO    TO   RECE62-SKYHENTEN(2 3)
           END-IF
           IF   RECE62-SKYHENTEN(2 4)  >=  RECE6G-SKYHENTEN(2 4)
             COMPUTE  RECE62-SKYHENTEN(2 4)  =
                      RECE62-SKYHENTEN(2 4)  -  RECE6G-SKYHENTEN(2 4)
           ELSE
             MOVE     ZERO    TO   RECE62-SKYHENTEN(2 4)
           END-IF
           IF   RECE62-SKYHENTEN(2 5)  >=  RECE6G-SKYHENTEN(2 5)
             COMPUTE  RECE62-SKYHENTEN(2 5)  =
                      RECE62-SKYHENTEN(2 5)  -  RECE6G-SKYHENTEN(2 5)
           ELSE
             MOVE     ZERO    TO   RECE62-SKYHENTEN(2 5)
           END-IF
      *
      *    在宅のレセ点数の編集（減点）
           IF   RECE62-TENSU(3 1)  >=  RECE6G-TENSU(3 1)
             COMPUTE  RECE62-TENSU(3 1)  =
                      RECE62-TENSU(3 1)  -  RECE6G-TENSU(3 1)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 1)
           END-IF
           IF   RECE62-TENSU(3 2)  >=  RECE6G-TENSU(3 2)
             COMPUTE  RECE62-TENSU(3 2)  =
                      RECE62-TENSU(3 2)  -  RECE6G-TENSU(3 2)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 2)
           END-IF
           IF   RECE62-TENSU(3 3)  >=  RECE6G-TENSU(3 3)
             COMPUTE  RECE62-TENSU(3 3)  =
                      RECE62-TENSU(3 3)  -  RECE6G-TENSU(3 3)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 3)
           END-IF
           IF   RECE62-TENSU(3 4)  >=  RECE6G-TENSU(3 4)
             COMPUTE  RECE62-TENSU(3 4)  =
                      RECE62-TENSU(3 4)  -  RECE6G-TENSU(3 4)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 4)
           END-IF
           IF   RECE62-TENSU(3 5)  >=  RECE6G-TENSU(3 5)
             COMPUTE  RECE62-TENSU(3 5)  =
                      RECE62-TENSU(3 5)  -  RECE6G-TENSU(3 5)
           ELSE
             MOVE     ZERO    TO   RECE62-TENSU(3 5)
           END-IF
           IF   RECE62-SYUTANTEN(3)  >=  RECE6G-SYUTANTEN(3)
             COMPUTE  RECE62-SYUTANTEN(3)  =
                      RECE62-SYUTANTEN(3)  -  RECE6G-SYUTANTEN(3)
           ELSE
             MOVE     ZERO    TO   RECE62-SYUTANTEN(3)
           END-IF
           IF   RECE62-ALLTENSU(3)   >=  RECE6G-ALLTENSU(3)
             COMPUTE  RECE62-ALLTENSU(3)   =
                      RECE62-ALLTENSU(3)   -  RECE6G-ALLTENSU(3)
           ELSE
             MOVE     ZERO    TO   RECE62-ALLTENSU(3)
           END-IF
      *
           IF   RECE62-SKYHENTEN(3 3)  >=  RECE6G-SKYHENTEN(3 3)
             COMPUTE  RECE62-SKYHENTEN(3 3)  =
                      RECE62-SKYHENTEN(3 3)  -  RECE6G-SKYHENTEN(3 3)
           ELSE
             MOVE     ZERO    TO   RECE62-SKYHENTEN(3 3)
           END-IF
           IF   RECE62-SKYHENTEN(3 4)  >=  RECE6G-SKYHENTEN(3 4)
             COMPUTE  RECE62-SKYHENTEN(3 4)  =
                      RECE62-SKYHENTEN(3 4)  -  RECE6G-SKYHENTEN(3 4)
           ELSE
             MOVE     ZERO    TO   RECE62-SKYHENTEN(3 4)
           END-IF
           IF   RECE62-SKYHENTEN(3 5)  >=  RECE6G-SKYHENTEN(3 5)
             COMPUTE  RECE62-SKYHENTEN(3 5)  =
                      RECE62-SKYHENTEN(3 5)  -  RECE6G-SKYHENTEN(3 5)
           ELSE
             MOVE     ZERO    TO   RECE62-SKYHENTEN(3 5)
           END-IF
      *
      *    その他注射のレセ点数の編集（減点）
           IF   RECE6C-TENSU(12 1)  >=  RECE6G-TENSU(12 1)
             COMPUTE  RECE62-TENSU(12 1)  =
                      RECE62-TENSU(12 1)  -  RECE6G-TENSU(12 1)
           ELSE
             COMPUTE  RECE62-TENSU(12 1)  =
                      RECE62-TENSU(12 1)  -  RECE6C-TENSU(12 1)
             COMPUTE  RECE6G-TENSU(12 1) =
                      RECE6G-TENSU(12 1) -
                      RECE6C-TENSU(12 1)
             IF  RECE6C-TENSU(11 1)  >=   RECE6G-TENSU(12 1)
               COMPUTE  RECE62-TENSU(11 1)  =
                        RECE62-TENSU(11 1)  -  RECE6G-TENSU(12 1)
             ELSE
               COMPUTE  RECE62-TENSU(11 1)  =
                        RECE62-TENSU(11 1)  -  RECE6C-TENSU(11 1)
               COMPUTE  RECE6G-TENSU(12 1) =
                        RECE6G-TENSU(12 1) -
                        RECE6C-TENSU(11 1)
               IF  RECE6C-TENSU(10 1)  >=   RECE6G-TENSU(12 1)
                 COMPUTE  RECE62-TENSU(10 1)  =
                          RECE62-TENSU(10 1)  -  RECE6G-TENSU(12 1)
               ELSE
                 COMPUTE  RECE62-TENSU(10 1)  =
                          RECE62-TENSU(10 1)  -  RECE6C-TENSU(10 1)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-TENSU(12 2)  >=  RECE6G-TENSU(12 2)
             COMPUTE  RECE62-TENSU(12 2)  =
                      RECE62-TENSU(12 2)  -  RECE6G-TENSU(12 2)
           ELSE
             COMPUTE  RECE62-TENSU(12 2)  =
                      RECE62-TENSU(12 2)  -  RECE6C-TENSU(12 2)
             COMPUTE  RECE6G-TENSU(12 2) =
                      RECE6G-TENSU(12 2) -
                      RECE6C-TENSU(12 2)
             IF  RECE6C-TENSU(11 2)  >=   RECE6G-TENSU(12 2)
               COMPUTE  RECE62-TENSU(11 2)  =
                        RECE62-TENSU(11 2)  -  RECE6G-TENSU(12 2)
             ELSE
               COMPUTE  RECE62-TENSU(11 2)  =
                        RECE62-TENSU(11 2)  -  RECE6C-TENSU(11 2)
               COMPUTE  RECE6G-TENSU(12 2) =
                        RECE6G-TENSU(12 2) -
                        RECE6C-TENSU(11 2)
               IF  RECE6C-TENSU(10 2)  >=   RECE6G-TENSU(12 2)
                 COMPUTE  RECE62-TENSU(10 2)  =
                          RECE62-TENSU(10 2)  -  RECE6G-TENSU(12 2)
               ELSE
                 COMPUTE  RECE62-TENSU(10 2)  =
                          RECE62-TENSU(10 2)  -  RECE6C-TENSU(10 2)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-TENSU(12 3)  >=  RECE6G-TENSU(12 3)
             COMPUTE  RECE62-TENSU(12 3)  =
                      RECE62-TENSU(12 3)  -  RECE6G-TENSU(12 3)
           ELSE
             COMPUTE  RECE62-TENSU(12 3)  =
                      RECE62-TENSU(12 3)  -  RECE6C-TENSU(12 3)
             COMPUTE  RECE6G-TENSU(12 3) =
                      RECE6G-TENSU(12 3) -
                      RECE6C-TENSU(12 3)
             IF  RECE6C-TENSU(11 3)  >=   RECE6G-TENSU(12 3)
               COMPUTE  RECE62-TENSU(11 3)  =
                        RECE62-TENSU(11 3)  -  RECE6G-TENSU(12 3)
             ELSE
               COMPUTE  RECE62-TENSU(11 3)  =
                        RECE62-TENSU(11 3)  -  RECE6C-TENSU(11 3)
               COMPUTE  RECE6G-TENSU(12 3) =
                        RECE6G-TENSU(12 3) -
                        RECE6C-TENSU(11 3)
               IF  RECE6C-TENSU(10 3)  >=   RECE6G-TENSU(12 3)
                 COMPUTE  RECE62-TENSU(10 3)  =
                          RECE62-TENSU(10 3)  -  RECE6G-TENSU(12 3)
               ELSE
                 COMPUTE  RECE62-TENSU(10 3)  =
                          RECE62-TENSU(10 3)  -  RECE6C-TENSU(10 3)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-TENSU(12 4)  >=  RECE6G-TENSU(12 4)
             COMPUTE  RECE62-TENSU(12 4)  =
                      RECE62-TENSU(12 4)  -  RECE6G-TENSU(12 4)
           ELSE
             COMPUTE  RECE62-TENSU(12 4)  =
                      RECE62-TENSU(12 4)  -  RECE6C-TENSU(12 4)
             COMPUTE  RECE6G-TENSU(12 4) =
                      RECE6G-TENSU(12 4) -
                      RECE6C-TENSU(12 4)
             IF  RECE6C-TENSU(11 4)  >=   RECE6G-TENSU(12 4)
               COMPUTE  RECE62-TENSU(11 4)  =
                        RECE62-TENSU(11 4)  -  RECE6G-TENSU(12 4)
             ELSE
               COMPUTE  RECE62-TENSU(11 4)  =
                        RECE62-TENSU(11 4)  -  RECE6C-TENSU(11 4)
               COMPUTE  RECE6G-TENSU(12 4) =
                        RECE6G-TENSU(12 4) -
                        RECE6C-TENSU(11 4)
               IF  RECE6C-TENSU(10 4)  >=   RECE6G-TENSU(12 4)
                 COMPUTE  RECE62-TENSU(10 4)  =
                          RECE62-TENSU(10 4)  -  RECE6G-TENSU(12 4)
               ELSE
                 COMPUTE  RECE62-TENSU(10 4)  =
                          RECE62-TENSU(10 4)  -  RECE6C-TENSU(10 4)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-TENSU(12 5)  >=  RECE6G-TENSU(12 5)
             COMPUTE  RECE62-TENSU(12 5)  =
                      RECE62-TENSU(12 5)  -  RECE6G-TENSU(12 5)
           ELSE
             COMPUTE  RECE62-TENSU(12 5)  =
                      RECE62-TENSU(12 5)  -  RECE6C-TENSU(12 5)
             COMPUTE  RECE6G-TENSU(12 5) =
                      RECE6G-TENSU(12 5) -
                      RECE6C-TENSU(12 5)
             IF  RECE6C-TENSU(11 5)  >=   RECE6G-TENSU(12 5)
               COMPUTE  RECE62-TENSU(11 5)  =
                        RECE62-TENSU(11 5)  -  RECE6G-TENSU(12 5)
             ELSE
               COMPUTE  RECE62-TENSU(11 5)  =
                        RECE62-TENSU(11 5)  -  RECE6C-TENSU(11 5)
               COMPUTE  RECE6G-TENSU(12 5) =
                        RECE6G-TENSU(12 5) -
                        RECE6C-TENSU(11 5)
               IF  RECE6C-TENSU(10 5)  >=   RECE6G-TENSU(12 5)
                 COMPUTE  RECE62-TENSU(10 5)  =
                          RECE62-TENSU(10 5)  -  RECE6G-TENSU(12 5)
               ELSE
                 COMPUTE  RECE62-TENSU(10 5)  =
                          RECE62-TENSU(10 5)  -  RECE6C-TENSU(10 5)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-SYUTANTEN(12)  >=  RECE6G-SYUTANTEN(12)
             COMPUTE  RECE62-SYUTANTEN(12)  =
                      RECE62-SYUTANTEN(12)  -  RECE6G-SYUTANTEN(12)
           ELSE
             COMPUTE  RECE62-SYUTANTEN(12)  =
                      RECE62-SYUTANTEN(12)  -  RECE6C-SYUTANTEN(12)
             COMPUTE  RECE6G-SYUTANTEN(12) =
                      RECE6G-SYUTANTEN(12) -
                      RECE6C-SYUTANTEN(12)
             IF  RECE6C-SYUTANTEN(11)  >=   RECE6G-SYUTANTEN(12)
               COMPUTE  RECE62-SYUTANTEN(11)  =
                        RECE62-SYUTANTEN(11)  -  RECE6G-SYUTANTEN(12)
             ELSE
               COMPUTE  RECE62-SYUTANTEN(11)  =
                        RECE62-SYUTANTEN(11)  -  RECE6C-SYUTANTEN(11)
               COMPUTE  RECE6G-SYUTANTEN(12) =
                        RECE6G-SYUTANTEN(12) -
                        RECE6C-SYUTANTEN(11)
               IF  RECE6C-SYUTANTEN(10)  >=   RECE6G-SYUTANTEN(12)
                 COMPUTE  RECE62-SYUTANTEN(10)  =
                          RECE62-SYUTANTEN(10)  -  RECE6G-SYUTANTEN(12)
               ELSE
                 COMPUTE  RECE62-SYUTANTEN(10)  =
                          RECE62-SYUTANTEN(10)  -  RECE6C-SYUTANTEN(10)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-ALLTENSU(12)   >=  RECE6G-ALLTENSU(12)
             COMPUTE  RECE62-ALLTENSU(12)   =
                      RECE62-ALLTENSU(12)   -  RECE6G-ALLTENSU(12)
           ELSE
             COMPUTE  RECE62-ALLTENSU(12)   =
                      RECE62-ALLTENSU(12)   -  RECE6C-ALLTENSU(12)
             COMPUTE  RECE6G-ALLTENSU(12)  =
                      RECE6G-ALLTENSU(12)  -
                      RECE6C-ALLTENSU(12)
             IF  RECE6C-ALLTENSU(11)   >=   RECE6G-ALLTENSU(12)
               COMPUTE  RECE62-ALLTENSU(11)   =
                        RECE62-ALLTENSU(11)   -  RECE6G-ALLTENSU(12)
             ELSE
               COMPUTE  RECE62-ALLTENSU(11)   =
                        RECE62-ALLTENSU(11)   -  RECE6C-ALLTENSU(11)
               COMPUTE  RECE6G-ALLTENSU(12)  =
                        RECE6G-ALLTENSU(12)  -
                        RECE6C-ALLTENSU(11)
               IF  RECE6C-ALLTENSU(10)   >=   RECE6G-ALLTENSU(12)
                 COMPUTE  RECE62-ALLTENSU(10)   =
                          RECE62-ALLTENSU(10)   -  RECE6G-ALLTENSU(12)
               ELSE
                 COMPUTE  RECE62-ALLTENSU(10)   =
                          RECE62-ALLTENSU(10)   -  RECE6C-ALLTENSU(10)
               END-IF
             END-IF
           END-IF
      *
           IF   RECE6C-SKYHENTEN(12 3)  >=  RECE6G-SKYHENTEN(12 3)
             COMPUTE  RECE62-SKYHENTEN(12 3) =
                      RECE62-SKYHENTEN(12 3) -  RECE6G-SKYHENTEN(12 3)
           ELSE
             COMPUTE  RECE62-SKYHENTEN(12 3) =
                      RECE62-SKYHENTEN(12 3) -  RECE6C-SKYHENTEN(12 3)
             COMPUTE  RECE6G-SKYHENTEN(12 3) =
                      RECE6G-SKYHENTEN(12 3) -
                      RECE6C-SKYHENTEN(12 3)
             IF  RECE6C-SKYHENTEN(11 3)  >=   RECE6G-SKYHENTEN(12 3)
               COMPUTE  RECE62-SKYHENTEN(11 3) =
                        RECE62-SKYHENTEN(11 3) -  RECE6G-SKYHENTEN(12 3)
             ELSE
               COMPUTE  RECE62-SKYHENTEN(11 3) =
                        RECE62-SKYHENTEN(11 3) -  RECE6C-SKYHENTEN(11 3)
               COMPUTE  RECE6G-SKYHENTEN(12 3) =
                        RECE6G-SKYHENTEN(12 3) -
                        RECE6C-SKYHENTEN(11 3)
               IF  RECE6C-SKYHENTEN(10 3)  >=   RECE6G-SKYHENTEN(12 3)
                 COMPUTE RECE62-SKYHENTEN(10 3) =
                         RECE62-SKYHENTEN(10 3) - RECE6G-SKYHENTEN(12 3)
               ELSE
                 COMPUTE RECE62-SKYHENTEN(10 3) =
                         RECE62-SKYHENTEN(10 3) - RECE6C-SKYHENTEN(10 3)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-SKYHENTEN(12 4)  >=  RECE6G-SKYHENTEN(12 4)
             COMPUTE  RECE62-SKYHENTEN(12 4) =
                      RECE62-SKYHENTEN(12 4) -  RECE6G-SKYHENTEN(12 4)
           ELSE
             COMPUTE  RECE62-SKYHENTEN(12 4) =
                      RECE62-SKYHENTEN(12 4) -  RECE6C-SKYHENTEN(12 4)
             COMPUTE  RECE6G-SKYHENTEN(12 4) =
                      RECE6G-SKYHENTEN(12 4) -
                      RECE6C-SKYHENTEN(12 4)
             IF  RECE6C-SKYHENTEN(11 4)  >=   RECE6G-SKYHENTEN(12 4)
               COMPUTE  RECE62-SKYHENTEN(11 4) =
                        RECE62-SKYHENTEN(11 4) -  RECE6G-SKYHENTEN(12 4)
             ELSE
               COMPUTE  RECE62-SKYHENTEN(11 4) =
                        RECE62-SKYHENTEN(11 4) -  RECE6C-SKYHENTEN(11 4)
               COMPUTE  RECE6G-SKYHENTEN(12 4) =
                        RECE6G-SKYHENTEN(12 4) -
                        RECE6C-SKYHENTEN(11 4)
               IF  RECE6C-SKYHENTEN(10 4)  >=   RECE6G-SKYHENTEN(12 4)
                 COMPUTE RECE62-SKYHENTEN(10 4) =
                         RECE62-SKYHENTEN(10 4) - RECE6G-SKYHENTEN(12 4)
               ELSE
                 COMPUTE RECE62-SKYHENTEN(10 4) =
                         RECE62-SKYHENTEN(10 4) - RECE6C-SKYHENTEN(10 4)
               END-IF
             END-IF
           END-IF
           IF   RECE6C-SKYHENTEN(12 5)  >=  RECE6G-SKYHENTEN(12 5)
             COMPUTE  RECE62-SKYHENTEN(12 5) =
                      RECE62-SKYHENTEN(12 5) -  RECE6G-SKYHENTEN(12 5)
           ELSE
             COMPUTE  RECE62-SKYHENTEN(12 5) =
                      RECE62-SKYHENTEN(12 5) -  RECE6C-SKYHENTEN(12 5)
             COMPUTE  RECE6G-SKYHENTEN(12 5) =
                      RECE6G-SKYHENTEN(12 5) -
                      RECE6C-SKYHENTEN(12 5)
             IF  RECE6C-SKYHENTEN(11 5)  >=   RECE6G-SKYHENTEN(12 5)
               COMPUTE  RECE62-SKYHENTEN(11 5) =
                        RECE62-SKYHENTEN(11 5) -  RECE6G-SKYHENTEN(12 5)
             ELSE
               COMPUTE  RECE62-SKYHENTEN(11 5) =
                        RECE62-SKYHENTEN(11 5) -  RECE6C-SKYHENTEN(11 5)
               COMPUTE  RECE6G-SKYHENTEN(12 5) =
                        RECE6G-SKYHENTEN(12 5) -
                        RECE6C-SKYHENTEN(11 5)
               IF  RECE6C-SKYHENTEN(10 5)  >=   RECE6G-SKYHENTEN(12 5)
                 COMPUTE RECE62-SKYHENTEN(10 5) =
                         RECE62-SKYHENTEN(10 5) - RECE6G-SKYHENTEN(12 5)
               ELSE
                 COMPUTE RECE62-SKYHENTEN(10 5) =
                         RECE62-SKYHENTEN(10 5) - RECE6C-SKYHENTEN(10 5)
               END-IF
             END-IF
           END-IF
      *
           .
       2113-GENTEN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    分点編集
      *****************************************************************
       2114-BUNTENSU-HENSYU-SEC               SECTION.
      *
           IF    RECE62-FUKUSHIFLG(3)  =  "2"
              IF   RECE62-HENTOTALTEN(3) = RECE62-TOTALTEN(3)
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(3)
                  MOVE   2       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
           IF    RECE62-FUKUSHIFLG(4)  =  "2"
              IF   RECE62-HENTOTALTEN(4) = RECE62-TOTALTEN(4)
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(4)
                  MOVE   3       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
           IF    RECE62-FUKUSHIFLG(5)  =  "2"
              IF   RECE62-HENTOTALTEN(5) = RECE62-TOTALTEN(5)
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(5)
                  MOVE   4       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
      *
           IF ((RECE62-TOTALTEN(1) NOT =  ZERO                 ) AND
               (RECE62-TOTALTEN(1)     =  RECE62-TOTALTEN(2)   ) AND
               (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(3)) AND
               (RECE62-KOHNUM(3)       =  SPACE                ) AND
               (RECE62-KOHNUM(4)       =  SPACE                ))
           OR ((RECE62-TOTALTEN(1) NOT =  ZERO                 ) AND
               (RECE62-TOTALTEN(1)     =  RECE62-TOTALTEN(2)   ) AND
               (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(3)) AND
               (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(4)) AND
               (RECE62-KOHNUM(4)       =  SPACE                ))
             IF  RECE62-FUKUSHIFLG(3)  =  "3"
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(3)
                  MOVE   2       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
             END-IF
             IF  RECE62-FUKUSHIFLG(4)  =  "3"
                  MOVE   SPACE   TO   RECE62-FUKUSHIFLG(4)
                  MOVE   3       TO   KOHFTN-IDX
                  PERFORM  21141-FTNKBNFLG-CLEAR-SEC
             END-IF
           END-IF
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   3   BY   1
                       UNTIL    KOHFTN-IDX     >    5
      *
             IF   RECE62-FUKUSHIFLG(KOHFTN-IDX)   NOT =  SPACE
                  IF   RECE62-TOTALTEN(KOHFTN-IDX) = ZERO
                    PERFORM  21144-TENSU-HENSYU3-SEC
                  ELSE
                    PERFORM  21142-TENSU-HENSYU1-SEC
                  END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       2114-BUNTENSU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセ電用負担区分編集フラグクリア
      *****************************************************************
       21141-FTNKBNFLG-CLEAR-SEC               SECTION.
      *
           PERFORM  VARYING  IDX13   FROM    1   BY  1
                     UNTIL  (IDX13                   >   10 )
                       OR   (RECE62-HKNCOMBI(IDX13)  =  ZERO)
      *
             IF  (RECE62-KOHNUMHC(IDX13 2) = RECE62-KOHNUM(KOHFTN-IDX))
             AND (RECE62-KOHIDHC(IDX13 2)  = RECE62-KOHID(KOHFTN-IDX) )
               MOVE      ZERO   TO   RECE62-FTNKBNFLG(IDX13 2)
               IF   (WRK-PREFNUM              = "36"    )
               AND  (RECE62-KOHNUMHC(IDX13 2) = "245"   )
               AND  (RECE62-KOHNUMHC(IDX13 3) = "748"   )
               AND  (RECE62-SRYYM            >= "200805")
                  MOVE   ZERO   TO   RECE62-FTNKBNFLG(IDX13 3)
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       21141-FTNKBNFLG-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療区分別点数編集
      *****************************************************************
       21142-TENSU-HENSYU1-SEC               SECTION.
      *
           PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX2     >   30
              MOVE     RECE62-SKYHENTEN(KOHFTN-IDX2 KOHFTN-IDX)
                       TO  RECE62-TENSU(KOHFTN-IDX2 KOHFTN-IDX)
           END-PERFORM
           PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX2     >   20
              MOVE     RECE62-SKYHENTEN-KHNKEI(KOHFTN-IDX2 KOHFTN-IDX)
                       TO  RECE62-NYUKHNKEI(KOHFTN-IDX2 KOHFTN-IDX)
              MOVE     RECE62-SKYHENTEN-TOKKEI(KOHFTN-IDX2 KOHFTN-IDX)
                       TO  RECE62-NYUTOKKEI(KOHFTN-IDX2 KOHFTN-IDX)
           END-PERFORM
           MOVE     RECE62-SKYHENTEN-KHNKEI2(KOHFTN-IDX)
                    TO  RECE62-NYUKHNKEI2(KOHFTN-IDX)
           MOVE     RECE62-SKYHENTEN-TOKKEI2(KOHFTN-IDX)
                    TO  RECE62-NYUTOKKEI2(KOHFTN-IDX)
      *
           .
       21142-TENSU-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療区分別点数編集
      *****************************************************************
       21144-TENSU-HENSYU3-SEC               SECTION.
      *
           PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX2     >   30
              MOVE  ZERO  TO  RECE62-TENSU(KOHFTN-IDX2 KOHFTN-IDX)
           END-PERFORM
           PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX2     >   20
              MOVE  ZERO  TO  RECE62-NYUKHNKEI(KOHFTN-IDX2 KOHFTN-IDX)
              MOVE  ZERO  TO  RECE62-NYUTOKKEI(KOHFTN-IDX2 KOHFTN-IDX)
           END-PERFORM
           MOVE     ZERO  TO  RECE62-NYUKHNKEI2(KOHFTN-IDX)
           MOVE     ZERO  TO  RECE62-NYUTOKKEI2(KOHFTN-IDX)
      *
           .
       21144-TENSU-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害該当者の判定
      *****************************************************************
       2115-SAIGAI-TAISYO-HANTEI-SEC      SECTION.
      *
           IF     RECE62-HKNNUM   NOT =   SPACE
             IF  (RECE62-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
               CONTINUE
             ELSE
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU-YM
               IF   RECE62-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                  MOVE   RECE62-TEKSTYMD(7:2)
                                            TO   WK-GENGAKU-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU-DD
               END-IF
      *
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU2-YM
               IF   RECE62-TEKEDYMD-X(1:6) >  RECE62-SRYYM
                 INITIALIZE                      STS-AREA-DAY
                 INITIALIZE                      LNK-DAY7-AREA
                 MOVE   "71"                TO   LNK-DAY7-IRAI
                 MOVE   RECE62-SRYYM        TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                                 LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
               ELSE
                 MOVE   RECE62-TEKEDYMD-X(7:2)
                                            TO   WK-GENGAKU2-DD
               END-IF
      *
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU3-YM
               IF   RECE62-TEKSTYMD-X(1:6)  >=  RECE62-SRYYM
                  MOVE   RECE62-TEKSTYMD-X(7:2)
                                            TO   WK-GENGAKU3-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU3-DD
               END-IF
      *
               PERFORM  21151-SAIGAI-TAISYO-HENSYU-SEC
             END-IF
           ELSE
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU-YM
               IF   RECE62-KOHTEKSTYMD(1)(1:6)
                                          >=  RECE62-SRYYM
                  MOVE   RECE62-KOHTEKSTYMD(1)(7:2)
                                            TO   WK-GENGAKU-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU-DD
               END-IF
      *
               MOVE      RECE62-SRYYM       TO   WK-GENGAKU2-YM
               IF   RECE62-KOHTEKEDYMD(1)(1:6)
                                           >  RECE62-SRYYM
                 INITIALIZE                      STS-AREA-DAY
                 INITIALIZE                      LNK-DAY7-AREA
                 MOVE   "71"                TO   LNK-DAY7-IRAI
                 MOVE   RECE62-SRYYM        TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                                 LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
               ELSE
                 MOVE   RECE62-KOHTEKEDYMD(1)(7:2)
                                            TO   WK-GENGAKU2-DD
               END-IF
      *
               MOVE     "99999999"          TO   WK-GENGAKU3-YMD
      *
               PERFORM  21151-SAIGAI-TAISYO-HENSYU-SEC
           END-IF
      *
           .
       2115-SAIGAI-TAISYO-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害該当者の編集
      *****************************************************************
       21151-SAIGAI-TAISYO-HENSYU-SEC      SECTION.
      *
           MOVE     SPACE    TO     WK-CHECK-TEKSTYMD
           MOVE     SPACE    TO     WK-CHECK-TEKEDYMD
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE62-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE62-PTID          TO  PTKOH-PTID
           MOVE    "959"                TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
              MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
              MOVE    "key4"             TO  MCP-PATHNAME
              PERFORM  900-PTKOHINF-READ-SEC
              PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WK-GENGAKU-YMD ) AND
                    (WK-GENGAKU-YMD  <=   PTKOH-TEKEDYMD ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU2-YMD) AND
                    (WK-GENGAKU2-YMD <=   PTKOH-TEKEDYMD ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU3-YMD) AND
                    (WK-GENGAKU3-YMD <=   PTKOH-TEKEDYMD ) AND
                    (WK-GENGAKU3-YMD NOT = "99999999"    ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                  MOVE     1             TO  FLG-SAIGAI-TAISYO
                  IF   PTKOH-TEKSTYMD(1:6)  >=  RECE62-SRYYM
                     MOVE   PTKOH-TEKSTYMD(7:2)
                                         TO  WRK-SAIGAI-DD
                  ELSE
                     MOVE   01           TO  WRK-SAIGAI-DD
                  END-IF
      *
                  MOVE  PTKOH-TEKSTYMD   TO  WK-CHECK-TEKSTYMD
                  IF    PTKOH-TEKSTYMD(1:6)  <  RECE62-SRYYM
                    MOVE  RECE62-SRYYM   TO  WK-CHECK-TEKSTYMD(1:6)
                    MOVE  "01"           TO  WK-CHECK-TEKSTYMD(7:2)
                  END-IF
                  MOVE  PTKOH-TEKEDYMD   TO  WK-CHECK-TEKEDYMD
                  IF    PTKOH-TEKEDYMD(1:6)  >  RECE62-SRYYM
                    MOVE  RECE62-SRYYM   TO  WK-CHECK-TEKEDYMD(1:6)
                    MOVE  "31"           TO  WK-CHECK-TEKEDYMD(7:2)
                  END-IF
      *
                  MOVE     1             TO  FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf" TO  MCP-TABLE
                  MOVE    "key4"         TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
              END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           MOVE     ZERO      TO  FLG-CHECK-ARI
           IF   FLG-SAIGAI-TAISYO  =  1
              PERFORM  211011-GENGAKU-CHECK-SEC
              IF   FLG-CHECK-ARI  =  ZERO
                MOVE   ZERO   TO  FLG-SAIGAI-TAISYO
              END-IF
           END-IF
      *
           .
       21151-SAIGAI-TAISYO-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額情報編集
      *****************************************************************
       2116-SKY-HENSYU-SEC      SECTION.
      *
      **   減免の免除・支払猶予以外は、災２の請求額情報編集は未対応
      *
           IF   (IDZ             =    1    )
           AND  (RECE62-SRYYM   >= "201004")
      *
      *      ＜医療費＞
      *
      *      主保険がある保険組み合わせ
             IF    (WRK-SKY-ZENGAKU      >  ZERO            )
             AND   (WRK-SKY-ICHIBUFTN    >  WRK-SKY-FTNMONEY)
               MOVE    ZERO    TO   FLG-KGK
               MOVE    ZERO    TO   FLG-KGK2
               IF     RECE62-KOUREI   =  "1" OR "2"
                 COMPUTE      WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU
                                              - WRK-SKY-HOKENJA
                 IF    (WRK-SKY-ICHIBUFTN  >  RECE62-FTNMONEY-SKY)
                 AND   (WRK-SKY-KEISAN     >  RECE62-FTNMONEY-SKY)
                   COMPUTE    WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                              - RECE62-FTNMONEY-SKY
                   IF   WRK-CHK-ICHIBUGAKU2  NOT =  ZERO
                     IF  WRK-SKY-FTNMONEY  >  RECE62-FTNMONEY-SKY
                       COMPUTE WRK-SKY-KEISAN5 = WRK-SKY-FTNMONEY
                                               - RECE62-FTNMONEY-SKY
                       IF  WRK-SKY-KEISAN2 > WRK-SKY-KEISAN5
                         COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN2
                                                 - WRK-SKY-KEISAN5
                       ELSE
                         MOVE    ZERO   TO   WRK-SKY-KEISAN2
                       END-IF
                     END-IF
                   END-IF
                   ADD    WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-HOKENJA
                   MOVE   1                TO  FLG-KGK2
                 END-IF
                 IF   RECE62-SKYIRYO-HOKENJA > WRK-SKY-FTNMONEY-XX2
                   COMPUTE  RECE62-SKYIRYO-HOKENJA  =
                            RECE62-SKYIRYO-HOKENJA  -
                            WRK-SKY-FTNMONEY-XX2
                 ELSE
                   MOVE   ZERO             TO  RECE62-SKYIRYO-HOKENJA
                 END-IF
               ELSE
                 IF  (RECE62-KOUREI       =  SPACE)
                 OR  (WK-GENGAKUKBN   NOT =  ZERO )
                   IF   WRK-SKY-ZENGAKU-KOH   =   ZERO
                     COMPUTE    WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU
                                                - WRK-SKY-HOKENJA
                     IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY
                       COMPUTE  WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                                - WRK-SKY-FTNMONEY
                       ADD   WRK-SKY-KEISAN2
                                        TO  RECE62-SKYIRYO-HOKENJA
                     END-IF
                   ELSE
                     IF  (RECE62-KOUREI   NOT =  SPACE)
                     AND (WK-GENGAKUKBN   NOT =  ZERO )
                       IF   RECE62-FTNMONEY-SKY  >  WRK-SKY-FTNMONEY3
                         COMPUTE RECE62-FTNMONEY-SKY =
                                 RECE62-FTNMONEY-SKY -
                                 WRK-SKY-FTNMONEY3
                       ELSE
                         MOVE    ZERO        TO  RECE62-FTNMONEY-SKY
                       END-IF
                     END-IF
                     COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU-KOH
                                               - WRK-SKY-HOKENJA-KOH
                     IF   WRK-SKY-KEISAN  >  RECE62-FTNMONEY-SKY
                       COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                               - RECE62-FTNMONEY-SKY
                       ADD   WRK-SKY-KEISAN2
                                      TO  RECE62-SKYIRYO-HOKENJA
                       MOVE    1             TO  FLG-KGK
                     END-IF
                     IF   WK-GENGAKUKBN   NOT =  ZERO
                       COMPUTE   WRK-SKY-KEISAN5 = WRK-SKY-ZENGAKU
                                                 - WRK-SKY-ZENGAKU-KOH
                       COMPUTE   WRK-SKY-KEISAN6 = WRK-SKY-HOKENJA
                                                 - WRK-SKY-HOKENJA-KOH
                       COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-KEISAN5
                                                 - WRK-SKY-KEISAN6
                       IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY3
                         COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                                 - WRK-SKY-FTNMONEY3
                         ADD   WRK-SKY-KEISAN2
                                        TO  RECE62-SKYIRYO-HOKENJA
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               MOVE WRK-SKY-FTNMONEY    TO  WRK-SKY-FTNMONEY9
               IF   WRK-SKY-FTNMONEY >= WRK-SKY-FTNMONEY-XXX
                 COMPUTE  WRK-SKY-FTNMONEY9         =
                          WRK-SKY-FTNMONEY          -
                          WRK-SKY-FTNMONEY-XXX
                 IF   RECE62-SRYYM   >=  "202001"
                   CONTINUE
                 ELSE
                   COMPUTE  RECE62-SKYIRYO-ICHIBUFTN  =
                            RECE62-SKYIRYO-ICHIBUFTN  -
                            WRK-SKY-FTNMONEY-XXX
                 END-IF
               END-IF
               IF  WRK-SKY-FTNMONEY-KOH2 = WRK-SKY-FTNMONEY-KOH3
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9     =
                            WRK-SKY-FTNMONEY-KOH3
               ELSE
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9     =
                            WRK-SKY-FTNMONEY-KOH      +
                            0.9
               END-IF
      *
               IF   RECE62-SRYYM  >=  "202111"
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9X3   =
                            WRK-SKY-FTNMONEY-KOH9
                 IF  (WRK-SKY-FTNMONEY-KOH2
                                       NOT = WRK-SKY-FTNMONEY-KOH3 )
                 AND (WRK-SKY-FTNMONEY-KOH
                                       NOT = WRK-SKY-FTNMONEY-KOHX3)
                   COMPUTE    WRK-SKY-FTNMONEY-KOH9X3   =
                              WRK-SKY-FTNMONEY-KOHX3    +
                              0.9
                 END-IF
               END-IF
      *
               IF    FLG-KOHSKY-ARI  =  1
                 MOVE WRK-SKY-FTNMONEY-JYOKEN
                                        TO  WRK-SKY-FTNMONEY9-JYOKEN
                 IF   WRK-SKY-FTNMONEY-JYOKEN
                                     >= WRK-SKY-FTNMONEY-XXX
                   COMPUTE  WRK-SKY-FTNMONEY9-JYOKEN  =
                            WRK-SKY-FTNMONEY-JYOKEN   -
                            WRK-SKY-FTNMONEY-XXX
                 END-IF
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9-JYOKEN =
                            WRK-SKY-FTNMONEY-KOH-JYOKEN  +
                            0.9
               END-IF
      *
               IF   WRK-SKY-ZENGAKU-KOH  >  ZERO
                 IF   ((RECE62-KOUREI   =  "1") AND
                       (FLG-KGK2        =   1 ))
                 OR   ( RECE62-KOUREI   =  "2" )
                   IF     RECE62-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY9
                     COMPUTE   WRK-SKY-KEISAN2 = RECE62-FTNMONEY-SKY
                                               - WRK-SKY-FTNMONEY9
                     ADD    WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-KOHFTN
                     IF     FLG-KOHSKY-ARI  =  1
                       MOVE WRK-SKY-KEISAN2  TO  WRK-SKY-SKYIRYO-KOHFTN
                       IF   WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO
                       AND  WRK-KOHSKY-XXX-FLG-RUI2  =   1
                         MOVE  WRK-SKY-SKYIRYO-KOHFTN
                                   TO  RECE62-SKYIRYO-KOHFTN-KOHSKY
                       ELSE
                         COMPUTE   WRK-SKY-KEISAN2     =
                                   RECE62-FTNMONEY-SKY -
                                   WRK-SKY-FTNMONEY9-JYOKEN
                         IF   WRK-KOHSKY-XXX-FLG-RUI1  =  1
                         AND  WRK-KOHSKY-XXX-FLG-RUI2  =  1
                           MOVE    WRK-SAIKEI-TAIHI
                                     TO  WRK-SKY-KEISAN2
                         END-IF
                         IF   FLG-SKYIRYO-KOHFTN  =  ZERO
                         AND  WRK-SKY-KEISAN2
                                   >= WRK-KOHSKY-XXX-COMPFTN-RUI
                           COMPUTE   WRK-SKY-KEISAN3 =
                                     WRK-SKY-KEISAN2 -
                                     WRK-KOHSKY-XXX-COMPFTN-RUI
                           IF   WRK-SKY-SKYIRYO-KOHFTN
                                   >= WRK-SKY-KEISAN3
                             COMPUTE   RECE62-SKYIRYO-KOHFTN-KOHSKY =
                                       WRK-SKY-SKYIRYO-KOHFTN       -
                                       WRK-SKY-KEISAN3
                           END-IF
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF   FLG-KGK   =   1
                     IF   RECE62-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY-KOH9
                       IF   RECE62-SRYYM  >=  "202111"
                         IF  RECE62-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY-KOH9X3
                           COMPUTE WRK-SKY-KEISAN2         =
                                   RECE62-FTNMONEY-SKY     -
                                   WRK-SKY-FTNMONEY-KOH9X3
                         ELSE
                           MOVE    ZERO  TO  WRK-SKY-KEISAN2
                         END-IF
                       ELSE
                           COMPUTE WRK-SKY-KEISAN2         =
                                   RECE62-FTNMONEY-SKY     -
                                   WRK-SKY-FTNMONEY-KOH9
                       END-IF
                       ADD  WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-KOHFTN
                       IF     FLG-KOHSKY-ARI  =  1
                         MOVE WRK-SKY-KEISAN2
                                             TO  WRK-SKY-SKYIRYO-KOHFTN
                         IF   WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO
                         AND  WRK-KOHSKY-XXX-FLG-RUI2  =   1
                           MOVE  WRK-SKY-SKYIRYO-KOHFTN
                                     TO  RECE62-SKYIRYO-KOHFTN-KOHSKY
                         ELSE
                           COMPUTE   WRK-SKY-KEISAN2     =
                                     RECE62-FTNMONEY-SKY -
                                     WRK-SKY-FTNMONEY-KOH9-JYOKEN
                           IF   WRK-KOHSKY-XXX-FLG-RUI1  =  1
                           AND  WRK-KOHSKY-XXX-FLG-RUI2  =  1
                             MOVE    WRK-SAIKEI-TAIHI
                                       TO  WRK-SKY-KEISAN2
                           END-IF
                           IF   FLG-SKYIRYO-KOHFTN  =  ZERO
                           AND  WRK-SKY-KEISAN2
                                     >= WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             COMPUTE   WRK-SKY-KEISAN3 =
                                       WRK-SKY-KEISAN2 -
                                       WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             IF   WRK-SKY-SKYIRYO-KOHFTN
                                     >= WRK-SKY-KEISAN3
                               COMPUTE   RECE62-SKYIRYO-KOHFTN-KOHSKY =
                                         WRK-SKY-SKYIRYO-KOHFTN       -
                                         WRK-SKY-KEISAN3
                             END-IF
                           END-IF
                         END-IF
                       END-IF
                     ELSE
                       COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-FTNMONEY-KOH9
                                               - RECE62-FTNMONEY-SKY
                       IF  RECE62-SKYIRYO-HOKENJA > WRK-SKY-KEISAN2
                         COMPUTE RECE62-SKYIRYO-HOKENJA =
                                 RECE62-SKYIRYO-HOKENJA -
                                 WRK-SKY-KEISAN2
                       ELSE
                         MOVE    ZERO    TO    RECE62-SKYIRYO-HOKENJA
                       END-IF
                     END-IF
                   ELSE
                     COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU-KOH
                                               - WRK-SKY-HOKENJA-KOH
                     IF   FLG-SKY-TOKKOH   =   1
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN +  5
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN / 10
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN * 10
                     END-IF
                     IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY-KOH9
                       IF   RECE62-SRYYM  >=  "202111"
                         IF  WRK-SKY-KEISAN
                                          >  WRK-SKY-FTNMONEY-KOH9X3
                           COMPUTE WRK-SKY-KEISAN2         =
                                   WRK-SKY-KEISAN          -
                                   WRK-SKY-FTNMONEY-KOH9X3
                         ELSE
                           MOVE    ZERO  TO  WRK-SKY-KEISAN2
                         END-IF
                       ELSE
                           COMPUTE WRK-SKY-KEISAN2         =
                                   WRK-SKY-KEISAN          -
                                   WRK-SKY-FTNMONEY-KOH9
                       END-IF
                       ADD  WRK-SKY-KEISAN2  TO  RECE62-SKYIRYO-KOHFTN
                       IF     FLG-KOHSKY-ARI  =  1
                         MOVE WRK-SKY-KEISAN2
                                             TO  WRK-SKY-SKYIRYO-KOHFTN
                         IF   WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO
                         AND  WRK-KOHSKY-XXX-FLG-RUI2  =   1
                           MOVE  WRK-SKY-SKYIRYO-KOHFTN
                                     TO  RECE62-SKYIRYO-KOHFTN-KOHSKY
                         ELSE
                           COMPUTE   WRK-SKY-KEISAN2     =
                                     WRK-SKY-KEISAN      -
                                     WRK-SKY-FTNMONEY-KOH9-JYOKEN
                           IF   WRK-KOHSKY-XXX-FLG-RUI1  =  1
                           AND  WRK-KOHSKY-XXX-FLG-RUI2  =  1
                             MOVE    WRK-SAIKEI-TAIHI
                                       TO  WRK-SKY-KEISAN2
                           END-IF
                           IF   FLG-SKYIRYO-KOHFTN  =  ZERO
                           AND  WRK-SKY-KEISAN2
                                     >= WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             COMPUTE   WRK-SKY-KEISAN3 =
                                       WRK-SKY-KEISAN2 -
                                       WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             IF   WRK-SKY-SKYIRYO-KOHFTN
                                     >= WRK-SKY-KEISAN3
                               COMPUTE   RECE62-SKYIRYO-KOHFTN-KOHSKY =
                                         WRK-SKY-SKYIRYO-KOHFTN       -
                                         WRK-SKY-KEISAN3
                             END-IF
                           END-IF
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
      *      主保険がない保険組み合わせ
             IF    (WRK-SKY-ZENGAKU2     >  ZERO             )
             AND   (WRK-SKY-ZENGAKU2     >  WRK-SKY-FTNMONEY2)
               COMPUTE    WRK-SKY-KEISAN2  =  WRK-SKY-ZENGAKU2
                                           -  WRK-SKY-FTNMONEY2
               ADD    WRK-SKY-KEISAN2   TO  RECE62-SKYIRYO-KOHFTN
             END-IF
      *
      *      ＜食事＞
      *
      *      主保険がある保険組み合わせ
             IF    (WRK-SKY-SKJ-ZENGAKU      >  ZERO                )
             AND   (WRK-SKY-SKJ-ICHIBUFTN    >  WRK-SKY-SKJ-FTNMONEY)
                 COMPUTE  WRK-SKY-KEISAN2  =  WRK-SKY-SKJ-ICHIBUFTN
                                           -  WRK-SKY-SKJ-FTNMONEY
                 ADD  WRK-SKY-KEISAN2   TO  RECE62-SKYSKJ-KOHFTN
                 IF     FLG-KOHSKY-ARI  =  1
                   MOVE WRK-SKY-KEISAN2 TO  WRK-SKY-SKYSKJ-KOHFTN
                   IF   WRK-KOHSKY-XXX-SKJFLG-RUI1  =  ZERO
                   AND  WRK-KOHSKY-XXX-SKJFLG-RUI2  =   1
                     MOVE  WRK-SKY-SKYSKJ-KOHFTN
                               TO  RECE62-SKYSKJ-KOHFTN-KOHSKY
                   ELSE
                     IF   WRK-KOHSKY-XXX-SYUSKJFTN-RUI
                               >= WRK-KOHSKY-XXX-SKJFTN-RUI
                       COMPUTE   WRK-SKY-KEISAN3 =
                                 WRK-KOHSKY-XXX-SYUSKJFTN-RUI -
                                 WRK-KOHSKY-XXX-SKJFTN-RUI
                       IF   WRK-SKY-SKYSKJ-KOHFTN
                               >= WRK-SKY-KEISAN3
                         COMPUTE   RECE62-SKYSKJ-KOHFTN-KOHSKY =
                                   WRK-SKY-SKYSKJ-KOHFTN       -
                                   WRK-SKY-KEISAN3
                       END-IF
                     END-IF
                   END-IF
                 END-IF
             END-IF
      *      主保険がない保険組み合わせ
             IF    (WRK-SKY-SKJ-ZENGAKU2     >  ZERO                 )
             AND   (WRK-SKY-SKJ-ZENGAKU2     >  WRK-SKY-SKJ-FTNMONEY2)
               COMPUTE    WRK-SKY-KEISAN2  =  WRK-SKY-SKJ-ZENGAKU2
                                           -  WRK-SKY-SKJ-FTNMONEY2
               ADD    WRK-SKY-KEISAN2   TO  RECE62-SKYSKJ-KOHFTN
             END-IF
           ELSE
             INITIALIZE        RECE62-SKYIRYO-INF
             INITIALIZE        RECE62-SKYSKJ-INF
           END-IF
      *
           .
       2116-SKY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    再掲・一部負担金置き換え編集
      *****************************************************************
       211A-ICHIBUFUTAN-OKIKAE2-SEC      SECTION.
      *
           IF  (IDZ                 =   1        )
           AND (RECE62-KOUREI       =  "1" OR "2")
           AND (WRK-TAIHI-OKIKAE    =   1        )
      *      再掲上置き換え
             IF  ( RECE62-KOHNUM(1)           =  SPACE     )
             OR  ((RECE62-SAIKEI-CHIKAN-KIN1  =  009999999) AND
                  (RECE62-KOUREI-SAIKEI       =  999999999))
                 MOVE   123456789   TO   RECE62-SAIKEI-CHIKAN-KIN1
             END-IF
             IF    RECE62-SAIKEI-CHIKAN-KIN1  =  123456789
                 CONTINUE
             ELSE
               IF  RECE62-SAIKEI-CHIKAN-KIN1  =  009999999
                 MOVE   999999999   TO   RECE62-KOUREI-SAIKEI
               ELSE
                 MOVE      1        TO   RECE62-SAIKEIZEROKSI1
                 MOVE   RECE62-SAIKEI-CHIKAN-KIN1
                                    TO   RECE62-KOUREI-SAIKEI
               END-IF
             END-IF
      *      再掲下置き換え
             IF  ( RECE62-KOHNUM(2)           =  SPACE     )
             OR  ((RECE62-SAIKEI-CHIKAN-KIN2  =  009999999) AND
                  (RECE62-KOUREI-SAIKEI2      =  999999999))
                 MOVE   123456789   TO   RECE62-SAIKEI-CHIKAN-KIN2
             END-IF
             IF    RECE62-SAIKEI-CHIKAN-KIN2  =  123456789
                 CONTINUE
             ELSE
               IF  RECE62-SAIKEI-CHIKAN-KIN2  =  009999999
                 MOVE   999999999   TO   RECE62-KOUREI-SAIKEI2
               ELSE
                 MOVE      1        TO   RECE62-SAIKEIZEROKSI2
                 MOVE   RECE62-SAIKEI-CHIKAN-KIN2
                                    TO   RECE62-KOUREI-SAIKEI2
               END-IF
             END-IF
      *      再掲３置き換え
             IF  ( RECE62-KOHNUM(3)           =  SPACE     )
             OR  ((RECE62-SAIKEI-CHIKAN-KIN3  =  009999999) AND
                  (RECE62-KOUREI-SAIKEI3      =  999999999))
                 MOVE   123456789   TO   RECE62-SAIKEI-CHIKAN-KIN3
             END-IF
             IF    RECE62-SAIKEI-CHIKAN-KIN3  =  123456789
                 CONTINUE
             ELSE
               IF  RECE62-SAIKEI-CHIKAN-KIN3  =  009999999
                 MOVE   999999999   TO   RECE62-KOUREI-SAIKEI3
               ELSE
                 MOVE      1        TO   RECE62-SAIKEIZEROKSI3
                 MOVE   RECE62-SAIKEI-CHIKAN-KIN3
                                    TO   RECE62-KOUREI-SAIKEI3
               END-IF
             END-IF
      *      再掲４置き換え
             IF  ( RECE62-KOHNUM(4)           =  SPACE     )
             OR  ((RECE62-SAIKEI-CHIKAN-KIN4  =  009999999) AND
                  (RECE62-KOUREI-SAIKEI4      =  999999999))
                 MOVE   123456789   TO   RECE62-SAIKEI-CHIKAN-KIN4
             END-IF
             IF    RECE62-SAIKEI-CHIKAN-KIN4  =  123456789
                 CONTINUE
             ELSE
               IF  RECE62-SAIKEI-CHIKAN-KIN4  =  009999999
                 MOVE   999999999   TO   RECE62-KOUREI-SAIKEI4
               ELSE
                 MOVE      1        TO   RECE62-SAIKEIZEROKSI4
                 MOVE   RECE62-SAIKEI-CHIKAN-KIN4
                                    TO   RECE62-KOUREI-SAIKEI4
               END-IF
             END-IF
      *      保険一部負担金置き換え
             IF    RECE62-HKN-CHIKAN-KIN      =  009999999
                 MOVE   123456789   TO   RECE62-HKN-CHIKAN-KIN
             END-IF
             IF    RECE62-HKN-CHIKAN-KIN      =  123456789
                 CONTINUE
             ELSE
                 MOVE   RECE62-HKN-CHIKAN-KIN
                                    TO   RECE62-FTNMONEY(1)
             END-IF
      *
             IF    RECE62-SAIKEI-CHIKAN-KIN1  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN2  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN3  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN4  =  123456789
             AND   RECE62-HKN-CHIKAN-KIN      =  123456789
               IF  RECE62-ICBKINKSI-ARI  =  1
                MOVE    ZERO        TO   RECE62-ICBKINKSI-ARI
               END-IF
               IF  RECE62-ICBKINKSI-ARI  =  2
                MOVE    3           TO   RECE62-ICBKINKSI-ARI
               END-IF
             END-IF
             MOVE       ZERO        TO   RECE62-ICBKINKSI-NASI
           END-IF
      *
           IF  (IDZ                   =   1)
           AND (RECE62-DAISAN-KOUREI  =   1)
           AND (WRK-TAIHI-OKIKAE      =   1)
      *      再掲上置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN1
      *      再掲下置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN2
      *      再掲３置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN3
      *      再掲４置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN4
      *      保険一部負担金置き換え
             IF    RECE62-HKN-CHIKAN-KIN      =  009999999
                 MOVE   123456789   TO   RECE62-HKN-CHIKAN-KIN
             END-IF
             IF    RECE62-HKN-CHIKAN-KIN      =  123456789
                 CONTINUE
             ELSE
                 MOVE   RECE62-HKN-CHIKAN-KIN
                                    TO   RECE62-FTNMONEY(1)
             END-IF
      *
             IF    RECE62-SAIKEI-CHIKAN-KIN1  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN2  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN3  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN4  =  123456789
             AND   RECE62-HKN-CHIKAN-KIN      =  123456789
               IF  RECE62-ICBKINKSI-ARI  =  1
                MOVE    ZERO        TO   RECE62-ICBKINKSI-ARI
               END-IF
               IF  RECE62-ICBKINKSI-ARI  =  2
                MOVE    3           TO   RECE62-ICBKINKSI-ARI
               END-IF
             END-IF
             MOVE       ZERO        TO   RECE62-ICBKINKSI-NASI
           END-IF
      *
           IF  (IDZ                     =   1         )
           AND (RECE62-KOUREI       NOT =  "1" AND "2")
           AND (WRK-TAIHI-OKIKAE        =   2         )
      *      再掲上置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN1
      *      再掲下置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN2
      *      再掲３置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN3
      *      再掲４置き換え
             MOVE   123456789       TO   RECE62-SAIKEI-CHIKAN-KIN4
      *      保険一部負担金置き換え
             MOVE   123456789       TO   RECE62-HKN-CHIKAN-KIN
      *
             IF    RECE62-SAIKEI-CHIKAN-KIN1  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN2  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN3  =  123456789
             AND   RECE62-SAIKEI-CHIKAN-KIN4  =  123456789
             AND   RECE62-HKN-CHIKAN-KIN      =  123456789
               IF  RECE62-ICBKINKSI-NASI   =  1
                MOVE    ZERO        TO   RECE62-ICBKINKSI-NASI
               END-IF
               IF  RECE62-ICBKINKSI-NASI   =  2
                MOVE    3           TO   RECE62-ICBKINKSI-NASI
               END-IF
             END-IF
             MOVE       ZERO        TO   RECE62-ICBKINKSI-ARI
           END-IF
      *
           IF ((IDZ                     =   1         ) AND
               (RECE62-KOUREI           =  "1" OR  "2") AND
               (WRK-TAIHI-OKIKAE        =   1         ))
           OR ((IDZ                     =   1         ) AND
               (RECE62-DAISAN-KOUREI    =   1         ) AND
               (WRK-TAIHI-OKIKAE        =   1         ))
           OR ((IDZ                     =   1         ) AND
               (RECE62-KOUREI       NOT =  "1" AND "2") AND
               (WRK-TAIHI-OKIKAE        =   2         ))
             IF   (RECE62-DAISAN-KOUREI    =   1)
             AND  (WRK-TAIHI-OKIKAE        =   2)
                MOVE    ZERO        TO   RECE62-DAISAN-KOUREI
                MOVE    ZERO        TO   RECE62-FTNMONEY(1)
             END-IF
           ELSE
             MOVE       ZERO        TO   RECE62-ICBKINKSI-NASI
             MOVE       ZERO        TO   RECE62-ICBKINKSI-ARI
             MOVE       123456789   TO   RECE62-SAIKEI-CHIKAN-KIN1
             MOVE       123456789   TO   RECE62-SAIKEI-CHIKAN-KIN2
             MOVE       123456789   TO   RECE62-SAIKEI-CHIKAN-KIN3
             MOVE       123456789   TO   RECE62-SAIKEI-CHIKAN-KIN4
             MOVE       123456789   TO   RECE62-HKN-CHIKAN-KIN
           END-IF
      *
           IF  (IDZ                 =   1)
           AND (WRK-TAIHI-OKIKAE2   =   1)
      *      公１一部負担金置き換え
             IF    RECE62-KOHNUM(1)        =  SPACE
                   MOVE    123456789    TO   RECE62-KOH-CHIKAN-KIN1
             END-IF
             IF    RECE62-KOH-CHIKAN-KIN1  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-KOH-CHIKAN-KIN1
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(2)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(2)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(2)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(2)
                 WHEN      OTHER
                   MOVE   RECE62-KOH-CHIKAN-KIN1
                                        TO   RECE62-FTNMONEY(2)
                   MOVE   "1"           TO   RECE62-KISAIFLG(2)
               END-EVALUATE
             END-IF
      *      公２一部負担金置き換え
             IF    RECE62-KOHNUM(2)        =  SPACE
                   MOVE    123456789    TO   RECE62-KOH-CHIKAN-KIN2
             END-IF
             IF    RECE62-KOH-CHIKAN-KIN2  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-KOH-CHIKAN-KIN2
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(3)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(3)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(3)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(3)
                 WHEN      OTHER
                   MOVE   RECE62-KOH-CHIKAN-KIN2
                                        TO   RECE62-FTNMONEY(3)
                   MOVE   "1"           TO   RECE62-KISAIFLG(3)
               END-EVALUATE
             END-IF
      *      公３一部負担金置き換え
             IF    RECE62-KOHNUM(3)        =  SPACE
                   MOVE    123456789    TO   RECE62-KOH-CHIKAN-KIN3
             END-IF
             IF    RECE62-KOH-CHIKAN-KIN3  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-KOH-CHIKAN-KIN3
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(4)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(4)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(4)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(4)
                 WHEN      OTHER
                   MOVE   RECE62-KOH-CHIKAN-KIN3
                                        TO   RECE62-FTNMONEY(4)
                   MOVE   "1"           TO   RECE62-KISAIFLG(4)
               END-EVALUATE
             END-IF
      *      公４一部負担金置き換え
             IF    RECE62-KOHNUM(4)        =  SPACE
                   MOVE    123456789    TO   RECE62-KOH-CHIKAN-KIN4
             END-IF
             IF    RECE62-KOH-CHIKAN-KIN4  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-KOH-CHIKAN-KIN4
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(5)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(5)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(5)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(5)
                 WHEN      OTHER
                   MOVE   RECE62-KOH-CHIKAN-KIN4
                                        TO   RECE62-FTNMONEY(5)
                   MOVE   "1"           TO   RECE62-KISAIFLG(5)
               END-EVALUATE
             END-IF
      *
             IF    RECE62-KOH-CHIKAN-KIN1  =  123456789
             AND   RECE62-KOH-CHIKAN-KIN2  =  123456789
             AND   RECE62-KOH-CHIKAN-KIN3  =  123456789
             AND   RECE62-KOH-CHIKAN-KIN4  =  123456789
               IF  RECE62-KOHCHIKAN  =  1
                MOVE    ZERO            TO   RECE62-KOHCHIKAN
               END-IF
             END-IF
      *
             MOVE    123456789          TO   RECE62-SEI-CHIKAN-KIN1
             MOVE    123456789          TO   RECE62-SEI-CHIKAN-KIN2
             MOVE    123456789          TO   RECE62-SEI-CHIKAN-KIN3
             MOVE    123456789          TO   RECE62-SEI-CHIKAN-KIN4
           END-IF
      *
           IF  (IDZ                 =   2)
           AND (WRK-TAIHI-OKIKAE2   =   1)
      *      公費請求書公１一部負担金置き換え
             IF    RECE62-KOHNUM(1)        =  SPACE
                   MOVE    123456789    TO   RECE62-SEI-CHIKAN-KIN1
             END-IF
             IF    RECE62-SEI-CHIKAN-KIN1  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-SEI-CHIKAN-KIN1
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(2)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(2)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(2)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(2)
                 WHEN      OTHER
                   MOVE   RECE62-SEI-CHIKAN-KIN1
                                        TO   RECE62-FTNMONEY(2)
                   MOVE   "1"           TO   RECE62-KISAIFLG(2)
               END-EVALUATE
             END-IF
      *      公費請求書公２一部負担金置き換え
             IF    RECE62-KOHNUM(2)        =  SPACE
                   MOVE    123456789    TO   RECE62-SEI-CHIKAN-KIN2
             END-IF
             IF    RECE62-SEI-CHIKAN-KIN2  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-SEI-CHIKAN-KIN2
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(3)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(3)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(3)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(3)
                 WHEN      OTHER
                   MOVE   RECE62-SEI-CHIKAN-KIN2
                                        TO   RECE62-FTNMONEY(3)
                   MOVE   "1"           TO   RECE62-KISAIFLG(3)
               END-EVALUATE
             END-IF
      *      公費請求書公３一部負担金置き換え
             IF    RECE62-KOHNUM(3)        =  SPACE
                   MOVE    123456789    TO   RECE62-SEI-CHIKAN-KIN3
             END-IF
             IF    RECE62-SEI-CHIKAN-KIN3  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-SEI-CHIKAN-KIN3
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(4)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(4)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(4)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(4)
                 WHEN      OTHER
                   MOVE   RECE62-SEI-CHIKAN-KIN3
                                        TO   RECE62-FTNMONEY(4)
                   MOVE   "1"           TO   RECE62-KISAIFLG(4)
               END-EVALUATE
             END-IF
      *      公費請求書公４一部負担金置き換え
             IF    RECE62-KOHNUM(4)        =  SPACE
                   MOVE    123456789    TO   RECE62-SEI-CHIKAN-KIN4
             END-IF
             IF    RECE62-SEI-CHIKAN-KIN4  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE62-SEI-CHIKAN-KIN4
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE62-FTNMONEY(5)
                   MOVE   SPACE         TO   RECE62-ZEROKISAIFLG(5)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE62-FTNMONEY(5)
                   MOVE   "1"           TO   RECE62-ZEROKISAIFLG(5)
                 WHEN      OTHER
                   MOVE   RECE62-SEI-CHIKAN-KIN4
                                        TO   RECE62-FTNMONEY(5)
                   MOVE   "1"           TO   RECE62-KISAIFLG(5)
               END-EVALUATE
             END-IF
      *
             IF    RECE62-SEI-CHIKAN-KIN1  =  123456789
             AND   RECE62-SEI-CHIKAN-KIN2  =  123456789
             AND   RECE62-SEI-CHIKAN-KIN3  =  123456789
             AND   RECE62-SEI-CHIKAN-KIN4  =  123456789
               IF  RECE62-KOHCHIKAN  =  1
                MOVE    ZERO            TO   RECE62-KOHCHIKAN
               END-IF
             END-IF
      *
             MOVE    123456789          TO   RECE62-KOH-CHIKAN-KIN1
             MOVE    123456789          TO   RECE62-KOH-CHIKAN-KIN2
             MOVE    123456789          TO   RECE62-KOH-CHIKAN-KIN3
             MOVE    123456789          TO   RECE62-KOH-CHIKAN-KIN4
           END-IF
      *
           IF  (IDZ                 =   1 OR 2)
           AND (WRK-TAIHI-OKIKAE2   =   1     )
             CONTINUE
           ELSE
             MOVE       ZERO            TO   RECE62-KOHCHIKAN
             MOVE       123456789       TO   RECE62-KOH-CHIKAN-KIN1
             MOVE       123456789       TO   RECE62-KOH-CHIKAN-KIN2
             MOVE       123456789       TO   RECE62-KOH-CHIKAN-KIN3
             MOVE       123456789       TO   RECE62-KOH-CHIKAN-KIN4
             MOVE       123456789       TO   RECE62-SEI-CHIKAN-KIN1
             MOVE       123456789       TO   RECE62-SEI-CHIKAN-KIN2
             MOVE       123456789       TO   RECE62-SEI-CHIKAN-KIN3
             MOVE       123456789       TO   RECE62-SEI-CHIKAN-KIN4
           END-IF
      *
           .
       211A-ICHIBUFUTAN-OKIKAE2-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費の再掲欄編集
      *****************************************************************
       2105-KOH-SAIKEI-HENSYU-SEC      SECTION.
      *
           IF   RECE62-KOUREI       =  "1" OR "2"
             MOVE     ZERO               TO  FLG-SYORI
             IF  (RECE62-TOTALTEN(1) NOT =  ZERO                 )
             AND (RECE62-TOTALTEN(1)     =  RECE62-TOTALTEN(2)   )
             AND (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(3))
             AND (RECE62-KOHNUM(3)       =  SPACE                )
             AND (RECE62-KOHNUM(4)       =  SPACE                )
               IF ((FLG-ZENKOKUKOHI-NISYU    =   1 OR 5) AND
                   (RECE62-EKF-SAIKEIKSI(3)  =  "3"    ))
               OR ((FLG-ZENKOKUKOHI-NISYU    =   2     ) AND
                   (RECE62-EKF-SAIKEIKSI2(3) =  SPACE  ))
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI2
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI2
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI1
      *
                   MOVE     1            TO  FLG-SYORI
               END-IF
             END-IF
             IF  (RECE62-TOTALTEN(1) NOT =  ZERO                 )
             AND (RECE62-TOTALTEN(1)     =  RECE62-TOTALTEN(2)   )
             AND (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(3))
             AND (RECE62-TOTALTEN(1)     =  RECE62-HENTOTALTEN(4))
             AND (RECE62-KOHNUM(4)       =  SPACE                )
               IF    RECE62-SRYYM  >=  "202301"
                 IF  (FLG-ZENKOKUKOHI-NISYU    =   2   )
                 AND (RECE62-EKF-SAIKEIKSI2(3) =  SPACE)
                 AND (RECE62-EKF-SAIKEIKSI2(4) =  SPACE)
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI3
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI3
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI2
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI2
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI1
      *
                   MOVE     1            TO  FLG-SYORI
                 END-IF
                 IF  (FLG-ZENKOKUKOHI-NISYU    =   2 OR 3)
                 AND (RECE62-EKF-SAIKEIKSI2(3) =  SPACE  )
                 AND (RECE62-EKF-SAIKEIKSI2(4) =  "1"    )
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI2
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI2
      *
                   MOVE     1            TO  FLG-SYORI
                 END-IF
                 IF  (FLG-ZENKOKUKOHI-NISYU    =   2 OR 3)
                 AND (RECE62-EKF-SAIKEIKSI2(3) =  "1"    )
                 AND (RECE62-EKF-SAIKEIKSI2(4) =  SPACE  )
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI3
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI3
      *
                   MOVE     1            TO  FLG-SYORI
                 END-IF
               ELSE
                 IF  (FLG-ZENKOKUKOHI-NISYU    =   2   )
                 AND (RECE62-EKF-SAIKEIKSI2(3) =  SPACE)
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI2
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI2
                   MOVE     999999999    TO  RECE62-KOUREI-SAIKEI
                   MOVE     ZERO         TO  RECE62-SAIKEIZEROKSI1
      *
                   MOVE     1            TO  FLG-SYORI
                 END-IF
               END-IF
             END-IF
             IF   (FLG-ZENKOKUKOHI-NISYU  =   2      )
             AND  (FLG-SYORI              =   ZERO   )
             AND  (RECE62-SRYYM          >=  "202301")
               PERFORM   VARYING  IDX  FROM  3  BY  1
                          UNTIL  (IDX                    >   5  )
                            OR   (RECE62-KOHNUM(IDX - 1) = SPACE)
                 IF   (RECE62-KOHNUM(IDX - 1)(1:1) >=  "1" AND <= "8")
                 AND  (TBL-TOKATUKAIFLG(IDX - 1)    =  ZERO          )
                   IF ((RECE62-KOUREI-HANTEIFLG       =  "1") AND
                       (RECE62-EKF-KAK21KBN-KM(IDX)   =  "1"))
                   OR ((RECE62-KOUREI-HANTEIFLG   NOT =  "1") AND
                       (RECE62-EKF-KAK21KBN-YM(IDX)   =  "1"))
                     EVALUATE   IDX
                       WHEN      3
                         MOVE   999999999  TO  RECE62-KOUREI-SAIKEI2
                         MOVE   ZERO       TO  RECE62-SAIKEIZEROKSI2
                       WHEN      4
                         MOVE   999999999  TO  RECE62-KOUREI-SAIKEI3
                         MOVE   ZERO       TO  RECE62-SAIKEIZEROKSI3
                       WHEN      5
                         MOVE   999999999  TO  RECE62-KOUREI-SAIKEI4
                         MOVE   ZERO       TO  RECE62-SAIKEIZEROKSI4
                     END-EVALUATE
                   END-IF
                 END-IF
               END-PERFORM
             END-IF
           END-IF
      *
           .
       2105-KOH-SAIKEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せ番号情報編集（マル長をはずす）
      *****************************************************************
       2106-HKNCOMBIINF-HENSYU-SEC      SECTION.
      *
      *    初期化
           MOVE    RECE62-REC     TO  RECE6W-REC
           INITIALIZE                 RECE62-HKNCOMBIINF-AREA
      *
      *    保険組合せ番号情報
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       10
               IF     RECE6W-HKNCOMBI (IDX)    NOT =   ZERO
                   MOVE    RECE6W-HKNCOMBI (IDX)
                                           TO  RECE62-HKNCOMBI (IDX)
                   MOVE    RECE6W-HKNNUMHC (IDX)
                                           TO  RECE62-HKNNUMHC (IDX)
                   PERFORM VARYING IDY     FROM    1   BY  1
                           UNTIL   IDY     >       4
                       IF     RECE6W-KOHNUMHC (IDX IDY)
                                           NOT =   SPACE
                           PERFORM VARYING IDXX    FROM    1   BY  1
                                   UNTIL   IDXX    >       4
                               IF   (RECE6W-KOHNUMHC (IDX IDY)   =
                                                  RECE62-KOHNUM (IDXX))
                               AND  (RECE6W-KOHIDHC  (IDX IDY)   =
                                                  RECE62-KOHID  (IDXX))
                                   MOVE    RECE6W-KOHNUMHCINF
                                                         (IDX IDY)
                                                   TO
                                           RECE62-KOHNUMHCINF(IDX IDY)
                               END-IF
                           END-PERFORM
                       END-IF
                   END-PERFORM                 
               END-IF
           END-PERFORM
      *
           .
       2106-HKNCOMBIINF-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット１
      *****************************************************************
       2107-OCR1-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR1-AREA
      *
      *保険者番号
           IF      WRK-3SYU-KBN           =   ALL "1" AND
                   RECE62-KOHNUM (4)      =   SPACE   AND
                   RECE62-HKNNUM          =   SPACE
      *        ３種の場合
               INITIALIZE                           ORCSNUMAREA
               MOVE    RECE62-KOHFTNJANUM(SEIHIDX)
                                            TO      SNUM-INX
               CALL    "ORCSNUM"            USING   ORCSNUMAREA
               IF      SNUM-RC              =       ZERO
                       MOVE   SNUM-OUTNUM   TO      OCR1-HKNJANUM
               ELSE
                       MOVE   ZERO          TO      OCR1-HKNJANUM
               END-IF
           ELSE
               INITIALIZE                           ORCSNUMAREA
               MOVE    RECE62-HKNJANUM      TO      SNUM-INX
               CALL    "ORCSNUM"            USING   ORCSNUMAREA
               IF      SNUM-RC              =       ZERO
                       MOVE   SNUM-OUTNUM   TO      OCR1-HKNJANUM
               ELSE
                       MOVE   ZERO          TO      OCR1-HKNJANUM
               END-IF
           END-IF
      *医療機関コード
           MOVE   SYS-1001-HOSPCD       TO      OCR1-HOSPCD
      *請求点数
           MOVE    RECE62-TOTALTEN(IDX5)
                                        TO      OCR1-SKYTENSU
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-SKYTENSU        TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT1
           END-IF
      *薬剤一部負担金
      *    MOVE    ZERO                 TO      OCR1-YKZFTN
      *生月日
           MOVE    "0"                  TO      OCR1-YKZFTN (1:1)
           MOVE    RECE62-BIRTHDAY      TO      WRK-BIRTHDAY
           MOVE    WRK-BIRTHDAY (5:4)   TO      OCR1-YKZFTN (2:4)
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-YKZFTN          TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT2
           END-IF
      *一部負担金
           MOVE    RECE62-FTNMONEY(IDX5)
                                        TO      OCR1-FTNMONEY
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-FTNMONEY        TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT3
           END-IF
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(1:35)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT4
           END-IF
      *診療実日数
           MOVE    RECE62-JNISSU(IDX5)  TO      OCR1-JNISSU
      *診療年月（和暦）
           INITIALIZE                           LNK-DAY1-AREA
           INITIALIZE                           STS-AREA-DAY
           MOVE    "11"                 TO      LNK-DAY1-IRAI
           MOVE    RECE62-SRYYM         TO      LNK-DAY1-YMD(1:6)
           MOVE    "01"                 TO      LNK-DAY1-YMD(7:2)
           CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                LNK-DAY1-AREA
           IF      STS-DAY-RC1          =       ZERO
                   MOVE  LNK-DAY1-YMD-X(3:4)
                                        TO      OCR1-SRYYM
           ELSE
                   MOVE  ZERO           TO      OCR1-SRYYM
           END-IF
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(37:6)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT5
           END-IF
      *市町村番号
           IF      RECE62-RJNFTNJANUM   =       SPACE
               MOVE  ZERO               TO      OCR1-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-RJNFTNJANUM
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR1-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR1-FTNJANUM
               END-IF
           END-IF
      *受給者番号
           IF      RECE62-RJNJKYSNUM    =       SPACE
               MOVE  ZERO               TO      OCR1-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-RJNJKYSNUM
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR1-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR1-JKYSNUM
               END-IF
           END-IF
      *チェックディジット６
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(44:15)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT6
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT6
           END-IF
      *都道府県番号
           MOVE    SYS-1001-PREFNUM     TO      OCR1-PREFNUM
      *点数表
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(1:1)
                                        TO      OCR1-TENSUHYO
           ELSE
               MOVE    RECE62-RECESYUBETU(1:1)
                                        TO      OCR1-TENSUHYO
           END-IF
      *保険種別１
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(2:1)
                                        TO      OCR1-HKNSYUBETU1
           ELSE
               MOVE    RECE62-RECESYUBETU(2:1)
                                        TO      OCR1-HKNSYUBETU1
           END-IF
      *保険種別２
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(3:1)
                                        TO      OCR1-HKNSYUBETU2
           ELSE
               MOVE    RECE62-RECESYUBETU(3:1)
                                        TO      OCR1-HKNSYUBETU2
           END-IF
      *本人・家族・入外
           IF      RECE62-RECESYUBETU   =    6666
               MOVE    RECE62-RECESYUBETU-X(4:1)
                                        TO      OCR1-HONKZKKBN
           ELSE
               MOVE    RECE62-RECESYUBETU(4:1)
                                        TO      OCR1-HONKZKKBN
           END-IF
      *整理番号
           MOVE    1                    TO      OCR1-SEIRINO
      *チェックディジット７
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(60:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT7
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT7
           END-IF
      *
           MOVE    OCR1-AREA            TO      RECE62-OCR1           
      *
           .
       2107-OCR1-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット２（Ｆ００２）
      *****************************************************************
       2108-OCR2-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR2-AREA
      *
      *性別
           MOVE    RECE62-SEX           TO      OCR2-SEX
      *元号・生年
           INITIALIZE                           LNK-DAY1-AREA
           INITIALIZE                           STS-AREA-DAY
           MOVE    "11"                 TO      LNK-DAY1-IRAI
           MOVE    RECE62-BIRTHDAY      TO      LNK-DAY1-YMD
           CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                LNK-DAY1-AREA
           IF      STS-DAY-RC1          =       ZERO
                   MOVE  LNK-DAY1-YMD-X(2:1)
                                        TO      OCR2-GENGO
                   MOVE  LNK-DAY1-YMD-X(3:2)
                                        TO      OCR2-BIRTHYY
           ELSE
                   MOVE  ZERO           TO      OCR2-GENGO
                   MOVE  ZERO           TO      OCR2-BIRTHYY
           END-IF
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(1:4)       TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT1
           END-IF
      *記号・番号
           IF      WRK-3SYU-KBN           =   ALL "1" AND
                   RECE62-KOHNUM (4)      =   SPACE   AND
                   RECE62-HKNNUM          =   SPACE
      *        ３種の場合（８桁）
               MOVE    RECE62-KOHJKYSNUM (SEIHIDX)
                                           TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-KIGO
               MOVE    ZERO                TO  OCR2-NUM
           ELSE
               MOVE    RECE62-KIGO         TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-KIGO
      *
               MOVE    RECE62-NUM          TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-NUM
           END-IF
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(6:20)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT2
           END-IF
      *公費１負担者番号
           IF      RECE62-KOHFTNJANUM(IDA) =      SPACE
               MOVE  ZERO               TO      OCR2-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHFTNJANUM(IDA)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR2-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR2-FTNJANUM
               END-IF
           END-IF
      *公費１受給者番号
           IF      RECE62-KOHJKYSNUM(IDA) =       SPACE
               MOVE  ZERO               TO      OCR2-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHJKYSNUM(IDA)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR2-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR2-JKYSNUM
               END-IF
           END-IF
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(27:15)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT3
           END-IF
      *公費１診療実日数・請求点数
           IF      RECE62-JNISSU   (IDX5)  =   RECE62-JNISSU   (IDX6)
           AND     RECE62-TOTALTEN (IDX5)  =   RECE62-TOTALTEN (IDX6)
           AND     RECE62-JSKISAIFLG       =   SPACE
           AND     RECE62-EKF-OCRFLG(IDX6) =   SPACE
               MOVE    ZERO                 TO  OCR2-JNISSU
                                                OCR2-TENSU   
           ELSE    
               MOVE    RECE62-JNISSU  (IDX6)   TO  OCR2-JNISSU
               MOVE    RECE62-TOTALTEN(IDX6)   TO  OCR2-TENSU
           END-IF
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(45:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT4
           END-IF
      *公費１薬剤一部負担金
           MOVE    ZERO                 TO      OCR2-YKZFTN
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(53:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT5
           END-IF
      *公費１患者負担額
           MOVE    RECE62-FTNMONEY(IDX6)
                                        TO      OCR2-FTNMONEY
      *チェックディジット６
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(59:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT6
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT6
           END-IF
      *チェックディジット７
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(43:22)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT7
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT7
           END-IF
      *予備１
           MOVE    SPACE                TO      OCR2-YOBI
      *
           IF      OCR2-AREA-X          =   ALL "0"
               MOVE    SPACE                    TO  OCR2-AREA-X
           END-IF  
           MOVE    OCR2-AREA            TO      RECE62-OCR2
      *
           .
       2108-OCR2-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット３（Ｆ００２）
      *****************************************************************
       2109-OCR3-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR3-AREA
      *
      *公費２負担者番号
           IF      RECE62-KOHFTNJANUM(IDB) =      SPACE
               MOVE  ZERO               TO      OCR3-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHFTNJANUM(IDB)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR3-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR3-FTNJANUM
               END-IF
           END-IF
      *公費２受給者番号
           IF      RECE62-KOHJKYSNUM(IDB) =       SPACE
               MOVE  ZERO               TO      OCR3-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE62-KOHJKYSNUM(IDB)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR3-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR3-JKYSNUM
               END-IF
           END-IF
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(1:15)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT1
           END-IF
      *公費２診療実日数・請求点数
           IF      RECE62-JNISSU   (IDX6)  =   RECE62-JNISSU   (IDX7)
           AND     RECE62-TOTALTEN (IDX6)  =   RECE62-TOTALTEN (IDX7)
           AND     RECE62-JSKISAIFLG       =   SPACE
           AND     RECE62-EKF-OCRFLG(IDX7) =   SPACE
               MOVE    ZERO                 TO  OCR3-JNISSU
                                                OCR3-TENSU   
           ELSE    
               MOVE    RECE62-JNISSU  (IDX7)   TO  OCR3-JNISSU
               MOVE    RECE62-TOTALTEN(IDX7)   TO  OCR3-TENSU
           END-IF
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(19:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT2
           END-IF
      *公費２薬剤一部負担金
           MOVE    ZERO                 TO      OCR3-YKZFTN
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(27:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT3
           END-IF
      *公費２患者負担額
           MOVE    RECE62-FTNMONEY(IDX7)
                                        TO      OCR3-FTNMONEY
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(33:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT4
           END-IF
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(17:22)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT5
           END-IF
      *予備２
           MOVE    SPACE                TO      OCR3-YOBI
      *
           IF      OCR3-AREA-X          =   ALL "0"
               MOVE    SPACE                TO  RECE62-OCR3
           ELSE 
               MOVE    OCR3-AREA            TO  RECE62-OCR3
           END-IF
      *
           .
       2109-OCR3-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害区分編集
      *****************************************************************
       2119-SAIGAIKBN-HENSYU-SEC      SECTION.
      *
      *    新潟県中越沖地震対応
      *    岩手・宮城内陸地震対応
      *    中国・九州北部豪雨対応
      *    平成２１年台風第９号対応
      *    平成２２年７月中国地方豪雨対応
      *    鹿児島県奄美市等における局地的大雨対応
      *
           IF   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "15"         ) AND
                 ( RECE62-SRYYM       >=   200709       ) AND
                 ( RECE62-SRYYM       <=   200712       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "03" OR "04" ) AND
                 ( RECE62-SRYYM       >=   200806       ) AND
                 ( RECE62-SRYYM       <=   200812       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "35" OR "40" ) AND
                 ( RECE62-SRYYM       >=   200907       ) AND
                 ( RECE62-SRYYM       <=   200912       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "28" OR "33" ) AND
                 ( RECE62-SRYYM       >=   200908       ) AND
                 ( RECE62-SRYYM       <=   201001       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "34" OR "35" ) AND
                 ( RECE62-SRYYM       >=   201007       ) AND
                 ( RECE62-SRYYM       <=   201012       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "46"         ) AND
                 ( RECE62-SRYYM       >=   201010       ) AND
                 ( RECE62-SRYYM       <=   201103       ))
           OR   (( IDZ                 =   1            ) AND
                 ( RECE62-SRYYM       >=   201101       ))
               IF    ( RECE62-HKNNUM   NOT =   SPACE )
               AND   ( RECE62-HKNJANUM     =   SPACE )
                   IF  RECE62-SRYYM   >=  "201101"
                       MOVE    6           TO  RECE62-RJNGAIKOHFTN (1)
      *                保険者不明＋減免対象者のとき
                       IF    RECE62-GENMENKBN   >  ZERO
                           MOVE    7       TO  RECE62-RJNGAIKOHFTN (1)
                       END-IF
                   ELSE
                       MOVE    3           TO  RECE62-RJNGAIKOHFTN (1)
                   END-IF
               ELSE
                   IF    ( RECE62-RJNHKNNUM
                                           NOT =   SPACE )
                   AND   ( RECE62-RJNFTNJANUM  =   SPACE )
                       MOVE    3           TO  RECE62-RJNGAIKOHFTN (1)
                   ELSE
      *                記号・番号が不明のとき
                       IF       RECE62-HKNNUM   NOT =   SPACE
                         IF    (RECE62-KIGO         =   SPACE)
                         AND   (RECE62-NUM          =   SPACE)
                           MOVE    1       TO  RECE62-RJNGAIKOHFTN (1)
                         ELSE
                           IF  (RECE62-KIGO     NOT =   SPACE)
                           AND (RECE62-NUM          =   SPACE)
                             MOVE  1       TO  RECE62-RJNGAIKOHFTN (1)
                           END-IF
                         END-IF
                       END-IF   
      *                老人保健の受給者番号が不明のとき
                       IF    ( RECE62-RJNHKNNUM
                                               NOT =   SPACE )
                       AND   ( RECE62-RJNJKYSNUM   =   SPACE )
                           MOVE    1       TO  RECE62-RJNGAIKOHFTN (1)
                       END-IF
      *                公費負担者番号又は受給者番号が不明のとき
                       IF  (RECE62-SRYYM          >= "201101")
                       AND (RECE62-RJNGAIKOHFTN(1) =  ZERO   )
                       AND (RECE62-HKNNUM          =  SPACE  )
                         PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                   UNTIL   IDX-SAI    >    4
                           IF   RECE62-KOHNUM(IDX-SAI) NOT =  SPACE
                             IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                               MOVE    6   TO  RECE62-RJNGAIKOHFTN (1)
                               MOVE    4   TO  IDX-SAI
                             ELSE
                              IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                               MOVE    1   TO  RECE62-RJNGAIKOHFTN (1)
                              END-IF
                             END-IF
                           END-IF
                         END-PERFORM
                       END-IF
      *                記号番号不明＋減免対象者のとき
      *                公費受給者番号不明＋減免対象者のとき
                       IF  (RECE62-RJNGAIKOHFTN(1) =   1  )
                       AND (RECE62-GENMENKBN       >  ZERO)
                         IF   RECE62-SRYYM    >= "201101"
                           MOVE    5       TO  RECE62-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
      *                公費負担者番号不明＋減免対象者のとき
                       IF  (RECE62-RJNGAIKOHFTN(1) =   6  )
                       AND (RECE62-GENMENKBN       >  ZERO)
                         IF   RECE62-SRYYM    >= "201101"
                           MOVE    7       TO  RECE62-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
      *                減免対象者のとき
                       IF  (RECE62-RJNGAIKOHFTN(1) =  ZERO)
                       AND (RECE62-GENMENKBN       >  ZERO)
                         IF    (RECE62-SRYYM    >= "201101")
                         AND   (FLG-GENMEN-ARI   =  1      )
                         AND   (FLG-GENMEN-NASI  =  1      )
                           MOVE    4       TO  RECE62-RJNGAIKOHFTN (1)
                           MOVE  WRK-GENMEN-NASI-KIN
                                           TO  RECE62-GENMEN-NASI-KIN
                           MOVE  WRK-GENMEN-NASI-SKJ
                                           TO  RECE62-GENMEN-NASI-SKJ
                           IF   (FLG-SAIGAI-TAISYO  =   1       )
                           AND  (RECE62-GENMENKBN   =   2  OR  3)
                             IF  RECE62-KOUREI      =  "1" OR "2"
                               MOVE   WRK-GENMEN-NASI-KIN
                                           TO  RECE62-FTNMONEY(1)
                             END-IF
                             IF  RECE62-SRYYM  <=  "201202"
                               MOVE   WRK-GENMEN-NASI-SKJ
                                           TO  RECE62-SHOKUJIFTN(1)
                             END-IF
                           END-IF
                         ELSE
                           IF  (RECE62-SRYYM    >= "201101")
                           AND (FLG-GENMEN-ARI2  =  1      )
                           AND (FLG-GENMEN-NASI2 =  1      )
                             MOVE    4     TO  RECE62-RJNGAIKOHFTN (1)
                             MOVE  WRK-GENMEN-NASI-KIN2
                                           TO  RECE62-GENMEN-NASI-KIN
                             MOVE  WRK-GENMEN-NASI-SKJ2
                                           TO  RECE62-GENMEN-NASI-SKJ
                           ELSE
                             MOVE    2     TO  RECE62-RJNGAIKOHFTN (1)
                           END-IF
                         END-IF
                       END-IF
                   END-IF
               END-IF
      *
               IF   RECE62-SRYYM   >=  "201007"
                   IF  (RECE62-SRYYM          >= "201101"         )
                   AND (RECE62-HKNNUM          =  SPACE           )
                   AND (FLG-SAIGAI-TAISYO      =   1              )
                   AND (RECE62-RJNGAIKOHFTN(1) =  2 OR 4 OR 5 OR 7)
      *              上限額確認
                     MOVE     ZERO      TO    FLG-SAIGAI-JGN-ETC
                     PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                               UNTIL   IDX-SAI    >    4
                       IF   RECE62-KOHNUM(IDX-SAI) NOT =  SPACE
                         IF  RECE62-KOHNUM(IDX-SAI)  =  "010"
                            MOVE   1    TO    FLG-SAIGAI-JGN-ETC
                         END-IF
                         IF ( RECE62-KOHNUM(IDX-SAI)  =
                              "012" OR "015" OR "016" OR
                              "024" OR "025" OR "038" OR "051" OR
                              "052" OR "079" OR "011" OR "020" OR
                              "028" OR "029"                      )
                         OR ((RECE62-KOHNUM(IDX-SAI)  = "054"    ) AND
                             (RECE62-SRYYM           >= "201501" ))
                            PERFORM   2117-SAIGAI-JGN-CHECK-SEC
                         END-IF
                       END-IF
                     END-PERFORM
                     IF  FLG-SAIGAI-JGN-ETC = ZERO
                       EVALUATE  RECE62-RJNGAIKOHFTN(1)
                         WHEN      2
                         WHEN      4
                           MOVE  ZERO  TO  RECE62-RJNGAIKOHFTN(1)
                         WHEN      5
                           MOVE   1    TO  RECE62-RJNGAIKOHFTN(1)
                         WHEN      7
                           MOVE   6    TO  RECE62-RJNGAIKOHFTN(1)
                       END-EVALUATE
                       MOVE    ZERO    TO  RECE62-GENMEN-NASI-KIN
                       MOVE    ZERO    TO  RECE62-GENMEN-NASI-SKJ
                       MOVE    ZERO    TO  RECE62-GENMENKBN
                     END-IF
                   END-IF
                   IF   FLG-SAIGAI-TAISYO   =   1
                     IF  (RECE62-SRYYM          >= "201101")
                     AND (RECE62-RJNGAIKOHFTN(1) =  ZERO   )
                       MOVE    3     TO   RECE62-RJNGAIKOHFTN (1)
                     END-IF
                     IF  (RECE62-HKNNUM      NOT =  SPACE  )
                     AND (RECE62-SRYYM          >= "201101")
                       EVALUATE  RECE62-RJNGAIKOHFTN(1)
                         WHEN       1
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF   RECE62-KOHNUM(IDX-SAI) NOT =  SPACE
                               IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE   11   TO  RECE62-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE    1   TO  RECE62-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                         WHEN       3
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF   RECE62-KOHNUM(IDX-SAI) NOT =  SPACE
                               IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE    9   TO  RECE62-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE   10   TO  RECE62-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                         WHEN       6
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF   RECE62-KOHNUM(IDX-SAI) NOT =  SPACE
                               IF  RECE62-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE    6   TO  RECE62-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE62-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE    8   TO  RECE62-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                       END-EVALUATE
                     END-IF
                     IF  (RECE62-SRYYM          >= "201101")
                       EVALUATE  RECE62-RJNGAIKOHFTN(1)
                         WHEN       2
                         WHEN       5
                         WHEN       7
                            MOVE    96   TO      FLG-TOKKI
                            PERFORM   21013-TOKKI-HENSYU-SEC
                         WHEN       4
                            MOVE    97   TO      FLG-TOKKI
                            PERFORM   21013-TOKKI-HENSYU-SEC
                       END-EVALUATE
                     END-IF
                     IF  (RECE62-SRYYM        >= "201101")
                     AND (RECE62-HKNNUM    NOT =  SPACE  )
                     AND (RECE62-HKNJANUM  NOT =  SPACE  )
                     AND (RECE62-KIGO      NOT =  SPACE  )
                     AND (RECE62-NUM           =  SPACE  )
                     AND (RECE62-RJNGAIKOHFTN(1) =  5    )
                       MOVE  SPACE   TO   RECE62-KIGO
                       MOVE  "0000000000"
                                     TO   RECE62-OCR2(6:10)
                       MOVE  "0"     TO   RECE62-OCR2(26:1)
                     END-IF
                   ELSE
                     MOVE    ZERO    TO   RECE62-RJNGAIKOHFTN (1)
                     MOVE    ZERO    TO   RECE62-GENMEN-NASI-KIN
                     MOVE    ZERO    TO   RECE62-GENMEN-NASI-SKJ
                   END-IF
               END-IF
           END-IF
      *
           .
       2119-SAIGAIKBN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費単独の災害対象上限額チェック
      *****************************************************************
       2117-SAIGAI-JGN-CHECK-SEC      SECTION.
      *
           INITIALIZE                        LNK-ORCSJGNGET-REC
           MOVE   RECE62-HOSPNUM         TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE62-NYUGAIKBN       TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE62-PTID            TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE62-KOHNUM(IDX-SAI) TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE62-KOHID(IDX-SAI)  TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE62-SRYYM           TO  LNK-ORCSJGNGET-SRYYM
           MOVE   RECE62-SRYYM       TO  LNK-ORCSJGNGET-SKYEDYMD(1:6)
           MOVE   "31"               TO  LNK-ORCSJGNGET-SKYEDYMD(7:2)
           IF     RECE62-KOHNUM(IDX-SAI)(1:1) >=  "1" AND <=  "8"
              MOVE   WRK-KOHJGNGET-TAISYOKBN(IDX-SAI)
                                         TO  LNK-ORCSJGNGET-SETKBN
              MOVE   WRK-KOHJGNGET-TEKIYOFLG(IDX-SAI)
                                         TO  LNK-ORCSJGNGET-SETKBN2
           END-IF
           CALL    "ORCSJGNGET"          USING
                                         LNK-ORCSJGNGET-REC
                                         SPA-AREA
           IF   LNK-ORCSJGNGET-RC  =  ZERO
             IF   LNK-ORCSJGNGET-NYUJGNGAK  NOT = ZERO
                MOVE    1    TO    FLG-SAIGAI-JGN-ETC
             END-IF
           END-IF
      *
           .
       2117-SAIGAI-JGN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    全角→数値半角変換処理
      *****************************************************************
       800-NUM-ZENKAKU-HENKAN-SEC    SECTION.
      *
           MOVE    ZERO                TO  WRK-STIDX
                                           WRK-EDIDX 
           MOVE    SPACE               TO  WRK-NUM
           MOVE    ZERO                TO  WRK-NUM-9
      *
      *    空白のときはゼロ 
           IF      WRK-ZENKAKU          =       SPACE
               MOVE    ZERO                TO  WRK-NUM
               MOVE    10                  TO  IDY   
           ELSE
      *
      *        文字の開始桁
               PERFORM VARYING IDX FROM    1   BY  1
                       UNTIL   IDX         >   80
                       OR      WRK-STIDX   >   ZERO
                   IF      WRK-ZENKAKU (IDX:1)  NOT =   SPACE
                       MOVE    IDX                 TO  WRK-STIDX
                   END-IF     
               END-PERFORM
      *        文字の終了桁
               PERFORM VARYING IDX FROM    80  BY  -1
                       UNTIL   IDX         <   1
                       OR      WRK-EDIDX   >   ZERO
                   IF      WRK-ZENKAKU (IDX:1)  NOT =   SPACE
                       MOVE    IDX                 TO  WRK-EDIDX
                   END-IF     
               END-PERFORM
      *
      *        全角数字のとき半角数字に変換（数字以外のときはゼロ）
               IF      WRK-ZENKAKU (WRK-STIDX:1)   >=  X"A1"
                   MOVE    ZERO                TO  IDX3
                   PERFORM VARYING     IDX     FROM    WRK-STIDX  BY  2
                           UNTIL       IDX     >       WRK-EDIDX
                       IF      WRK-ZENKAKU (IDX:2)  >= "０"  AND
                                                   <=  "９"
                           ADD     1               TO  IDX3
                           EVALUATE    WRK-ZENKAKU (IDX:2)
                               WHEN    "０"
                                   MOVE    "0"     TO  WRK-NUM (IDX3:1)
                               WHEN    "１"
                                   MOVE    "1"     TO  WRK-NUM (IDX3:1)
                               WHEN    "２"
                                   MOVE    "2"     TO  WRK-NUM (IDX3:1)
                               WHEN    "３"
                                   MOVE    "3"     TO  WRK-NUM (IDX3:1)
                               WHEN    "４"
                                   MOVE    "4"     TO  WRK-NUM (IDX3:1)
                               WHEN    "５"
                                   MOVE    "5"     TO  WRK-NUM (IDX3:1)
                               WHEN    "６"
                                   MOVE    "6"     TO  WRK-NUM (IDX3:1)
                               WHEN    "７"
                                   MOVE    "7"     TO  WRK-NUM (IDX3:1)
                               WHEN    "８"
                                   MOVE    "8"     TO  WRK-NUM (IDX3:1)
                               WHEN    "９"
                                   MOVE    "9"     TO  WRK-NUM (IDX3:1)
                           END-EVALUATE
      *****************ELSE
      *****************    MOVE    ZERO            TO  WRK-NUM
      *****************    MOVE    WRK-EDIDX       TO  IDX
      *****************    MOVE    10              TO  IDX3
                       END-IF
                   END-PERFORM
                   MOVE    IDX3                TO  IDY     
               ELSE
      *        半角数字に変換（数字以外のときはゼロ）
                   INSPECT WRK-ZENKAKU(WRK-STIDX:)  REPLACING   ALL " "
                                                                BY  "0"
                   IF      WRK-ZENKAKU(WRK-STIDX:)     NOT NUMERIC
                       PERFORM VARYING IDX     FROM    WRK-STIDX  BY  1
                               UNTIL   IDX     >       WRK-EDIDX
                           IF      WRK-ZENKAKU (IDX:1) >=  "0" AND
                                                       <=  "9"
                               ADD     1           TO  IDX3
                               MOVE    WRK-ZENKAKU (IDX:1)
                                                   TO  WRK-NUM (IDX3:1)
                           END-IF
                       END-PERFORM    
                       MOVE    IDX3                TO  IDY     
                   ELSE
                       COMPUTE IDY     =   WRK-EDIDX   -
                                           WRK-STIDX   +   1
                       MOVE    WRK-ZENKAKU (WRK-STIDX:IDY) TO  WRK-NUM
                   END-IF     
               END-IF
           END-IF
      *
           INITIALIZE                      ORCSNUMAREA
           MOVE    WRK-NUM-X           TO  SNUM-INX
           CALL    "ORCSNUM"           USING   ORCSNUMAREA
           IF      SNUM-RC             =   ZERO
               MOVE    SNUM-OUTNUM         TO  WRK-NUM-9
           ELSE
               MOVE    ZERO                TO  WRK-NUM-9 
           END-IF
      *
           .
       800-NUM-ZENKAKU-HENKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    地方公費の給付外点数の編集
      *****************************************************************
       300-KYUFUGAI-HENSYU-SEC         SECTION.
      *
           MOVE    ZERO                TO  RECE62-KYUFUGAITEN
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       10
                   OR      RECE62-HKNCOMBI (IDX1)  =   ZERO
               IF      RECE62-KOHNUMHC (IDX1 1)
                                       NOT =   SPACE
      *            
                   INITIALIZE                  ORCSKOHPLUS-AREA
                   MOVE    RECE62-HOSPNUM  TO  LNK-SKOHPLUS-HOSPNUM
                   MOVE    SYS-1001-PREFNUM
                                           TO  LNK-SKOHPLUS-PREFNUM
                   MOVE    RECE62-PTID     TO  LNK-SKOHPLUS-PTID
                   MOVE    RECE62-HKNCOMBI (IDX1)
                                           TO  LNK-SKOHPLUS-HKNCOMBI
                   MOVE    RECE62-SRYYM    TO  LNK-SKOHPLUS-SRYYMD(1:6)
                   MOVE    "01"            TO  LNK-SKOHPLUS-SRYYMD(7:2)
                   CALL    "ORCSKOHPLUS"   USING
                                           ORCSKOHPLUS-AREA
                                           SPA-AREA
      *           
                   IF    ( LNK-SKOHPLUS-RC     =   ZERO )
                   AND   ( LNK-SKOHPLUS-FTNKBN =   "1"  )
                       IF   RECE62-SRYKA (1)  NOT =  SPACE
                           INITIALIZE                  SYUNOU-REC
                           MOVE    RECE62-HOSPNUM  TO  SYU-HOSPNUM
                           MOVE    RECE62-NYUGAIKBN
                                                   TO  SYU-NYUGAIKBN
                           MOVE    RECE62-PTID     TO  SYU-PTID
                           MOVE    RECE62-SRYYM    TO  SYU-SRYYMD(1:6)
                           MOVE    "__"            TO  SYU-SRYYMD(7:2)
                           MOVE    RECE62-HKNCOMBI (IDX1)
                                                   TO  SYU-HKNCOMBINUM
                           MOVE    SYUNOU-REC      TO  MCPDATA-REC
                           MOVE    "tbl_syunou"    TO  MCP-TABLE
                           MOVE    "key19"         TO  MCP-PATHNAME
                           PERFORM   900-DBSELECT-SEC
                           IF      MCP-RC          =   ZERO
                               MOVE    "tbl_syunou"    TO  MCP-TABLE
                               MOVE    "key19"         TO  MCP-PATHNAME
                               PERFORM 900-SYUNOU-READ-SEC
                               PERFORM UNTIL   FLG-SYUNOU  =    1
                                 IF  (SYU-DENPJTIKBN         NOT = "3")
                                 AND (RECE62-DAISANFLG(IDX1) NOT =  1 )
                                   ADD     SYU-KYUFUGAI-GOKEI-TEN
                                                TO  RECE62-KYUFUGAITEN
                                 END-IF
                                 MOVE    "tbl_syunou"  TO  MCP-TABLE
                                 MOVE    "key19"       TO  MCP-PATHNAME
                                 PERFORM 900-SYUNOU-READ-SEC
                               END-PERFORM          
                           END-IF
      *
                           MOVE    "tbl_syunou"    TO  MCP-TABLE
                           MOVE    "key19"         TO  MCP-PATHNAME
                           PERFORM 900-CLOSE-SEC
                       END-IF
                   END-IF
               END-IF
           END-PERFORM
      *
           .
       300-KYUFUGAI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＫＥＹ編集処理
      *****************************************************************
       500-RECE64-KEY-HENSYU-SEC       SECTION.
      *
           MOVE    SPACE               TO  RECE64-REC
           INITIALIZE                      RECE64-REC
           MOVE    RECE62-KEY          TO  RECE64-KEY1
           .
       500-RECE64-KEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＫＥＹ編集処理
      *****************************************************************
       500-RECE65-KEY-HENSYU-SEC       SECTION.
      *
           MOVE    SPACE               TO  RECE65-REC
           INITIALIZE                      RECE65-REC
           MOVE    RECE62-KEY          TO  RECE65-KEY1
           .
       500-RECE65-KEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数テーブルの検索
      *****************************************************************
       900-TENSU-TBL-SEC               SECTION.
      *
           MOVE    ZERO                     TO      FLG-TENSU
           MOVE    WRK-SRYCD                TO      TTNS-CHK-SRYCD
           MOVE    WK-TAIHI-SRYYMD          TO      TTNS-CHK-YMD
      *
      *    点数マスタ退避ワークチェック
           PERFORM 9001-TTNS-CHK-SEC
      *
      *    退避ワークに存在しない場合はＤＢを検索
           IF    ( TTNS-FLG            =   ZERO )
               INITIALIZE                           TNS-TENSU-REC
               MOVE    SPA-HOSPNUM          TO      TNS-HOSPNUM
               MOVE    WRK-SRYCD            TO      TNS-SRYCD
               MOVE    WK-TAIHI-SRYYMD      TO      TNS-YUKOSTYMD
                                                    TNS-YUKOEDYMD
               MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
               MOVE    "tbl_tensu"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM   900-DBSELECT-SEC
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_tensu"      TO      MCP-TABLE
                   MOVE    "key"            TO      MCP-PATHNAME
                   PERFORM  910-TENSU-READ-SEC
                   IF       FLG-TENSU       =       1
                       DISPLAY   "TENSU FETCH ERR"  
                   ELSE
      *                点数マスタ退避ワークに編集する
                       PERFORM 9001-TTNS-HEN-SEC
                   END-IF
               ELSE
                   DISPLAY   "TENSU SELECT ERR" 
                   INITIALIZE       TNS-TENSU-REC
                   MOVE    1   TO   FLG-TENSU
               END-IF
      *
               MOVE    "tbl_tensu"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM   900-CLOSE-SEC
           END-IF
      *
           .
       900-TENSU-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ退避ワークチェック処理
      *****************************************************************
       9001-TTNS-CHK-SEC               SECTION.
      *
           MOVE    ZERO                TO  TTNS-FLG
           INITIALIZE                      TNS-TENSU-REC
      *
           PERFORM VARYING TTNS-IDX    FROM    1   BY  1
                   UNTIL ( TTNS-IDX    >   TTNS-MAX )
                    OR   ( TTNS-FLG    =   1 )
               IF    ( TTNS-KEY-SRYCD (TTNS-IDX)
                                       =   TTNS-CHK-SRYCD )
                 AND ( TTNS-KEY-YUKOSTYMD (TTNS-IDX)
                                      <=   TTNS-CHK-YMD )
                 AND ( TTNS-KEY-YUKOEDYMD (TTNS-IDX)
                                      >=   TTNS-CHK-YMD )
                   MOVE    1           TO  TTNS-FLG
                   MOVE    TTNS-DAT(TTNS-IDX)
                                       TO  TNS-TENSU-REC
               END-IF
           END-PERFORM
      *
           .
       9001-TTNS-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ退避ワーク編集処理
      *****************************************************************
       9001-TTNS-HEN-SEC               SECTION.
      *
           IF      WRK-SRYCD(1:1)       = "6" OR "7"
               INITIALIZE                   TNSUP-KEY
               MOVE    WK-TAIHI-SRYYMD  TO  TNSUP-YUKOSTYMD
                                            TNSUP-YUKOEDYMD
               CALL    "ORCSSETTANI"    USING
                                        TNS-TENSU-REC
                                        SPA-AREA
           END-IF
      *
           IF      TNS-TANIMOJISU    =   ZERO
           AND     TNS-TANINAME  NOT =   SPACE
               PERFORM   VARYING   IDW2   FROM   24   BY  -1
                          UNTIL    IDW2    <      1
                  IF   TNS-TANINAME(IDW2:1)  NOT =   SPACE
                      COMPUTE  TNS-TANIMOJISU   =   IDW2   /   2
                      MOVE    1     TO    IDW2
                  END-IF
               END-PERFORM
           END-IF
      *
           IF    ( TTNS-CONST-MAX  >   TTNS-MAX )
               COMPUTE TTNS-MAX    =   TTNS-MAX    +   1
               MOVE    TNS-SRYCD       TO  TTNS-KEY-SRYCD(TTNS-MAX)
               MOVE    TNS-YUKOSTYMD   TO  TTNS-KEY-YUKOSTYMD(TTNS-MAX)
               MOVE    TNS-YUKOEDYMD   TO  TTNS-KEY-YUKOEDYMD(TTNS-MAX)
               MOVE    TNS-TENSU-REC   TO  TTNS-DAT(TTNS-MAX)
           END-IF
      *
           .
       9001-TTNS-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数読込
      *****************************************************************
       910-TENSU-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計読込
      *****************************************************************
       900-SRYACCT-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACCT-REC
               MOVE    ZERO            TO  FLG-SRYACCT
           ELSE
               INITIALIZE                  SRYACCT-REC
               MOVE    1               TO  FLG-SRYACCT
           END-IF
      *
           .
       900-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為読込
      *****************************************************************
       900-SRYACT-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       900-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院会計マスター読込
      *****************************************************************
       900-NYUINACCT-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  NYUINACCT-REC
               MOVE    ZERO            TO  FLG-NYUINACCT
           ELSE
               INITIALIZE                  NYUINACCT-REC
               MOVE    1               TO  FLG-NYUINACCT
           END-IF
      *
           .
       900-NYUINACCT-READ-EXT.
           EXIT.
      *
      **************************************************************
      *    入院診療行為マスター読込
      **************************************************************
       900-NYUINACT-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  NYUINACT-REC
               MOVE    ZERO            TO  FLG-NYUINACT
           ELSE
               INITIALIZE                  NYUINACT-REC
               MOVE    1               TO  FLG-NYUINACT
           END-IF
      *
           .
       900-NYUINACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    収納読込
      *****************************************************************
       900-SYUNOU-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYUNOU-REC
               MOVE    ZERO            TO  FLG-SYUNOU
      *
               INITIALIZE              TBL-TOKATUKAI2
               IF  ((WRK-PREFNUM              = "13"        ) AND
                    (SYU-KOH-HKNNUM(1)        = "151"       ) AND
                    (RECE62-SRYYM            >= "200905"    ))
               OR  ((WRK-PREFNUM              = "23"        ) AND
                    (SYU-KOH-HKNNUM(1)        = "191"       ) AND
                    (RECE62-SRYYM            >= "200910"    ) AND
                    (RECE62-SRYYM            <= "201509"    ))
               OR  ((WRK-PREFNUM              = "23" OR "24") AND
                    (SYU-KOH-HKNNUM(1)        = "152"       ) AND
                    (RECE62-SRYYM            >= "201104"    ) AND
                    (RECE62-SRYYM            <= "201412"    ))
                 MOVE     1     TO     TBL-TOKATUKAIFLG2
               END-IF
      *
           ELSE
               INITIALIZE                  SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
       900-SYUNOU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報読込
      *****************************************************************
       900-PTKOHINF-READ-SEC           SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHINF-REC
               MOVE    ZERO            TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                  PTKOHINF-REC
               MOVE    1               TO  FLG-PTKOHINF
           END-IF
      *
           .
       900-PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    選定療養マスター読込
      *****************************************************************
       900-SENTEICDCHG-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SENTEICDCHG-REC
               MOVE    ZERO            TO  FLG-SENTEICDCHG
           ELSE
               INITIALIZE                  SENTEICDCHG-REC
               MOVE    1               TO  FLG-SENTEICDCHG
           END-IF
      *
           .
       900-SENTEICDCHG-READ-EXT.
           EXIT.
      *
      **************************************************************
      *    患者入院履歴読込
      **************************************************************
       900-PTNYUINRRK-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               MOVE    ZERO            TO  FLG-PTNYUINRRK
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       900-PTNYUINRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスタ読込
      *****************************************************************
       900-HKNCOMBI-INV-SEC         SECTION.
      *
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hkncombi"      TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-HKNCOMBI
                   MOVE    MCPDATA-REC         TO  HKNCOMBI-REC
                   IF      COMB-DELKBN         =   "1"
                       MOVE    1               TO  FLG-HKNCOMBI
                   END-IF
               ELSE
                   MOVE    1                   TO  FLG-HKNCOMBI
                   INITIALIZE                      HKNCOMBI-REC
               END-IF
           ELSE
               MOVE    1                       TO  FLG-HKNCOMBI
               INITIALIZE                          HKNCOMBI-REC
           END-IF
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-HKNCOMBI-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者保険情報読込
      *****************************************************************
       900-PTHKNINF-INV-SEC           SECTION.
      *
           MOVE     "tbl_pthkninf"     TO  MCP-TABLE
           MOVE     "key"              TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF        MCP-RC            =   ZERO
             MOVE   "tbl_pthkninf"     TO  MCP-TABLE
             MOVE   "key"              TO  MCP-PATHNAME
             PERFORM 900-DBFETCH-SEC
             IF      MCP-RC            =   ZERO
               MOVE  MCPDATA-REC       TO  PTHKNINF-REC
               MOVE  ZERO              TO  FLG-PTHKNINF
             ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
             END-IF
           ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
           END-IF
           MOVE     "tbl_pthkninf"     TO  MCP-TABLE
           MOVE     "key"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       900-PTHKNINF-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスタ読込
      *****************************************************************
       960-KANRIMST-READ-SEC         SECTION.
      *
           PERFORM   900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       960-KANRIMST-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者コメントマスタ読み込み
      *****************************************************************
       950-PTCOM-READ-SEC           SECTION.
      *
           MOVE    PTCOM-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptcom"     TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  PTCOM-REC
                   MOVE    ZERO                TO  FLG-PTCOM
               ELSE
                   MOVE    1                   TO  FLG-PTCOM
                   INITIALIZE                  PTCOM-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTCOM
               INITIALIZE                  PTCOM-REC
           END-IF
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF      FLG-PTCOM           =   ZERO
               IF      PTCOM-INPUTCOMENT   NOT =   SPACE
                   MOVE    ZERO            TO  WRK-COL
                                               IDZ1
                                               IDZ2 
                   INSPECT PTCOM-INPUTCOMENT   TALLYING    WRK-COL
                                               FOR ALL WRK-CONS-RETURN
                   IF      WRK-COL         >   ZERO
                       DISPLAY "PTCOM=" PTCOM-KEY
                       PERFORM VARYING IDZ1    FROM    1   BY  1
                               UNTIL   IDZ1    >       140
                           IF      PTCOM-INPUTCOMENT(IDZ1:1)
                                               =   WRK-CONS-RETURN
                               COMPUTE IDZ2    =   IDZ1    -   1
                               MOVE    140     TO  IDZ1
                           END-IF
                       END-PERFORM
      *
                       CALL    "coblog" USING   "ptcom returncd err"
                       MOVE    SPACE               TO  WRK-RECEERR
                       MOVE    SPACE               TO  WRK-ERRMSG
                       STRING
                        "コメント文字コード不正　患者番号="
                                                   DELIMITED  BY  SIZE
                               RECE62-PTNUM        DELIMITED  BY  SPACE
                               "　診療区分="       DELIMITED  BY  SIZE
                               WRK-TH-SRYKBN       DELIMITED  BY  SPACE
                                                   INTO    WRK-ERRMSG
                       END-STRING
                       IF      IDZ2        >   1    
                           STRING   WRK-ERRMSG     DELIMITED  BY  SPACE
                                   "　コメント="   DELIMITED  BY  SIZE
                                   PTCOM-INPUTCOMENT(1:IDZ2)
                                                   DELIMITED  BY  SPACE
                                                   INTO    WRK-RECEERR
                           END-STRING
                       ELSE
                           STRING   WRK-ERRMSG     DELIMITED  BY  SPACE
                                    "　コメント="  DELIMITED  BY  SIZE
                                    PTCOM-SRYCD    DELIMITED  BY  SPACE
                                                   INTO    WRK-RECEERR
                           END-STRING
                       END-IF
                       PERFORM 500-ERR-HENSYU-SEC
      *
                       MOVE    SPACE               TO  WRK-ERRMSG
                       STRING  "ORCR0640 "         DELIMITED  BY  SIZE
                               WRK-RECEERR         DELIMITED  BY  SIZE
                               LOW-VALUE           DELIMITED  BY  SIZE
                                                   INTO    WRK-ERRMSG
                       END-STRING
                       PERFORM 500-COBABORT-SEC
                   END-IF
               END-IF
           END-IF
      *
           .
       950-PTCOM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加読み込み
      *****************************************************************
       900-SRYACCTPLUS-READ-SEC           SECTION.
      *
           MOVE    SRYACCTPLUS-REC     TO  MCPDATA-REC
      *
           MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  SRYACCTPLUS-REC
                   MOVE    ZERO                TO  FLG-SRYACCTPLUS
               ELSE
                   MOVE    1                   TO  FLG-SRYACCTPLUS
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SRYACCTPLUS
           END-IF
      *
           MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-SRYACCTPLUS-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       RECE62-READ-SEC            SECTION.
      *
           READ    RECE62-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-RECE62
               NOT  AT  END
                   IF      STS-RECE62          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE62PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE62          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
      *
                   ADD     1     TO    CNT-IN(IDZ)
                   ADD     1     TO    CNT-IN-COMMIT
                                       CNT-IN-CANCEL
      *
                   DISPLAY "RECE62 " IDZ " PTNUM=" RECE62-PTNUM     
                                         " (PTID=" RECE62-PTID ")"
      *
                   MOVE  RECE62-SRYYM   TO  WRK-SYS-SRYYMD(1:6)
                   MOVE  "01"           TO  WRK-SYS-SRYYMD(7:2)
                   PERFORM 910-SYSKANRI-HENSYU-SEC
      *
           END-READ
           .
       RECE62-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       RECE65-READ-SEC            SECTION.
      *
           READ    RECE65-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-RECE65-ZAN
               NOT  AT  END
                   IF      STS-RECE65          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE65PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE65          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
           END-READ
           .
       RECE65-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    診療年月の対象となるシス管理を取得（個別処理のみ
      ****************************************************************
       910-SYSKANRI-HENSYU-SEC         SECTION.
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
               CONTINUE
           ELSE
      *        医療機関ＩＤ編集
               MOVE  ZERO           TO  FLG-SET
               PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                     UNTIL  ( SYSKAN-IDX              >  100  )
                      OR    ( TBL-SYS1001(SYSKAN-IDX) = SPACE )
                      OR    ( FLG-SET                 =   1   )
      *
                 MOVE  TBL-SYS1001(SYSKAN-IDX)  TO  SYS-1001-REC
                 IF   ( SYS-1001-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                 AND  ( WRK-SYS-SRYYMD     <=  SYS-1001-EDYUKYMD )
                    MOVE     1               TO    FLG-SET
                    MOVE   SYS-1001-PREFNUM  TO    WRK-PREFNUM
                    MOVE   SYS-1001-DAISANKBN
                                             TO    WRK-DAISAN-DAISANKBN
                    IF  WRK-DAISAN-DAISANKBN = SPACE
                      MOVE "2"               TO    WRK-DAISAN-DAISANKBN
                    END-IF
                 END-IF
      *
               END-PERFORM
               IF     FLG-SET  =  ZERO
                  STRING
                     "医療機関情報が取得できませんでした。診療年月＝"
                                               DELIMITED  BY  SIZE 
                       RECE62-SRYYM            DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
                  END-STRING
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1              TO  FLG-RECE62
                  GO  TO  910-SYSKANRI-HENSYU-EXT
               END-IF
      *
      *        施設基準情報
               MOVE    ZERO         TO  FLG-SET
               PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                         UNTIL ( SYSKAN-IDX2               >  100  )
                          OR   ( TBL-SYS10062(SYSKAN-IDX2) = SPACE )
                          OR   ( FLG-SET                   =   1   )
                   MOVE    TBL-SYS10062(SYSKAN-IDX2)  TO  SYS-1006-REC
                   IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                   AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                       MOVE     1                  TO  FLG-SET
                   END-IF
               END-PERFORM
               IF      FLG-SET    =   ZERO
                   MOVE  ZERO                    TO  WRK-SISETU613
                   MOVE  ZERO                    TO  WRK-SISETU695
               ELSE
                   MOVE  SYS-1006-SSTKIJUN(113)  TO  WRK-SISETU613
                   MOVE  SYS-1006-SSTKIJUN(195)  TO  WRK-SISETU695
               END-IF
      *
               MOVE    ZERO         TO  FLG-SET
               PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                         UNTIL ( SYSKAN-IDX2               >  100  )
                          OR   ( TBL-SYS10067(SYSKAN-IDX2) = SPACE )
                          OR   ( FLG-SET                   =   1   )
                   MOVE    TBL-SYS10067(SYSKAN-IDX2)  TO  SYS-1006-REC
                   IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                   AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                       MOVE     1                  TO  FLG-SET
                   END-IF
               END-PERFORM
               IF      FLG-SET    =   ZERO
                   MOVE  ZERO                    TO  WRK-SISETU3055
                   MOVE  ZERO                    TO  WRK-SISETU3056
                   MOVE  ZERO                    TO  WRK-SISETU3057
                   MOVE  ZERO                    TO  WRK-SISETU3058
                   MOVE  ZERO                    TO  WRK-SISETU3168
                   MOVE  ZERO                    TO  WRK-SISETU3169
               ELSE
                   MOVE  SYS-1006-SSTKIJUN(55)   TO  WRK-SISETU3055
                   MOVE  SYS-1006-SSTKIJUN(56)   TO  WRK-SISETU3056
                   MOVE  SYS-1006-SSTKIJUN(57)   TO  WRK-SISETU3057
                   MOVE  SYS-1006-SSTKIJUN(58)   TO  WRK-SISETU3058
                   MOVE  SYS-1006-SSTKIJUN(168)  TO  WRK-SISETU3168
                   MOVE  SYS-1006-SSTKIJUN(169)  TO  WRK-SISETU3169
               END-IF
      *
      *        帳票編集区分情報
               MOVE    ZERO                TO  FLG-SET
               MOVE    SPACE               TO  WRK-1030-KOUHATUKA
      *
               IF      WRK-PARA-PRTKBN = "9" OR "2" OR "3" OR "4" OR "5"
                 PERFORM VARYING SYSKAN-IDX  FROM    1   BY  1
                         UNTIL ( SYSKAN-IDX              >  100  )
                         OR    ( TBL-SYS1030(SYSKAN-IDX) = SPACE )
                         OR    ( FLG-SET                 =   1   )
                   MOVE    TBL-SYS1030(SYSKAN-IDX) TO  SYS-1030-REC
                   IF  ( SYS-1030-STYUKYMD       <= WRK-SYS-SRYYMD    )
                   AND ( WRK-SYS-SRYYMD          <= SYS-1030-EDYUKYMD )
                       MOVE     1          TO  FLG-SET
                       MOVE    SYS-1030-KOUHATUKA
                                           TO  WRK-1030-KOUHATUKA
                   END-IF
                 END-PERFORM
               END-IF
      *
               MOVE      RECE62-SRYYM   TO  WRK-SRYYM-5000
               PERFORM   1001-SYS-5000-CHK-SEC
      *        食事・未実施減算情報（システム管理テーブルより）
               INITIALIZE             WRK-SHOKUJIRYOYO-OCC
                                      WRK-TOKUKANRIKASAN-OCC
      *
               INITIALIZE             WRK-SYS-MIJISI-T
      *
               MOVE  ZERO         TO  FLG-SET
               PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                    UNTIL  ( SYSKAN-IDX              >  100  )
                     OR    ( TBL-SYS5000(SYSKAN-IDX) = SPACE )
                     OR    ( FLG-SET                 =   1   )
      *
                  MOVE  TBL-SYS5000(SYSKAN-IDX)  TO  SYS-5000-REC
                  IF   ( SYS-5000-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                  AND  ( WRK-SYS-SRYYMD     <=  SYS-5000-EDYUKYMD )
                      MOVE     1       TO    FLG-SET
                      PERFORM  1002-SYSKAN-HENSYU-SEC
                      IF        WRK-SYS5000-COUNT    =     ZERO
                          CONTINUE
                      ELSE
                          PERFORM  1003-SYS-5000-GET-SEC
                      END-IF
                  END-IF
      *
               END-PERFORM
               IF     FLG-SET  =  ZERO
                  STRING
              "医療機関情報−入院基本が取得できませんでした。診療年月＝"
                                               DELIMITED  BY  SIZE 
                       RECE62-SRYYM            DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
                  END-STRING
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1              TO  FLG-RECE62
                  GO  TO  910-SYSKANRI-HENSYU-EXT
               END-IF
           END-IF
      *
           .
      *
       910-SYSKANRI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ更新処理（Ｆ００２）
      *****************************************************************
       RECE62-REWRITE-SEC                SECTION.
      *
           REWRITE   RECE62-REC
      *
           IF      STS-RECE62          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
      *
               MOVE    4                   TO  WRK-ERR-FLG
               MOVE    RECE62PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE62          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           ADD     1                   TO  CNT-OUT3 (IDZ)
      *
           .
       RECE62-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００４）
      *****************************************************************
       RECE64-WRITE-SEC                SECTION.
      *
           IF      IDZ             =   1               
               IF      WRK-PARA-SHELLID
                                   NOT =   "RECEPTX"
      *            診療会計マスタ付加情報設定
                   PERFORM 9001-SRYACCTPLUS-HENSYU-SEC
               END-IF
      * 
               MOVE    RECE64-ZAITEN      TO    RECE64-HOKATU-ZAITEN
               MOVE    RECE64-SYUTEN1     TO    RECE64-HOKATU-SYUTEN1
               MOVE    RECE64-SYUTEN2     TO    RECE64-HOKATU-SYUTEN2
               MOVE    RECE64-YKZTEN      TO    RECE64-HOKATU-YKZTEN
               MOVE    RECE64-KIZAITEN    TO    RECE64-HOKATU-KIZAITEN
      *
               WRITE   RECE64-REC
      *
               IF     (RECE64-ZAIKAISU    NOT =    ZERO         )
               AND    (RECE64-JIHOKBN         =    SPACE        )
               AND    (RECE64-SRYKBN      NOT =    "95" AND "96")
                 PERFORM  VARYING  IDX18  FROM  1  BY  1
                           UNTIL  (IDX18                   >  10  )
                             OR   (RECE62-HKNCOMBI(IDX18)  =  ZERO)
                   IF  RECE64-HKNCOMBI  =  RECE62-HKNCOMBI(IDX18)
                     IF   RECE64-ZAITEN   NOT =    ZERO
                       MOVE   1   TO   TBL-HKNCOMBI-SKYTENFLG(IDX18)
                     ELSE
                       MOVE   1   TO   TBL-HKNCOMBI-SKYTENFLG2(IDX18)
                     END-IF
                     MOVE    10   TO   IDX18
                   END-IF
                 END-PERFORM
               END-IF
      *
               IF      STS-RECE64          =   "00"
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  WRK-ERR-AREA
                   INITIALIZE                      WRK-ERR-AREA
      *
                   MOVE    3                   TO  WRK-ERR-FLG
                   MOVE    RECE64PARA          TO  WRK-ERR-FILE-NM
                   MOVE    STS-RECE64          TO  WRK-ERR-FILE-STS
                   PERFORM 500-FILE-ERR-ABORT-SEC
               END-IF
      *
               ADD     1                   TO  CNT-OUT1
           END-IF
      *
           .
       RECE64-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加情報設定処理
      *****************************************************************
       9001-SRYACCTPLUS-HENSYU-SEC     SECTION.
      *
           IF      RECE64-SRYKBN       =   "13"    OR  "14"    OR  "11"
               CONTINUE
           ELSE
               GO  TO  9001-SRYACCTPLUS-HENSYU-EXT
           END-IF
           IF      RECE64-ZAIREQFLG    =   "1"
               CONTINUE
           ELSE
               GO  TO  9001-SRYACCTPLUS-HENSYU-EXT
           END-IF
      *
           MOVE    SPACE               TO  SRYACCTPLUS-REC
           INITIALIZE                      SRYACCTPLUS-REC
           MOVE    RECE64-HOSPNUM      TO  ACCTP-HOSPNUM
           MOVE    RECE64-NYUGAIKBN    TO  ACCTP-NYUGAIKBN
           MOVE    RECE64-PTID         TO  ACCTP-PTID
           MOVE    RECE64-SRYKA        TO  ACCTP-SRYKA
           MOVE    RECE64-SRYYM        TO  ACCTP-SRYYM
           MOVE    RECE64-ZAINUM       TO  ACCTP-ZAINUM
           MOVE    1                   TO  ACCTP-RENNUM
           PERFORM 900-SRYACCTPLUS-READ-SEC
           IF      FLG-SRYACCTPLUS     =   0
               MOVE    ACCTP-SYUGI-TBL-G   TO  RECE64-ACCTP-SYUGI-TBL-G
               MOVE    ACCTP-SANSOTEN      TO  RECE64-ACCTP-SANSOTEN
               MOVE    ACCTP-CHISOTEN      TO  RECE64-ACCTP-CHISOTEN
           ELSE
               STRING  "診療会計マスタ付加情報読み込みエラー KEY="
                                               DELIMITED  BY  SIZE
                       ACCTP-KEY               DELIMITED  BY  SIZE
                                               INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
      *
               MOVE    SPACE               TO  WRK-ERRMSG
               STRING  "ORCR0640 "             DELIMITED  BY  SIZE
                       WRK-RECEERR             DELIMITED  BY  SIZE
                       LOW-VALUE               DELIMITED  BY  SIZE
                                               INTO    WRK-ERRMSG
               END-STRING
               PERFORM 500-COBABORT-SEC
           END-IF
      *
           .
       9001-SRYACCTPLUS-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００５）
      *****************************************************************
       RECE65-WRITE-SEC                SECTION.
      *
           IF      IDZ             =   1               
      *    レセプト処理
               WRITE   RECE65-REC
      *
               IF      STS-RECE65          =   "00"
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  WRK-ERR-AREA
                   INITIALIZE                      WRK-ERR-AREA
      *
                   MOVE    3                   TO  WRK-ERR-FLG
                   MOVE    RECE65PARA          TO  WRK-ERR-FILE-NM
                   MOVE    STS-RECE65          TO  WRK-ERR-FILE-STS
                   PERFORM 500-FILE-ERR-ABORT-SEC
               END-IF
      *
               ADD     1                   TO  CNT-OUT2
           END-IF 
      *
           .
       RECE65-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００５）
      *****************************************************************
       RECE65-REWRITE-SEC              SECTION.                        
      *
           IF      IDZ             =   1               
      *    レセプト処理
      *
              MOVE    ZERO                TO  FLG-REWRITE
      *
              INITIALIZE                      RECE65-REC
              MOVE    RECE64-KEY1         TO  RECE65-KEY1
              MOVE    RECE64-ZAINUM       TO  RECE65-ZAINUM
              MOVE    RECE64-ZAIREN       TO  RECE65-ZAIREN
              START   RECE65-FILE
                    KEY IS    >=   RECE65-KEY
                    INVALID
                        MOVE    1         TO  FLG-RECE65-ZAN
                    NOT INVALID
                        MOVE    ZERO      TO  FLG-RECE65-ZAN
                        PERFORM    RECE65-READ-SEC
              END-START
              PERFORM   UNTIL
                  (RECE64-KEY1         NOT =  RECE65-KEY1  )      OR
                  (RECE64-ZAINUM       NOT =  RECE65-ZAINUM)      OR
                  (RECE64-ZAIREN       NOT =  RECE65-ZAIREN)      OR
                  (FLG-RECE65-ZAN            =      1        )    OR
                  (FLG-REWRITE               =      1        )
                   IF ((FLG-ZANHAIKI     =  1          ) AND
                       (RECE65-RENNUM    =  WRK-RENNUM ))
                   OR ((FLG-FORMAL-KISAI =  1          ) AND
                       (RECE65-RENNUM    =  WRK-RENNUM2))
                      MOVE    1              TO  FLG-REWRITE
                      PERFORM  VARYING  IDXB  FROM  5   BY  -1
                                UNTIL   IDXB   <    1
                        IF  RECE65-SRYCD(IDXB)  NOT = SPACE
                          IF   FLG-ZANHAIKI     =  1
                            MOVE   WRK-SRYSURYO3
                                          TO  RECE65-SRYSURYO (IDXB)
                          END-IF
                          IF   FLG-FORMAL-KISAI =  1
                            MOVE   "1"    TO  RECE65-RECEPTFLG(IDXB)
                          END-IF
                          MOVE      1     TO  IDXB
                        END-IF
                      END-PERFORM
                      REWRITE   RECE65-REC
      *
                      IF      STS-RECE65          =   "00"
                          CONTINUE
                      ELSE
                          MOVE    SPACE               TO  WRK-ERR-AREA
                          INITIALIZE                      WRK-ERR-AREA
      *
                          MOVE    4                   TO  WRK-ERR-FLG
                          MOVE    RECE65PARA          TO
                                                      WRK-ERR-FILE-NM
                          MOVE    STS-RECE65          TO
                                                      WRK-ERR-FILE-STS
                          PERFORM 500-FILE-ERR-ABORT-SEC
                      END-IF
                   END-IF
                   PERFORM    RECE65-READ-SEC
              END-PERFORM
      *
           END-IF 
      *
           .
       RECE65-REWRITE-EXT.
           EXIT.                                                       
      *
      ****************************************************************
      *    保険履歴情報データ読み
      ****************************************************************
       900-RECE69-NEXT-SEC           SECTION.
      *
           READ    RECE69-FILE      NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE69
               NOT AT  END
                   IF      STS-RECE69          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE69PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE69          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
      *
                   MOVE    ZERO      TO  FLG-RECE69
           END-READ
      *
           .
       900-RECE69-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー出力処理
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *         
               IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *            ジョブ管理終了処理
                   MOVE    "JBE"           TO  SJOBKANRI-MODE
                   INITIALIZE                  JOBKANRI-REC
                   MOVE    WRK-RECEERR     TO  JOB-YOBI
                   MOVE    "9999"          TO  JOB-ERRCD
                   PERFORM   900-CALL-ORCSJOB-SEC
               END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー時終了処理
      *****************************************************************
       500-COBABORT-SEC                SECTION.
      *
           CALL    "cobabort"          USING   WRK-ERRMSG
      *
           .
       500-COBABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ファイルエラー処理
      *****************************************************************
       500-FILE-ERR-ABORT-SEC           SECTION.
      *
           EVALUATE    WRK-ERR-FLG
               WHEN    1
                   MOVE    "ファイルＯＰＥＮエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file open err" TO  WRK-ERR-FILE-MSG1
               WHEN    2
                   MOVE    "ファイル読み込みエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file read err" TO  WRK-ERR-FILE-MSG1
               WHEN    3
                   MOVE    "ファイル書き込みエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file write err"
                                           TO  WRK-ERR-FILE-MSG1
               WHEN    4
                   MOVE    "ファイル更新エラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file rewrite err"
                                           TO  WRK-ERR-FILE-MSG1
           END-EVALUATE
      *
           STRING  WRK-ERR-FILE-MSG        DELIMITED   BY  SPACE
                   WRK-ERR-FILE-NM (WRK-SGETTEMP-ST:)
                                           DELIMITED   BY  SPACE
                   " STS="                 DELIMITED   BY  SIZE
                   WRK-ERR-FILE-STS        DELIMITED   BY  SIZE
                                           INTO    WRK-RECEERR
           END-STRING
           PERFORM 500-ERR-HENSYU-SEC
      *
           STRING  "ORCR0640 "             DELIMITED   BY  SIZE
                   WRK-ERR-FILE-MSG1       DELIMITED   BY  SIZE
                   " FILE="                DELIMITED   BY  SIZE
                   WRK-ERR-FILE-NM (WRK-SGETTEMP-ST:)
                                           DELIMITED   BY  SPACE
                   "  STS="                DELIMITED   BY  SIZE
                   WRK-ERR-FILE-STS        DELIMITED   BY  SIZE
                   LOW-VALUE               DELIMITED   BY  SIZE
                                           INTO    WRK-ERRMSG
           END-STRING
           PERFORM 500-COBABORT-SEC
      *
           .
       500-FILE-ERR-ABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    処理中止処理
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               PERFORM   900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "処理が中止されました"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                ジョブ管理終了処理
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
                       PERFORM   900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラーメッセージ編集処理
      *****************************************************************
       600-ERRMSG-EDIT-SEC             SECTION.
      *
           MOVE    SPACE               TO  ERR-HEN-ERRMSG
      *
           MOVE    RECE62-PTNUM        TO  ERR-PTNUM
      *
           MOVE    ZERO                TO  WRK-SHO
                                           WRK-AMARI
           MOVE    1                   TO  WRK-LEN
           MOVE    SPACE               TO  WRK-STR
           STRING  ERR-PTNUM           DELIMITED   BY  SPACE
           INTO    WRK-STR
           WITH  POINTER WRK-LEN
           END-STRING
      *
           COMPUTE WRK-LEN =   WRK-LEN -   1
      *
           DIVIDE  2   INTO    WRK-LEN GIVING  WRK-SHO
           REMAINDER WRK-AMARI
           END-DIVIDE
      *
           IF    ( WRK-AMARI   =   ZERO )
              STRING  ERR-ERRMSG          DELIMITED   BY  SPACE
                      "［患者番号："      DELIMITED   BY  SIZE
                      ERR-PTNUM           DELIMITED   BY  SPACE
                      "］"                DELIMITED   BY  SIZE
              INTO    ERR-HEN-ERRMSG
              END-STRING
           ELSE
              STRING  ERR-ERRMSG          DELIMITED   BY  SPACE
                      "［患者番号:"       DELIMITED   BY  SIZE
                      ERR-PTNUM           DELIMITED   BY  SPACE
                      "］"                DELIMITED   BY  SIZE
              INTO    ERR-HEN-ERRMSG
              END-STRING
           END-IF
      *
           .
       600-ERRMSG-EDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    終了処理
      *****************************************************************
       300-TERM-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ステップ管理終了処理
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               PERFORM   900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
             DISPLAY "RECE62  CNT-IN  :" CNT-IN(1)
             DISPLAY "RECE62X CNT-IN  :" CNT-IN(2)
             DISPLAY "RECE64  CNT-OUT :" CNT-OUT1 
             DISPLAY "RECE65  CNT-OUT :" CNT-OUT2 
             DISPLAY "RECE62  CNT-OUT :" CNT-OUT3(1)
             DISPLAY "RECE62X CNT-OUT :" CNT-OUT3(2)
             DISPLAY "*** ORCR0640 END ***"
           .
       300-TERM-EXT.
           EXIT.
      *
      *****************************************************************
      *    一時ファイル名取得処理
      *****************************************************************
       800-FILENM-SET-SEC        SECTION.
      *
           MOVE    WRK-PARA-TERMID     TO  RECEDAT1PARA-TERMID
           MOVE    WRK-PARA-HOSPNUM    TO  RECEDAT1PARA-HOSPNUM
           .
       800-FILENM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルクローズ処理
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *      
      *
      *****************************************************************
      *    ジョブ管理ＤＢ制御処理
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＳＥＬＥＣＴ処理
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    MCP-RC              TO  WRK-MCP-RC
      *
               STRING  "ＤＢ読み込みエラー　TABLE="
                                           DELIMITED   BY  SIZE
                       MCP-TABLE           DELIMITED   BY  SPACE
                       " RC="              DELIMITED   BY  SIZE
                       WRK-MCP-RC          DELIMITED   BY  SIZE
                                           INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
      *
               STRING  "ORCR0640 select err TABLE="
                                           DELIMITED   BY  SIZE
                       MCP-TABLE           DELIMITED   BY  SPACE
                       " PATHNAME="        DELIMITED   BY  SIZE
                       MCP-PATHNAME        DELIMITED   BY  SPACE
                       " RC="              DELIMITED   BY  SIZE
                       WRK-MCP-RC          DELIMITED   BY  SIZE
                       LOW-VALUE           DELIMITED   BY  SIZE
                                           INTO    WRK-ERRMSG
               END-STRING
               PERFORM 500-COBABORT-SEC
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＦＥＴＣＨ処理
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    テーブルアクセス処理
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
           CALL    "ORCDBMAIN"     USING   MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　オープン処理
      *****************************************************************
       100-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　クローズ処理
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBDISCONNECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　ＣＯＭＭＩＴ処理
      *****************************************************************
       900-DBCOMMIT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBCOMMIT-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ＤＢ　ＳＴＡＲＴ処理
      *****************************************************************
       900-DBSTART-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBSTART-EXT.
           EXIT.
      *
