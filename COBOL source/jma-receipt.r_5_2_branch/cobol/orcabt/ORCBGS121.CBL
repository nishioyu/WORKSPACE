      *******************************************************************
      * Project code name "ORCA"
      * ∆¸∞Â…∏Ω‡•Ï•ª•◊•»•Ω•’•»° JMA standard receipt software°À
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCBGS121.
      *****************************************************************
      *  •∑•π•∆•‡Ãæ        : £œ£“£√£¡
      *  •µ•÷•∑•π•∆•‡Ãæ    : ∑Óº°ƒ¢…º
      *  •≥•Û•›°º•Õ•Û•»Ãæ  : ø∑ ›∏± Ã¿¡µ·•¡•ß•√•Ø…Ω Ã¿∫Ÿ…Ω
      *  ¥…Õ˝º‘            :
      *  ∫Ó¿Æ∆¸…’    ∫Ó∂»º‘        µ≠Ω“
      *  11/01/13    NACL-¬¿≈ƒ     ø∑µ¨∫Ó¿Æ
      *****************************************************************
      *  •◊•Ì•∞•È•‡Ω§¿µÕ˙ŒÚ
      * Maj/Min/Rev  Ω§¿µº‘       ∆¸…’      ∆‚Õ∆
      *  05.01.01    ORCAMO        22/09/27  Œ·œ¬£¥«Ø£±£∞∑Ó≤˛¿µ¬–±˛
      *                                      ∏Â¥¸π‚Œ£≤≥‰¬–±˛
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *    •Ï•ª•◊•» Ã¿¡µ·•’•°•§•Î
           SELECT  BGSMEI-FILE     ASSIGN  ASS-BGSMEI
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  BGSMEI-KEY
                                   FILE    STATUS  IS  STS-BGSMEI.
      *
      *    •®•È°º•’•°•§•Î
           SELECT  BGS100ERR-FILE  ASSIGN  ASS-BGS100ERR
                                   FILE    STATUS  IS  STS-BGS100ERR.
      *
       DATA                        DIVISION.
       FILE                        SECTION.
      *
      *    •Ï•ª•◊•» Ã¿¡µ·•’•°•§•Î
       FD  BGSMEI-FILE.
       01  BGSMEI-REC.
           COPY    "CPBGSF01.INC"  REPLACING  //BGSF01-//
                                   BY         //BGSMEI-//.
      *    •®•È°º•’•°•§•Î
       FD  BGS100ERR-FILE.
       01  BGS100ERR-REC           PIC X(200).
      *
       WORKING-STORAGE             SECTION.
      *
           COPY  "HCGS121NV02.INC" REPLACING  //HCGS121NV02//
                                   BY         //HCGS121N//.
           COPY  "HCGS121GV02.INC" REPLACING  //HCGS121GV02//
                                   BY         //HCGS121G//.
      *
           COPY  "CPASGNPARA.INC"  REPLACING  //ASGNPARA//
                                   BY         //ASS-BGSMEI//.
           COPY  "CPASGNPARA.INC"  REPLACING  //ASGNPARA//
                                   BY         //ASS-BGS100ERR//.
      *
       01  STS-AREA.
           03  STS-BGSMEI          PIC X(02).
           03  STS-BGS100ERR       PIC X(02).
      *
       01  CNT-AREA.
           03  CNT-NYUIN           PIC 9(05).
           03  CNT-GAIRAI          PIC 9(05).
           03  CNT-PAGE            PIC 9(05).
           03  CNT-LINE            PIC 9(05).
           03  CNT-KENSU           PIC 9(05).
           03  CNT-LEN             PIC 9(05).
           03  CNT-CSV             PIC 9(05).
      *
       01  FLG-AREA.
           03  FLG-BGSMEI          PIC 9(01).
           03  FLG-LOOPEND         PIC 9(01).
           03  FLG-HKNJAINF        PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-PTNUM           PIC 9(01).
      *
       01  IDX-AREA.
           03  IDX0                PIC 9(05).
           03  IDX1                PIC 9(05).
           03  IDX2                PIC 9(05).
           03  IDX-HKN             PIC 9(05).
           03  IDX-TTL             PIC 9(05).
           03  IDX-BASE            PIC 9(05).
           03  IDXP                PIC 9(05).
           03  IDX-RECEKA          PIC 9(05).
           03  IDXI                PIC 9(05).
           03  IDXL                PIC 9(05).
           03  IDXM                PIC 9(05).
           03  IDXT                PIC 9(05).
      *
       01  WRK-AREA.
           03  WRK-ITEM-SIZE       PIC 9(05).
           03  WRK-ITEM            PIC X(100).
           03  WRK-SYMD            PIC X(08).
           03  WRK-EDTYMD1         PIC X(10).
           03  WRK-EDTYMD3         PIC X(22).
           03  WRK-ERRMSG          PIC X(200).
           03  WRK-Z3              PIC Z(3).
           03  WRK-Z4              PIC Z(3)9.
           03  WRK-Z5              PIC Z(5).
           03  WRK-Z9              PIC Z(9).
           03  WRK-TENZ            PIC Z(8)9.
           03  WRK-M9              PIC -(9).
           03  WRK-HKNNUM          PIC X(3).
           03  WRK-TTLID           PIC 9(5).
           03  WRK-CSV-SRYYM       PIC X(10).
           03  WRK-PRT-SRYYM       PIC X(16).
           03  WRK-PRT-SAKYMD      PIC X(22).
           03  WRK-KANACHK-STR     PIC X(500).
           03  WRK-SRYKANAME1      PIC X(24).
           03  WRK-SKYSBTNAME      PIC X(50).
           03  WRK-MAX             PIC 9(05).
           03  WRK-CSVDATA         PIC X(20000).
           03  WRK-NYUGAIKBN       PIC X(01).
           03  WRK-NYUGAIKBNMEI    PIC X(04).
           03  WRK-PRTKBN.
               05  WRK-PRTKBNZ9    PIC Z9.
           03  WRK-PRTKBNMEI       PIC X(40).
           03  WRK-DATAKBN         PIC X(01).
           03  WRK-DATAKBNMEI      PIC X(50).
           03  WRK-SBTKBN-G.
               05  WRK-SBTGRPID    PIC 9(02).
               05  WRK-SBTRATE     PIC 9(02).
               05  WRK-SBTHKN      PIC 9(02).
           03  WRK-HKNKBNNAME      PIC X(20).
           03  WRK-SYUKA-HKN       PIC 9(01).
           03  WRK-HKNKBN-HKN-G.
               05  WRK-HKNKBN-HKN  PIC 9(01).
           03  WRK-HKNJANUM        PIC X(08).
           03  WRK-HKNJANAME       PIC X(50).
      *
       01  CSV-HEAD-AREA.
           03  CSV-H01-G.
               05  CSV-H01-VAL.
                   07  CSV-H01-PRTKBN          PIC X(50)
                           VALUE   "ƒ¢…º∂Ë ¨".
                   07  CSV-H01-PRTKBNMEI       PIC X(50)
                           VALUE   "ƒ¢…º∂Ë ¨Ãæ".
                   07  CSV-H01-DATAKBN         PIC X(50)
                           VALUE   "•«°º•ø∂Ë ¨".
                   07  CSV-H01-DATAKBNMEI      PIC X(50)
                           VALUE   "•«°º•ø∂Ë ¨Ãæ".
                   07  CSV-H01-SRYYM           PIC X(50)
                           VALUE   "ø«Œ≈«Ø∑Ó".
                   07  CSV-H01-NYUGAIKBN       PIC X(50)
                           VALUE   "∆˛≥∞∂Ë ¨".
                   07  CSV-H01-NYUGAIKBNMEI    PIC X(50)
                           VALUE   "∆˛≥∞∂Ë ¨ÃææŒ".
                   07  CSV-H01-SKYSBTKBN       PIC X(50)
                           VALUE   "≈ˆ∑Ó°¶≈ˆ∑Ó≥∞∂Ë ¨".
                   07  CSV-H01-SKYSBT          PIC X(50)
                           VALUE   "≈ˆ∑Ó°¶≈ˆ∑Ó≥∞∂Ë ¨ÃææŒ".
                   07  CSV-H01-SRYKA           PIC X(50)
                           VALUE   "ø«Œ≈≤ •≥°º•…".
                   07  CSV-H01-SRYKAMEI        PIC X(50)
                           VALUE   "ø«Œ≈≤ ÃææŒ".
                   07  CSV-H01-HKNKBN          PIC X(50)
                           VALUE   " ›∏±∂Ë ¨".
                   07  CSV-H01-PTNUM           PIC X(50)
                           VALUE   "¥µº‘»÷πÊ".
                   07  CSV-H01-NAME            PIC X(50)
                           VALUE   "ª·Ãæ".
                   07  CSV-H01-HBTNUM          PIC X(50)
                           VALUE   "À° Ã»÷πÊ".
                   07  CSV-H01-HKNJANUM        PIC X(50)
                           VALUE   " ›∏±º‘»÷πÊ".
                   07  CSV-H01-HKNJANAME       PIC X(50)
                           VALUE   " ›∏±º‘Ãæ".
                   07  CSV-H01-KENSU           PIC X(50)
                           VALUE   "∑ÔøÙ".
                   07  CSV-H01-NISSU           PIC X(50)
                           VALUE   "∆¸øÙ".
                   07  CSV-H01-TENSU           PIC X(50)
                           VALUE   "≈¿øÙ".
                   07  CSV-H01-FTNMONEY        PIC X(50)
                           VALUE   "¥µº‘…È√¥≥€".
                   07  CSV-H01-HKNMONEY        PIC X(50)
                           VALUE   " ›∏±¿¡µ·≥€".
                   07  CSV-H01-KOHMONEY        PIC X(50)
                           VALUE   "∏¯»Ò¿¡µ·≥€".
                   07  CSV-H01-TTLMONEY        PIC X(50)
                           VALUE   " ›∏±ø«Œ≈º˝±◊° £·°À".
                   07  CSV-H01-SKJKAISU        PIC X(50)
                           VALUE   "ø©ªˆ°¶¿∏≥Ë≤ÛøÙ".
                   07  CSV-H01-SKJFTNMONEY     PIC X(50)
                           VALUE   "ø©ªˆ°¶¿∏≥Ë…∏Ω‡…È√¥≥€".
                   07  CSV-H01-SKJHKNMONEY     PIC X(50)
                           VALUE   "ø©ªˆ°¶¿∏≥Ë ›∏±¿¡µ·≥€".
                   07  CSV-H01-SKJKOHMONEY     PIC X(50)
                           VALUE   "ø©ªˆ°¶¿∏≥Ë∏¯»Ò¿¡µ·≥€".
                   07  CSV-H01-SKJTTLMONEY     PIC X(50)
                           VALUE   "ø©ªˆ°¶¿∏≥Ë¿¡µ·±ﬂ° £‚°À".
                   07  CSV-H01-TTLTTLMONEY     PIC X(50)
                           VALUE   "° £·°À°‹° £‚°À".
                   07  CSV-H01-SRYYM2          PIC X(50)
                           VALUE   "ø«Œ≈«Ø∑Ó° ≈ˆ∑Ó∞ ≥∞°À".
               05  CSV-H01-R   REDEFINES   CSV-H01-VAL.
                   07  CSV-H01-ITEM            PIC X(50)
                                               OCCURS  31.
               05  CSV-H01-MAX                 PIC 9(05)
                                               VALUE   31.
           03  CSV-H02-G.
               05  CSV-H02-VAL.
                   07  CSV-H02-PRTKBN          PIC X(50)
                           VALUE   "ƒ¢…º∂Ë ¨".
                   07  CSV-H02-PRTKBNMEI       PIC X(50)
                           VALUE   "ƒ¢…º∂Ë ¨Ãæ".
                   07  CSV-H02-DATAKBN         PIC X(50)
                           VALUE   "•«°º•ø∂Ë ¨".
                   07  CSV-H02-DATAKBNMEI      PIC X(50)
                           VALUE   "•«°º•ø∂Ë ¨Ãæ".
                   07  CSV-H02-SRYYM           PIC X(50)
                           VALUE   "ø«Œ≈«Ø∑Ó".
                   07  CSV-H02-NYUGAIKBN       PIC X(50)
                           VALUE   "∆˛≥∞∂Ë ¨".
                   07  CSV-H02-NYUGAIKBNMEI    PIC X(50)
                           VALUE   "∆˛≥∞∂Ë ¨ÃææŒ".
                   07  CSV-H02-SKYSBTKBN       PIC X(50)
                           VALUE   "≈ˆ∑Ó°¶≈ˆ∑Ó≥∞∂Ë ¨".
                   07  CSV-H02-SKYSBT          PIC X(50)
                           VALUE   "≈ˆ∑Ó°¶≈ˆ∑Ó≥∞∂Ë ¨ÃææŒ".
                   07  CSV-H02-SRYKA           PIC X(50)
                           VALUE   "ø«Œ≈≤ •≥°º•…".
                   07  CSV-H02-SRYKAMEI        PIC X(50)
                           VALUE   "ø«Œ≈≤ ÃææŒ".
                   07  CSV-H02-HKNKBN          PIC X(50)
                           VALUE   " ›∏±∂Ë ¨".
                   07  CSV-H02-PTNUM           PIC X(50)
                           VALUE   "¥µº‘»÷πÊ".
                   07  CSV-H02-NAME            PIC X(50)
                           VALUE   "ª·Ãæ".
                   07  CSV-H02-HBTNUM          PIC X(50)
                           VALUE   "À° Ã»÷πÊ".
                   07  CSV-H02-HKNJANUM        PIC X(50)
                           VALUE   " ›∏±º‘»÷πÊ".
                   07  CSV-H02-HKNJANAME       PIC X(50)
                           VALUE   " ›∏±º‘Ãæ".
                   07  CSV-H02-KENSU           PIC X(50)
                           VALUE   "∑ÔøÙ".
                   07  CSV-H02-NISSU           PIC X(50)
                           VALUE   "∆¸øÙ".
                   07  CSV-H02-TENSU           PIC X(50)
                           VALUE   "≈¿øÙ".
                   07  CSV-H02-FTNMONEY        PIC X(50)
                           VALUE   "¥µº‘…È√¥≥€".
                   07  CSV-H02-HKNMONEY        PIC X(50)
                           VALUE   " ›∏±¿¡µ·≥€".
                   07  CSV-H02-KOHMONEY        PIC X(50)
                           VALUE   "∏¯»Ò¿¡µ·≥€".
                   07  CSV-H02-TTLMONEY        PIC X(50)
                           VALUE   " ›∏±ø«Œ≈º˝±◊° £·°À".
                   07  CSV-H02-SRYYM2          PIC X(50)
                           VALUE   "ø«Œ≈«Ø∑Ó° ≈ˆ∑Ó∞ ≥∞°À".
               05  CSV-H02-R   REDEFINES   CSV-H02-VAL.
                   07  CSV-H02-ITEM            PIC X(50)
                                               OCCURS  25.
               05  CSV-H02-MAX                 PIC 9(05)
                                               VALUE   25.
      *
       01  KEY-AREA.
           03  KEY-RECEKA          PIC X(02).
           03  KEY-NYUGAIKBN       PIC X(01).
           03  KEY-SKYSBT          PIC X(01).
           03  KEY-SBTKBN-G.
               05  KEY-SBTGRPID    PIC 9(02).
               05  KEY-SBTRATE     PIC 9(02).
               05  KEY-SBTHKN      PIC 9(02).
      *
       01  CONST-AREA.
           03  CONST-H2605         PIC X(06)   VALUE "201405".
           03  CONST-R0410         PIC X(06)   VALUE "202210".
           03  CONST-SYAHO         PIC 9(02)   VALUE 1.
           03  CONST-KOKUHO        PIC 9(02)   VALUE 2.
           03  CONST-KOUKI         PIC 9(02)   VALUE 3.
           03  CONST-TOKUYO        PIC 9(02)   VALUE 4.
           03  CONST-JIHI          PIC 9(02)   VALUE 5.
           03  CONST-CHIKEN        PIC 9(02)   VALUE 6.
           03  CONST-ROUSAI        PIC 9(02)   VALUE 7.
           03  CONST-JIBAI         PIC 9(02)   VALUE 8.
           03  CONST-DAISAN        PIC 9(02)   VALUE 9.
           03  CONST-KOUGAI        PIC 9(02)   VALUE 10.
      *
           03  CONST-SYA-KOU9HEI   PIC 9(02)   VALUE 1.
           03  CONST-SYA-KOU9TAN   PIC 9(02)   VALUE 2.
           03  CONST-SYA-KOU7HEI   PIC 9(02)   VALUE 3.
           03  CONST-SYA-KOU7TAN   PIC 9(02)   VALUE 4.
           03  CONST-SYA-HONHEI    PIC 9(02)   VALUE 5.
           03  CONST-SYA-HONTAN    PIC 9(02)   VALUE 6.
           03  CONST-SYA-KZKHEI    PIC 9(02)   VALUE 7.
           03  CONST-SYA-KZKTAN    PIC 9(02)   VALUE 8.
           03  CONST-SYA-MISGKHEI  PIC 9(02)   VALUE 9.
           03  CONST-SYA-MISGKTAN  PIC 9(02)   VALUE 10.
           03  CONST-SYA-KOH       PIC 9(02)   VALUE 11.
      *
           03  CONST-KOK-IPNKOU9   PIC 9(02)   VALUE 1.
           03  CONST-KOK-IPNKOU7   PIC 9(02)   VALUE 2.
           03  CONST-KOK-IPN       PIC 9(02)   VALUE 3.
           03  CONST-KOK-IPNMISGK  PIC 9(02)   VALUE 4.
           03  CONST-KOK-TAI       PIC 9(02)   VALUE 5.
           03  CONST-KOK-TAIKZK    PIC 9(02)   VALUE 6.
           03  CONST-KOK-TAIMISGK  PIC 9(02)   VALUE 7.
      *
           03  CONST-KOU-KOU9      PIC 9(02)   VALUE 1.
           03  CONST-KOU-KOU7      PIC 9(02)   VALUE 2.
      *
           03  CONST-TKY-H068      PIC 9(02)   VALUE 1.
           03  CONST-TKY-H069      PIC 9(02)   VALUE 2.
           03  CONST-TKY-H040      PIC 9(02)   VALUE 3.
      *
           03  CONST-RSI-TG        PIC 9(02)   VALUE 1.
           03  CONST-RSI-TT        PIC 9(02)   VALUE 2.
           03  CONST-RSI-SG        PIC 9(02)   VALUE 3.
           03  CONST-RSI-ST        PIC 9(02)   VALUE 4.
           03  CONST-RSI-AC        PIC 9(02)   VALUE 5.
           03  CONST-RSI-KS        PIC 9(02)   VALUE 6.
      *
           03  CONST-JBI-NEW        PIC 9(02)   VALUE 1.
           03  CONST-JBI-USUAL      PIC 9(02)   VALUE 2.
      *
           03  CONST-KGI-GRP        PIC 9(02)   VALUE 1.
      *
           03  CONST-DSN-GRP        PIC 9(02)   VALUE 1.
      *
           03  CONST-HKNKBN2-TTL   PIC 9(02)   VALUE 99.
      *
           03  CONST-MEI-TTL       PIC 9(03) VALUE 55.
           03  CONST-MEI-MAX       PIC 9(03) VALUE 54.
      *
       01  TOTAL-AREA.
           COPY    "CPBGSF01.INC"  REPLACING  //BGSF01-//
                                   BY         //TOTAL-//.
      *
      *    •Ï•ª•◊•» Ã¿¡µ·•«°º•ø¬‡»ÚŒŒ∞Ë
       01  TBGSMEI-AREA.
           COPY    "CPBGSF01.INC"  REPLACING  //BGSF01-//
                                   BY         //TBGSMEI-//.
      *
           COPY  "HCGS121N.INC"    REPLACING  //HCGS121N//
                                   BY         //TMPS121//.
      *
      *****************************************************************
      *    •’•°•§•Î•Ï•§•¢•¶•»
      *****************************************************************
      *
      *    •∑•π•∆•‡¥…Õ˝
           COPY    "CPSYSKANRI.INC".
           COPY    "CPSK1005.INC".
      *
      *     ›∏±º‘
       01  HKNJAINF-REC.
           COPY    "CPHKNJAINF.INC".
      *
      *    ¥µº‘»÷πÊ
       01  PTNUM-REC.
           COPY    "CPPTNUM.INC".
      *
      *    •∏•Á•÷¥…Õ˝•ﬁ•π•ø
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *****************************************************************
      *    •µ•÷•◊•ÌÕ—°°ŒŒ∞Ë
      *****************************************************************
      *
      *    •∏•Á•÷¥…Õ˝£ƒ£¬¿©∏Ê•µ•÷
           COPY    "CPORCSJOBKANRI.INC".
      *
      *    ∞ı∫˛£ƒ£¬ππø∑•µ•÷
           COPY    "CPORCSPRT.INC".
      *
      *    ¡¥≥—»æ≥—•¡•ß•√•Ø
           COPY    "CPORCSKANACHK.INC".
      *
      *    ∆¸…’ —¥π•µ•÷
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    ≈˝∑◊£√£”£÷¿©∏Ê•µ•÷
           COPY    "CPORCSTOUKEICSV.INC".
      *
      *    £ƒ£¬∏°∫˜
           COPY    "MCPAREA".
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                     SECTION.
       01  BGS100P-AREA.
           COPY    "CPORCSPRTLNK.INC".
           COPY    "CPBGS100PARA.INC".
      *
           COPY    "COMMON-SPA".
      *
      ****************************************************************
       PROCEDURE               DIVISION
                                       USING
                                       BGS100P-AREA
                                       SPA-AREA.
      *
      *****************************************************************
      *    ºÁ°°°°ΩËÕ˝
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC
      *
           PERFORM 300-END-SEC
      *
           PERFORM 990-EXIT-PROGRAM-SEC
      *
           .
      *****************************************************************
      *    ΩÈ¥¸°°ΩËÕ˝
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                      STS-AREA
                                           CNT-AREA
                                           FLG-AREA
                                           IDX-AREA
                                           WRK-AREA
      *
           MOVE    BGS100P-MEIFNAME    TO  ASS-BGSMEI
           MOVE    BGS100P-ERRFNAME    TO  ASS-BGS100ERR
      *
           MOVE    "STM"               TO  SJOBKANRI-MODE
           INITIALIZE                      JOBKANRI-REC
           EVALUATE    BGS100P-HOKEN
           WHEN    CONST-SYAHO
               MOVE    "º“ › ¨∫Ó¿Æ√Ê"
                                       TO  JOB-YOBI
           WHEN    CONST-KOKUHO
               MOVE    "πÒ › ¨∫Ó¿Æ√Ê"
                                       TO  JOB-YOBI
           WHEN    CONST-KOUKI
               MOVE    "∏Â¥¸π‚Œº‘ ¨∫Ó¿Æ√Ê"
                                       TO  JOB-YOBI
           WHEN    OTHER
               MOVE    "Ã¿∫Ÿ…Ω∫Ó¿Æ√Ê"
                                       TO  JOB-YOBI
           END-EVALUATE
      *
           PERFORM 800-ORCSJOB-SEC
      *
           MOVE    SPA-SYSYMD          TO  WRK-SYMD
           PERFORM 800-HIZUKE-EDIT-SEC
           MOVE    WRK-EDTYMD3         TO  WRK-PRT-SAKYMD
      *
           MOVE    BGS100P-SRYYMD      TO  WRK-SYMD
           PERFORM 800-HIZUKE-EDIT-SEC
           MOVE    WRK-EDTYMD3(1:16)   TO  WRK-PRT-SRYYM
      *
           MOVE    BGS100P-SRYYM(1:4)  TO  WRK-CSV-SRYYM(1:4)
           MOVE    "/"                 TO  WRK-CSV-SRYYM(5:1)
           MOVE    BGS100P-SRYYM(5:2)  TO  WRK-CSV-SRYYM(6:2)
      *
           MOVE    SPACE               TO  WRK-ITEM
           INSPECT WRK-ITEM  TALLYING  WRK-ITEM-SIZE   FOR ALL " "
      *
           EVALUATE    BGS100P-HOKEN
           WHEN    CONST-SYAHO
               MOVE    BGS100P-SYUKA-SYA
                                       TO  WRK-SYUKA-HKN
           WHEN    CONST-KOKUHO
               MOVE    BGS100P-SYUKA-KOK
                                       TO  WRK-SYUKA-HKN
           WHEN    CONST-KOUKI
               MOVE    BGS100P-SYUKA-KOU
                                       TO  WRK-SYUKA-HKN
           WHEN    OTHER
               MOVE    ZERO            TO  WRK-SYUKA-HKN
           END-EVALUATE
      *
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÁ°°ΩËÕ˝
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           IF    ( BGS100P-EDITKBN =   "1" )
               MOVE    "1"         TO  KEY-SKYSBT
               PERFORM 201-MAIN-SEC
               MOVE    "2"         TO  KEY-SKYSBT
               PERFORM 201-MAIN-SEC
           ELSE
               MOVE    SPACE       TO  KEY-SKYSBT
               PERFORM 201-MAIN-SEC
           END-IF
      *
           .
       200-MAIN-EXT.
           EXIT.
      *****************************************************************
      *    ºÁ°°ΩËÕ˝
      *****************************************************************
       201-MAIN-SEC                SECTION.
      *
           IF    ( WRK-SYUKA-HKN   =   1 )
             IF    ( BGS100P-RECEKA-MAX  >   ZERO )
               PERFORM VARYING IDX-RECEKA  FROM    1   BY  1
                       UNTIL ( IDX-RECEKA  >   BGS100P-RECEKA-MAX )
      *
                   MOVE    BGS100P-RECEKA (IDX-RECEKA)
                                   TO  KEY-RECEKA
      *
                   PERFORM 2001-MAIN-SEC
               END-PERFORM
             ELSE
               MOVE    SPACE       TO  KEY-RECEKA
               PERFORM 2001-MAIN-SEC
             END-IF
           ELSE
               MOVE    SPACE       TO  KEY-RECEKA
               PERFORM 2001-MAIN-SEC
           END-IF
      *
           .
       201-MAIN-EXT.
           EXIT.
      *****************************************************************
      *    ºÁ°°ΩËÕ˝
      *****************************************************************
       2001-MAIN-SEC                SECTION.
      *
           MOVE    SPACE               TO      WRK-SKYSBTNAME
           IF    ( BGS100P-EDITKBN =   "1" )
               EVALUATE    KEY-SKYSBT
               WHEN    "1"
                   MOVE  "≈ˆ∑Óø«Œ≈ ¨"  TO      WRK-SKYSBTNAME
               WHEN    "2"
                   MOVE  "≈ˆ∑Óø«Œ≈ ¨∞ ≥∞° ∑Ó√Ÿ§Ï¿¡µ·°¢ ÷Ã· ¨∫∆¿¡µ·°À"
                                       TO      WRK-SKYSBTNAME
               END-EVALUATE
           END-IF
      *
           MOVE    SPACE           TO      WRK-SRYKANAME1
           IF    ( WRK-SYUKA-HKN   =   1 )
               EVALUATE    KEY-RECEKA
               WHEN    "00"
                   MOVE    "ºÁ≤ ¿ﬂƒÍ§ §∑"
                                       TO  WRK-SRYKANAME1
               WHEN    OTHER
                   INITIALIZE                  SYSKANRI-REC
                   MOVE    SPA-HOSPNUM     TO  SYS-HOSPNUM
                   MOVE    "1005"          TO  SYS-KANRICD
                   MOVE    KEY-RECEKA      TO  SYS-KBNCD
                   MOVE    BGS100P-SRYYMD  TO  SYS-STYUKYMD
                                               SYS-EDYUKYMD
                   PERFORM 900-SYSKANRI-KEY10-SEL-SEC
                   MOVE    SYSKANRI-REC    TO  SYS-1005-REC
                   MOVE    SYS-1005-SRYKANAME1
                                       TO  WRK-SRYKANAME1
               END-EVALUATE
           END-IF
      *
           PERFORM 2001-MEI-EDIT-SEC
      *
           .
       2001-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ã¿∫Ÿ…Ω ‘Ω∏ΩËÕ˝
      *****************************************************************
       2001-MEI-EDIT-SEC               SECTION.
      *
           OPEN    INPUT  BGSMEI-FILE
      *
           PERFORM 900-BGSMEI-READ-SEC
      *
           PERFORM UNTIL ( FLG-BGSMEI  NOT =   ZERO )
      *
               MOVE    BGSMEI-NYUGAIKBN    TO  KEY-NYUGAIKBN
               MOVE    BGSMEI-SBTKBN-G     TO  KEY-SBTKBN-G
               MOVE    SPACE               TO  WRK-HKNKBNNAME
               INITIALIZE                      TOTAL-AREA
      *
               PERFORM UNTIL ( FLG-BGSMEI      NOT =   ZERO )
                         OR  ( KEY-NYUGAIKBN   NOT =   BGSMEI-NYUGAIKBN)
      *
                   PERFORM 210-HEAD-SEC
      *
                   PERFORM UNTIL ( FLG-BGSMEI  NOT =   ZERO )
                             OR  ( KEY-NYUGAIKBN
                                               NOT =   BGSMEI-NYUGAIKBN)
                             OR  ( CNT-LINE       >=   CONST-MEI-MAX )
      *
                       PERFORM 220-BODY-SEC
      *
                       PERFORM 900-BGSMEI-READ-SEC
      *
                       IF    ( FLG-BGSMEI      NOT =   ZERO )
                         OR  ( KEY-NYUGAIKBN   NOT =   BGSMEI-NYUGAIKBN)
                           PERFORM 2201-TOTAL-EDIT-SEC
                       END-IF
      *
                   END-PERFORM
      *
                   PERFORM 230-HCGS121-PRINT-SEC
                   PERFORM 2001-HCGS121-CSV-SEC
      *
               END-PERFORM
      *
           END-PERFORM
      *
           CLOSE   BGSMEI-FILE
      *
           .
       2001-MEI-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    Ã¿∫Ÿ…Ω•ÿ•√•¿°ºΩËÕ˝
      *****************************************************************
       210-HEAD-SEC                    SECTION.
      *
           INITIALIZE                      HCGS121N
                                           TMPS121
      *
           EVALUATE    BGSMEI-HOKEN
           WHEN    CONST-SYAHO
               MOVE    "° º“ ›°À"      TO  HCGS121N-HKNNAME
           WHEN    CONST-KOKUHO
               MOVE    "° πÒ ›°À"      TO  HCGS121N-HKNNAME
           WHEN    CONST-KOUKI
               MOVE    "° ∏Â¥¸π‚Œº‘°À"
                                       TO  HCGS121N-HKNNAME
           WHEN    CONST-TOKUYO
               MOVE    "° ∆√ ÃŒ≈Õ‹»Ò°À" 
                                       TO  HCGS121N-HKNNAME
           WHEN    CONST-ROUSAI
               MOVE    "° œ´∫“°À"      TO  HCGS121N-HKNNAME
           WHEN    CONST-JIBAI
               MOVE    "° º´«Â¿’°À"    TO  HCGS121N-HKNNAME
           WHEN    CONST-KOUGAI
               MOVE    "° ∏¯≥≤°À"      TO  HCGS121N-HKNNAME
           WHEN    CONST-DAISAN
               MOVE    "° º´«Â¿’° ¬Ëª∞º‘π‘∞Ÿ°À°À"
                                       TO  HCGS121N-HKNNAME
           END-EVALUATE
      *
           MOVE    WRK-PRT-SRYYM       TO  HCGS121N-SRYYM
           IF    ( BGSMEI-NYUGAIKBN    =   "1" )
               MOVE    "∆˛±°"          TO  HCGS121N-NYUGAI
           ELSE
               MOVE    "≥∞ÕË"          TO  HCGS121N-NYUGAI
           END-IF
           MOVE    WRK-PRT-SAKYMD      TO  HCGS121N-SYSYMD
           MOVE    WRK-SKYSBTNAME      TO  HCGS121N-SKYSBT
      *
           MOVE    WRK-SRYKANAME1      TO  HCGS121N-SRYKANAME
      *
           COMPUTE CNT-PAGE  = CNT-PAGE    +   1
           MOVE    CNT-PAGE            TO  WRK-Z3
           MOVE    WRK-Z3              TO  HCGS121N-PAGE
      *
           MOVE    ZERO                TO  CNT-LINE
      *
           MOVE    BGSMEI-NYUGAIKBN    TO  KEY-NYUGAIKBN
      *
           .
       210-HEAD-EXT.
           EXIT.
      *****************************************************************
      *    Ã¿∫Ÿ…ΩÃ¿∫ŸΩËÕ˝
      *****************************************************************
       220-BODY-SEC                    SECTION.
      *
           COMPUTE CNT-LINE = CNT-LINE +   1
      *
           MOVE    BGSMEI-SBTKBN-G TO  WRK-SBTKBN-G
      *
           IF    ( WRK-SBTHKN      =   CONST-HKNKBN2-TTL )
               MOVE    "°°°°æÆ°°∑◊"
                                   TO  HCGS121N-HKNKBNNAME (CNT-LINE)
                                       TMPS121-HKNKBNNAME (CNT-LINE)
           ELSE
      *
               PERFORM 900-PTNUM-KEY-SEL-SEC
      *
               IF    ( CNT-LINE            =   1 )
                OR   ( KEY-SBTGRPID    NOT =   WRK-SBTGRPID )
                OR   ( KEY-SBTRATE     NOT =   WRK-SBTRATE )
      *
                   MOVE    WRK-SBTGRPID
                                   TO  KEY-SBTGRPID
                   MOVE    WRK-SBTRATE
                                   TO  KEY-SBTRATE
      *
                   PERFORM 2201-HKNKBNNAME-EDIT-SEC
      *
                   EVALUATE    WRK-HKNKBNNAME
                   WHEN "π‚∞Ï∏¯»Ò ªÕ—° £π°À"
                       MOVE    "π‚∞Ï∏¯»Ò ªÕ—(9)"
                                   TO  HCGS121N-HKNKBNNAME(CNT-LINE)(3:)
                   WHEN "π‚∞Ï∏¯»Ò ªÕ—° £∏°À"
                       MOVE    "π‚∞Ï∏¯»Ò ªÕ—(8)"
                                   TO  HCGS121N-HKNKBNNAME(CNT-LINE)(3:)
                   WHEN OTHER
                       MOVE    WRK-HKNKBNNAME
                                   TO  HCGS121N-HKNKBNNAME(CNT-LINE)(3:)
                   END-EVALUATE
      *
               END-IF
      *
               IF   (  BGSMEI-HOKEN        =   CONST-SYAHO
                   AND WRK-SBTGRPID        =   CONST-SYA-KOH )
                 OR (  BGSMEI-HOKEN        =   CONST-ROUSAI
                                            OR CONST-JIBAI
                                            OR CONST-KOUGAI
                                            OR CONST-DAISAN
                                                            )
                   CONTINUE
               ELSE
                   IF    ( BGSMEI-HOKEN    NOT =   CONST-TOKUYO )
                       IF    ( BGSMEI-HKNNUM   =   "009" )
                           MOVE    "01"
                                   TO  HCGS121N-HBTNUM (CNT-LINE)
                       ELSE
                           MOVE    BGSMEI-HKNNUM (2:2)
                                   TO  HCGS121N-HBTNUM (CNT-LINE)
                       END-IF
                   END-IF
      *
                   MOVE    BGSMEI-HKNJANUM
                                   TO  HCGS121N-HKNJANUM (CNT-LINE)
      *
                   PERFORM 900-HKNJAINF-KEY-SEL-SEC
      *
                   IF    ( HKNJA-HKNJANAME NOT =   SPACE )
                       MOVE    HKNJA-HKNJANAME
                                   TO  HCGS121N-HKNJANAME (CNT-LINE)
                   END-IF
               END-IF
      *
               EVALUATE    BGSMEI-SEIKYUFLG
               WHEN   1
                    MOVE    "¢˛" TO  HCGS121N-HKNKBNNAME(CNT-LINE)(1:2)
               WHEN   2
                    MOVE    "°˛" TO  HCGS121N-HKNKBNNAME(CNT-LINE)(1:2)
               END-EVALUATE
      *
               IF    ( PTNUM-PTNUM (11:)   =   SPACE )
                   MOVE    PTNUM-PTNUM
                                   TO  HCGS121N-PTNUM (CNT-LINE)
               ELSE
                   MOVE    PTNUM-PTNUM
                                   TO  HCGS121N-PTNUM2 (CNT-LINE)
               END-IF
      *
               IF    ( BGSMEI-SRYYM    NOT =   BGS100P-SRYYM )
                   MOVE    BGSMEI-SRYYM    TO  WRK-SYMD
                   MOVE    "01"            TO  WRK-SYMD (7:2)
                   PERFORM 800-HIZUKE-EDIT-SEC
                   MOVE    WRK-EDTYMD1(1:6)
                                   TO  HCGS121N-SRYYM2(CNT-LINE)
                   MOVE    BGSMEI-SRYYM(1:4)
                                   TO  TMPS121-SRYYM2(CNT-LINE)(1:4)
                   MOVE    "/"     TO  TMPS121-SRYYM2(CNT-LINE)(5:1)
                   MOVE    BGSMEI-SRYYM(5:2)
                                   TO  TMPS121-SRYYM2(CNT-LINE)(6:2)
               END-IF
      *
               MOVE    BGSMEI-NAME     TO  HCGS121N-NAME (CNT-LINE)
      *
               MOVE    WRK-HKNKBNNAME
                                   TO  TMPS121-HKNKBNNAME (CNT-LINE)
               MOVE    PTNUM-PTNUM
                                   TO  TMPS121-PTNUM2     (CNT-LINE)
      *
           END-IF
      *
           MOVE    BGSMEI-REC      TO  TBGSMEI-AREA
           MOVE    CNT-LINE        TO  IDXM
           PERFORM 2201-BODY-SEC
           IF    ( BGSMEI-SEIKYUFLG    =    2 )
               MOVE    SPACE       TO  HCGS121N-NISSU (CNT-LINE)
                                       HCGS121N-TENSU (CNT-LINE)
           END-IF
      *
           IF    ( WRK-SBTHKN     NOT =   CONST-HKNKBN2-TTL )
               PERFORM 2201-TOTAL-SUM-SEC
           END-IF
      *
           .
       220-BODY-EXT.
           EXIT.
      *****************************************************************
      *    Ã¿∫Ÿ…ΩÃ¿∫ŸΩËÕ˝
      *****************************************************************
       2201-BODY-SEC                   SECTION.
      *
           MOVE    TBGSMEI-KENSU   TO  WRK-Z4
           MOVE    WRK-Z4          TO  HCGS121N-KENSU (IDXM)
      *
           MOVE    TBGSMEI-NISSU   TO  WRK-Z4
           MOVE    WRK-Z4          TO  HCGS121N-NISSU (IDXM)
      *
           MOVE    TBGSMEI-TENSU   TO  WRK-TENZ
           MOVE    WRK-TENZ        TO  HCGS121N-TENSU (IDXM)
      *
           MOVE    TBGSMEI-FTNMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-FTNMONEY (IDXM)
      *
           MOVE    TBGSMEI-HKNMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-HKNMONEY (IDXM)
      *
           MOVE    TBGSMEI-KOHMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-KOHMONEY (IDXM)
      *
           MOVE    TBGSMEI-TTLMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-TTLMONEY (IDXM)
      *
           MOVE    TBGSMEI-SKJKAISU
                                   TO  WRK-Z5
           MOVE    WRK-Z5          TO  HCGS121N-SKJKAISU (IDXM)
      *
           MOVE    TBGSMEI-SKJTTLMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-SKJTTLMONEY (IDXM)
      *
           MOVE    TBGSMEI-SKJFTNMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-SKJFTNMONEY (IDXM)
      *
           MOVE    TBGSMEI-SKJHKNMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-SKJHKNMONEY (IDXM)
      *
           MOVE    TBGSMEI-SKJKOHMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-SKJKOHMONEY (IDXM)
      *
           MOVE    TBGSMEI-TTLTTLMONEY
                                   TO  WRK-Z9
           MOVE    WRK-Z9          TO  HCGS121N-TTLTTLMONEY (IDXM)
      *
           .
       2201-BODY-EXT.
           EXIT.
      *****************************************************************
      *    πÁ∑◊Ω∏∑◊ΩËÕ˝
      *****************************************************************
       2201-TOTAL-SUM-SEC              SECTION.
      *
           COMPUTE TOTAL-KENSU
               =   TOTAL-KENSU + BGSMEI-KENSU
           COMPUTE TOTAL-NISSU
               =   TOTAL-NISSU + BGSMEI-NISSU
           COMPUTE TOTAL-TENSU
               =   TOTAL-TENSU + BGSMEI-TENSU
           COMPUTE TOTAL-FTNMONEY
               =   TOTAL-FTNMONEY     + BGSMEI-FTNMONEY
           COMPUTE TOTAL-HKNMONEY
               =   TOTAL-HKNMONEY     + BGSMEI-HKNMONEY
           COMPUTE TOTAL-KOHMONEY
               =   TOTAL-KOHMONEY     + BGSMEI-KOHMONEY
           COMPUTE TOTAL-TTLMONEY
               =   TOTAL-TTLMONEY     + BGSMEI-TTLMONEY
           COMPUTE TOTAL-SKJKAISU
               =   TOTAL-SKJKAISU     + BGSMEI-SKJKAISU
           COMPUTE TOTAL-SKJTTLMONEY
               =   TOTAL-SKJTTLMONEY  + BGSMEI-SKJTTLMONEY
           COMPUTE TOTAL-SKJFTNMONEY
               =   TOTAL-SKJFTNMONEY  + BGSMEI-SKJFTNMONEY
           COMPUTE TOTAL-SKJHKNMONEY
               =   TOTAL-SKJHKNMONEY  + BGSMEI-SKJHKNMONEY
           COMPUTE TOTAL-SKJKOHMONEY
               =   TOTAL-SKJKOHMONEY  + BGSMEI-SKJKOHMONEY
           COMPUTE TOTAL-TTLTTLMONEY
               =   TOTAL-TTLTTLMONEY  + BGSMEI-TTLTTLMONEY
      *
           .
       2201-TOTAL-SUM-EXT.
           EXIT.
      *****************************************************************
      *     ›∏±∂Ë ¨ÃææŒ ‘Ω∏ΩËÕ˝
      *****************************************************************
       2201-HKNKBNNAME-EDIT-SEC        SECTION.
      *
           MOVE    SPACE               TO  WRK-HKNKBNNAME
      *
           EVALUATE    BGSMEI-HOKEN
           WHEN    CONST-SYAHO
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-SYA-KOU9HEI
                   IF    ( BGS100P-SRYYM  >=  CONST-H2605 )
                       IF    ( BGSMEI-SBTRATE  =  1 )
                           MOVE    "π‚∞Ï∏¯»Ò ªÕ—° £π°À"
                                       TO  WRK-HKNKBNNAME
                       ELSE
                           MOVE    "π‚∞Ï∏¯»Ò ªÕ—° £∏°À"
                                       TO  WRK-HKNKBNNAME
                       END-IF
                   ELSE
                       MOVE    "π‚£π∏¯»Ò ªÕ—"
                                       TO  WRK-HKNKBNNAME
                   END-IF
               WHEN    CONST-SYA-KOU9TAN
                   IF    ( BGS100P-SRYYM  >=  CONST-H2605 )
                       IF    ( BGSMEI-SBTRATE  =  1 )
                           MOVE    "π‚∞Ï√±∆»° £π°À"
                                       TO  WRK-HKNKBNNAME
                       ELSE
                           MOVE    "π‚∞Ï√±∆»° £∏°À"
                                       TO  WRK-HKNKBNNAME
                       END-IF
                   ELSE
                       MOVE    "π‚£π√±∆»"
                                       TO  WRK-HKNKBNNAME
                   END-IF
               WHEN    CONST-SYA-KOU7HEI
                   MOVE    "π‚£∑∏¯»Ò ªÕ—"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-KOU7TAN
                   MOVE    "π‚£∑√±∆»"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-HONHEI
                   MOVE    "À‹øÕ∏¯»Ò ªÕ—"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-HONTAN
                   MOVE    "À‹øÕ√±∆»"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-KZKHEI
                   MOVE    "≤»¬≤∏¯»Ò ªÕ—"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-KZKTAN
                   MOVE    "≤»¬≤√±∆»"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-MISGKHEI
                   MOVE    "£∂∫–∏¯»Ò ªÕ—"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-MISGKTAN
                   MOVE    "£∂∫–√±∆»"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-SYA-KOH
                   MOVE    "∏¯»Ò√±∆»°¶ ªÕ—"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           WHEN    CONST-KOKUHO
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-KOK-IPNKOU9
                   IF    ( BGS100P-SRYYM  >=  CONST-H2605 )
                       IF    ( BGSMEI-SBTRATE  =  1 )
                           MOVE    "∞Ï»Ãπ‚∞Ï° £π°À"
                                       TO  WRK-HKNKBNNAME
                       ELSE
                           MOVE    "∞Ï»Ãπ‚∞Ï° £∏°À"
                                       TO  WRK-HKNKBNNAME
                       END-IF
                   ELSE
                       MOVE    "∞Ï»Ãπ‚£π"
                                       TO  WRK-HKNKBNNAME
                   END-IF
               WHEN    CONST-KOK-IPNKOU7
                   MOVE    "∞Ï»Ãπ‚£∑"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-KOK-IPN
                   MOVE    "∞Ï»Ã"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-KOK-IPNMISGK
                   MOVE    "∞Ï»Ã£∂∫–"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-KOK-TAI
                   MOVE    "¬‡ø¶À‹øÕ"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-KOK-TAIKZK
                   MOVE    "¬‡ø¶≤»¬≤"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-KOK-TAIMISGK
                   MOVE    "¬‡ø¶£∂∫–"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           WHEN    CONST-KOUKI
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-KOU-KOU9
                   IF    ( BGS100P-SRYYM  <   CONST-R0410 )
                       MOVE    "π‚£π"
                                           TO  WRK-HKNKBNNAME
                   ELSE
                       IF    ( BGSMEI-SBTRATE  =  1 )
                           MOVE    "∏Â¥¸π‚Œ∞Ï° £π°À"
                                               TO  WRK-HKNKBNNAME
                       ELSE
                           MOVE    "∏Â¥¸π‚Œ∞Ï° £∏°À"
                                               TO  WRK-HKNKBNNAME
                       END-IF                        
                   END-IF                    
               WHEN    CONST-KOU-KOU7
                   IF    ( BGS100P-SRYYM  <   CONST-R0410 )
                       MOVE    "π‚£∑"
                                           TO  WRK-HKNKBNNAME
                   ELSE
                       MOVE    "∏Â¥¸π‚Œ£∑"
                                           TO  WRK-HKNKBNNAME
                   END-IF
               END-EVALUATE
           WHEN    CONST-TOKUYO
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-TKY-H068
                   MOVE    "∆√Õ‹»Ò"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-TKY-H069
                   MOVE    "¬‡∆√Õ‹»Ò"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-TKY-H040
                   MOVE    "∏Â¥¸∆√Õ‹»Ò"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           WHEN    CONST-ROUSAI
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-RSI-TG
                   MOVE    "√ª¥¸°¶∂»Ã≥"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-RSI-TT
                   MOVE    "√ª¥¸°¶ƒÃ∂–"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-RSI-SG
                   MOVE    "Ω˝…¬°¶∂»Ã≥"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-RSI-ST
                   MOVE    "Ω˝…¬°¶ƒÃ∂–"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-RSI-AC
                   MOVE    "•¢•’•ø°º•±•¢"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-RSI-KS
                   MOVE    "∏¯Ã≥∫“≥≤"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           WHEN    CONST-JIBAI
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-JBI-NEW
                   MOVE    "ø∑ÕÕº∞"
                                       TO  WRK-HKNKBNNAME
               WHEN    CONST-JBI-USUAL
                   MOVE    "ΩæÕËÕÕº∞"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           WHEN    CONST-KOUGAI
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-KGI-GRP
                   MOVE    "∏¯≥≤"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           WHEN    CONST-DAISAN
               EVALUATE    WRK-SBTGRPID
               WHEN    CONST-DSN-GRP
                   MOVE    "¬Ëª∞º‘π‘∞Ÿ"
                                       TO  WRK-HKNKBNNAME
               END-EVALUATE
           END-EVALUATE
      *
           .
       2201-HKNKBNNAME-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    πÁ∑◊π‘ ‘Ω∏ΩËÕ˝
      *****************************************************************
       2201-TOTAL-EDIT-SEC             SECTION.
      *
           MOVE    CONST-MEI-TTL   TO  IDXM
      *
           MOVE    "°°°°πÁ°°∑◊"    TO  HCGS121N-HKNKBNNAME (IDXM)
                                       TMPS121-HKNKBNNAME  (IDXM)
           MOVE    TOTAL-AREA      TO  TBGSMEI-AREA
           PERFORM 2201-BODY-SEC
      *
           .
       2201-TOTAL-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ∞ı∫˛ΩËÕ˝
      *****************************************************************
       230-HCGS121-PRINT-SEC         SECTION.
      *
           INITIALIZE                  ORCSPRTAREA
      *
           IF    ( KEY-NYUGAIKBN   =   "1" )
               MOVE    "HCGS121NV02.red"  TO  SPRT-PRTID
               MOVE    HCGS121N        TO  SPRT-PRTDATA
           ELSE
               INITIALIZE                      HCGS121G
      *
               MOVE    HCGS121N-PAGE       TO  HCGS121G-PAGE
               MOVE    HCGS121N-SRYYM      TO  HCGS121G-SRYYM
               MOVE    HCGS121N-SYSYMD     TO  HCGS121G-SYSYMD
               MOVE    HCGS121N-NYUGAI     TO  HCGS121G-NYUGAI
               MOVE    HCGS121N-SRYKANAME  TO  HCGS121G-SRYKANAME
               MOVE    HCGS121N-HKNNAME    TO  HCGS121G-HKNNAME
               MOVE    HCGS121N-SKYSBT     TO  HCGS121G-SKYSBT
               PERFORM VARYING IDX0   FROM    1   BY  1
                       UNTIL ( IDX0   >   CONST-MEI-TTL )
                   MOVE    HCGS121N-PTNUM  (IDX0)
                                           TO  HCGS121G-PTNUM (IDX0)
                   MOVE    HCGS121N-PTNUM2 (IDX0)
                                           TO  HCGS121G-PTNUM2(IDX0)
                   MOVE    HCGS121N-SRYYM2 (IDX0)
                                           TO  HCGS121G-SRYYM2(IDX0)
                   MOVE    HCGS121N-NAME   (IDX0)
                                           TO  HCGS121G-NAME  (IDX0)
                   MOVE    HCGS121N-HKNJANUM  (IDX0)
                                           TO  HCGS121G-HKNJANUM  (IDX0)
                   MOVE    HCGS121N-HKNJANAME (IDX0)
                                           TO  HCGS121G-HKNJANAME (IDX0)
                   MOVE    HCGS121N-HKNKBNNAME(IDX0)
                                           TO  HCGS121G-HKNKBNNAME(IDX0)
                   MOVE    HCGS121N-HBTNUM (IDX0)
                                           TO  HCGS121G-HBTNUM (IDX0)
                   MOVE    HCGS121N-KENSU (IDX0)
                                           TO  HCGS121G-KENSU (IDX0)
                   MOVE    HCGS121N-NISSU (IDX0)
                                           TO  HCGS121G-NISSU (IDX0)
                   MOVE    HCGS121N-TENSU (IDX0)
                                           TO  HCGS121G-TENSU (IDX0)
                   MOVE    HCGS121N-FTNMONEY (IDX0)
                                           TO  HCGS121G-FTNMONEY (IDX0)
                   MOVE    HCGS121N-HKNMONEY (IDX0)
                                           TO  HCGS121G-HKNMONEY (IDX0)
                   MOVE    HCGS121N-KOHMONEY (IDX0)
                                           TO  HCGS121G-KOHMONEY (IDX0)
                   MOVE    HCGS121N-TTLMONEY (IDX0)
                                           TO  HCGS121G-TTLMONEY (IDX0)
               END-PERFORM
      *
               MOVE    "HCGS121GV02.red"  TO  SPRT-PRTID
               MOVE    HCGS121G        TO  SPRT-PRTDATA
      *
           END-IF
      *
           PERFORM 230-PRINT-SEC
      *
      *
           .
       230-HCGS121-PRINT-EXT.
           EXIT.
      *****************************************************************
      *    ∞ı∫˛ΩËÕ˝
      *****************************************************************
       230-PRINT-SEC                   SECTION.
      *
           MOVE    "INS"           TO  SPRT-MODE
           MOVE    LNK-PRTKANRI-RENNUM
                                   TO  SPRT-RENNUM
           MOVE    LNK-PRTKANRI-TBL-KEY
                                   TO  SPRT-TBL-KEY
           MOVE    LNK-PRTKANRI-TBL-GROUP
                                   TO  SPRT-TBL-GROUP
           MOVE    BGS100P-SRYYM   TO  SPRT-SRYYM
           MOVE    LNK-PRTKANRI-SKYYMD
                                   TO  SPRT-SKYYMD
           MOVE    LNK-PRTKANRI-SHELLID
                                   TO  SPRT-SHELLID
           MOVE    LNK-PRTKANRI-SHORI-RENNUM
                                   TO  SPRT-SHORI-RENNUM
           MOVE    LNK-PRTKANRI-PRIORITY
                                   TO  SPRT-PRIORITY
           MOVE    BGS100P-SHELLMSG TO SPRT-TITLE
           MOVE    LNK-PRTKANRI-TERMID
                                   TO  SPRT-TERMID
           MOVE    LNK-PRTKANRI-OPID
                                   TO  SPRT-OPID
           MOVE    LNK-PRTKANRI-PRTNM
                                   TO  SPRT-PRTNM
           MOVE    "1"             TO  SPRT-SITEKBN
      *
           CALL    "ORCSPRT"           USING
                                       ORCSPRTAREA
                                       SPA-AREA
           IF    ( SPRT-RETURN     =   ZERO )
               CONTINUE
           ELSE
               MOVE    "∞ı∫˛£ƒ£¬§Àππø∑§«§≠§ﬁ§ª§Û§«§∑§ø"
                                   TO  WRK-ERRMSG
               PERFORM 500-ERR-HENSYU-SEC
           END-IF
      *
           .
       230-PRINT-EXT.
           EXIT.
      *****************************************************************
      *    Ã¿∫Ÿ…Ω ‘Ω∏ΩËÕ˝° £√£”£÷°À
      *****************************************************************
       2001-HCGS121-CSV-SEC            SECTION.
      *
           MOVE    BGS100P-HOKEN   TO  WRK-PRTKBNZ9
      *
           MOVE    SPACE           TO  WRK-PRTKBNMEI
           EVALUATE    BGS100P-HOKEN
           WHEN    CONST-SYAHO
               MOVE    "º“ ›"      TO  WRK-PRTKBNMEI
           WHEN    CONST-KOKUHO
               MOVE    "πÒ ›"      TO  WRK-PRTKBNMEI
           WHEN    CONST-KOUKI
               MOVE    "∏Â¥¸π‚Œº‘"
                                   TO  WRK-PRTKBNMEI
           WHEN    CONST-TOKUYO
               MOVE    "∆√ ÃŒ≈Õ‹»Ò" TO WRK-PRTKBNMEI
           WHEN    CONST-ROUSAI
               MOVE    "œ´∫“"      TO  WRK-PRTKBNMEI
           WHEN    CONST-JIBAI
               MOVE    "º´«Â¿’"    TO  WRK-PRTKBNMEI
           WHEN    CONST-DAISAN
               MOVE    "º´«Â¿’° ¬Ëª∞º‘π‘∞Ÿ°À" 
                                   TO  WRK-PRTKBNMEI
           WHEN    CONST-KOUGAI
               MOVE    "∏¯≥≤"      TO  WRK-PRTKBNMEI
           END-EVALUATE
      *
           IF    ( KEY-NYUGAIKBN   =   "1" )
               MOVE    "1"         TO  WRK-NYUGAIKBN
               MOVE    "∆˛±°"      TO  WRK-NYUGAIKBNMEI
           ELSE
               MOVE    "2"         TO  WRK-NYUGAIKBN
               MOVE    "≥∞ÕË"      TO  WRK-NYUGAIKBNMEI
           END-IF
      *
           COMPUTE CNT-CSV =   CNT-CSV     +   1
      *
           IF    ( CNT-CSV =   1 )
               IF    ( KEY-NYUGAIKBN   =   "1" )
                   MOVE    SPACE           TO  WRK-CSVDATA
                   MOVE    1               TO  IDXP
                   PERFORM VARYING IDXI    FROM    1   BY  1
                           UNTIL ( IDXI    >   CSV-H01-MAX )
      *
                       MOVE    CSV-H01-ITEM (IDXI)
                                           TO  WRK-ITEM
      *
                       IF    ( IDXI   >=   CSV-H01-MAX    )
                           PERFORM 802-CSVDATA-EDIT-SEC
                       ELSE
                           PERFORM 801-CSVDATA-EDIT-SEC
                       END-IF
      *
                   END-PERFORM
               ELSE
                   MOVE    SPACE           TO  WRK-CSVDATA
                   MOVE    1               TO  IDXP
                   PERFORM VARYING IDXI    FROM    1   BY  1
                           UNTIL ( IDXI    >   CSV-H02-MAX )
      *
                       MOVE    CSV-H02-ITEM (IDXI)
                                           TO  WRK-ITEM
      *
                       IF    ( IDXI   >=   CSV-H02-MAX    )
                           PERFORM 802-CSVDATA-EDIT-SEC
                       ELSE
                           PERFORM 801-CSVDATA-EDIT-SEC
                       END-IF
      *
                   END-PERFORM
               END-IF
      *
               PERFORM 230-TOUKEICSV-SEC
      *
           END-IF
      *
           PERFORM VARYING IDX2    FROM    1   BY  1
                   UNTIL ( IDX2    >   CNT-LINE )
      *
               PERFORM 20011-HCGS121-CSV-SEC
      *
           END-PERFORM
      *
           IF    ( FLG-BGSMEI      NOT =   ZERO )
             OR  ( KEY-NYUGAIKBN   NOT =   BGSMEI-NYUGAIKBN)
      *
               MOVE    CONST-MEI-TTL   TO  IDX2
      *
               PERFORM 20011-HCGS121-CSV-SEC
      *
           END-IF
      *
           .
       2001-HCGS121-CSV-EXT.
           EXIT.
      *****************************************************************
      *    Ã¿∫Ÿ…Ω ‘Ω∏ΩËÕ˝° £√£”£÷°À° ∆˛±°°À
      *****************************************************************
       20011-HCGS121-CSV-SEC           SECTION.
      *
           MOVE  SPACE             TO  WRK-CSVDATA
           MOVE    1               TO  IDXP
      *
           MOVE    "5"             TO  WRK-DATAKBN
           MOVE    "•Ï•ª•◊•» Ã"    TO  WRK-DATAKBNMEI
           PERFORM 20011-CSV-KEY-EDIT-SEC
      *
           MOVE    TMPS121-HKNKBNNAME (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    TMPS121-PTNUM2 (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-NAME (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-HBTNUM (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-HKNJANUM (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-HKNJANAME (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-KENSU (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-NISSU (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-TENSU (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-FTNMONEY (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-HKNMONEY (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-KOHMONEY (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE    HCGS121N-TTLMONEY (IDX2)
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           IF    ( KEY-NYUGAIKBN   =   "1" )
               MOVE    HCGS121N-SKJKAISU (IDX2)
                                   TO  WRK-ITEM
               PERFORM 801-CSVDATA-EDIT-SEC
      *
               MOVE    HCGS121N-SKJFTNMONEY (IDX2)
                                   TO  WRK-ITEM
               PERFORM 801-CSVDATA-EDIT-SEC
      *
               MOVE    HCGS121N-SKJHKNMONEY (IDX2)
                                   TO  WRK-ITEM
               PERFORM 801-CSVDATA-EDIT-SEC
      *
               MOVE    HCGS121N-SKJKOHMONEY (IDX2)
                                   TO  WRK-ITEM
               PERFORM 801-CSVDATA-EDIT-SEC
      *
               MOVE    HCGS121N-SKJTTLMONEY (IDX2)
                                   TO  WRK-ITEM
               PERFORM 801-CSVDATA-EDIT-SEC
      *
               MOVE    HCGS121N-TTLTTLMONEY (IDX2)
                                   TO  WRK-ITEM
               PERFORM 801-CSVDATA-EDIT-SEC
           END-IF
      *
           MOVE    TMPS121-SRYYM2 (IDX2)
                                   TO  WRK-ITEM
           PERFORM 802-CSVDATA-EDIT-SEC
      *
           PERFORM 230-TOUKEICSV-SEC
      *
           .
       20011-HCGS121-CSV-EXT.
           EXIT.
      *****************************************************************
      *    £√£”£÷•’•°•§•Î£À£≈£Ÿπ‡Ã‹ ‘Ω∏ΩËÕ˝
      *****************************************************************
       20011-CSV-KEY-EDIT-SEC         SECTION.
      *
           MOVE  WRK-PRTKBN        TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-PRTKBNMEI     TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-DATAKBN       TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-DATAKBNMEI    TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-CSV-SRYYM     TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-NYUGAIKBN     TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-NYUGAIKBNMEI
                                   TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  KEY-SKYSBT        TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-SKYSBTNAME    TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  KEY-RECEKA        TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           MOVE  WRK-SRYKANAME1    TO  WRK-ITEM
           PERFORM 801-CSVDATA-EDIT-SEC
      *
           .
       20011-CSV-KEY-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    £√£”£÷Ω–ŒœΩËÕ˝
      *****************************************************************
       230-TOUKEICSV-SEC               SECTION.
      *
           INITIALIZE                  ORCSTOUKEICSVAREA
           MOVE    "INS"           TO  STOUKEICSV-MODE
           MOVE    LNK-PRTKANRI-TBL-KEY
                                   TO  STOUKEICSV-TBL-KEY
           MOVE    LNK-PRTKANRI-RENNUM
                                   TO  STOUKEICSV-RENNUM
           MOVE    LNK-PRTKANRI-TBL-GROUP
                                   TO  STOUKEICSV-TBL-GROUP
           MOVE    LNK-PRTKANRI-SHORI-RENNUM
                                   TO  STOUKEICSV-SHORI-RENNUM
           MOVE    LNK-PRTKANRI-SHELLID
                                   TO  STOUKEICSV-SHELLID
           MOVE    BGS100P-SRYYM   TO  STOUKEICSV-SRYYM
           MOVE    BGS100P-NYUGAIKBN
                                   TO  STOUKEICSV-NYUGAIKBN
           MOVE    ZERO            TO  STOUKEICSV-PTID
           MOVE    BGS100P-CSVDIR  TO  STOUKEICSV-TO-FOLDER
           MOVE    BGS100P-CSVFNAME TO STOUKEICSV-TO-DATA
           MOVE    "2"             TO  STOUKEICSV-CODE-TYPE
           MOVE    WRK-CSVDATA     TO  STOUKEICSV-CSVDATA
           MOVE    " ›∏± Ã¿¡µ·•¡•ß•√•ØÃ¿∫Ÿ…Ω£√£”£÷∫Ó¿Æ"
                                   TO  STOUKEICSV-TITLE
      *
           CALL    "ORCSTOUKEICSV"     USING
                                       ORCSTOUKEICSVAREA
                                       SPA-AREA
           IF    ( STOUKEICSV-RETURN   =   ZERO )
               CONTINUE
           ELSE
               MOVE    "≈˝∑◊£√£”£÷£ƒ£¬§Àππø∑§«§≠§ﬁ§ª§Û§«§∑§ø"
                                   TO  WRK-ERRMSG
               PERFORM 500-ERR-HENSYU-SEC
           END-IF
      *
           .
      *
       230-TOUKEICSV-EXT.
           EXIT.
      *****************************************************************
      *    Ω™Œª°°°°ΩËÕ˝
      *****************************************************************
       300-END-SEC                 SECTION.
      *
           COMPUTE BGS100P-PAGE
               =   BGS100P-PAGE    +   CNT-PAGE
      *
           .
       300-END-EXT.
           EXIT.
      *****************************************************************
      *    •®•È°ºΩ–ŒœΩËÕ˝
      *****************************************************************
       500-ERR-HENSYU-SEC          SECTION.
      *
           OPEN    INPUT   BGS100ERR-FILE
           IF      STS-BGS100ERR     =   ZERO
               CLOSE   BGS100ERR-FILE
           ELSE
               OPEN    OUTPUT              BGS100ERR-FILE
      *
               MOVE    WRK-ERRMSG      TO  BGS100ERR-REC
               WRITE   BGS100ERR-REC
               CLOSE   BGS100ERR-FILE
      *
      *        •∏•Á•÷¥…Õ˝≥´ªœΩËÕ˝
               MOVE    "JBE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    WRK-ERRMSG      TO  JOB-YOBI
               MOVE    "9999"          TO  JOB-ERRCD
               PERFORM 800-ORCSJOB-SEC
           END-IF
      *
           MOVE    1                   TO  BGS100P-RC
      *
           PERFORM 990-EXIT-PROGRAM-SEC
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *****************************************************************
      *    CSV•«°º•ø ‘Ω∏ΩËÕ˝
      *****************************************************************
       800-CSVDATA-EDIT-SEC            SECTION.
      *
           IF    ( WRK-ITEM        NOT =   SPACE )
               PERFORM 800-GET-ITEM-SIZE-SEC
               STRING  WRK-ITEM(IDXL:CNT-LEN)  DELIMITED   BY  SIZE
               INTO    WRK-CSVDATA
               WITH    POINTER   IDXP
               END-STRING
           END-IF
           .
      *
       800-CSVDATA-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    CSV•«°º•ø ‘Ω∏ΩËÕ˝
      *****************************************************************
       801-CSVDATA-EDIT-SEC            SECTION.
      *
           PERFORM 800-CSVDATA-EDIT-SEC
           PERFORM 800-PUT-DELIMITER-SEC
           .
      *
       801-CSVDATA-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    CSV•«°º•ø ‘Ω∏ΩËÕ˝
      *****************************************************************
       802-CSVDATA-EDIT-SEC            SECTION.
      *
           PERFORM 800-CSVDATA-EDIT-SEC
      *    PERFORM 800-PUT-CR-SEC
           .
      *
       802-CSVDATA-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    π‡Ã‹•µ•§•∫ºË∆¿ΩËÕ˝
      *****************************************************************
       800-GET-ITEM-SIZE-SEC           SECTION.
      *
           MOVE    ZERO            TO  IDXL
                                       CNT-LEN
      *
           PERFORM VARYING IDX0    FROM    1   BY  1
                   UNTIL ( IDX0    >   WRK-ITEM-SIZE )
                    OR   ( WRK-ITEM (IDX0:)    =  SPACE )
      *
               IF    ( IDXL = ZERO )
                   IF    ( WRK-ITEM (IDX0:1)   NOT =  SPACE )
                       MOVE    IDX0 TO IDXL
                       MOVE    1    TO CNT-LEN
                   END-IF
               ELSE
                   COMPUTE CNT-LEN  =  CNT-LEN + 1
               END-IF
      *
           END-PERFORM
      *
           .
       800-GET-ITEM-SIZE-EXT.
           EXIT.
      *****************************************************************
      *    ∂Ë¿⁄§Í ∏ª˙ ‘Ω∏ΩËÕ˝
      *****************************************************************
       800-PUT-DELIMITER-SEC           SECTION.
      *
           STRING    ","   DELIMITED   BY  SIZE
           INTO      WRK-CSVDATA
           WITH      POINTER   IDXP
           END-STRING
      *
           .
       800-PUT-DELIMITER-EXT.
           EXIT.
      *****************************************************************
      *    ≤˛π‘ ∏ª˙ ‘Ω∏ΩËÕ˝
      *****************************************************************
       800-PUT-CR-SEC                  SECTION.
      *
           STRING    X"0D"   DELIMITED BY  SIZE
           INTO      WRK-CSVDATA
           WITH      POINTER   IDXP
           END-STRING
      *
           .
       800-PUT-CR-EXT.
           EXIT.
      *****************************************************************
      *    ¿æŒÒ∆¸À‹∏Ï —¥πΩËÕ˝
      *****************************************************************
       800-HIZUKE-EDIT-SEC             SECTION.
      *
           MOVE    SPACE           TO  WRK-EDTYMD1
                                       WRK-EDTYMD3
      *
           IF    ( WRK-SYMD            =   SPACE )
               CONTINUE
           ELSE
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY2-AREA
               MOVE    "21"                TO  LNK-DAY2-IRAI
               MOVE    WRK-SYMD            TO  LNK-DAY2-YMD
               CALL    "ORCSDAY"   USING
                                   STS-AREA-DAY
                                   LNK-DAY2-AREA
               MOVE    LNK-DAY2-EDTYMD1    TO  WRK-EDTYMD1
               MOVE    LNK-DAY2-EDTYMD3    TO  WRK-EDTYMD3
               INSPECT WRK-EDTYMD3 REPLACING  ALL "  "  BY  "°°"
           END-IF
      *
      *
           .
       800-HIZUKE-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ¡¥≥— —¥πΩËÕ˝
      *****************************************************************
       800-ZENKAKU-SEC                 SECTION.
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE   "2"              TO  KANACHK-SYORI
           MOVE  500               TO  KANACHK-MAX-CNT
           MOVE  WRK-KANACHK-STR   TO  KANACHK-MAE-INPUT
           CALL    "ORCSKANACHK"   USING   ORCSKANACHKAREA
           MOVE    KANACHK-OUT-INPUT
                                   TO  WRK-KANACHK-STR
      *
           .
       800-ZENKAKU-EXT.
           EXIT.
      *****************************************************************
      *    •∏•Á•÷¥…Õ˝•µ•÷
      *****************************************************************
       800-ORCSJOB-SEC                 SECTION.
      *
           MOVE    SPA-HOSPNUM         TO  JOB-HOSPNUM
           MOVE    BGS100P-JOBID       TO  JOB-JOBID
           MOVE    BGS100P-SHELLID     TO  JOB-SHELLID
           MOVE    "ORCBGS100"         TO  JOB-PGID
           MOVE    BGS100P-SHELLMSG    TO  JOB-SHELLMSG
           CALL    "ORCSJOB"           USING
                                       ORCSJOBKANRIAREA 
                                       JOBKANRI-REC
                                       SPA-AREA
      *
           .
      *
       800-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    •Ï•ª•◊•» Ã¿¡µ·•’•°•§•Î∆…π˛ΩËÕ˝
      *****************************************************************
       900-BGSMEI-READ-SEC           SECTION.
      *
           MOVE    ZERO            TO  FLG-BGSMEI
                                       FLG-LOOPEND
      *
           PERFORM UNTIL ( FLG-BGSMEI    NOT =   ZERO )
                    OR   ( FLG-LOOPEND   NOT =   ZERO )
      *
               READ    BGSMEI-FILE     NEXT
               AT  END
                   MOVE    1       TO  FLG-BGSMEI
               NOT AT  END
      *
                   MOVE    1       TO  FLG-LOOPEND
      *
                   IF    ( BGS100P-HOKEN   NOT =   BGSMEI-HOKEN )
                           MOVE    ZERO    TO  FLG-LOOPEND
                   END-IF
      *
                   IF    ( BGS100P-NYUGAIKBN   =   "1" OR "2" )
                       IF    ( BGS100P-NYUGAIKBN
                                           NOT =   BGSMEI-NYUGAIKBN )
                           MOVE    ZERO    TO  FLG-LOOPEND
                       END-IF
                   END-IF
      *
                   IF    ( KEY-SKYSBT      NOT =   SPACE )
                       IF   (( KEY-SKYSBT      =   "1" )
                        AND  ( BGSMEI-SKYSBT   =   "1" ))
                         OR (( KEY-SKYSBT      =   "2" )
                        AND  ( BGSMEI-SKYSBT   =   "2" OR "3" ))
                           CONTINUE
                       ELSE
                           MOVE    ZERO    TO  FLG-LOOPEND
                       END-IF
                   END-IF
      *
                   IF    ( KEY-RECEKA      NOT =   SPACE )
                       IF    ( KEY-RECEKA  NOT =   BGSMEI-RECEKA )
                           MOVE    ZERO    TO  FLG-LOOPEND
                       END-IF
                   END-IF
      *
                   IF    ( BGS100P-HKNKBN-HKN
                                           NOT =   SPACE )
      *
                       IF    ( BGS100P-HKNKBN-HKN
                                               =   "1" OR "2" OR "3" )
                           MOVE    BGS100P-HKNKBN-HKN
                                               TO  WRK-HKNKBN-HKN-G
                           IF    ( WRK-HKNKBN-HKN
                                           NOT =   BGSMEI-HOKEN )
                               MOVE    ZERO    TO  FLG-LOOPEND
                           END-IF
                           IF    ( BGS100P-HKNKBN
                                       NOT =   BGSMEI-SBTKBN-G (1:2))
                               MOVE    ZERO    TO  FLG-LOOPEND
                           END-IF
                       ELSE
                           MOVE        ZERO    TO  FLG-LOOPEND
                       END-IF
                   END-IF
      *
                   IF    ( BGS100P-HKNJANUM
                                           NOT =   SPACE )
                       IF    ( BGS100P-HKNJANUM
                                           NOT =   BGSMEI-HKNJANUM )
                               MOVE    ZERO    TO  FLG-LOOPEND
                       END-IF
                   END-IF
      *
               END-READ
      *
           END-PERFORM
      *
           .
      *
       900-BGSMEI-READ-EXT.
           EXIT.
      *****************************************************************
      *     ›∏±º‘•ﬁ•π•ø∏°∫˜ΩËÕ˝
      *****************************************************************
       900-HKNJAINF-KEY-SEL-SEC        SECTION.
      *
           MOVE    ZERO                TO  FLG-HKNJAINF
      *
           INITIALIZE                      HKNJAINF-REC
           MOVE    SPA-HOSPNUM         TO  HKNJA-HOSPNUM
           MOVE    BGSMEI-HKNJANUM     TO  HKNJA-HKNJANUM
           MOVE    HKNJAINF-REC        TO  MCPDATA-REC
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF ( MCP-RC                 =   ZERO )
               MOVE    MCPDATA-REC     TO  HKNJAINF-REC
           ELSE
               MOVE    1               TO  FLG-HKNJAINF
               INITIALIZE                  HKNJAINF-REC
           END-IF
      *
           MOVE    "tbl_hknjainf"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       900-HKNJAINF-KEY-SEL-EXT.
           EXIT.
      *****************************************************************
      *    ¥µº‘»÷πÊ•ﬁ•π•ø∏°∫˜ΩËÕ˝
      *****************************************************************
       900-PTNUM-KEY-SEL-SEC        SECTION.
      *
           MOVE    ZERO                TO  FLG-PTNUM
      *
           INITIALIZE                      PTNUM-REC
           MOVE    SPA-HOSPNUM         TO  PTNUM-HOSPNUM
           MOVE    BGSMEI-PTID         TO  PTNUM-PTID
           MOVE    PTNUM-REC           TO  MCPDATA-REC
           MOVE    "tbl_ptnum"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF ( MCP-RC                 =   ZERO )
               MOVE    MCPDATA-REC     TO  PTNUM-REC
           ELSE
               MOVE    1               TO  FLG-PTNUM
               INITIALIZE                  PTNUM-REC
           END-IF
      *
           MOVE    "tbl_ptnum"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       900-PTNUM-KEY-SEL-EXT.
           EXIT.
      *****************************************************************
      *    •∑•π•∆•‡¥…Õ˝∏°∫˜ΩËÕ˝
      *****************************************************************
       900-SYSKANRI-KEY10-SEL-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-SYSKANRI
      *
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC          =   ZERO )
               MOVE    MCPDATA-REC     TO  SYSKANRI-REC
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
               INITIALIZE                  SYSKANRI-REC
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
      *
       900-SYSKANRI-KEY10-SEL-EXT.
           EXIT.
      *****************************************************************
      *    £ƒ£¬∏°∫˜ΩËÕ˝° FHETCH§‚π‘§¶)
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
           IF    ( MCP-RC          =   ZERO )
               PERFORM 910-DBFETCH-SEC
           END-IF
      *
           .
      *
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £ƒ£¬∏°∫˜ΩËÕ˝° FHETCH§Úπ‘§Ô§ §§)
      *****************************************************************
       911-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *
           .
      *
       911-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £ƒ£¬∆…§ﬂπ˛§ﬂΩËÕ˝
      *****************************************************************
       910-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *
           .
      *
       910-DBFETCH-EXT.
           EXIT.
      *****************************************************************
      *    £ƒ£¬•Ø•Ì°º•∫ΩËÕ˝
      *****************************************************************
       910-DBCLOSECURSOR-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *
           .
      *
       910-DBCLOSECURSOR-EXT.
           EXIT.
      *****************************************************************
      *    •◊•Ì•∞•È•‡Ω™ŒªΩËÕ˝
      *****************************************************************
       990-EXIT-PROGRAM-SEC            SECTION.
      *
           DISPLAY "ORCBGS121 RC [" BGS100P-RC "]"
      *
           EXIT PROGRAM
      *
           .
       990-EXIT-PROGRAM-EXT.
           EXIT.
