      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSKANGOCHG.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : Æþ±¡
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ´Ç¸î¿¦°÷¿ôÅùÆþ±¡´ðËÜÎÁ¥³¡¼¥É¼èÆÀ¥µ¥Ö
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  16/03/02    NACL¡Ý¾®Æ¦Âô  ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *Ê¿À®£³£°Ç¯£´·î²þÄêÂÐ±þ
      *  05.00.00    NACL-¾®Æ¦Âô  18/03/02  ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¤Î·Ð²á
      *                                     Á¼ÃÖÄÉ²Ã¡Ê´Ç¸îÈæÎ¨£³£°ÂÐ£±¡Ë
      *  05.00.00    NACL-¾®Æ¦Âô  18/03/09  ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë
      *                                     Á¼ÃÖÄÉ²Ã£²¡¦ÄÌÂ§£¸ÂÐ±þ
      *  05.00.00    NACL-¾®Æ¦Âô  20/07/03  ÆÃÄêÆþ±¡ÎÁ¤Î»»ÄêÍ×·ï³°¤ÇÎÅÍÜ
      *                                     ÉÂÅïÆþ±¡ÎÁ¤ò»»Äê»þ¤ÏÊÑ´¹ÂÐ¾Ý³°
      *  05.02.00    ORCAMO       24/03/22  ÎáÏÂ£¶Ç¯£³·î
      *                                     ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê·Ð²áÁ¼ÃÖ¡Ë½ªÎ»ÂÐ±þ
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-PTNYUINRRK      PIC 9(01).
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý
      *
           COPY    "CPSK5000.INC".
      *
           COPY    "CPSK5001.INC".
      *
      *    ´µ¼ÔÆþ±¡ÍúÎò¥Þ¥¹¥¿¡¼
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *
           COPY    "MCPAREA".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    ´Ç¸î¿¦°÷¿ôÅùÆþ±¡´ðËÜÎÁ¥³¡¼¥É¼èÆÀ¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANGOCHG.INC".
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
       PROCEDURE                   DIVISION    USING
           ORCSKANGOCHG-AREA
           SPA-AREA
           .
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                    SECTION.
      *
      *     DISPLAY "== ORCSKANGOCHG =="
      *     DISPLAY "SPA-HOSPNUM = " SPA-HOSPNUM
      *     DISPLAY "SPA-PTID    = " SPA-PTID
      *    Æþ±¡ÍúÎò¤ò¸¡º÷¤·ºÇ½ªÆþ±¡Îò¤ÎÆÃÄêÆþ±¡ÎÁ»»ÄêÍ×·ï¶èÊ¬¤ò¼èÆÀ
           INITIALIZE                    PTNYUINRRK-REC
           MOVE    SPA-HOSPNUM       TO  PTNYUINRRK-HOSPNUM
           MOVE    SPA-PTID          TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC    TO  MCPDATA-REC
           MOVE    "tbl_ptnyuinrrk"  TO  MCP-TABLE
           MOVE    "key9"            TO  MCP-PATHNAME
           PERFORM 910-PTNYUINRRK-SELECT-SEC
           IF      FLG-PTNYUINRRK     =  ZERO
               MOVE    "tbl_ptnyuinrrk"   TO  MCP-TABLE
               MOVE    "key9"             TO  MCP-PATHNAME
               PERFORM 910-PTNYUINRRK-FETCH-SEC
           END-IF
      *
      *     DISPLAY  "PTNYUINRRK-TOKU-SANTEIYOUKENKBN = "
      *               PTNYUINRRK-TOKU-SANTEIYOUKENKBN
           MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
           MOVE    "key9"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    ÆÃÄêÆþ±¡ÎÁ»»ÄêÍ×·ï¶èÊ¬¤¬£±¤Î»þ¤Ï·Ð²áÁ¼ÃÖ¡Ê¸º»»¡Ë¤ÎÃÖ¤­´¹¤¨¤ò
      *    ¹Ô¤ï¤Ê¤¤
           IF      (FLG-PTNYUINRRK              =   ZERO)    AND
                   (PTNYUINRRK-TOKU-SANTEIYOUKENKBN  =    "1")
               MOVE    1                 TO     LNK-KANGOCHG-RC
               GO    TO   000-PROC-EXT
           END-IF
      *
           IF  LNK-KANGOCHG-SANTEIYM       >=   "201604"
      *        ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷¡Ê´Ç¸î¿¦°÷¿ôÅù·Ð²áÁ¼ÃÖ¤Î¶èÊ¬¼èÆÀ¡Ë
               MOVE    SPACE               TO  SYS-5001-REC
               INITIALIZE                      SYS-5001-REC
               MOVE    "5001"              TO  SYS-5001-KANRICD
               MOVE    LNK-KANGOCHG-BTU-NUM
                                           TO  SYS-5001-KBNCD
               MOVE    LNK-KANGOCHG-SANTEIYM
                                           TO  SYS-5001-STYUKYMD(1:6)
               MOVE    "01"                TO  SYS-5001-STYUKYMD(7:2)
               MOVE    SYS-5001-STYUKYMD   TO  SYS-5001-EDYUKYMD
               MOVE    SPA-HOSPNUM         TO  SYS-5001-HOSPNUM
               MOVE    SYS-5001-REC        TO  MCPDATA-REC
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 910-DBSELECT-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    "tbl_syskanri"      TO  MCP-TABLE
                   MOVE    "key10"             TO  MCP-PATHNAME
                   PERFORM 920-DBFETCH-SEC
                   IF      MCP-RC              =   ZERO
                       MOVE    ZERO                TO  FLG-SYSKANRI
                       MOVE    MCPDATA-REC         TO  SYS-5001-REC
                   ELSE
                       MOVE    1                   TO  FLG-SYSKANRI
                   END-IF
               ELSE
                   MOVE    SPACE               TO  SYS-5001-REC
                   INITIALIZE                  SYS-5001-REC
                   MOVE    1               TO  FLG-SYSKANRI
               END-IF
      *
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 990-DBCLOSE-SEC
      *
      *        ±ÉÍÜ´ÉÍýÂÎÀ©¸º»»µ¬Äê³ºÅö¡ÊÄÌÂ§£¸¡Ë¤ÎÂÐ¾Ý³ÎÇ§
               IF  LNK-KANGOCHG-SANTEIYM       >=   "201804"
      *           ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷
                   MOVE    SPACE           TO  SYS-5000-REC
                   INITIALIZE                  SYS-5000-REC
                   MOVE    "5000"          TO  SYS-5000-KANRICD
                   MOVE    "*"             TO  SYS-5000-KBNCD
                   MOVE    LNK-KANGOCHG-SANTEIYM
                                           TO  SYS-5000-STYUKYMD(1:6)
                   MOVE    "01"            TO  SYS-5000-STYUKYMD(7:2)
                   MOVE    SYS-5000-STYUKYMD
                                           TO  SYS-5000-EDYUKYMD
                   MOVE    SPA-HOSPNUM     TO  SYS-5000-HOSPNUM
                   MOVE    SYS-5000-REC    TO  MCPDATA-REC
                   MOVE    "tbl_syskanri"  TO  MCP-TABLE
                   MOVE    "key10"         TO  MCP-PATHNAME
                   PERFORM 910-DBSELECT-SEC
                   IF      MCP-RC              =   ZERO
                       MOVE    "tbl_syskanri"      TO  MCP-TABLE
                       MOVE    "key10"             TO  MCP-PATHNAME
                       PERFORM 920-DBFETCH-SEC
                       IF      MCP-RC              =   ZERO
                           MOVE    ZERO                TO  FLG-SYSKANRI
                           MOVE    MCPDATA-REC         TO  SYS-5000-REC
                       ELSE
                           MOVE    SPACE           TO  SYS-5000-REC
                           INITIALIZE                  SYS-5000-REC
                           MOVE    1                   TO  FLG-SYSKANRI
                       END-IF
                   ELSE
                       MOVE    SPACE           TO  SYS-5000-REC
                       INITIALIZE                  SYS-5000-REC
                       MOVE    1               TO  FLG-SYSKANRI
                   END-IF
      *
                   MOVE    "tbl_syskanri"      TO  MCP-TABLE
                   MOVE    "key10"             TO  MCP-PATHNAME
                   PERFORM 990-DBCLOSE-SEC
               END-IF
      *
      *        Ê¿À®£²£¸Ç¯£´·î²þÄê¡Ê´Ç¸î¿¦°÷¿ôÅù·Ð²áÁ¼ÃÖÆþ±¡´ðËÜÎÁ¡Ë
               IF  LNK-KANGOCHG-SANTEIYM       <=   "201803"
                   IF    SYS-5001-SYOKUINKBN  =   "1"
                       IF    LNK-KANGOCHG-SRYCD    NOT  =  SPACE
                           PERFORM    200-CDCHG-SEC
                       END-IF
                   END-IF
               END-IF
      *
      *        Ê¿À®£³£°Ç¯£´·î²þÄê¡Ê´Ç¸î¿¦°÷¿ôÅù·Ð²áÁ¼ÃÖÆþ±¡´ðËÜÎÁ¡¡·Ð²áÁ¼ÃÖ£±¡Ë
      *        ÎáÏÂ£¶Ç¯£³·î£³£±Æü¤Ç½ªÎ»
               IF  (LNK-KANGOCHG-SANTEIYM       >=   "201804")  AND
                   (LNK-KANGOCHG-SANTEIYM       <=   "202403")
                   IF    SYS-5001-SYOKUINKBN  =   "1"
                       IF    LNK-KANGOCHG-SRYCD    NOT  =  SPACE
                           PERFORM    201-CDCHG-SEC
                       END-IF
                   END-IF
               END-IF
      *
      *        Ê¿À®£³£°Ç¯£´·î²þÄê¡Ê´Ç¸îÈæÎ¨£³£°ÂÐ£±Åù·Ð²áÁ¼ÃÖ¡¡·Ð²áÁ¼ÃÖ£²¡Ë
               IF  LNK-KANGOCHG-SANTEIYM       >=   "201804"
                   IF    SYS-5001-SYOKUINKBN2  =   "1"
                       IF    LNK-KANGOCHG-SRYCD    NOT  =  SPACE
                           PERFORM    202-CDCHG-SEC
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
      *
           IF  LNK-KANGOCHG-SANTEIYM       >=   "202204"
      *        ÎáÏÂ£´Ç¯£´·î²þÄê¡Ê·ÐÁ¼¡§·î£±²ó°Ê¾å£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               IF  LNK-KANGOCHG-SANTEIYM       >=   "202204"
                   IF    PTNYUINRRK-TOKU-SANTEIYOUKENKBN  =   "7"
                       IF    LNK-KANGOCHG-SRYCD    NOT =  SPACE
                           PERFORM    203-CDCHG-SEC
                       END-IF
                   END-IF
               END-IF
           END-IF



           IF    LNK-KANGOCHG-CHGSRYCD   =     SPACE
               MOVE    1                 TO     LNK-KANGOCHG-RC
           END-IF
      *
           .
      *
       000-PROC-EXT.
           EXIT   PROGRAM
           .
      *
      *****************************************************************
      *    ¥³¡¼¥ÉÃÖ¤­´¹¤¨¡Ê´Ç¸î¿¦°÷¿ôÅù·Ð²áÁ¼ÃÖÆþ±¡´ðËÜÎÁ¡Ë
      *    Ê¿À®£²£¸Ç¯£´·î¤«¤éÊ¿À®£³£°Ç¯£³·î¤Þ¤Ç
      *****************************************************************
       200-CDCHG-SEC                    SECTION.
      *
           EVALUATE    LNK-KANGOCHG-SRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Á¡Ë
               WHEN    "190132410"
                  MOVE "190183710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Á¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190132510"
                  MOVE "190183810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Â¡Ë
               WHEN    "190132610"
                  MOVE "190183910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Â¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190132710"
                  MOVE "190184010" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Ã¡Ë
               WHEN    "190132810"
                  MOVE "190184110" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Ã¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190132910"
                  MOVE "190184210" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Ä¡Ë
               WHEN    "190133010"
                  MOVE "190184310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Ä¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190133110"
                  MOVE "190184410" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Å¡Ë
               WHEN    "190133210"
                  MOVE "190184510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Å¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190133310"
                  MOVE "190184610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Æ¡Ë
               WHEN    "190133410"
                  MOVE "190184710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Æ¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190133510"
                  MOVE "190184810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Ç¡Ë
               WHEN    "190133610"
                  MOVE "190184910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£Ç¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190133710"
                  MOVE "190185010" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£È¡Ë
               WHEN    "190133810"
                  MOVE "190185110" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£È¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190133910"
                  MOVE "190185210" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£É¡Ë
               WHEN    "190134010"
                  MOVE "190185310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡´ðËÜÎÁ£²¡ÊÆþ±¡´ðËÜÎÁ£É¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë
               WHEN    "190134110"
                  MOVE "190185410" TO  LNK-KANGOCHG-CHGSRYCD
               WHEN    OTHER
                       CONTINUE
           END-EVALUATE
      *
           .
      *
       200-CDCHG-EXT.
           .
      *
      *****************************************************************
      *    ¥³¡¼¥ÉÃÖ¤­´¹¤¨¡Ê´Ç¸î¿¦°÷¿ôÅù·Ð²áÁ¼ÃÖÆþ±¡´ðËÜÎÁ¡¡·Ð²áÁ¼ÃÖ£±¡Ë
      *    Ê¿À®£³£°Ç¯£´·î¤«¤é
      *****************************************************************
       201-CDCHG-SEC                    SECTION.
      *
           EVALUATE    LNK-KANGOCHG-SRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Á¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190132410"
                  MOVE "190215110" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Á¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190132510"
                  MOVE "190215210" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Â¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190132610"
                  MOVE "190215310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Â¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190132710"
                  MOVE "190215410" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ã¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190132810"
                  MOVE "190215510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ã¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190132910"
                  MOVE "190215610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ä¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133010"
                  MOVE "190215710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ä¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133110"
                  MOVE "190215810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Å¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133210"
                  MOVE "190215910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Å¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133310"
                  MOVE "190216010" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Æ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133410"
                  MOVE "190216110" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Æ¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133510"
                  MOVE "190216210" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ç¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133610"
                  MOVE "190216310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ç¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133710"
                  MOVE "190216410" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£È¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133810"
                  MOVE "190216510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£È¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190133910"
                  MOVE "190216610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190134010"
                  MOVE "190216710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£±¡Ë
               WHEN    "190134110"
                  MOVE "190216810" TO  LNK-KANGOCHG-CHGSRYCD
               WHEN    OTHER
                       CONTINUE
           END-EVALUATE
      *
           .
      *
       201-CDCHG-EXT.
           .
      *
      *****************************************************************
      *    ¥³¡¼¥ÉÃÖ¤­´¹¤¨¡Ê´Ç¸îÈæÎ¨£³£°ÂÐ£±Åù·Ð²áÁ¼ÃÖÆþ±¡´ðËÜÎÁ¡¡·Ð²áÁ¼ÃÖ£²¡Ë
      *    Ê¿À®£³£°Ç¯£´·î¤«¤é
      *****************************************************************
       202-CDCHG-SEC                    SECTION.
      *
           EVALUATE    LNK-KANGOCHG-SRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Á¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190132410"
                  MOVE "190202510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Á¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190132510"
                  MOVE "190202610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Â¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190132610"
                  MOVE "190202710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Â¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190132710"
                  MOVE "190202810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ã¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190132810"
                  MOVE "190202910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ã¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190132910"
                  MOVE "190203010" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ä¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133010"
                  MOVE "190203110" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ä¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133110"
                  MOVE "190203210" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Å¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133210"
                  MOVE "190203310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Å¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133310"
                  MOVE "190203410" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Æ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133410"
                  MOVE "190203510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Æ¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133510"
                  MOVE "190203610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ç¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133610"
                  MOVE "190203710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ç¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133710"
                  MOVE "190203810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£È¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133810"
                  MOVE "190203910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£È¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190133910"
                  MOVE "190204010" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190134010"
                  MOVE "190204110" TO  LNK-KANGOCHG-CHGSRYCD
      *           ÄÌÂ§£¸¤Î»þ¡¢¹¹¤ËÃÖ¤­´¹¤¨
                  IF    SYS-5000-EIYOUKSNKBN   =    "1"
                       MOVE "190204310" TO  LNK-KANGOCHG-CHGSRYCD
                  END-IF
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ£²¡Ë
               WHEN    "190134110"
                  MOVE "190204210" TO  LNK-KANGOCHG-CHGSRYCD
      *           ÄÌÂ§£¸¤Î»þ¡¢¹¹¤ËÃÖ¤­´¹¤¨
                  IF    SYS-5000-EIYOUKSNKBN   =    "1"
                       MOVE "190204410" TO  LNK-KANGOCHG-CHGSRYCD
                  END-IF
               WHEN    OTHER
                       CONTINUE
           END-EVALUATE
      *
           .
      *
       202-CDCHG-EXT.
           .
      *
      *****************************************************************
      *    ¥³¡¼¥ÉÃÖ¤­´¹¤¨¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
      *    ÎáÏÂ£´Ç¯£´·î¤«¤é
      *****************************************************************
       203-CDCHG-SEC                    SECTION.
      *
           EVALUATE    LNK-KANGOCHG-SRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Á¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190132410"
                  MOVE "190238310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Á¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190132510"
                  MOVE "190238410" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Â¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190132610"
                  MOVE "190238510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Â¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190132710"
                  MOVE "190238610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ã¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190132810"
                  MOVE "190238710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ã¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190132910"
                  MOVE "190238810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ä¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133010"
                  MOVE "190238910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ä¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133110"
                  MOVE "190239010" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Å¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133210"
                  MOVE "190239110" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Å¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133310"
                  MOVE "190239210" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Æ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133410"
                  MOVE "190239310" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Æ¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133510"
                  MOVE "190239410" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ç¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133610"
                  MOVE "190239510" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£Ç¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133710"
                  MOVE "190239610" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£È¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133810"
                  MOVE "190239710" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£È¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190133910"
                  MOVE "190239810" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190134010"
                  MOVE "190239910" TO  LNK-KANGOCHG-CHGSRYCD
      *        ÎÅÍÜÉÂÅïÆþ±¡ÎÁ£²¡Ê£É¡Ë¡ÊÀ¸³èÎÅÍÜ¡Ë¡Ê·Ð²áÁ¼ÃÖ¡¡£Æ£É£ÍÂ¬Äê¤Ê¤·¡Ë
               WHEN    "190134110"
                  MOVE "190240010" TO  LNK-KANGOCHG-CHGSRYCD
               WHEN    OTHER
                       CONTINUE
           END-EVALUATE
      *
           .
      *
       203-CDCHG-EXT.
           .
      *
      *****************************************************************
      *    ´µ¼ÔÆþ±¡ÍúÎò¸¡º÷
      *****************************************************************
       910-PTNYUINRRK-SELECT-SEC        SECTION.
      *
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           PERFORM   910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-PTNYUINRRK
           ELSE
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       910-PTNYUINRRK-SELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼ÔÆþ±¡ÍúÎòÆÉ¹þ
      *****************************************************************
       910-PTNYUINRRK-FETCH-SEC        SECTION.
      *
           PERFORM   920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               MOVE    ZERO            TO  FLG-PTNYUINRRK
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       910-PTNYUINRRK-FETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥¹½èÍý
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
